(function(am){typeof define=="function"&&define.amd?define(am):am()})(function(){"use strict";function am(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var Ml=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function TC(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zB(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var AC={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var om=Symbol.for("react.element"),BB=Symbol.for("react.portal"),UB=Symbol.for("react.fragment"),VB=Symbol.for("react.strict_mode"),WB=Symbol.for("react.profiler"),jB=Symbol.for("react.provider"),GB=Symbol.for("react.context"),HB=Symbol.for("react.forward_ref"),qB=Symbol.for("react.suspense"),KB=Symbol.for("react.memo"),XB=Symbol.for("react.lazy"),RC=Symbol.iterator;function YB(t){return t===null||typeof t!="object"?null:(t=RC&&t[RC]||t["@@iterator"],typeof t=="function"?t:null)}var _C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DC=Object.assign,PC={};function gu(t,e,n){this.props=t,this.context=e,this.refs=PC,this.updater=n||_C}gu.prototype.isReactComponent={},gu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},gu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function FC(){}FC.prototype=gu.prototype;function gw(t,e,n){this.props=t,this.context=e,this.refs=PC,this.updater=n||_C}var xw=gw.prototype=new FC;xw.constructor=gw,DC(xw,gu.prototype),xw.isPureReactComponent=!0;var MC=Array.isArray,OC=Object.prototype.hasOwnProperty,yw={current:null},LC={key:!0,ref:!0,__self:!0,__source:!0};function zC(t,e,n){var s,r={},a=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)OC.call(e,s)&&!LC.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:om,type:t,key:a,ref:o,props:r,_owner:yw.current}}function ZB(t,e){return{$$typeof:om,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function bw(t){return typeof t=="object"&&t!==null&&t.$$typeof===om}function JB(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var BC=/\/+/g;function ww(t,e){return typeof t=="object"&&t!==null&&t.key!=null?JB(""+t.key):e.toString(36)}function Hf(t,e,n,s,r){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case om:case BB:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+ww(o,0):s,MC(r)?(n="",t!=null&&(n=t.replace(BC,"$&/")+"/"),Hf(r,e,n,"",function(u){return u})):r!=null&&(bw(r)&&(r=ZB(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(BC,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",MC(t))for(var l=0;l<t.length;l++){a=t[l];var c=s+ww(a,l);o+=Hf(a,e,n,c,r)}else if(c=YB(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=s+ww(a,l++),o+=Hf(a,e,n,c,r);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function qf(t,e,n){if(t==null)return t;var s=[],r=0;return Hf(t,s,"","",function(a){return e.call(n,a,r++)}),s}function QB(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Vs={current:null},Kf={transition:null},eU={ReactCurrentDispatcher:Vs,ReactCurrentBatchConfig:Kf,ReactCurrentOwner:yw};function UC(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:qf,forEach:function(t,e,n){qf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return qf(t,function(){e++}),e},toArray:function(t){return qf(t,function(e){return e})||[]},only:function(t){if(!bw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},It.Component=gu,It.Fragment=UB,It.Profiler=WB,It.PureComponent=gw,It.StrictMode=VB,It.Suspense=qB,It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eU,It.act=UC,It.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=DC({},t.props),r=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=yw.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)OC.call(e,c)&&!LC.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:om,type:t.type,key:r,ref:a,props:s,_owner:o}},It.createContext=function(t){return t={$$typeof:GB,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:jB,_context:t},t.Consumer=t},It.createElement=zC,It.createFactory=function(t){var e=zC.bind(null,t);return e.type=t,e},It.createRef=function(){return{current:null}},It.forwardRef=function(t){return{$$typeof:HB,render:t}},It.isValidElement=bw,It.lazy=function(t){return{$$typeof:XB,_payload:{_status:-1,_result:t},_init:QB}},It.memo=function(t,e){return{$$typeof:KB,type:t,compare:e===void 0?null:e}},It.startTransition=function(t){var e=Kf.transition;Kf.transition={};try{t()}finally{Kf.transition=e}},It.unstable_act=UC,It.useCallback=function(t,e){return Vs.current.useCallback(t,e)},It.useContext=function(t){return Vs.current.useContext(t)},It.useDebugValue=function(){},It.useDeferredValue=function(t){return Vs.current.useDeferredValue(t)},It.useEffect=function(t,e){return Vs.current.useEffect(t,e)},It.useId=function(){return Vs.current.useId()},It.useImperativeHandle=function(t,e,n){return Vs.current.useImperativeHandle(t,e,n)},It.useInsertionEffect=function(t,e){return Vs.current.useInsertionEffect(t,e)},It.useLayoutEffect=function(t,e){return Vs.current.useLayoutEffect(t,e)},It.useMemo=function(t,e){return Vs.current.useMemo(t,e)},It.useReducer=function(t,e,n){return Vs.current.useReducer(t,e,n)},It.useRef=function(t){return Vs.current.useRef(t)},It.useState=function(t){return Vs.current.useState(t)},It.useSyncExternalStore=function(t,e,n){return Vs.current.useSyncExternalStore(t,e,n)},It.useTransition=function(){return Vs.current.useTransition()},It.version="18.3.1",AC.exports=It;var N=AC.exports;const i=TC(N),VC=am({__proto__:null,default:i},[N]);window.__POWERED_BY_QIANKUN__&&(window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__?__webpack_public_path__=window.__INJECTED_PUBLIC_PATH_BY_QIANKUN__:console.warn("[Qiankun] __INJECTED_PUBLIC_PATH_BY_QIANKUN__ is not defined!"));var Xf={};/*!
 * vite-plugin-qiankun.js v1.0.14
 * (c) 2021-2022 Teng Mao Qing
 * Released under the MIT License.
 */Object.defineProperty(Xf,"__esModule",{value:!0});var xu=typeof window<"u"?window.proxy||window:{},WC=function(t){xu?.__POWERED_BY_QIANKUN__&&(window.moudleQiankunAppLifeCycles||(window.moudleQiankunAppLifeCycles={}),xu.qiankunName&&(window.moudleQiankunAppLifeCycles[xu.qiankunName]=t))};Xf.default=WC;var tU=Xf.qiankunWindow=xu;Xf.renderWithQiankun=WC;var jC={exports:{}},vr={},GC={exports:{}},HC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,_){var P=D.length;D.push(_);e:for(;0<P;){var z=P-1>>>1,q=D[z];if(0<r(q,_))D[z]=_,D[P]=q,P=z;else break e}}function n(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var _=D[0],P=D.pop();if(P!==_){D[0]=P;e:for(var z=0,q=D.length,K=q>>>1;z<K;){var ae=2*(z+1)-1,ne=D[ae],Z=ae+1,ke=D[Z];if(0>r(ne,P))Z<q&&0>r(ke,ne)?(D[z]=ke,D[Z]=P,z=Z):(D[z]=ne,D[ae]=P,z=ae);else if(Z<q&&0>r(ke,P))D[z]=ke,D[Z]=P,z=Z;else break e}}return _}function r(D,_){var P=D.sortIndex-_.sortIndex;return P!==0?P:D.id-_.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,m=null,h=3,p=!1,f=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(D){for(var _=n(u);_!==null;){if(_.callback===null)s(u);else if(_.startTime<=D)s(u),_.sortIndex=_.expirationTime,e(c,_);else break;_=n(u)}}function v(D){if(y=!1,w(D),!f)if(n(c)!==null)f=!0,L(E);else{var _=n(u);_!==null&&Y(v,_.startTime-D)}}function E(D,_){f=!1,y&&(y=!1,g(I),I=-1),p=!0;var P=h;try{for(w(_),m=n(c);m!==null&&(!(m.expirationTime>_)||D&&!T());){var z=m.callback;if(typeof z=="function"){m.callback=null,h=m.priorityLevel;var q=z(m.expirationTime<=_);_=t.unstable_now(),typeof q=="function"?m.callback=q:m===n(c)&&s(c),w(_)}else s(c);m=n(c)}if(m!==null)var K=!0;else{var ae=n(u);ae!==null&&Y(v,ae.startTime-_),K=!1}return K}finally{m=null,h=P,p=!1}}var k=!1,C=null,I=-1,A=5,$=-1;function T(){return!(t.unstable_now()-$<A)}function F(){if(C!==null){var D=t.unstable_now();$=D;var _=!0;try{_=C(!0,D)}finally{_?O():(k=!1,C=null)}}else k=!1}var O;if(typeof b=="function")O=function(){b(F)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,B=M.port2;M.port1.onmessage=F,O=function(){B.postMessage(null)}}else O=function(){x(F,0)};function L(D){C=D,k||(k=!0,O())}function Y(D,_){I=x(function(){D(t.unstable_now())},_)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,L(E))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var _=3;break;default:_=h}var P=h;h=_;try{return D()}finally{h=P}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,_){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var P=h;h=D;try{return _()}finally{h=P}},t.unstable_scheduleCallback=function(D,_,P){var z=t.unstable_now();switch(typeof P=="object"&&P!==null?(P=P.delay,P=typeof P=="number"&&0<P?z+P:z):P=z,D){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=P+q,D={id:d++,callback:_,priorityLevel:D,startTime:P,expirationTime:q,sortIndex:-1},P>z?(D.sortIndex=P,e(u,D),n(c)===null&&D===n(u)&&(y?(g(I),I=-1):y=!0,Y(v,P-z))):(D.sortIndex=q,e(c,D),f||p||(f=!0,L(E))),D},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(D){var _=h;return function(){var P=h;h=_;try{return D.apply(this,arguments)}finally{h=P}}}})(HC),GC.exports=HC;var nU=GC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sU=N,Er=nU;function Te(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qC=new Set,im={};function Ol(t,e){yu(t,e),yu(t+"Capture",e)}function yu(t,e){for(im[t]=e,t=0;t<e.length;t++)qC.add(e[t])}var Fo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vw=Object.prototype.hasOwnProperty,rU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,KC={},XC={};function aU(t){return vw.call(XC,t)?!0:vw.call(KC,t)?!1:rU.test(t)?XC[t]=!0:(KC[t]=!0,!1)}function oU(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function iU(t,e,n,s){if(e===null||typeof e>"u"||oU(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ws(t,e,n,s,r,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var hs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){hs[t]=new Ws(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];hs[e]=new Ws(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){hs[t]=new Ws(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){hs[t]=new Ws(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){hs[t]=new Ws(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){hs[t]=new Ws(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){hs[t]=new Ws(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){hs[t]=new Ws(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){hs[t]=new Ws(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ew=/[\-:]([a-z])/g;function Nw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ew,Nw);hs[e]=new Ws(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ew,Nw);hs[e]=new Ws(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ew,Nw);hs[e]=new Ws(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){hs[t]=new Ws(t,1,!1,t.toLowerCase(),null,!1,!1)}),hs.xlinkHref=new Ws("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){hs[t]=new Ws(t,1,!1,t.toLowerCase(),null,!0,!0)});function kw(t,e,n,s){var r=hs.hasOwnProperty(e)?hs[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(iU(e,n,r,s)&&(n=null),s||r===null?aU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Mo=sU.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yf=Symbol.for("react.element"),bu=Symbol.for("react.portal"),wu=Symbol.for("react.fragment"),Sw=Symbol.for("react.strict_mode"),Cw=Symbol.for("react.profiler"),YC=Symbol.for("react.provider"),ZC=Symbol.for("react.context"),Iw=Symbol.for("react.forward_ref"),$w=Symbol.for("react.suspense"),Tw=Symbol.for("react.suspense_list"),Aw=Symbol.for("react.memo"),Ci=Symbol.for("react.lazy"),JC=Symbol.for("react.offscreen"),QC=Symbol.iterator;function lm(t){return t===null||typeof t!="object"?null:(t=QC&&t[QC]||t["@@iterator"],typeof t=="function"?t:null)}var vn=Object.assign,Rw;function cm(t){if(Rw===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Rw=e&&e[1]||""}return`
`+Rw+t}var _w=!1;function Dw(t,e){if(!t||_w)return"";_w=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),a=s.stack.split(`
`),o=r.length-1,l=a.length-1;1<=o&&0<=l&&r[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==a[l]){var c=`
`+r[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{_w=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cm(t):""}function lU(t){switch(t.tag){case 5:return cm(t.type);case 16:return cm("Lazy");case 13:return cm("Suspense");case 19:return cm("SuspenseList");case 0:case 2:case 15:return t=Dw(t.type,!1),t;case 11:return t=Dw(t.type.render,!1),t;case 1:return t=Dw(t.type,!0),t;default:return""}}function Pw(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wu:return"Fragment";case bu:return"Portal";case Cw:return"Profiler";case Sw:return"StrictMode";case $w:return"Suspense";case Tw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ZC:return(t.displayName||"Context")+".Consumer";case YC:return(t._context.displayName||"Context")+".Provider";case Iw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Aw:return e=t.displayName||null,e!==null?e:Pw(t.type)||"Memo";case Ci:e=t._payload,t=t._init;try{return Pw(t(e))}catch{}}return null}function cU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pw(e);case 8:return e===Sw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ii(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function eI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uU(t){var e=eI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,a=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Zf(t){t._valueTracker||(t._valueTracker=uU(t))}function tI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=eI(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Jf(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fw(t,e){var n=e.checked;return vn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function nI(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Ii(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sI(t,e){e=e.checked,e!=null&&kw(t,"checked",e,!1)}function Mw(t,e){sI(t,e);var n=Ii(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ow(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ow(t,e.type,Ii(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rI(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ow(t,e,n){(e!=="number"||Jf(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var um=Array.isArray;function vu(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Ii(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Lw(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Te(91));return vn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function aI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Te(92));if(um(n)){if(1<n.length)throw Error(Te(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ii(n)}}function oI(t,e){var n=Ii(e.value),s=Ii(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function iI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function lI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?lI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Qf,cI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Qf=Qf||document.createElement("div"),Qf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Qf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function dm(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var mm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dU=["Webkit","ms","Moz","O"];Object.keys(mm).forEach(function(t){dU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),mm[e]=mm[t]})});function uI(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||mm.hasOwnProperty(t)&&mm[t]?(""+e).trim():e+"px"}function dI(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=uI(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var mU=vn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bw(t,e){if(e){if(mU[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Te(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Te(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Te(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Te(62))}}function Uw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vw=null;function Ww(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jw=null,Eu=null,Nu=null;function mI(t){if(t=Pm(t)){if(typeof jw!="function")throw Error(Te(280));var e=t.stateNode;e&&(e=Eg(e),jw(t.stateNode,t.type,e))}}function hI(t){Eu?Nu?Nu.push(t):Nu=[t]:Eu=t}function pI(){if(Eu){var t=Eu,e=Nu;if(Nu=Eu=null,mI(t),e)for(t=0;t<e.length;t++)mI(e[t])}}function fI(t,e){return t(e)}function gI(){}var Gw=!1;function xI(t,e,n){if(Gw)return t(e,n);Gw=!0;try{return fI(t,e,n)}finally{Gw=!1,(Eu!==null||Nu!==null)&&(gI(),pI())}}function hm(t,e){var n=t.stateNode;if(n===null)return null;var s=Eg(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Te(231,e,typeof n));return n}var Hw=!1;if(Fo)try{var pm={};Object.defineProperty(pm,"passive",{get:function(){Hw=!0}}),window.addEventListener("test",pm,pm),window.removeEventListener("test",pm,pm)}catch{Hw=!1}function hU(t,e,n,s,r,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var fm=!1,eg=null,tg=!1,qw=null,pU={onError:function(t){fm=!0,eg=t}};function fU(t,e,n,s,r,a,o,l,c){fm=!1,eg=null,hU.apply(pU,arguments)}function gU(t,e,n,s,r,a,o,l,c){if(fU.apply(this,arguments),fm){if(fm){var u=eg;fm=!1,eg=null}else throw Error(Te(198));tg||(tg=!0,qw=u)}}function Ll(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function yI(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bI(t){if(Ll(t)!==t)throw Error(Te(188))}function xU(t){var e=t.alternate;if(!e){if(e=Ll(t),e===null)throw Error(Te(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var a=r.alternate;if(a===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===n)return bI(r),t;if(a===s)return bI(r),e;a=a.sibling}throw Error(Te(188))}if(n.return!==s.return)n=r,s=a;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,s=a;break}if(l===s){o=!0,s=r,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,s=r;break}if(l===s){o=!0,s=a,n=r;break}l=l.sibling}if(!o)throw Error(Te(189))}}if(n.alternate!==s)throw Error(Te(190))}if(n.tag!==3)throw Error(Te(188));return n.stateNode.current===n?t:e}function wI(t){return t=xU(t),t!==null?vI(t):null}function vI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vI(t);if(e!==null)return e;t=t.sibling}return null}var EI=Er.unstable_scheduleCallback,NI=Er.unstable_cancelCallback,yU=Er.unstable_shouldYield,bU=Er.unstable_requestPaint,Dn=Er.unstable_now,wU=Er.unstable_getCurrentPriorityLevel,Kw=Er.unstable_ImmediatePriority,kI=Er.unstable_UserBlockingPriority,ng=Er.unstable_NormalPriority,vU=Er.unstable_LowPriority,SI=Er.unstable_IdlePriority,sg=null,Xa=null;function EU(t){if(Xa&&typeof Xa.onCommitFiberRoot=="function")try{Xa.onCommitFiberRoot(sg,t,void 0,(t.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:SU,NU=Math.log,kU=Math.LN2;function SU(t){return t>>>=0,t===0?32:31-(NU(t)/kU|0)|0}var rg=64,ag=4194304;function gm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function og(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,a=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~r;l!==0?s=gm(l):(a&=o,a!==0&&(s=gm(a)))}else o=n&~r,o!==0?s=gm(o):a!==0&&(s=gm(a));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,a=e&-e,r>=a||r===16&&(a&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-ya(e),r=1<<n,s|=t[n],e&=~r;return s}function CU(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IU(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-ya(a),l=1<<o,c=r[o];c===-1?(!(l&n)||l&s)&&(r[o]=CU(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function Xw(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function CI(){var t=rg;return rg<<=1,!(rg&4194240)&&(rg=64),t}function Yw(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function xm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ya(e),t[e]=n}function $U(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-ya(n),a=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~a}}function Zw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-ya(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var Kt=0;function II(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var $I,Jw,TI,AI,RI,Qw=!1,ig=[],$i=null,Ti=null,Ai=null,ym=new Map,bm=new Map,Ri=[],TU="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _I(t,e){switch(t){case"focusin":case"focusout":$i=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":Ai=null;break;case"pointerover":case"pointerout":ym.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bm.delete(e.pointerId)}}function wm(t,e,n,s,r,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:a,targetContainers:[r]},e!==null&&(e=Pm(e),e!==null&&Jw(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function AU(t,e,n,s,r){switch(e){case"focusin":return $i=wm($i,t,e,n,s,r),!0;case"dragenter":return Ti=wm(Ti,t,e,n,s,r),!0;case"mouseover":return Ai=wm(Ai,t,e,n,s,r),!0;case"pointerover":var a=r.pointerId;return ym.set(a,wm(ym.get(a)||null,t,e,n,s,r)),!0;case"gotpointercapture":return a=r.pointerId,bm.set(a,wm(bm.get(a)||null,t,e,n,s,r)),!0}return!1}function DI(t){var e=zl(t.target);if(e!==null){var n=Ll(e);if(n!==null){if(e=n.tag,e===13){if(e=yI(n),e!==null){t.blockedOn=e,RI(t.priority,function(){TI(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=tv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Vw=s,n.target.dispatchEvent(s),Vw=null}else return e=Pm(n),e!==null&&Jw(e),t.blockedOn=n,!1;e.shift()}return!0}function PI(t,e,n){lg(t)&&n.delete(e)}function RU(){Qw=!1,$i!==null&&lg($i)&&($i=null),Ti!==null&&lg(Ti)&&(Ti=null),Ai!==null&&lg(Ai)&&(Ai=null),ym.forEach(PI),bm.forEach(PI)}function vm(t,e){t.blockedOn===e&&(t.blockedOn=null,Qw||(Qw=!0,Er.unstable_scheduleCallback(Er.unstable_NormalPriority,RU)))}function Em(t){function e(r){return vm(r,t)}if(0<ig.length){vm(ig[0],t);for(var n=1;n<ig.length;n++){var s=ig[n];s.blockedOn===t&&(s.blockedOn=null)}}for($i!==null&&vm($i,t),Ti!==null&&vm(Ti,t),Ai!==null&&vm(Ai,t),ym.forEach(e),bm.forEach(e),n=0;n<Ri.length;n++)s=Ri[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Ri.length&&(n=Ri[0],n.blockedOn===null);)DI(n),n.blockedOn===null&&Ri.shift()}var ku=Mo.ReactCurrentBatchConfig,cg=!0;function _U(t,e,n,s){var r=Kt,a=ku.transition;ku.transition=null;try{Kt=1,ev(t,e,n,s)}finally{Kt=r,ku.transition=a}}function DU(t,e,n,s){var r=Kt,a=ku.transition;ku.transition=null;try{Kt=4,ev(t,e,n,s)}finally{Kt=r,ku.transition=a}}function ev(t,e,n,s){if(cg){var r=tv(t,e,n,s);if(r===null)yv(t,e,s,ug,n),_I(t,s);else if(AU(r,t,e,n,s))s.stopPropagation();else if(_I(t,s),e&4&&-1<TU.indexOf(t)){for(;r!==null;){var a=Pm(r);if(a!==null&&$I(a),a=tv(t,e,n,s),a===null&&yv(t,e,s,ug,n),a===r)break;r=a}r!==null&&s.stopPropagation()}else yv(t,e,s,null,n)}}var ug=null;function tv(t,e,n,s){if(ug=null,t=Ww(s),t=zl(t),t!==null)if(e=Ll(t),e===null)t=null;else if(n=e.tag,n===13){if(t=yI(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ug=t,null}function FI(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wU()){case Kw:return 1;case kI:return 4;case ng:case vU:return 16;case SI:return 536870912;default:return 16}default:return 16}}var _i=null,nv=null,dg=null;function MI(){if(dg)return dg;var t,e=nv,n=e.length,s,r="value"in _i?_i.value:_i.textContent,a=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[a-s];s++);return dg=r.slice(t,1<s?1-s:void 0)}function mg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hg(){return!0}function OI(){return!1}function Nr(t){function e(n,s,r,a,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?hg:OI,this.isPropagationStopped=OI,this}return vn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hg)},persist:function(){},isPersistent:hg}),e}var Su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sv=Nr(Su),Nm=vn({},Su,{view:0,detail:0}),PU=Nr(Nm),rv,av,km,pg=vn({},Nm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:iv,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==km&&(km&&t.type==="mousemove"?(rv=t.screenX-km.screenX,av=t.screenY-km.screenY):av=rv=0,km=t),rv)},movementY:function(t){return"movementY"in t?t.movementY:av}}),LI=Nr(pg),FU=vn({},pg,{dataTransfer:0}),MU=Nr(FU),OU=vn({},Nm,{relatedTarget:0}),ov=Nr(OU),LU=vn({},Su,{animationName:0,elapsedTime:0,pseudoElement:0}),zU=Nr(LU),BU=vn({},Su,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UU=Nr(BU),VU=vn({},Su,{data:0}),zI=Nr(VU),WU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GU[t])?!!e[t]:!1}function iv(){return HU}var qU=vn({},Nm,{key:function(t){if(t.key){var e=WU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=mg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?jU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:iv,charCode:function(t){return t.type==="keypress"?mg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?mg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KU=Nr(qU),XU=vn({},pg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),BI=Nr(XU),YU=vn({},Nm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:iv}),ZU=Nr(YU),JU=vn({},Su,{propertyName:0,elapsedTime:0,pseudoElement:0}),QU=Nr(JU),eV=vn({},pg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tV=Nr(eV),nV=[9,13,27,32],lv=Fo&&"CompositionEvent"in window,Sm=null;Fo&&"documentMode"in document&&(Sm=document.documentMode);var sV=Fo&&"TextEvent"in window&&!Sm,UI=Fo&&(!lv||Sm&&8<Sm&&11>=Sm),VI=" ",WI=!1;function jI(t,e){switch(t){case"keyup":return nV.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Cu=!1;function rV(t,e){switch(t){case"compositionend":return GI(e);case"keypress":return e.which!==32?null:(WI=!0,VI);case"textInput":return t=e.data,t===VI&&WI?null:t;default:return null}}function aV(t,e){if(Cu)return t==="compositionend"||!lv&&jI(t,e)?(t=MI(),dg=nv=_i=null,Cu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return UI&&e.locale!=="ko"?null:e.data;default:return null}}var oV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!oV[t.type]:e==="textarea"}function qI(t,e,n,s){hI(s),e=bg(e,"onChange"),0<e.length&&(n=new sv("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Cm=null,Im=null;function iV(t){d$(t,0)}function fg(t){var e=Ru(t);if(tI(e))return t}function lV(t,e){if(t==="change")return e}var KI=!1;if(Fo){var cv;if(Fo){var uv="oninput"in document;if(!uv){var XI=document.createElement("div");XI.setAttribute("oninput","return;"),uv=typeof XI.oninput=="function"}cv=uv}else cv=!1;KI=cv&&(!document.documentMode||9<document.documentMode)}function YI(){Cm&&(Cm.detachEvent("onpropertychange",ZI),Im=Cm=null)}function ZI(t){if(t.propertyName==="value"&&fg(Im)){var e=[];qI(e,Im,t,Ww(t)),xI(iV,e)}}function cV(t,e,n){t==="focusin"?(YI(),Cm=e,Im=n,Cm.attachEvent("onpropertychange",ZI)):t==="focusout"&&YI()}function uV(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fg(Im)}function dV(t,e){if(t==="click")return fg(e)}function mV(t,e){if(t==="input"||t==="change")return fg(e)}function hV(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ba=typeof Object.is=="function"?Object.is:hV;function $m(t,e){if(ba(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!vw.call(e,r)||!ba(t[r],e[r]))return!1}return!0}function JI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function QI(t,e){var n=JI(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=JI(n)}}function e$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?e$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function t$(){for(var t=window,e=Jf();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jf(t.document)}return e}function dv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function pV(t){var e=t$(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&e$(n.ownerDocument.documentElement,n)){if(s!==null&&dv(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,a=Math.min(s.start,r);s=s.end===void 0?a:Math.min(s.end,r),!t.extend&&a>s&&(r=s,s=a,a=r),r=QI(n,a);var o=QI(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),a>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var fV=Fo&&"documentMode"in document&&11>=document.documentMode,Iu=null,mv=null,Tm=null,hv=!1;function n$(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;hv||Iu==null||Iu!==Jf(s)||(s=Iu,"selectionStart"in s&&dv(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Tm&&$m(Tm,s)||(Tm=s,s=bg(mv,"onSelect"),0<s.length&&(e=new sv("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Iu)))}function gg(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var $u={animationend:gg("Animation","AnimationEnd"),animationiteration:gg("Animation","AnimationIteration"),animationstart:gg("Animation","AnimationStart"),transitionend:gg("Transition","TransitionEnd")},pv={},s$={};Fo&&(s$=document.createElement("div").style,"AnimationEvent"in window||(delete $u.animationend.animation,delete $u.animationiteration.animation,delete $u.animationstart.animation),"TransitionEvent"in window||delete $u.transitionend.transition);function xg(t){if(pv[t])return pv[t];if(!$u[t])return t;var e=$u[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in s$)return pv[t]=e[n];return t}var r$=xg("animationend"),a$=xg("animationiteration"),o$=xg("animationstart"),i$=xg("transitionend"),l$=new Map,c$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Di(t,e){l$.set(t,e),Ol(e,[t])}for(var fv=0;fv<c$.length;fv++){var gv=c$[fv],gV=gv.toLowerCase(),xV=gv[0].toUpperCase()+gv.slice(1);Di(gV,"on"+xV)}Di(r$,"onAnimationEnd"),Di(a$,"onAnimationIteration"),Di(o$,"onAnimationStart"),Di("dblclick","onDoubleClick"),Di("focusin","onFocus"),Di("focusout","onBlur"),Di(i$,"onTransitionEnd"),yu("onMouseEnter",["mouseout","mouseover"]),yu("onMouseLeave",["mouseout","mouseover"]),yu("onPointerEnter",["pointerout","pointerover"]),yu("onPointerLeave",["pointerout","pointerover"]),Ol("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ol("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ol("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ol("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ol("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ol("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Am="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yV=new Set("cancel close invalid load scroll toggle".split(" ").concat(Am));function u$(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,gU(s,e,void 0,t),t.currentTarget=null}function d$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var a=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&r.isPropagationStopped())break e;u$(r,l,u),a=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&r.isPropagationStopped())break e;u$(r,l,u),a=c}}}if(tg)throw t=qw,tg=!1,qw=null,t}function dn(t,e){var n=e[kv];n===void 0&&(n=e[kv]=new Set);var s=t+"__bubble";n.has(s)||(m$(e,t,2,!1),n.add(s))}function xv(t,e,n){var s=0;e&&(s|=4),m$(n,t,s,e)}var yg="_reactListening"+Math.random().toString(36).slice(2);function Rm(t){if(!t[yg]){t[yg]=!0,qC.forEach(function(n){n!=="selectionchange"&&(yV.has(n)||xv(n,!1,t),xv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[yg]||(e[yg]=!0,xv("selectionchange",!1,e))}}function m$(t,e,n,s){switch(FI(e)){case 1:var r=_U;break;case 4:r=DU;break;default:r=ev}n=r.bind(null,e,n,t),r=void 0,!Hw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function yv(t,e,n,s,r){var a=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=zl(l),o===null)return;if(c=o.tag,c===5||c===6){s=a=o;continue e}l=l.parentNode}}s=s.return}xI(function(){var u=a,d=Ww(n),m=[];e:{var h=l$.get(t);if(h!==void 0){var p=sv,f=t;switch(t){case"keypress":if(mg(n)===0)break e;case"keydown":case"keyup":p=KU;break;case"focusin":f="focus",p=ov;break;case"focusout":f="blur",p=ov;break;case"beforeblur":case"afterblur":p=ov;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=LI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=MU;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=ZU;break;case r$:case a$:case o$:p=zU;break;case i$:p=QU;break;case"scroll":p=PU;break;case"wheel":p=tV;break;case"copy":case"cut":case"paste":p=UU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=BI}var y=(e&4)!==0,x=!y&&t==="scroll",g=y?h!==null?h+"Capture":null:h;y=[];for(var b=u,w;b!==null;){w=b;var v=w.stateNode;if(w.tag===5&&v!==null&&(w=v,g!==null&&(v=hm(b,g),v!=null&&y.push(_m(b,v,w)))),x)break;b=b.return}0<y.length&&(h=new p(h,f,null,n,d),m.push({event:h,listeners:y}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&n!==Vw&&(f=n.relatedTarget||n.fromElement)&&(zl(f)||f[Oo]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(f=n.relatedTarget||n.toElement,p=u,f=f?zl(f):null,f!==null&&(x=Ll(f),f!==x||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=u),p!==f)){if(y=LI,v="onMouseLeave",g="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(y=BI,v="onPointerLeave",g="onPointerEnter",b="pointer"),x=p==null?h:Ru(p),w=f==null?h:Ru(f),h=new y(v,b+"leave",p,n,d),h.target=x,h.relatedTarget=w,v=null,zl(d)===u&&(y=new y(g,b+"enter",f,n,d),y.target=w,y.relatedTarget=x,v=y),x=v,p&&f)t:{for(y=p,g=f,b=0,w=y;w;w=Tu(w))b++;for(w=0,v=g;v;v=Tu(v))w++;for(;0<b-w;)y=Tu(y),b--;for(;0<w-b;)g=Tu(g),w--;for(;b--;){if(y===g||g!==null&&y===g.alternate)break t;y=Tu(y),g=Tu(g)}y=null}else y=null;p!==null&&h$(m,h,p,y,!1),f!==null&&x!==null&&h$(m,x,f,y,!0)}}e:{if(h=u?Ru(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var E=lV;else if(HI(h))if(KI)E=mV;else{E=uV;var k=cV}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=dV);if(E&&(E=E(t,u))){qI(m,E,n,d);break e}k&&k(t,h,u),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&Ow(h,"number",h.value)}switch(k=u?Ru(u):window,t){case"focusin":(HI(k)||k.contentEditable==="true")&&(Iu=k,mv=u,Tm=null);break;case"focusout":Tm=mv=Iu=null;break;case"mousedown":hv=!0;break;case"contextmenu":case"mouseup":case"dragend":hv=!1,n$(m,n,d);break;case"selectionchange":if(fV)break;case"keydown":case"keyup":n$(m,n,d)}var C;if(lv)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Cu?jI(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(UI&&n.locale!=="ko"&&(Cu||I!=="onCompositionStart"?I==="onCompositionEnd"&&Cu&&(C=MI()):(_i=d,nv="value"in _i?_i.value:_i.textContent,Cu=!0)),k=bg(u,I),0<k.length&&(I=new zI(I,t,null,n,d),m.push({event:I,listeners:k}),C?I.data=C:(C=GI(n),C!==null&&(I.data=C)))),(C=sV?rV(t,n):aV(t,n))&&(u=bg(u,"onBeforeInput"),0<u.length&&(d=new zI("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=C))}d$(m,e)})}function _m(t,e,n){return{instance:t,listener:e,currentTarget:n}}function bg(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=hm(t,n),a!=null&&s.unshift(_m(t,a,r)),a=hm(t,e),a!=null&&s.push(_m(t,a,r))),t=t.return}return s}function Tu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function h$(t,e,n,s,r){for(var a=e._reactName,o=[];n!==null&&n!==s;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,r?(c=hm(n,a),c!=null&&o.unshift(_m(n,c,l))):r||(c=hm(n,a),c!=null&&o.push(_m(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var bV=/\r\n?/g,wV=/\u0000|\uFFFD/g;function p$(t){return(typeof t=="string"?t:""+t).replace(bV,`
`).replace(wV,"")}function wg(t,e,n){if(e=p$(e),p$(t)!==e&&n)throw Error(Te(425))}function vg(){}var bv=null,wv=null;function vv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ev=typeof setTimeout=="function"?setTimeout:void 0,vV=typeof clearTimeout=="function"?clearTimeout:void 0,f$=typeof Promise=="function"?Promise:void 0,EV=typeof queueMicrotask=="function"?queueMicrotask:typeof f$<"u"?function(t){return f$.resolve(null).then(t).catch(NV)}:Ev;function NV(t){setTimeout(function(){throw t})}function Nv(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),Em(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Em(e)}function Pi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function g$(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Au=Math.random().toString(36).slice(2),Ya="__reactFiber$"+Au,Dm="__reactProps$"+Au,Oo="__reactContainer$"+Au,kv="__reactEvents$"+Au,kV="__reactListeners$"+Au,SV="__reactHandles$"+Au;function zl(t){var e=t[Ya];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Oo]||n[Ya]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=g$(t);t!==null;){if(n=t[Ya])return n;t=g$(t)}return e}t=n,n=t.parentNode}return null}function Pm(t){return t=t[Ya]||t[Oo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ru(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Te(33))}function Eg(t){return t[Dm]||null}var Sv=[],_u=-1;function Fi(t){return{current:t}}function mn(t){0>_u||(t.current=Sv[_u],Sv[_u]=null,_u--)}function an(t,e){_u++,Sv[_u]=t.current,t.current=e}var Mi={},Ss=Fi(Mi),tr=Fi(!1),Bl=Mi;function Du(t,e){var n=t.type.contextTypes;if(!n)return Mi;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in n)r[a]=e[a];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function nr(t){return t=t.childContextTypes,t!=null}function Ng(){mn(tr),mn(Ss)}function x$(t,e,n){if(Ss.current!==Mi)throw Error(Te(168));an(Ss,e),an(tr,n)}function y$(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(Te(108,cU(t)||"Unknown",r));return vn({},n,s)}function kg(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Mi,Bl=Ss.current,an(Ss,t),an(tr,tr.current),!0}function b$(t,e,n){var s=t.stateNode;if(!s)throw Error(Te(169));n?(t=y$(t,e,Bl),s.__reactInternalMemoizedMergedChildContext=t,mn(tr),mn(Ss),an(Ss,t)):mn(tr),an(tr,n)}var Lo=null,Sg=!1,Cv=!1;function w$(t){Lo===null?Lo=[t]:Lo.push(t)}function CV(t){Sg=!0,w$(t)}function Oi(){if(!Cv&&Lo!==null){Cv=!0;var t=0,e=Kt;try{var n=Lo;for(Kt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Lo=null,Sg=!1}catch(r){throw Lo!==null&&(Lo=Lo.slice(t+1)),EI(Kw,Oi),r}finally{Kt=e,Cv=!1}}return null}var Pu=[],Fu=0,Cg=null,Ig=0,zr=[],Br=0,Ul=null,zo=1,Bo="";function Vl(t,e){Pu[Fu++]=Ig,Pu[Fu++]=Cg,Cg=t,Ig=e}function v$(t,e,n){zr[Br++]=zo,zr[Br++]=Bo,zr[Br++]=Ul,Ul=t;var s=zo;t=Bo;var r=32-ya(s)-1;s&=~(1<<r),n+=1;var a=32-ya(e)+r;if(30<a){var o=r-r%5;a=(s&(1<<o)-1).toString(32),s>>=o,r-=o,zo=1<<32-ya(e)+r|n<<r|s,Bo=a+t}else zo=1<<a|n<<r|s,Bo=t}function Iv(t){t.return!==null&&(Vl(t,1),v$(t,1,0))}function $v(t){for(;t===Cg;)Cg=Pu[--Fu],Pu[Fu]=null,Ig=Pu[--Fu],Pu[Fu]=null;for(;t===Ul;)Ul=zr[--Br],zr[Br]=null,Bo=zr[--Br],zr[Br]=null,zo=zr[--Br],zr[Br]=null}var kr=null,Sr=null,xn=!1,wa=null;function E$(t,e){var n=jr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function N$(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,kr=t,Sr=Pi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,kr=t,Sr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ul!==null?{id:zo,overflow:Bo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=jr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,kr=t,Sr=null,!0):!1;default:return!1}}function Tv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Av(t){if(xn){var e=Sr;if(e){var n=e;if(!N$(t,e)){if(Tv(t))throw Error(Te(418));e=Pi(n.nextSibling);var s=kr;e&&N$(t,e)?E$(s,n):(t.flags=t.flags&-4097|2,xn=!1,kr=t)}}else{if(Tv(t))throw Error(Te(418));t.flags=t.flags&-4097|2,xn=!1,kr=t}}}function k$(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;kr=t}function $g(t){if(t!==kr)return!1;if(!xn)return k$(t),xn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vv(t.type,t.memoizedProps)),e&&(e=Sr)){if(Tv(t))throw S$(),Error(Te(418));for(;e;)E$(t,e),e=Pi(e.nextSibling)}if(k$(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Te(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sr=Pi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sr=null}}else Sr=kr?Pi(t.stateNode.nextSibling):null;return!0}function S$(){for(var t=Sr;t;)t=Pi(t.nextSibling)}function Mu(){Sr=kr=null,xn=!1}function Rv(t){wa===null?wa=[t]:wa.push(t)}var IV=Mo.ReactCurrentBatchConfig;function Fm(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Te(309));var s=n.stateNode}if(!s)throw Error(Te(147,t));var r=s,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=r.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error(Te(284));if(!n._owner)throw Error(Te(290,t))}return t}function Tg(t,e){throw t=Object.prototype.toString.call(e),Error(Te(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function C$(t){var e=t._init;return e(t._payload)}function I$(t){function e(g,b){if(t){var w=g.deletions;w===null?(g.deletions=[b],g.flags|=16):w.push(b)}}function n(g,b){if(!t)return null;for(;b!==null;)e(g,b),b=b.sibling;return null}function s(g,b){for(g=new Map;b!==null;)b.key!==null?g.set(b.key,b):g.set(b.index,b),b=b.sibling;return g}function r(g,b){return g=Gi(g,b),g.index=0,g.sibling=null,g}function a(g,b,w){return g.index=w,t?(w=g.alternate,w!==null?(w=w.index,w<b?(g.flags|=2,b):w):(g.flags|=2,b)):(g.flags|=1048576,b)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,b,w,v){return b===null||b.tag!==6?(b=E1(w,g.mode,v),b.return=g,b):(b=r(b,w),b.return=g,b)}function c(g,b,w,v){var E=w.type;return E===wu?d(g,b,w.props.children,v,w.key):b!==null&&(b.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ci&&C$(E)===b.type)?(v=r(b,w.props),v.ref=Fm(g,b,w),v.return=g,v):(v=Qg(w.type,w.key,w.props,null,g.mode,v),v.ref=Fm(g,b,w),v.return=g,v)}function u(g,b,w,v){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=N1(w,g.mode,v),b.return=g,b):(b=r(b,w.children||[]),b.return=g,b)}function d(g,b,w,v,E){return b===null||b.tag!==7?(b=Yl(w,g.mode,v,E),b.return=g,b):(b=r(b,w),b.return=g,b)}function m(g,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=E1(""+b,g.mode,w),b.return=g,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Yf:return w=Qg(b.type,b.key,b.props,null,g.mode,w),w.ref=Fm(g,null,b),w.return=g,w;case bu:return b=N1(b,g.mode,w),b.return=g,b;case Ci:var v=b._init;return m(g,v(b._payload),w)}if(um(b)||lm(b))return b=Yl(b,g.mode,w,null),b.return=g,b;Tg(g,b)}return null}function h(g,b,w,v){var E=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:l(g,b,""+w,v);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Yf:return w.key===E?c(g,b,w,v):null;case bu:return w.key===E?u(g,b,w,v):null;case Ci:return E=w._init,h(g,b,E(w._payload),v)}if(um(w)||lm(w))return E!==null?null:d(g,b,w,v,null);Tg(g,w)}return null}function p(g,b,w,v,E){if(typeof v=="string"&&v!==""||typeof v=="number")return g=g.get(w)||null,l(b,g,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Yf:return g=g.get(v.key===null?w:v.key)||null,c(b,g,v,E);case bu:return g=g.get(v.key===null?w:v.key)||null,u(b,g,v,E);case Ci:var k=v._init;return p(g,b,w,k(v._payload),E)}if(um(v)||lm(v))return g=g.get(w)||null,d(b,g,v,E,null);Tg(b,v)}return null}function f(g,b,w,v){for(var E=null,k=null,C=b,I=b=0,A=null;C!==null&&I<w.length;I++){C.index>I?(A=C,C=null):A=C.sibling;var $=h(g,C,w[I],v);if($===null){C===null&&(C=A);break}t&&C&&$.alternate===null&&e(g,C),b=a($,b,I),k===null?E=$:k.sibling=$,k=$,C=A}if(I===w.length)return n(g,C),xn&&Vl(g,I),E;if(C===null){for(;I<w.length;I++)C=m(g,w[I],v),C!==null&&(b=a(C,b,I),k===null?E=C:k.sibling=C,k=C);return xn&&Vl(g,I),E}for(C=s(g,C);I<w.length;I++)A=p(C,g,I,w[I],v),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?I:A.key),b=a(A,b,I),k===null?E=A:k.sibling=A,k=A);return t&&C.forEach(function(T){return e(g,T)}),xn&&Vl(g,I),E}function y(g,b,w,v){var E=lm(w);if(typeof E!="function")throw Error(Te(150));if(w=E.call(w),w==null)throw Error(Te(151));for(var k=E=null,C=b,I=b=0,A=null,$=w.next();C!==null&&!$.done;I++,$=w.next()){C.index>I?(A=C,C=null):A=C.sibling;var T=h(g,C,$.value,v);if(T===null){C===null&&(C=A);break}t&&C&&T.alternate===null&&e(g,C),b=a(T,b,I),k===null?E=T:k.sibling=T,k=T,C=A}if($.done)return n(g,C),xn&&Vl(g,I),E;if(C===null){for(;!$.done;I++,$=w.next())$=m(g,$.value,v),$!==null&&(b=a($,b,I),k===null?E=$:k.sibling=$,k=$);return xn&&Vl(g,I),E}for(C=s(g,C);!$.done;I++,$=w.next())$=p(C,g,I,$.value,v),$!==null&&(t&&$.alternate!==null&&C.delete($.key===null?I:$.key),b=a($,b,I),k===null?E=$:k.sibling=$,k=$);return t&&C.forEach(function(F){return e(g,F)}),xn&&Vl(g,I),E}function x(g,b,w,v){if(typeof w=="object"&&w!==null&&w.type===wu&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Yf:e:{for(var E=w.key,k=b;k!==null;){if(k.key===E){if(E=w.type,E===wu){if(k.tag===7){n(g,k.sibling),b=r(k,w.props.children),b.return=g,g=b;break e}}else if(k.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ci&&C$(E)===k.type){n(g,k.sibling),b=r(k,w.props),b.ref=Fm(g,k,w),b.return=g,g=b;break e}n(g,k);break}else e(g,k);k=k.sibling}w.type===wu?(b=Yl(w.props.children,g.mode,v,w.key),b.return=g,g=b):(v=Qg(w.type,w.key,w.props,null,g.mode,v),v.ref=Fm(g,b,w),v.return=g,g=v)}return o(g);case bu:e:{for(k=w.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){n(g,b.sibling),b=r(b,w.children||[]),b.return=g,g=b;break e}else{n(g,b);break}else e(g,b);b=b.sibling}b=N1(w,g.mode,v),b.return=g,g=b}return o(g);case Ci:return k=w._init,x(g,b,k(w._payload),v)}if(um(w))return f(g,b,w,v);if(lm(w))return y(g,b,w,v);Tg(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(n(g,b.sibling),b=r(b,w),b.return=g,g=b):(n(g,b),b=E1(w,g.mode,v),b.return=g,g=b),o(g)):n(g,b)}return x}var Ou=I$(!0),$$=I$(!1),Ag=Fi(null),Rg=null,Lu=null,_v=null;function Dv(){_v=Lu=Rg=null}function Pv(t){var e=Ag.current;mn(Ag),t._currentValue=e}function Fv(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function zu(t,e){Rg=t,_v=Lu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(sr=!0),t.firstContext=null)}function Ur(t){var e=t._currentValue;if(_v!==t)if(t={context:t,memoizedValue:e,next:null},Lu===null){if(Rg===null)throw Error(Te(308));Lu=t,Rg.dependencies={lanes:0,firstContext:t}}else Lu=Lu.next=t;return e}var Wl=null;function Mv(t){Wl===null?Wl=[t]:Wl.push(t)}function T$(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,Mv(e)):(n.next=r.next,r.next=n),e.interleaved=n,Uo(t,s)}function Uo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Li=!1;function Ov(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function A$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Vo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zi(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Mt&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Uo(t,n)}return r=s.interleaved,r===null?(e.next=e,Mv(s)):(e.next=r.next,r.next=e),s.interleaved=e,Uo(t,n)}function _g(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Zw(t,n)}}function R$(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?r=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?r=a=e:a=a.next=e}else r=a=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Dg(t,e,n,s){var r=t.updateQueue;Li=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var m=r.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,p=l.eventTime;if((s&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var f=t,y=l;switch(h=e,p=n,y.tag){case 1:if(f=y.payload,typeof f=="function"){m=f.call(p,m,h);break e}m=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=y.payload,h=typeof f=="function"?f.call(p,m,h):f,h==null)break e;m=vn({},m,h);break e;case 2:Li=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=m):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;h=l,l=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(d===null&&(c=m),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else a===null&&(r.shared.lanes=0);Hl|=o,t.lanes=o,t.memoizedState=m}}function _$(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(Te(191,r));r.call(s)}}}var Mm={},Za=Fi(Mm),Om=Fi(Mm),Lm=Fi(Mm);function jl(t){if(t===Mm)throw Error(Te(174));return t}function Lv(t,e){switch(an(Lm,e),an(Om,t),an(Za,Mm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zw(e,t)}mn(Za),an(Za,e)}function Bu(){mn(Za),mn(Om),mn(Lm)}function D$(t){jl(Lm.current);var e=jl(Za.current),n=zw(e,t.type);e!==n&&(an(Om,t),an(Za,n))}function zv(t){Om.current===t&&(mn(Za),mn(Om))}var En=Fi(0);function Pg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bv=[];function Uv(){for(var t=0;t<Bv.length;t++)Bv[t]._workInProgressVersionPrimary=null;Bv.length=0}var Fg=Mo.ReactCurrentDispatcher,Vv=Mo.ReactCurrentBatchConfig,Gl=0,Nn=null,Xn=null,ss=null,Mg=!1,zm=!1,Bm=0,$V=0;function Cs(){throw Error(Te(321))}function Wv(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ba(t[n],e[n]))return!1;return!0}function jv(t,e,n,s,r,a){if(Gl=a,Nn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fg.current=t===null||t.memoizedState===null?_V:DV,t=n(s,r),zm){a=0;do{if(zm=!1,Bm=0,25<=a)throw Error(Te(301));a+=1,ss=Xn=null,e.updateQueue=null,Fg.current=PV,t=n(s,r)}while(zm)}if(Fg.current=zg,e=Xn!==null&&Xn.next!==null,Gl=0,ss=Xn=Nn=null,Mg=!1,e)throw Error(Te(300));return t}function Gv(){var t=Bm!==0;return Bm=0,t}function Ja(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?Nn.memoizedState=ss=t:ss=ss.next=t,ss}function Vr(){if(Xn===null){var t=Nn.alternate;t=t!==null?t.memoizedState:null}else t=Xn.next;var e=ss===null?Nn.memoizedState:ss.next;if(e!==null)ss=e,Xn=t;else{if(t===null)throw Error(Te(310));Xn=t,t={memoizedState:Xn.memoizedState,baseState:Xn.baseState,baseQueue:Xn.baseQueue,queue:Xn.queue,next:null},ss===null?Nn.memoizedState=ss=t:ss=ss.next=t}return ss}function Um(t,e){return typeof e=="function"?e(t):e}function Hv(t){var e=Vr(),n=e.queue;if(n===null)throw Error(Te(311));n.lastRenderedReducer=t;var s=Xn,r=s.baseQueue,a=n.pending;if(a!==null){if(r!==null){var o=r.next;r.next=a.next,a.next=o}s.baseQueue=r=a,n.pending=null}if(r!==null){a=r.next,s=s.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((Gl&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,o=s):c=c.next=m,Nn.lanes|=d,Hl|=d}u=u.next}while(u!==null&&u!==a);c===null?o=s:c.next=l,ba(s,e.memoizedState)||(sr=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do a=r.lane,Nn.lanes|=a,Hl|=a,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qv(t){var e=Vr(),n=e.queue;if(n===null)throw Error(Te(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,a=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do a=t(a,o.action),o=o.next;while(o!==r);ba(a,e.memoizedState)||(sr=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),n.lastRenderedState=a}return[a,s]}function P$(){}function F$(t,e){var n=Nn,s=Vr(),r=e(),a=!ba(s.memoizedState,r);if(a&&(s.memoizedState=r,sr=!0),s=s.queue,Kv(L$.bind(null,n,s,t),[t]),s.getSnapshot!==e||a||ss!==null&&ss.memoizedState.tag&1){if(n.flags|=2048,Vm(9,O$.bind(null,n,s,r,e),void 0,null),rs===null)throw Error(Te(349));Gl&30||M$(n,e,r)}return r}function M$(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Nn.updateQueue,e===null?(e={lastEffect:null,stores:null},Nn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function O$(t,e,n,s){e.value=n,e.getSnapshot=s,z$(e)&&B$(t)}function L$(t,e,n){return n(function(){z$(e)&&B$(t)})}function z$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ba(t,n)}catch{return!0}}function B$(t){var e=Uo(t,1);e!==null&&ka(e,t,1,-1)}function U$(t){var e=Ja();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Um,lastRenderedState:t},e.queue=t,t=t.dispatch=RV.bind(null,Nn,t),[e.memoizedState,t]}function Vm(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Nn.updateQueue,e===null?(e={lastEffect:null,stores:null},Nn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function V$(){return Vr().memoizedState}function Og(t,e,n,s){var r=Ja();Nn.flags|=t,r.memoizedState=Vm(1|e,n,void 0,s===void 0?null:s)}function Lg(t,e,n,s){var r=Vr();s=s===void 0?null:s;var a=void 0;if(Xn!==null){var o=Xn.memoizedState;if(a=o.destroy,s!==null&&Wv(s,o.deps)){r.memoizedState=Vm(e,n,a,s);return}}Nn.flags|=t,r.memoizedState=Vm(1|e,n,a,s)}function W$(t,e){return Og(8390656,8,t,e)}function Kv(t,e){return Lg(2048,8,t,e)}function j$(t,e){return Lg(4,2,t,e)}function G$(t,e){return Lg(4,4,t,e)}function H$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function q$(t,e,n){return n=n!=null?n.concat([t]):null,Lg(4,4,H$.bind(null,e,t),n)}function Xv(){}function K$(t,e){var n=Vr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Wv(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function X$(t,e){var n=Vr();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&Wv(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Y$(t,e,n){return Gl&21?(ba(n,e)||(n=CI(),Nn.lanes|=n,Hl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,sr=!0),t.memoizedState=n)}function TV(t,e){var n=Kt;Kt=n!==0&&4>n?n:4,t(!0);var s=Vv.transition;Vv.transition={};try{t(!1),e()}finally{Kt=n,Vv.transition=s}}function Z$(){return Vr().memoizedState}function AV(t,e,n){var s=Wi(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},J$(t))Q$(e,n);else if(n=T$(t,e,n,s),n!==null){var r=Gs();ka(n,t,s,r),eT(n,e,s)}}function RV(t,e,n){var s=Wi(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(J$(t))Q$(e,r);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,n);if(r.hasEagerState=!0,r.eagerState=l,ba(l,o)){var c=e.interleaved;c===null?(r.next=r,Mv(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}n=T$(t,e,r,s),n!==null&&(r=Gs(),ka(n,t,s,r),eT(n,e,s))}}function J$(t){var e=t.alternate;return t===Nn||e!==null&&e===Nn}function Q$(t,e){zm=Mg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eT(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Zw(t,n)}}var zg={readContext:Ur,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},_V={readContext:Ur,useCallback:function(t,e){return Ja().memoizedState=[t,e===void 0?null:e],t},useContext:Ur,useEffect:W$,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Og(4194308,4,H$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Og(4194308,4,t,e)},useInsertionEffect:function(t,e){return Og(4,2,t,e)},useMemo:function(t,e){var n=Ja();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Ja();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=AV.bind(null,Nn,t),[s.memoizedState,t]},useRef:function(t){var e=Ja();return t={current:t},e.memoizedState=t},useState:U$,useDebugValue:Xv,useDeferredValue:function(t){return Ja().memoizedState=t},useTransition:function(){var t=U$(!1),e=t[0];return t=TV.bind(null,t[1]),Ja().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Nn,r=Ja();if(xn){if(n===void 0)throw Error(Te(407));n=n()}else{if(n=e(),rs===null)throw Error(Te(349));Gl&30||M$(s,e,n)}r.memoizedState=n;var a={value:n,getSnapshot:e};return r.queue=a,W$(L$.bind(null,s,a,t),[t]),s.flags|=2048,Vm(9,O$.bind(null,s,a,n,e),void 0,null),n},useId:function(){var t=Ja(),e=rs.identifierPrefix;if(xn){var n=Bo,s=zo;n=(s&~(1<<32-ya(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bm++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$V++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},DV={readContext:Ur,useCallback:K$,useContext:Ur,useEffect:Kv,useImperativeHandle:q$,useInsertionEffect:j$,useLayoutEffect:G$,useMemo:X$,useReducer:Hv,useRef:V$,useState:function(){return Hv(Um)},useDebugValue:Xv,useDeferredValue:function(t){var e=Vr();return Y$(e,Xn.memoizedState,t)},useTransition:function(){var t=Hv(Um)[0],e=Vr().memoizedState;return[t,e]},useMutableSource:P$,useSyncExternalStore:F$,useId:Z$,unstable_isNewReconciler:!1},PV={readContext:Ur,useCallback:K$,useContext:Ur,useEffect:Kv,useImperativeHandle:q$,useInsertionEffect:j$,useLayoutEffect:G$,useMemo:X$,useReducer:qv,useRef:V$,useState:function(){return qv(Um)},useDebugValue:Xv,useDeferredValue:function(t){var e=Vr();return Xn===null?e.memoizedState=t:Y$(e,Xn.memoizedState,t)},useTransition:function(){var t=qv(Um)[0],e=Vr().memoizedState;return[t,e]},useMutableSource:P$,useSyncExternalStore:F$,useId:Z$,unstable_isNewReconciler:!1};function va(t,e){if(t&&t.defaultProps){e=vn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Yv(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:vn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Bg={isMounted:function(t){return(t=t._reactInternals)?Ll(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Gs(),r=Wi(t),a=Vo(s,r);a.payload=e,n!=null&&(a.callback=n),e=zi(t,a,r),e!==null&&(ka(e,t,r,s),_g(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Gs(),r=Wi(t),a=Vo(s,r);a.tag=1,a.payload=e,n!=null&&(a.callback=n),e=zi(t,a,r),e!==null&&(ka(e,t,r,s),_g(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Gs(),s=Wi(t),r=Vo(n,s);r.tag=2,e!=null&&(r.callback=e),e=zi(t,r,s),e!==null&&(ka(e,t,s,n),_g(e,t,s))}};function tT(t,e,n,s,r,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,a,o):e.prototype&&e.prototype.isPureReactComponent?!$m(n,s)||!$m(r,a):!0}function nT(t,e,n){var s=!1,r=Mi,a=e.contextType;return typeof a=="object"&&a!==null?a=Ur(a):(r=nr(e)?Bl:Ss.current,s=e.contextTypes,a=(s=s!=null)?Du(t,r):Mi),e=new e(n,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bg,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=a),e}function sT(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Bg.enqueueReplaceState(e,e.state,null)}function Zv(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Ov(t);var a=e.contextType;typeof a=="object"&&a!==null?r.context=Ur(a):(a=nr(e)?Bl:Ss.current,r.context=Du(t,a)),r.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Yv(t,e,a,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Bg.enqueueReplaceState(r,r.state,null),Dg(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Uu(t,e){try{var n="",s=e;do n+=lU(s),s=s.return;while(s);var r=n}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:r,digest:null}}function Jv(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Qv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var FV=typeof WeakMap=="function"?WeakMap:Map;function rT(t,e,n){n=Vo(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){qg||(qg=!0,p1=s),Qv(t,e)},n}function aT(t,e,n){n=Vo(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){Qv(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){Qv(t,e),typeof s!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function oT(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new FV;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=XV.bind(null,t,e,n),e.then(t,t))}function iT(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function lT(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Vo(-1,1),e.tag=2,zi(n,e,1))),n.lanes|=1),t)}var MV=Mo.ReactCurrentOwner,sr=!1;function js(t,e,n,s){e.child=t===null?$$(e,null,n,s):Ou(e,t.child,n,s)}function cT(t,e,n,s,r){n=n.render;var a=e.ref;return zu(e,r),s=jv(t,e,n,s,a,r),n=Gv(),t!==null&&!sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Wo(t,e,r)):(xn&&n&&Iv(e),e.flags|=1,js(t,e,s,r),e.child)}function uT(t,e,n,s,r){if(t===null){var a=n.type;return typeof a=="function"&&!v1(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=a,dT(t,e,a,s,r)):(t=Qg(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&r)){var o=a.memoizedProps;if(n=n.compare,n=n!==null?n:$m,n(o,s)&&t.ref===e.ref)return Wo(t,e,r)}return e.flags|=1,t=Gi(a,s),t.ref=e.ref,t.return=e,e.child=t}function dT(t,e,n,s,r){if(t!==null){var a=t.memoizedProps;if($m(a,s)&&t.ref===e.ref)if(sr=!1,e.pendingProps=s=a,(t.lanes&r)!==0)t.flags&131072&&(sr=!0);else return e.lanes=t.lanes,Wo(t,e,r)}return e1(t,e,n,s,r)}function mT(t,e,n){var s=e.pendingProps,r=s.children,a=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},an(Wu,Cr),Cr|=n;else{if(!(n&1073741824))return t=a!==null?a.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,an(Wu,Cr),Cr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:n,an(Wu,Cr),Cr|=s}else a!==null?(s=a.baseLanes|n,e.memoizedState=null):s=n,an(Wu,Cr),Cr|=s;return js(t,e,r,n),e.child}function hT(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function e1(t,e,n,s,r){var a=nr(n)?Bl:Ss.current;return a=Du(e,a),zu(e,r),n=jv(t,e,n,s,a,r),s=Gv(),t!==null&&!sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Wo(t,e,r)):(xn&&s&&Iv(e),e.flags|=1,js(t,e,n,r),e.child)}function pT(t,e,n,s,r){if(nr(n)){var a=!0;kg(e)}else a=!1;if(zu(e,r),e.stateNode===null)Vg(t,e),nT(e,n,s),Zv(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ur(u):(u=nr(n)?Bl:Ss.current,u=Du(e,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==u)&&sT(e,o,s,u),Li=!1;var h=e.memoizedState;o.state=h,Dg(e,s,o,r),c=e.memoizedState,l!==s||h!==c||tr.current||Li?(typeof d=="function"&&(Yv(e,n,d,s),c=e.memoizedState),(l=Li||tT(e,n,l,s,h,c,u))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,A$(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:va(e.type,l),o.props=u,m=e.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Ur(c):(c=nr(n)?Bl:Ss.current,c=Du(e,c));var p=n.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==m||h!==c)&&sT(e,o,s,c),Li=!1,h=e.memoizedState,o.state=h,Dg(e,s,o,r);var f=e.memoizedState;l!==m||h!==f||tr.current||Li?(typeof p=="function"&&(Yv(e,n,p,s),f=e.memoizedState),(u=Li||tT(e,n,u,s,h,f,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,f,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,f,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=f),o.props=s,o.state=f,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return t1(t,e,n,s,a,r)}function t1(t,e,n,s,r,a){hT(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&b$(e,n,!1),Wo(t,e,a);s=e.stateNode,MV.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=Ou(e,t.child,null,a),e.child=Ou(e,null,l,a)):js(t,e,l,a),e.memoizedState=s.state,r&&b$(e,n,!0),e.child}function fT(t){var e=t.stateNode;e.pendingContext?x$(t,e.pendingContext,e.pendingContext!==e.context):e.context&&x$(t,e.context,!1),Lv(t,e.containerInfo)}function gT(t,e,n,s,r){return Mu(),Rv(r),e.flags|=256,js(t,e,n,s),e.child}var n1={dehydrated:null,treeContext:null,retryLane:0};function s1(t){return{baseLanes:t,cachePool:null,transitions:null}}function xT(t,e,n){var s=e.pendingProps,r=En.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(r&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),an(En,r&1),t===null)return Av(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,a?(s=e.mode,a=e.child,o={mode:"hidden",children:o},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=e0(o,s,0,null),t=Yl(t,s,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=s1(n),e.memoizedState=n1,t):r1(e,o));if(r=t.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return OV(t,e,o,s,l,r,n);if(a){a=s.fallback,o=e.mode,r=t.child,l=r.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Gi(r,c),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?a=Gi(l,a):(a=Yl(a,o,n,null),a.flags|=2),a.return=e,s.return=e,s.sibling=a,e.child=s,s=a,a=e.child,o=t.child.memoizedState,o=o===null?s1(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~n,e.memoizedState=n1,s}return a=t.child,t=a.sibling,s=Gi(a,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function r1(t,e){return e=e0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ug(t,e,n,s){return s!==null&&Rv(s),Ou(e,t.child,null,n),t=r1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function OV(t,e,n,s,r,a,o){if(n)return e.flags&256?(e.flags&=-257,s=Jv(Error(Te(422))),Ug(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=s.fallback,r=e.mode,s=e0({mode:"visible",children:s.children},r,0,null),a=Yl(a,r,o,null),a.flags|=2,s.return=e,a.return=e,s.sibling=a,e.child=s,e.mode&1&&Ou(e,t.child,null,o),e.child.memoizedState=s1(o),e.memoizedState=n1,a);if(!(e.mode&1))return Ug(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,a=Error(Te(419)),s=Jv(a,s,void 0),Ug(t,e,o,s)}if(l=(o&t.childLanes)!==0,sr||l){if(s=rs,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,Uo(t,r),ka(s,t,r,-1))}return w1(),s=Jv(Error(Te(421))),Ug(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=YV.bind(null,t),r._reactRetry=e,null):(t=a.treeContext,Sr=Pi(r.nextSibling),kr=e,xn=!0,wa=null,t!==null&&(zr[Br++]=zo,zr[Br++]=Bo,zr[Br++]=Ul,zo=t.id,Bo=t.overflow,Ul=e),e=r1(e,s.children),e.flags|=4096,e)}function yT(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Fv(t.return,e,n)}function a1(t,e,n,s,r){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=n,a.tailMode=r)}function bT(t,e,n){var s=e.pendingProps,r=s.revealOrder,a=s.tail;if(js(t,e,s.children,n),s=En.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&yT(t,n,e);else if(t.tag===19)yT(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(an(En,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Pg(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),a1(e,!1,r,n,a);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Pg(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}a1(e,!0,n,null,a);break;case"together":a1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Vg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Hl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Te(153));if(e.child!==null){for(t=e.child,n=Gi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function LV(t,e,n){switch(e.tag){case 3:fT(e),Mu();break;case 5:D$(e);break;case 1:nr(e.type)&&kg(e);break;case 4:Lv(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;an(Ag,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(an(En,En.current&1),e.flags|=128,null):n&e.child.childLanes?xT(t,e,n):(an(En,En.current&1),t=Wo(t,e,n),t!==null?t.sibling:null);an(En,En.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return bT(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),an(En,En.current),s)break;return null;case 22:case 23:return e.lanes=0,mT(t,e,n)}return Wo(t,e,n)}var wT,o1,vT,ET;wT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},o1=function(){},vT=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,jl(Za.current);var a=null;switch(n){case"input":r=Fw(t,r),s=Fw(t,s),a=[];break;case"select":r=vn({},r,{value:void 0}),s=vn({},s,{value:void 0}),a=[];break;case"textarea":r=Lw(t,r),s=Lw(t,s),a=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=vg)}Bw(n,s);var o;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(im.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in s){var c=s[u];if(l=r?.[u],s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(im.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&dn("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(e.updateQueue=u)&&(e.flags|=4)}},ET=function(t,e,n,s){n!==s&&(e.flags|=4)};function Wm(t,e){if(!xn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Is(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function zV(t,e,n){var s=e.pendingProps;switch($v(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Is(e),null;case 1:return nr(e.type)&&Ng(),Is(e),null;case 3:return s=e.stateNode,Bu(),mn(tr),mn(Ss),Uv(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&($g(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wa!==null&&(x1(wa),wa=null))),o1(t,e),Is(e),null;case 5:zv(e);var r=jl(Lm.current);if(n=e.type,t!==null&&e.stateNode!=null)vT(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(Te(166));return Is(e),null}if(t=jl(Za.current),$g(e)){s=e.stateNode,n=e.type;var a=e.memoizedProps;switch(s[Ya]=e,s[Dm]=a,t=(e.mode&1)!==0,n){case"dialog":dn("cancel",s),dn("close",s);break;case"iframe":case"object":case"embed":dn("load",s);break;case"video":case"audio":for(r=0;r<Am.length;r++)dn(Am[r],s);break;case"source":dn("error",s);break;case"img":case"image":case"link":dn("error",s),dn("load",s);break;case"details":dn("toggle",s);break;case"input":nI(s,a),dn("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},dn("invalid",s);break;case"textarea":aI(s,a),dn("invalid",s)}Bw(n,a),r=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?s.textContent!==l&&(a.suppressHydrationWarning!==!0&&wg(s.textContent,l,t),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&wg(s.textContent,l,t),r=["children",""+l]):im.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&dn("scroll",s)}switch(n){case"input":Zf(s),rI(s,a,!0);break;case"textarea":Zf(s),iI(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=vg)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=lI(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Ya]=e,t[Dm]=s,wT(t,e,!1,!1),e.stateNode=t;e:{switch(o=Uw(n,s),n){case"dialog":dn("cancel",t),dn("close",t),r=s;break;case"iframe":case"object":case"embed":dn("load",t),r=s;break;case"video":case"audio":for(r=0;r<Am.length;r++)dn(Am[r],t);r=s;break;case"source":dn("error",t),r=s;break;case"img":case"image":case"link":dn("error",t),dn("load",t),r=s;break;case"details":dn("toggle",t),r=s;break;case"input":nI(t,s),r=Fw(t,s),dn("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=vn({},s,{value:void 0}),dn("invalid",t);break;case"textarea":aI(t,s),r=Lw(t,s),dn("invalid",t);break;default:r=s}Bw(n,r),l=r;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?dI(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&cI(t,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&dm(t,c):typeof c=="number"&&dm(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(im.hasOwnProperty(a)?c!=null&&a==="onScroll"&&dn("scroll",t):c!=null&&kw(t,a,c,o))}switch(n){case"input":Zf(t),rI(t,s,!1);break;case"textarea":Zf(t),iI(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Ii(s.value));break;case"select":t.multiple=!!s.multiple,a=s.value,a!=null?vu(t,!!s.multiple,a,!1):s.defaultValue!=null&&vu(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=vg)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Is(e),null;case 6:if(t&&e.stateNode!=null)ET(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(Te(166));if(n=jl(Lm.current),jl(Za.current),$g(e)){if(s=e.stateNode,n=e.memoizedProps,s[Ya]=e,(a=s.nodeValue!==n)&&(t=kr,t!==null))switch(t.tag){case 3:wg(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wg(s.nodeValue,n,(t.mode&1)!==0)}a&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ya]=e,e.stateNode=s}return Is(e),null;case 13:if(mn(En),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xn&&Sr!==null&&e.mode&1&&!(e.flags&128))S$(),Mu(),e.flags|=98560,a=!1;else if(a=$g(e),s!==null&&s.dehydrated!==null){if(t===null){if(!a)throw Error(Te(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Te(317));a[Ya]=e}else Mu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Is(e),a=!1}else wa!==null&&(x1(wa),wa=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||En.current&1?Yn===0&&(Yn=3):w1())),e.updateQueue!==null&&(e.flags|=4),Is(e),null);case 4:return Bu(),o1(t,e),t===null&&Rm(e.stateNode.containerInfo),Is(e),null;case 10:return Pv(e.type._context),Is(e),null;case 17:return nr(e.type)&&Ng(),Is(e),null;case 19:if(mn(En),a=e.memoizedState,a===null)return Is(e),null;if(s=(e.flags&128)!==0,o=a.rendering,o===null)if(s)Wm(a,!1);else{if(Yn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Pg(t),o!==null){for(e.flags|=128,Wm(a,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)a=n,t=s,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return an(En,En.current&1|2),e.child}t=t.sibling}a.tail!==null&&Dn()>ju&&(e.flags|=128,s=!0,Wm(a,!1),e.lanes=4194304)}else{if(!s)if(t=Pg(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wm(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!xn)return Is(e),null}else 2*Dn()-a.renderingStartTime>ju&&n!==1073741824&&(e.flags|=128,s=!0,Wm(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(n=a.last,n!==null?n.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Dn(),e.sibling=null,n=En.current,an(En,s?n&1|2:n&1),e):(Is(e),null);case 22:case 23:return b1(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Cr&1073741824&&(Is(e),e.subtreeFlags&6&&(e.flags|=8192)):Is(e),null;case 24:return null;case 25:return null}throw Error(Te(156,e.tag))}function BV(t,e){switch($v(e),e.tag){case 1:return nr(e.type)&&Ng(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Bu(),mn(tr),mn(Ss),Uv(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return zv(e),null;case 13:if(mn(En),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Te(340));Mu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mn(En),null;case 4:return Bu(),null;case 10:return Pv(e.type._context),null;case 22:case 23:return b1(),null;case 24:return null;default:return null}}var Wg=!1,$s=!1,UV=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function Vu(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){kn(t,e,s)}else n.current=null}function i1(t,e,n){try{n()}catch(s){kn(t,e,s)}}var NT=!1;function VV(t,e){if(bv=cg,t=t$(),dv(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,m=t,h=null;t:for(;;){for(var p;m!==n||r!==0&&m.nodeType!==3||(l=o+r),m!==a||s!==0&&m.nodeType!==3||(c=o+s),m.nodeType===3&&(o+=m.nodeValue.length),(p=m.firstChild)!==null;)h=m,m=p;for(;;){if(m===t)break t;if(h===n&&++u===r&&(l=o),h===a&&++d===s&&(c=o),(p=m.nextSibling)!==null)break;m=h,h=m.parentNode}m=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(wv={focusedElem:t,selectionRange:n},cg=!1,Xe=e;Xe!==null;)if(e=Xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Xe=t;else for(;Xe!==null;){e=Xe;try{var f=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var y=f.memoizedProps,x=f.memoizedState,g=e.stateNode,b=g.getSnapshotBeforeUpdate(e.elementType===e.type?y:va(e.type,y),x);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Te(163))}}catch(v){kn(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,Xe=t;break}Xe=e.return}return f=NT,NT=!1,f}function jm(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var a=r.destroy;r.destroy=void 0,a!==void 0&&i1(e,n,a)}r=r.next}while(r!==s)}}function jg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function l1(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function kT(t){var e=t.alternate;e!==null&&(t.alternate=null,kT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ya],delete e[Dm],delete e[kv],delete e[kV],delete e[SV])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ST(t){return t.tag===5||t.tag===3||t.tag===4}function CT(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ST(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function c1(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=vg));else if(s!==4&&(t=t.child,t!==null))for(c1(t,e,n),t=t.sibling;t!==null;)c1(t,e,n),t=t.sibling}function u1(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(u1(t,e,n),t=t.sibling;t!==null;)u1(t,e,n),t=t.sibling}var ps=null,Ea=!1;function Bi(t,e,n){for(n=n.child;n!==null;)IT(t,e,n),n=n.sibling}function IT(t,e,n){if(Xa&&typeof Xa.onCommitFiberUnmount=="function")try{Xa.onCommitFiberUnmount(sg,n)}catch{}switch(n.tag){case 5:$s||Vu(n,e);case 6:var s=ps,r=Ea;ps=null,Bi(t,e,n),ps=s,Ea=r,ps!==null&&(Ea?(t=ps,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ps.removeChild(n.stateNode));break;case 18:ps!==null&&(Ea?(t=ps,n=n.stateNode,t.nodeType===8?Nv(t.parentNode,n):t.nodeType===1&&Nv(t,n),Em(t)):Nv(ps,n.stateNode));break;case 4:s=ps,r=Ea,ps=n.stateNode.containerInfo,Ea=!0,Bi(t,e,n),ps=s,Ea=r;break;case 0:case 11:case 14:case 15:if(!$s&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var a=r,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&i1(n,e,o),r=r.next}while(r!==s)}Bi(t,e,n);break;case 1:if(!$s&&(Vu(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){kn(n,e,l)}Bi(t,e,n);break;case 21:Bi(t,e,n);break;case 22:n.mode&1?($s=(s=$s)||n.memoizedState!==null,Bi(t,e,n),$s=s):Bi(t,e,n);break;default:Bi(t,e,n)}}function $T(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new UV),e.forEach(function(s){var r=ZV.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Na(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ps=l.stateNode,Ea=!1;break e;case 3:ps=l.stateNode.containerInfo,Ea=!0;break e;case 4:ps=l.stateNode.containerInfo,Ea=!0;break e}l=l.return}if(ps===null)throw Error(Te(160));IT(a,o,r),ps=null,Ea=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(u){kn(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)TT(e,t),e=e.sibling}function TT(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Na(e,t),Qa(t),s&4){try{jm(3,t,t.return),jg(3,t)}catch(y){kn(t,t.return,y)}try{jm(5,t,t.return)}catch(y){kn(t,t.return,y)}}break;case 1:Na(e,t),Qa(t),s&512&&n!==null&&Vu(n,n.return);break;case 5:if(Na(e,t),Qa(t),s&512&&n!==null&&Vu(n,n.return),t.flags&32){var r=t.stateNode;try{dm(r,"")}catch(y){kn(t,t.return,y)}}if(s&4&&(r=t.stateNode,r!=null)){var a=t.memoizedProps,o=n!==null?n.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&sI(r,a),Uw(l,o);var u=Uw(l,a);for(o=0;o<c.length;o+=2){var d=c[o],m=c[o+1];d==="style"?dI(r,m):d==="dangerouslySetInnerHTML"?cI(r,m):d==="children"?dm(r,m):kw(r,d,m,u)}switch(l){case"input":Mw(r,a);break;case"textarea":oI(r,a);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?vu(r,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?vu(r,!!a.multiple,a.defaultValue,!0):vu(r,!!a.multiple,a.multiple?[]:"",!1))}r[Dm]=a}catch(y){kn(t,t.return,y)}}break;case 6:if(Na(e,t),Qa(t),s&4){if(t.stateNode===null)throw Error(Te(162));r=t.stateNode,a=t.memoizedProps;try{r.nodeValue=a}catch(y){kn(t,t.return,y)}}break;case 3:if(Na(e,t),Qa(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Em(e.containerInfo)}catch(y){kn(t,t.return,y)}break;case 4:Na(e,t),Qa(t);break;case 13:Na(e,t),Qa(t),r=t.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(h1=Dn())),s&4&&$T(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?($s=(u=$s)||d,Na(e,t),$s=u):Na(e,t),Qa(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Xe=t,d=t.child;d!==null;){for(m=Xe=d;Xe!==null;){switch(h=Xe,p=h.child,h.tag){case 0:case 11:case 14:case 15:jm(4,h,h.return);break;case 1:Vu(h,h.return);var f=h.stateNode;if(typeof f.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,f.props=e.memoizedProps,f.state=e.memoizedState,f.componentWillUnmount()}catch(y){kn(s,n,y)}}break;case 5:Vu(h,h.return);break;case 22:if(h.memoizedState!==null){_T(m);continue}}p!==null?(p.return=h,Xe=p):_T(m)}d=d.sibling}e:for(d=null,m=t;;){if(m.tag===5){if(d===null){d=m;try{r=m.stateNode,u?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=uI("display",o))}catch(y){kn(t,t.return,y)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(y){kn(t,t.return,y)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Na(e,t),Qa(t),s&4&&$T(t);break;case 21:break;default:Na(e,t),Qa(t)}}function Qa(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(ST(n)){var s=n;break e}n=n.return}throw Error(Te(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(dm(r,""),s.flags&=-33);var a=CT(t);u1(t,a,r);break;case 3:case 4:var o=s.stateNode.containerInfo,l=CT(t);c1(t,l,o);break;default:throw Error(Te(161))}}catch(c){kn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function WV(t,e,n){Xe=t,AT(t)}function AT(t,e,n){for(var s=(t.mode&1)!==0;Xe!==null;){var r=Xe,a=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||Wg;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||$s;l=Wg;var u=$s;if(Wg=o,($s=c)&&!u)for(Xe=r;Xe!==null;)o=Xe,c=o.child,o.tag===22&&o.memoizedState!==null?DT(r):c!==null?(c.return=o,Xe=c):DT(r);for(;a!==null;)Xe=a,AT(a),a=a.sibling;Xe=r,Wg=l,$s=u}RT(t)}else r.subtreeFlags&8772&&a!==null?(a.return=r,Xe=a):RT(t)}}function RT(t){for(;Xe!==null;){var e=Xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$s||jg(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!$s)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:va(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&_$(e,a,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}_$(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Em(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Te(163))}$s||e.flags&512&&l1(e)}catch(h){kn(e,e.return,h)}}if(e===t){Xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Xe=n;break}Xe=e.return}}function _T(t){for(;Xe!==null;){var e=Xe;if(e===t){Xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Xe=n;break}Xe=e.return}}function DT(t){for(;Xe!==null;){var e=Xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{jg(4,e)}catch(c){kn(e,n,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(c){kn(e,r,c)}}var a=e.return;try{l1(e)}catch(c){kn(e,a,c)}break;case 5:var o=e.return;try{l1(e)}catch(c){kn(e,o,c)}}}catch(c){kn(e,e.return,c)}if(e===t){Xe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Xe=l;break}Xe=e.return}}var jV=Math.ceil,Gg=Mo.ReactCurrentDispatcher,d1=Mo.ReactCurrentOwner,Wr=Mo.ReactCurrentBatchConfig,Mt=0,rs=null,Bn=null,fs=0,Cr=0,Wu=Fi(0),Yn=0,Gm=null,Hl=0,Hg=0,m1=0,Hm=null,rr=null,h1=0,ju=1/0,jo=null,qg=!1,p1=null,Ui=null,Kg=!1,Vi=null,Xg=0,qm=0,f1=null,Yg=-1,Zg=0;function Gs(){return Mt&6?Dn():Yg!==-1?Yg:Yg=Dn()}function Wi(t){return t.mode&1?Mt&2&&fs!==0?fs&-fs:IV.transition!==null?(Zg===0&&(Zg=CI()),Zg):(t=Kt,t!==0||(t=window.event,t=t===void 0?16:FI(t.type)),t):1}function ka(t,e,n,s){if(50<qm)throw qm=0,f1=null,Error(Te(185));xm(t,n,s),(!(Mt&2)||t!==rs)&&(t===rs&&(!(Mt&2)&&(Hg|=n),Yn===4&&ji(t,fs)),ar(t,s),n===1&&Mt===0&&!(e.mode&1)&&(ju=Dn()+500,Sg&&Oi()))}function ar(t,e){var n=t.callbackNode;IU(t,e);var s=og(t,t===rs?fs:0);if(s===0)n!==null&&NI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&NI(n),e===1)t.tag===0?CV(FT.bind(null,t)):w$(FT.bind(null,t)),EV(function(){!(Mt&6)&&Oi()}),n=null;else{switch(II(s)){case 1:n=Kw;break;case 4:n=kI;break;case 16:n=ng;break;case 536870912:n=SI;break;default:n=ng}n=WT(n,PT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function PT(t,e){if(Yg=-1,Zg=0,Mt&6)throw Error(Te(327));var n=t.callbackNode;if(Gu()&&t.callbackNode!==n)return null;var s=og(t,t===rs?fs:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Jg(t,s);else{e=s;var r=Mt;Mt|=2;var a=OT();(rs!==t||fs!==e)&&(jo=null,ju=Dn()+500,Kl(t,e));do try{qV();break}catch(l){MT(t,l)}while(!0);Dv(),Gg.current=a,Mt=r,Bn!==null?e=0:(rs=null,fs=0,e=Yn)}if(e!==0){if(e===2&&(r=Xw(t),r!==0&&(s=r,e=g1(t,r))),e===1)throw n=Gm,Kl(t,0),ji(t,s),ar(t,Dn()),n;if(e===6)ji(t,s);else{if(r=t.current.alternate,!(s&30)&&!GV(r)&&(e=Jg(t,s),e===2&&(a=Xw(t),a!==0&&(s=a,e=g1(t,a))),e===1))throw n=Gm,Kl(t,0),ji(t,s),ar(t,Dn()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(Te(345));case 2:Xl(t,rr,jo);break;case 3:if(ji(t,s),(s&130023424)===s&&(e=h1+500-Dn(),10<e)){if(og(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Gs(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Ev(Xl.bind(null,t,rr,jo),e);break}Xl(t,rr,jo);break;case 4:if(ji(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-ya(s);a=1<<o,o=e[o],o>r&&(r=o),s&=~a}if(s=r,s=Dn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*jV(s/1960))-s,10<s){t.timeoutHandle=Ev(Xl.bind(null,t,rr,jo),s);break}Xl(t,rr,jo);break;case 5:Xl(t,rr,jo);break;default:throw Error(Te(329))}}}return ar(t,Dn()),t.callbackNode===n?PT.bind(null,t):null}function g1(t,e){var n=Hm;return t.current.memoizedState.isDehydrated&&(Kl(t,e).flags|=256),t=Jg(t,e),t!==2&&(e=rr,rr=n,e!==null&&x1(e)),t}function x1(t){rr===null?rr=t:rr.push.apply(rr,t)}function GV(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],a=r.getSnapshot;r=r.value;try{if(!ba(a(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ji(t,e){for(e&=~m1,e&=~Hg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ya(e),s=1<<n;t[n]=-1,e&=~s}}function FT(t){if(Mt&6)throw Error(Te(327));Gu();var e=og(t,0);if(!(e&1))return ar(t,Dn()),null;var n=Jg(t,e);if(t.tag!==0&&n===2){var s=Xw(t);s!==0&&(e=s,n=g1(t,s))}if(n===1)throw n=Gm,Kl(t,0),ji(t,e),ar(t,Dn()),n;if(n===6)throw Error(Te(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Xl(t,rr,jo),ar(t,Dn()),null}function y1(t,e){var n=Mt;Mt|=1;try{return t(e)}finally{Mt=n,Mt===0&&(ju=Dn()+500,Sg&&Oi())}}function ql(t){Vi!==null&&Vi.tag===0&&!(Mt&6)&&Gu();var e=Mt;Mt|=1;var n=Wr.transition,s=Kt;try{if(Wr.transition=null,Kt=1,t)return t()}finally{Kt=s,Wr.transition=n,Mt=e,!(Mt&6)&&Oi()}}function b1(){Cr=Wu.current,mn(Wu)}function Kl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,vV(n)),Bn!==null)for(n=Bn.return;n!==null;){var s=n;switch($v(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ng();break;case 3:Bu(),mn(tr),mn(Ss),Uv();break;case 5:zv(s);break;case 4:Bu();break;case 13:mn(En);break;case 19:mn(En);break;case 10:Pv(s.type._context);break;case 22:case 23:b1()}n=n.return}if(rs=t,Bn=t=Gi(t.current,null),fs=Cr=e,Yn=0,Gm=null,m1=Hg=Hl=0,rr=Hm=null,Wl!==null){for(e=0;e<Wl.length;e++)if(n=Wl[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,a=n.pending;if(a!==null){var o=a.next;a.next=r,s.next=o}n.pending=s}Wl=null}return t}function MT(t,e){do{var n=Bn;try{if(Dv(),Fg.current=zg,Mg){for(var s=Nn.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}Mg=!1}if(Gl=0,ss=Xn=Nn=null,zm=!1,Bm=0,d1.current=null,n===null||n.return===null){Yn=1,Gm=e,Bn=null;break}e:{var a=t,o=n.return,l=n,c=e;if(e=fs,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=iT(o);if(p!==null){p.flags&=-257,lT(p,o,l,a,e),p.mode&1&&oT(a,u,e),e=p,c=u;var f=e.updateQueue;if(f===null){var y=new Set;y.add(c),e.updateQueue=y}else f.add(c);break e}else{if(!(e&1)){oT(a,u,e),w1();break e}c=Error(Te(426))}}else if(xn&&l.mode&1){var x=iT(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),lT(x,o,l,a,e),Rv(Uu(c,l));break e}}a=c=Uu(c,l),Yn!==4&&(Yn=2),Hm===null?Hm=[a]:Hm.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=rT(a,c,e);R$(a,g);break e;case 1:l=c;var b=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ui===null||!Ui.has(w)))){a.flags|=65536,e&=-e,a.lanes|=e;var v=aT(a,l,e);R$(a,v);break e}}a=a.return}while(a!==null)}zT(n)}catch(E){e=E,Bn===n&&n!==null&&(Bn=n=n.return);continue}break}while(!0)}function OT(){var t=Gg.current;return Gg.current=zg,t===null?zg:t}function w1(){(Yn===0||Yn===3||Yn===2)&&(Yn=4),rs===null||!(Hl&268435455)&&!(Hg&268435455)||ji(rs,fs)}function Jg(t,e){var n=Mt;Mt|=2;var s=OT();(rs!==t||fs!==e)&&(jo=null,Kl(t,e));do try{HV();break}catch(r){MT(t,r)}while(!0);if(Dv(),Mt=n,Gg.current=s,Bn!==null)throw Error(Te(261));return rs=null,fs=0,Yn}function HV(){for(;Bn!==null;)LT(Bn)}function qV(){for(;Bn!==null&&!yU();)LT(Bn)}function LT(t){var e=VT(t.alternate,t,Cr);t.memoizedProps=t.pendingProps,e===null?zT(t):Bn=e,d1.current=null}function zT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=BV(n,e),n!==null){n.flags&=32767,Bn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yn=6,Bn=null;return}}else if(n=zV(n,e,Cr),n!==null){Bn=n;return}if(e=e.sibling,e!==null){Bn=e;return}Bn=e=t}while(e!==null);Yn===0&&(Yn=5)}function Xl(t,e,n){var s=Kt,r=Wr.transition;try{Wr.transition=null,Kt=1,KV(t,e,n,s)}finally{Wr.transition=r,Kt=s}return null}function KV(t,e,n,s){do Gu();while(Vi!==null);if(Mt&6)throw Error(Te(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Te(177));t.callbackNode=null,t.callbackPriority=0;var a=n.lanes|n.childLanes;if($U(t,a),t===rs&&(Bn=rs=null,fs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Kg||(Kg=!0,WT(ng,function(){return Gu(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Wr.transition,Wr.transition=null;var o=Kt;Kt=1;var l=Mt;Mt|=4,d1.current=null,VV(t,n),TT(n,t),pV(wv),cg=!!bv,wv=bv=null,t.current=n,WV(n),bU(),Mt=l,Kt=o,Wr.transition=a}else t.current=n;if(Kg&&(Kg=!1,Vi=t,Xg=r),a=t.pendingLanes,a===0&&(Ui=null),EU(n.stateNode),ar(t,Dn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(qg)throw qg=!1,t=p1,p1=null,t;return Xg&1&&t.tag!==0&&Gu(),a=t.pendingLanes,a&1?t===f1?qm++:(qm=0,f1=t):qm=0,Oi(),null}function Gu(){if(Vi!==null){var t=II(Xg),e=Wr.transition,n=Kt;try{if(Wr.transition=null,Kt=16>t?16:t,Vi===null)var s=!1;else{if(t=Vi,Vi=null,Xg=0,Mt&6)throw Error(Te(331));var r=Mt;for(Mt|=4,Xe=t.current;Xe!==null;){var a=Xe,o=a.child;if(Xe.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Xe=u;Xe!==null;){var d=Xe;switch(d.tag){case 0:case 11:case 15:jm(8,d,a)}var m=d.child;if(m!==null)m.return=d,Xe=m;else for(;Xe!==null;){d=Xe;var h=d.sibling,p=d.return;if(kT(d),d===u){Xe=null;break}if(h!==null){h.return=p,Xe=h;break}Xe=p}}}var f=a.alternate;if(f!==null){var y=f.child;if(y!==null){f.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}Xe=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,Xe=o;else e:for(;Xe!==null;){if(a=Xe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:jm(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,Xe=g;break e}Xe=a.return}}var b=t.current;for(Xe=b;Xe!==null;){o=Xe;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Xe=w;else e:for(o=b;Xe!==null;){if(l=Xe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:jg(9,l)}}catch(E){kn(l,l.return,E)}if(l===o){Xe=null;break e}var v=l.sibling;if(v!==null){v.return=l.return,Xe=v;break e}Xe=l.return}}if(Mt=r,Oi(),Xa&&typeof Xa.onPostCommitFiberRoot=="function")try{Xa.onPostCommitFiberRoot(sg,t)}catch{}s=!0}return s}finally{Kt=n,Wr.transition=e}}return!1}function BT(t,e,n){e=Uu(n,e),e=rT(t,e,1),t=zi(t,e,1),e=Gs(),t!==null&&(xm(t,1,e),ar(t,e))}function kn(t,e,n){if(t.tag===3)BT(t,t,n);else for(;e!==null;){if(e.tag===3){BT(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ui===null||!Ui.has(s))){t=Uu(n,t),t=aT(e,t,1),e=zi(e,t,1),t=Gs(),e!==null&&(xm(e,1,t),ar(e,t));break}}e=e.return}}function XV(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Gs(),t.pingedLanes|=t.suspendedLanes&n,rs===t&&(fs&n)===n&&(Yn===4||Yn===3&&(fs&130023424)===fs&&500>Dn()-h1?Kl(t,0):m1|=n),ar(t,e)}function UT(t,e){e===0&&(t.mode&1?(e=ag,ag<<=1,!(ag&130023424)&&(ag=4194304)):e=1);var n=Gs();t=Uo(t,e),t!==null&&(xm(t,e,n),ar(t,n))}function YV(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),UT(t,n)}function ZV(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Te(314))}s!==null&&s.delete(e),UT(t,n)}var VT;VT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||tr.current)sr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return sr=!1,LV(t,e,n);sr=!!(t.flags&131072)}else sr=!1,xn&&e.flags&1048576&&v$(e,Ig,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Vg(t,e),t=e.pendingProps;var r=Du(e,Ss.current);zu(e,n),r=jv(null,e,s,t,r,n);var a=Gv();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,nr(s)?(a=!0,kg(e)):a=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Ov(e),r.updater=Bg,e.stateNode=r,r._reactInternals=e,Zv(e,s,t,n),e=t1(null,e,s,!0,a,n)):(e.tag=0,xn&&a&&Iv(e),js(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Vg(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=QV(s),t=va(s,t),r){case 0:e=e1(null,e,s,t,n);break e;case 1:e=pT(null,e,s,t,n);break e;case 11:e=cT(null,e,s,t,n);break e;case 14:e=uT(null,e,s,va(s.type,t),n);break e}throw Error(Te(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:va(s,r),e1(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:va(s,r),pT(t,e,s,r,n);case 3:e:{if(fT(e),t===null)throw Error(Te(387));s=e.pendingProps,a=e.memoizedState,r=a.element,A$(t,e),Dg(e,s,null,n);var o=e.memoizedState;if(s=o.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){r=Uu(Error(Te(423)),e),e=gT(t,e,s,n,r);break e}else if(s!==r){r=Uu(Error(Te(424)),e),e=gT(t,e,s,n,r);break e}else for(Sr=Pi(e.stateNode.containerInfo.firstChild),kr=e,xn=!0,wa=null,n=$$(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Mu(),s===r){e=Wo(t,e,n);break e}js(t,e,s,n)}e=e.child}return e;case 5:return D$(e),t===null&&Av(e),s=e.type,r=e.pendingProps,a=t!==null?t.memoizedProps:null,o=r.children,vv(s,r)?o=null:a!==null&&vv(s,a)&&(e.flags|=32),hT(t,e),js(t,e,o,n),e.child;case 6:return t===null&&Av(e),null;case 13:return xT(t,e,n);case 4:return Lv(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Ou(e,null,s,n):js(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:va(s,r),cT(t,e,s,r,n);case 7:return js(t,e,e.pendingProps,n),e.child;case 8:return js(t,e,e.pendingProps.children,n),e.child;case 12:return js(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,a=e.memoizedProps,o=r.value,an(Ag,s._currentValue),s._currentValue=o,a!==null)if(ba(a.value,o)){if(a.children===r.children&&!tr.current){e=Wo(t,e,n);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=Vo(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Fv(a.return,n,e),l.lanes|=n;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Te(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Fv(o,n,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}js(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,zu(e,n),r=Ur(r),s=s(r),e.flags|=1,js(t,e,s,n),e.child;case 14:return s=e.type,r=va(s,e.pendingProps),r=va(s.type,r),uT(t,e,s,r,n);case 15:return dT(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:va(s,r),Vg(t,e),e.tag=1,nr(s)?(t=!0,kg(e)):t=!1,zu(e,n),nT(e,s,r),Zv(e,s,r,n),t1(null,e,s,!0,t,n);case 19:return bT(t,e,n);case 22:return mT(t,e,n)}throw Error(Te(156,e.tag))};function WT(t,e){return EI(t,e)}function JV(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(t,e,n,s){return new JV(t,e,n,s)}function v1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function QV(t){if(typeof t=="function")return v1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Iw)return 11;if(t===Aw)return 14}return 2}function Gi(t,e){var n=t.alternate;return n===null?(n=jr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Qg(t,e,n,s,r,a){var o=2;if(s=t,typeof t=="function")v1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case wu:return Yl(n.children,r,a,e);case Sw:o=8,r|=8;break;case Cw:return t=jr(12,n,e,r|2),t.elementType=Cw,t.lanes=a,t;case $w:return t=jr(13,n,e,r),t.elementType=$w,t.lanes=a,t;case Tw:return t=jr(19,n,e,r),t.elementType=Tw,t.lanes=a,t;case JC:return e0(n,r,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case YC:o=10;break e;case ZC:o=9;break e;case Iw:o=11;break e;case Aw:o=14;break e;case Ci:o=16,s=null;break e}throw Error(Te(130,t==null?t:typeof t,""))}return e=jr(o,n,e,r),e.elementType=t,e.type=s,e.lanes=a,e}function Yl(t,e,n,s){return t=jr(7,t,s,e),t.lanes=n,t}function e0(t,e,n,s){return t=jr(22,t,s,e),t.elementType=JC,t.lanes=n,t.stateNode={isHidden:!1},t}function E1(t,e,n){return t=jr(6,t,null,e),t.lanes=n,t}function N1(t,e,n){return e=jr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function eW(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yw(0),this.expirationTimes=Yw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yw(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function k1(t,e,n,s,r,a,o,l,c){return t=new eW(t,e,n,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=jr(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ov(a),t}function tW(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bu,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function jT(t){if(!t)return Mi;t=t._reactInternals;e:{if(Ll(t)!==t||t.tag!==1)throw Error(Te(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(nr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Te(171))}if(t.tag===1){var n=t.type;if(nr(n))return y$(t,n,e)}return e}function GT(t,e,n,s,r,a,o,l,c){return t=k1(n,s,!0,t,r,a,o,l,c),t.context=jT(null),n=t.current,s=Gs(),r=Wi(n),a=Vo(s,r),a.callback=e??null,zi(n,a,r),t.current.lanes=r,xm(t,r,s),ar(t,s),t}function t0(t,e,n,s){var r=e.current,a=Gs(),o=Wi(r);return n=jT(n),e.context===null?e.context=n:e.pendingContext=n,e=Vo(a,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=zi(r,e,o),t!==null&&(ka(t,r,o,a),_g(t,r,o)),o}function n0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function HT(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function S1(t,e){HT(t,e),(t=t.alternate)&&HT(t,e)}function nW(){return null}var qT=typeof reportError=="function"?reportError:function(t){console.error(t)};function C1(t){this._internalRoot=t}s0.prototype.render=C1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Te(409));t0(t,e,null,null)},s0.prototype.unmount=C1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ql(function(){t0(null,t,null,null)}),e[Oo]=null}};function s0(t){this._internalRoot=t}s0.prototype.unstable_scheduleHydration=function(t){if(t){var e=AI();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ri.length&&e!==0&&e<Ri[n].priority;n++);Ri.splice(n,0,t),n===0&&DI(t)}};function I1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function r0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function KT(){}function sW(t,e,n,s,r){if(r){if(typeof s=="function"){var a=s;s=function(){var u=n0(o);a.call(u)}}var o=GT(e,s,t,0,null,!1,!1,"",KT);return t._reactRootContainer=o,t[Oo]=o.current,Rm(t.nodeType===8?t.parentNode:t),ql(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var u=n0(c);l.call(u)}}var c=k1(t,0,!1,null,null,!1,!1,"",KT);return t._reactRootContainer=c,t[Oo]=c.current,Rm(t.nodeType===8?t.parentNode:t),ql(function(){t0(e,c,n,s)}),c}function a0(t,e,n,s,r){var a=n._reactRootContainer;if(a){var o=a;if(typeof r=="function"){var l=r;r=function(){var c=n0(o);l.call(c)}}t0(e,o,t,r)}else o=sW(n,e,t,r,s);return n0(o)}$I=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=gm(e.pendingLanes);n!==0&&(Zw(e,n|1),ar(e,Dn()),!(Mt&6)&&(ju=Dn()+500,Oi()))}break;case 13:ql(function(){var s=Uo(t,1);if(s!==null){var r=Gs();ka(s,t,1,r)}}),S1(t,1)}},Jw=function(t){if(t.tag===13){var e=Uo(t,134217728);if(e!==null){var n=Gs();ka(e,t,134217728,n)}S1(t,134217728)}},TI=function(t){if(t.tag===13){var e=Wi(t),n=Uo(t,e);if(n!==null){var s=Gs();ka(n,t,e,s)}S1(t,e)}},AI=function(){return Kt},RI=function(t,e){var n=Kt;try{return Kt=t,e()}finally{Kt=n}},jw=function(t,e,n){switch(e){case"input":if(Mw(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Eg(s);if(!r)throw Error(Te(90));tI(s),Mw(s,r)}}}break;case"textarea":oI(t,n);break;case"select":e=n.value,e!=null&&vu(t,!!n.multiple,e,!1)}},fI=y1,gI=ql;var rW={usingClientEntryPoint:!1,Events:[Pm,Ru,Eg,hI,pI,y1]},Km={findFiberByHostInstance:zl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aW={bundleType:Km.bundleType,version:Km.version,rendererPackageName:Km.rendererPackageName,rendererConfig:Km.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wI(t),t===null?null:t.stateNode},findFiberByHostInstance:Km.findFiberByHostInstance||nW,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var o0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!o0.isDisabled&&o0.supportsFiber)try{sg=o0.inject(aW),Xa=o0}catch{}}vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rW,vr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I1(e))throw Error(Te(200));return tW(t,e,null,n)},vr.createRoot=function(t,e){if(!I1(t))throw Error(Te(299));var n=!1,s="",r=qT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=k1(t,1,!1,null,null,n,!1,s,r),t[Oo]=e.current,Rm(t.nodeType===8?t.parentNode:t),new C1(e)},vr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Te(188)):(t=Object.keys(t).join(","),Error(Te(268,t)));return t=wI(e),t=t===null?null:t.stateNode,t},vr.flushSync=function(t){return ql(t)},vr.hydrate=function(t,e,n){if(!r0(e))throw Error(Te(200));return a0(null,t,e,!0,n)},vr.hydrateRoot=function(t,e,n){if(!I1(t))throw Error(Te(405));var s=n!=null&&n.hydratedSources||null,r=!1,a="",o=qT;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=GT(e,null,t,1,n??null,r,!1,a,o),t[Oo]=e.current,Rm(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new s0(e)},vr.render=function(t,e,n){if(!r0(e))throw Error(Te(200));return a0(null,t,e,!1,n)},vr.unmountComponentAtNode=function(t){if(!r0(t))throw Error(Te(40));return t._reactRootContainer?(ql(function(){a0(null,null,t,!1,function(){t._reactRootContainer=null,t[Oo]=null})}),!0):!1},vr.unstable_batchedUpdates=y1,vr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!r0(n))throw Error(Te(200));if(t==null||t._reactInternals===void 0)throw Error(Te(38));return a0(t,e,n,!1,s)},vr.version="18.3.1-next-f1338f8080-20240426";function XT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(XT)}catch(t){console.error(t)}}XT(),jC.exports=vr;var YT=jC.exports,ZT,JT=YT;ZT=JT.createRoot,JT.hydrateRoot;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var oW={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iW=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Se=(t,e)=>{const n=N.forwardRef(({color:s="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:c,...u},d)=>N.createElement("svg",{ref:d,...oW,width:r,height:r,stroke:s,strokeWidth:o?Number(a)*24/Number(r):a,className:["lucide",`lucide-${iW(t)}`,l].join(" "),...u},[...e.map(([m,h])=>N.createElement(m,h)),...Array.isArray(c)?c:[c]]));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lW=Se("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=Se("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xm=Se("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cW=Se("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Un=Se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Se("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $1=Se("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=Se("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uW=Se("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=Se("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jl=Se("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Se("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=Se("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=Se("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Se("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dW=Se("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eo=Se("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Se("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eA=Se("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mW=Se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hW=Se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=Se("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=Se("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nA=Se("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pW=Se("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fW=Se("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gW=Se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xW=Se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=Se("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=Se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=Se("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=Se("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sA=Se("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yW=Se("Factory",[["path",{d:"M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8l-7 5V8l-7 5V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"159hny"}],["path",{d:"M17 18h1",key:"uldtlt"}],["path",{d:"M12 18h1",key:"s9uhes"}],["path",{d:"M7 18h1",key:"1neino"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bW=Se("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=Se("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=Se("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Se("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wW=Se("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vW=Se("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EW=Se("GitFork",[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=Se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NW=Se("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kW=Se("HandHeart",[["path",{d:"M11 14h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1ifwr1"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9",key:"17abbs"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"M19.5 8.5c.7-.7 1.5-1.6 1.5-2.7A2.73 2.73 0 0 0 16 4a2.78 2.78 0 0 0-5 1.8c0 1.2.8 2 1.5 2.8L16 12Z",key:"1h3036"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=Se("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SW=Se("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oA=Se("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CW=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IW=Se("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=Se("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lA=Se("LineChart",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $W=Se("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=Se("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TW=Se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=Se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=Se("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AW=Se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cA=Se("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=Se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nh=Se("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RW=Se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uA=Se("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A1=Se("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dA=Se("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _W=Se("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=Se("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DW=Se("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R1=Se("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=Se("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mA=Se("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=Se("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D1=Se("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=Se("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=Se("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hA=Se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PW=Se("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FW=Se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MW=Se("Sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=Se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pA=Se("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=Se("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OW=Se("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Se("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LW=Se("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zW=Se("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=Se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zu=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=Se("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=Se("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P1=Se("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);let BW={data:""},UW=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||BW,VW=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,WW=/\/\*[^]*?\*\/|  +/g,yA=/\n+/g,Ki=(t,e)=>{let n="",s="",r="";for(let a in t){let o=t[a];a[0]=="@"?a[1]=="i"?n=a+" "+o+";":s+=a[1]=="f"?Ki(o,a):a+"{"+Ki(o,a[1]=="k"?"":e)+"}":typeof o=="object"?s+=Ki(o,e?e.replace(/([^,])+/g,l=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,l):l?l+" "+c:c)):a):o!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=Ki.p?Ki.p(a,o):a+":"+o+";")}return n+(e&&r?e+"{"+r+"}":r)+s},Zo={},bA=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+bA(t[n]);return e}return t},jW=(t,e,n,s,r)=>{let a=bA(t),o=Zo[a]||(Zo[a]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(a));if(!Zo[o]){let c=a!==t?t:(u=>{let d,m,h=[{}];for(;d=VW.exec(u.replace(WW,""));)d[4]?h.shift():d[3]?(m=d[3].replace(yA," ").trim(),h.unshift(h[0][m]=h[0][m]||{})):h[0][d[1]]=d[2].replace(yA," ").trim();return h[0]})(t);Zo[o]=Ki(r?{["@keyframes "+o]:c}:c,n?"":"."+o)}let l=n&&Zo.g?Zo.g:null;return n&&(Zo.g=Zo[o]),((c,u,d,m)=>{m?u.data=u.data.replace(m,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(Zo[o],e,s,l),o},GW=(t,e,n)=>t.reduce((s,r,a)=>{let o=e[a];if(o&&o.call){let l=o(n),c=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=c?"."+c:l&&typeof l=="object"?l.props?"":Ki(l,""):l===!1?"":l}return s+r+(o??"")},"");function c0(t){let e=this||{},n=t.call?t(e.p):t;return jW(n.unshift?n.raw?GW(n,[].slice.call(arguments,1),e.p):n.reduce((s,r)=>Object.assign(s,r&&r.call?r(e.p):r),{}):n,UW(e.target),e.g,e.o,e.k)}let wA,F1,M1;c0.bind({g:1});let Jo=c0.bind({k:1});function HW(t,e,n,s){Ki.p=e,wA=t,F1=n,M1=s}function Xi(t,e){let n=this||{};return function(){let s=arguments;function r(a,o){let l=Object.assign({},a),c=l.className||r.className;n.p=Object.assign({theme:F1&&F1()},l),n.o=/ *go\d+/.test(c),l.className=c0.apply(n,s)+(c?" "+c:"");let u=t;return t[0]&&(u=l.as||t,delete l.as),M1&&u[0]&&M1(l),wA(u,l)}return r}}var qW=t=>typeof t=="function",u0=(t,e)=>qW(t)?t(e):t,KW=(()=>{let t=0;return()=>(++t).toString()})(),vA=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),XW=20,EA=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,XW)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:n}=e;return EA(t,{type:t.toasts.find(a=>a.id===n.id)?1:0,toast:n});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(a=>a.id===s||s===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let r=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+r}))}}},d0=[],ec={toasts:[],pausedAt:void 0},tc=t=>{ec=EA(ec,t),d0.forEach(e=>{e(ec)})},YW={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ZW=(t={})=>{let[e,n]=N.useState(ec),s=N.useRef(ec);N.useEffect(()=>(s.current!==ec&&n(ec),d0.push(n),()=>{let a=d0.indexOf(n);a>-1&&d0.splice(a,1)}),[]);let r=e.toasts.map(a=>{var o,l,c;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((o=t[a.type])==null?void 0:o.removeDelay)||t?.removeDelay,duration:a.duration||((l=t[a.type])==null?void 0:l.duration)||t?.duration||YW[a.type],style:{...t.style,...(c=t[a.type])==null?void 0:c.style,...a.style}}});return{...e,toasts:r}},JW=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:n?.id||KW()}),sh=t=>(e,n)=>{let s=JW(e,t,n);return tc({type:2,toast:s}),s.id},$t=(t,e)=>sh("blank")(t,e);$t.error=sh("error"),$t.success=sh("success"),$t.loading=sh("loading"),$t.custom=sh("custom"),$t.dismiss=t=>{tc({type:3,toastId:t})},$t.remove=t=>tc({type:4,toastId:t}),$t.promise=(t,e,n)=>{let s=$t.loading(e.loading,{...n,...n?.loading});return typeof t=="function"&&(t=t()),t.then(r=>{let a=e.success?u0(e.success,r):void 0;return a?$t.success(a,{id:s,...n,...n?.success}):$t.dismiss(s),r}).catch(r=>{let a=e.error?u0(e.error,r):void 0;a?$t.error(a,{id:s,...n,...n?.error}):$t.dismiss(s)}),t};var QW=(t,e)=>{tc({type:1,toast:{id:t,height:e}})},ej=()=>{tc({type:5,time:Date.now()})},rh=new Map,tj=1e3,nj=(t,e=tj)=>{if(rh.has(t))return;let n=setTimeout(()=>{rh.delete(t),tc({type:4,toastId:t})},e);rh.set(t,n)},sj=t=>{let{toasts:e,pausedAt:n}=ZW(t);N.useEffect(()=>{if(n)return;let a=Date.now(),o=e.map(l=>{if(l.duration===1/0)return;let c=(l.duration||0)+l.pauseDuration-(a-l.createdAt);if(c<0){l.visible&&$t.dismiss(l.id);return}return setTimeout(()=>$t.dismiss(l.id),c)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[e,n]);let s=N.useCallback(()=>{n&&tc({type:6,time:Date.now()})},[n]),r=N.useCallback((a,o)=>{let{reverseOrder:l=!1,gutter:c=8,defaultPosition:u}=o||{},d=e.filter(p=>(p.position||u)===(a.position||u)&&p.height),m=d.findIndex(p=>p.id===a.id),h=d.filter((p,f)=>f<m&&p.visible).length;return d.filter(p=>p.visible).slice(...l?[h+1]:[0,h]).reduce((p,f)=>p+(f.height||0)+c,0)},[e]);return N.useEffect(()=>{e.forEach(a=>{if(a.dismissed)nj(a.id,a.removeDelay);else{let o=rh.get(a.id);o&&(clearTimeout(o),rh.delete(a.id))}})},[e]),{toasts:e,handlers:{updateHeight:QW,startPause:ej,endPause:s,calculateOffset:r}}},rj=Jo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,aj=Jo`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,oj=Jo`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ij=Xi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rj} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${aj} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${oj} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,lj=Jo`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,cj=Xi("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${lj} 1s linear infinite;
`,uj=Jo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,dj=Jo`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,mj=Xi("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${uj} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${dj} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,hj=Xi("div")`
  position: absolute;
`,pj=Xi("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,fj=Jo`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,gj=Xi("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${fj} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,xj=({toast:t})=>{let{icon:e,type:n,iconTheme:s}=t;return e!==void 0?typeof e=="string"?N.createElement(gj,null,e):e:n==="blank"?null:N.createElement(pj,null,N.createElement(cj,{...s}),n!=="loading"&&N.createElement(hj,null,n==="error"?N.createElement(ij,{...s}):N.createElement(mj,{...s})))},yj=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,bj=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,wj="0%{opacity:0;} 100%{opacity:1;}",vj="0%{opacity:1;} 100%{opacity:0;}",Ej=Xi("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Nj=Xi("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,kj=(t,e)=>{let n=t.includes("top")?1:-1,[s,r]=vA()?[wj,vj]:[yj(n),bj(n)];return{animation:e?`${Jo(s)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Jo(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Sj=N.memo(({toast:t,position:e,style:n,children:s})=>{let r=t.height?kj(t.position||e||"top-center",t.visible):{opacity:0},a=N.createElement(xj,{toast:t}),o=N.createElement(Nj,{...t.ariaProps},u0(t.message,t));return N.createElement(Ej,{className:t.className,style:{...r,...n,...t.style}},typeof s=="function"?s({icon:a,message:o}):N.createElement(N.Fragment,null,a,o))});HW(N.createElement);var Cj=({id:t,className:e,style:n,onHeightUpdate:s,children:r})=>{let a=N.useCallback(o=>{if(o){let l=()=>{let c=o.getBoundingClientRect().height;s(t,c)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,s]);return N.createElement("div",{ref:a,className:e,style:n},r)},Ij=(t,e)=>{let n=t.includes("top"),s=n?{top:0}:{bottom:0},r=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:vA()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...s,...r}},$j=c0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,m0=16,NA=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:s,children:r,containerStyle:a,containerClassName:o})=>{let{toasts:l,handlers:c}=sj(n);return N.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:m0,left:m0,right:m0,bottom:m0,pointerEvents:"none",...a},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},l.map(u=>{let d=u.position||e,m=c.calculateOffset(u,{reverseOrder:t,gutter:s,defaultPosition:e}),h=Ij(d,m);return N.createElement(Cj,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?$j:"",style:h},u.type==="custom"?u0(u.message,u):r?r(u):N.createElement(Sj,{toast:u,position:d}))}))};/*! js-cookie v3.0.5 | MIT */function h0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)t[s]=n[s]}return t}var Tj={read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function O1(t,e){function n(r,a,o){if(!(typeof document>"u")){o=h0({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var l="";for(var c in o)o[c]&&(l+="; "+c,o[c]!==!0&&(l+="="+o[c].split(";")[0]));return document.cookie=r+"="+t.write(a,r)+l}}function s(r){if(!(typeof document>"u"||arguments.length&&!r)){for(var a=document.cookie?document.cookie.split("; "):[],o={},l=0;l<a.length;l++){var c=a[l].split("="),u=c.slice(1).join("=");try{var d=decodeURIComponent(c[0]);if(o[d]=t.read(u,d),r===d)break}catch{}}return r?o[r]:o}}return Object.create({set:n,get:s,remove:function(r,a){n(r,"",h0({},a,{expires:-1}))},withAttributes:function(r){return O1(this.converter,h0({},this.attributes,r))},withConverter:function(r){return O1(h0({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(t)}})}var $e=O1(Tj,{path:"/"});const Aj=()=>{const[t,e]=N.useState("automatic"),[n,s]=N.useState([{id:1,name:"John Smith",skills:["Web Development","UI/UX Design"],status:"Complete",successRate:"95%"},{id:2,name:"Sarah Johnson",skills:["Digital Marketing","Content Creation"],status:"Incomplete",successRate:"87%"},{id:3,name:"Michael Brown",skills:["Project Management","Agile"],status:"Complete",successRate:"92%"},{id:4,name:"Emily Davis",skills:["Data Analysis","Machine Learning"],status:"Complete",successRate:"89%"},{id:5,name:"David Wilson",skills:["Mobile Development","React Native"],status:"Incomplete",successRate:"78%"}]);return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Profile Creation"),i.createElement("button",{className:"flex items-center space-x-2 rounded-lg bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700"},i.createElement(xs,{className:"h-5 w-5"}),i.createElement("span",null,"New Profile"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"mb-6 flex space-x-4 border-b border-gray-200"},i.createElement("button",{className:`border-b-2 px-4 py-2 font-medium ${t==="automatic"?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>e("automatic")},"Automatic Generation"),i.createElement("button",{className:`border-b-2 px-4 py-2 font-medium ${t==="manual"?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>e("manual")},"Manual Creation"),i.createElement("button",{className:`border-b-2 px-4 py-2 font-medium ${t==="import"?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>e("import")},"Import Profiles")),t==="automatic"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-lg bg-indigo-50 p-4 text-indigo-700"},i.createElement("p",{className:"text-sm"},"The AI will automatically generate detailed profiles based on available data sources. You can review and customize the generated profiles before finalizing.")),i.createElement("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Data Sources"),i.createElement("div",{className:"mt-2 space-y-2"},["LinkedIn Profiles","Resume Database","Previous Performance Data","Skills Assessment"].map((r,a)=>i.createElement("div",{key:a,className:"flex items-center"},i.createElement("input",{type:"checkbox",id:`source-${a}`,className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",defaultChecked:!0}),i.createElement("label",{htmlFor:`source-${a}`,className:"ml-2 text-sm text-gray-700"},r))))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Profile Depth"),i.createElement("select",{className:"mt-2 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm"},i.createElement("option",null,"Basic (Skills & Experience)"),i.createElement("option",null,"Standard (+ Performance Metrics)"),i.createElement("option",null,"Comprehensive (+ Success Patterns)")))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Search for Existing Profiles"),i.createElement("div",{className:"mt-2 flex rounded-md shadow-sm"},i.createElement("div",{className:"relative flex flex-grow items-stretch"},i.createElement("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},i.createElement(Xu,{className:"h-5 w-5 text-gray-400"})),i.createElement("input",{type:"text",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Search by name, skills, or experience..."})),i.createElement("button",{className:"ml-3 inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},"Search"))),i.createElement("button",{className:"w-full rounded-md bg-indigo-600 py-2 px-4 text-white hover:bg-indigo-700"},"Generate Profiles")),t==="manual"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Full Name"),i.createElement("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"John Smith"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Email"),i.createElement("input",{type:"email",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"john.smith@example.com"}))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Skills (comma separated)"),i.createElement("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Web Development, UI/UX Design, JavaScript, React"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Experience"),i.createElement("textarea",{rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Describe professional experience..."})),i.createElement("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Hourly Rate ($)"),i.createElement("input",{type:"number",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"75"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Availability"),i.createElement("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},i.createElement("option",null,"Full-time"),i.createElement("option",null,"Part-time"),i.createElement("option",null,"Weekends only"),i.createElement("option",null,"Evenings only")))),i.createElement("div",{className:"flex justify-end space-x-3"},i.createElement("button",{className:"rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},"Cancel"),i.createElement("button",{className:"rounded-md bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Create Profile"))),t==="import"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-lg border-2 border-dashed border-gray-300 p-6 text-center"},i.createElement("div",{className:"flex justify-center"},i.createElement(Xo,{className:"h-12 w-12 text-gray-400"})),i.createElement("p",{className:"mt-2 text-sm font-medium text-gray-900"},"Drag and drop CSV or Excel files"),i.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Or click to browse from your computer"),i.createElement("input",{type:"file",className:"hidden",id:"file-upload",accept:".csv, .xlsx, .xls"}),i.createElement("button",{onClick:()=>document.getElementById("file-upload")?.click(),className:"mt-4 inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Select Files")),i.createElement("div",{className:"rounded-lg bg-gray-50 p-4"},i.createElement("h3",{className:"text-sm font-medium text-gray-900"},"Import Guidelines"),i.createElement("ul",{className:"mt-2 list-disc pl-5 text-xs text-gray-500"},i.createElement("li",null,"Use our template for best results"),i.createElement("li",null,"CSV or Excel files only"),i.createElement("li",null,"Maximum 100 profiles per import"),i.createElement("li",null,"Required fields: Name, Email, Skills"),i.createElement("li",null,"Optional fields will be generated by AI if missing")),i.createElement("button",{className:"mt-3 text-xs font-medium text-indigo-600 hover:text-indigo-500"},"Download Template")))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h2",{className:"mb-4 text-lg font-semibold text-gray-900"},"Existing Profiles"),i.createElement("div",{className:"overflow-x-auto"},i.createElement("table",{className:"min-w-full divide-y divide-gray-200"},i.createElement("thead",{className:"bg-gray-50"},i.createElement("tr",null,i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Name"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Skills"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Success Rate"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions"))),i.createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},n.map(r=>i.createElement("tr",{key:r.id},i.createElement("td",{className:"whitespace-nowrap px-6 py-4"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center"},i.createElement(tA,{className:"h-6 w-6 text-indigo-600"})),i.createElement("div",{className:"ml-4"},i.createElement("div",{className:"text-sm font-medium text-gray-900"},r.name)))),i.createElement("td",{className:"px-6 py-4"},i.createElement("div",{className:"flex flex-wrap gap-1"},r.skills.map((a,o)=>i.createElement("span",{key:o,className:"inline-flex items-center rounded-full bg-indigo-100 px-2.5 py-0.5 text-xs font-medium text-indigo-800"},a)))),i.createElement("td",{className:"whitespace-nowrap px-6 py-4"},r.status==="Complete"?i.createElement("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800"},i.createElement(mt,{className:"mr-1 h-3 w-3"}),"Complete"):i.createElement("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800"},i.createElement(Sn,{className:"mr-1 h-3 w-3"}),"Incomplete")),i.createElement("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},r.successRate),i.createElement("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},i.createElement("button",{className:"mr-2 text-indigo-600 hover:text-indigo-900"},i.createElement(Hi,{className:"h-4 w-4"})),i.createElement("button",{className:"text-red-600 hover:text-red-900"},i.createElement(Hr,{className:"h-4 w-4"}))))))))))},Rj=()=>{const[t,e]=N.useState("create"),[n,s]=N.useState([{id:1,title:"Web Development Project",client:"XYZ Corp",budget:"$2,500",status:"Published",matches:8},{id:2,title:"Digital Marketing Campaign",client:"ABC Inc",budget:"$1,800",status:"Draft",matches:0},{id:3,title:"Mobile App Development",client:"Tech Startup",budget:"$5,000",status:"Published",matches:12},{id:4,title:"Content Creation for Blog",client:"Marketing Agency",budget:"$800",status:"Pending Approval",matches:0},{id:5,title:"UI/UX Design for Website",client:"E-commerce Store",budget:"$1,200",status:"Published",matches:5}]);return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Gig Generation"),i.createElement("button",{className:"flex items-center space-x-2 rounded-lg bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700"},i.createElement(xs,{className:"h-5 w-5"}),i.createElement("span",null,"New Gig"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"mb-6 flex space-x-4 border-b border-gray-200"},i.createElement("button",{className:`border-b-2 px-4 py-2 font-medium ${t==="create"?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>e("create")},"Create Gig"),i.createElement("button",{className:`border-b-2 px-4 py-2 font-medium ${t==="optimize"?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>e("optimize")},"Optimize Existing"),i.createElement("button",{className:`border-b-2 px-4 py-2 font-medium ${t==="templates"?"border-indigo-600 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700"}`,onClick:()=>e("templates")},"Templates")),t==="create"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-lg bg-indigo-50 p-4 text-indigo-700"},i.createElement("div",{className:"flex items-start"},i.createElement(Yu,{className:"mr-2 h-5 w-5 flex-shrink-0"}),i.createElement("p",{className:"text-sm"},"The AI will help you create an optimized gig description based on your requirements. Fill in the details below or use our quick-start templates."))),i.createElement("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Gig Title"),i.createElement("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g., Web Development Project"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Client/Company"),i.createElement("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g., XYZ Corporation"}))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Gig Description"),i.createElement("textarea",{rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Describe the project, requirements, and desired outcomes..."})),i.createElement("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Budget"),i.createElement("div",{className:"mt-1 flex rounded-md shadow-sm"},i.createElement("span",{className:"inline-flex items-center rounded-l-md border border-r-0 border-gray-300 bg-gray-50 px-3 text-gray-500 sm:text-sm"},"$"),i.createElement("input",{type:"number",className:"block w-full flex-1 rounded-none rounded-r-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"1000"}))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Duration"),i.createElement("div",{className:"mt-1 flex rounded-md shadow-sm"},i.createElement("input",{type:"number",className:"block w-full flex-1 rounded-l-md border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"2"}),i.createElement("span",{className:"inline-flex items-center rounded-r-md border border-l-0 border-gray-300 bg-gray-50 px-3 text-gray-500 sm:text-sm"},"weeks"))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Required Skills"),i.createElement("input",{type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"e.g., JavaScript, React, Node.js"}))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Optimization Level"),i.createElement("div",{className:"mt-2 grid grid-cols-1 gap-4 sm:grid-cols-3"},i.createElement("div",{className:"relative flex cursor-pointer rounded-lg border bg-white p-4 shadow-sm focus:outline-none"},i.createElement("input",{type:"radio",name:"optimization",value:"basic",className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500",defaultChecked:!0}),i.createElement("div",{className:"ml-3 flex flex-col"},i.createElement("span",{className:"block text-sm font-medium text-gray-900"},"Basic"),i.createElement("span",{className:"block text-xs text-gray-500"},"Grammar & clarity checks"))),i.createElement("div",{className:"relative flex cursor-pointer rounded-lg border bg-white p-4 shadow-sm focus:outline-none"},i.createElement("input",{type:"radio",name:"optimization",value:"standard",className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500"}),i.createElement("div",{className:"ml-3 flex flex-col"},i.createElement("span",{className:"block text-sm font-medium text-gray-900"},"Standard"),i.createElement("span",{className:"block text-xs text-gray-500"},"+ Keyword optimization"))),i.createElement("div",{className:"relative flex cursor-pointer rounded-lg border bg-white p-4 shadow-sm focus:outline-none"},i.createElement("input",{type:"radio",name:"optimization",value:"premium",className:"h-4 w-4 border-gray-300 text-indigo-600 focus:ring-indigo-500"}),i.createElement("div",{className:"ml-3 flex flex-col"},i.createElement("span",{className:"block text-sm font-medium text-gray-900"},"Premium"),i.createElement("span",{className:"block text-xs text-gray-500"},"+ Conversion optimization"))))),i.createElement("div",{className:"flex justify-end space-x-3"},i.createElement("button",{className:"rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},"Save as Draft"),i.createElement("button",{className:"rounded-md bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Generate & Preview"))),t==="optimize"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Select Gig to Optimize"),i.createElement("div",{className:"mt-2 flex rounded-md shadow-sm"},i.createElement("div",{className:"relative flex flex-grow items-stretch"},i.createElement("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},i.createElement(Xu,{className:"h-5 w-5 text-gray-400"})),i.createElement("input",{type:"text",className:"block w-full rounded-md border-gray-300 pl-10 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Search by title or client..."})),i.createElement("button",{className:"ml-3 inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},"Search"))),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Digital Marketing Campaign"),i.createElement("p",{className:"text-sm text-gray-500"},"Client: ABC Inc")),i.createElement("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800"},"Draft")),i.createElement("div",{className:"mt-4"},i.createElement("p",{className:"text-sm text-gray-700"},"Looking for a digital marketing expert to help with our new product launch. Need someone with experience in social media marketing, email campaigns, and PPC advertising.")),i.createElement("div",{className:"mt-4 flex items-center justify-between"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",null,i.createElement("span",{className:"text-xs text-gray-500"},"Budget:"),i.createElement("span",{className:"ml-1 text-sm font-medium text-gray-900"},"$1,800")),i.createElement("div",null,i.createElement("span",{className:"text-xs text-gray-500"},"Duration:"),i.createElement("span",{className:"ml-1 text-sm font-medium text-gray-900"},"3 weeks"))),i.createElement("button",{className:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(Yu,{className:"mr-1 h-4 w-4"}),"Optimize"))),i.createElement("div",{className:"rounded-lg bg-indigo-50 p-4"},i.createElement("h3",{className:"text-sm font-medium text-indigo-900"},"AI Optimization Suggestions"),i.createElement("ul",{className:"mt-2 space-y-2"},i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-indigo-700"},"Add specific KPIs and success metrics to attract qualified candidates")),i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-indigo-700"},"Include information about target audience and platforms")),i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-indigo-700"},"Specify required reporting frequency and format"))),i.createElement("button",{className:"mt-3 text-sm font-medium text-indigo-600 hover:text-indigo-500"},"Apply All Suggestions"))),t==="templates"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},[{title:"Web Development",description:"For website creation, maintenance, or redesign projects",skills:["HTML/CSS","JavaScript","React"]},{title:"Digital Marketing",description:"For social media, email, and advertising campaigns",skills:["Social Media","SEO","Content"]},{title:"Mobile App Development",description:"For iOS and Android application projects",skills:["Swift","Kotlin","React Native"]},{title:"UI/UX Design",description:"For user interface and experience design projects",skills:["Figma","User Research","Prototyping"]},{title:"Content Creation",description:"For blog posts, articles, and copywriting",skills:["Writing","Editing","SEO"]},{title:"Data Analysis",description:"For data processing and insights generation",skills:["SQL","Python","Visualization"]}].map((r,a)=>i.createElement("div",{key:a,className:"rounded-lg border border-gray-200 bg-white p-4 shadow-sm hover:shadow-md"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},r.title),i.createElement("p",{className:"mt-1 text-sm text-gray-500"},r.description),i.createElement("div",{className:"mt-3 flex flex-wrap gap-1"},r.skills.map((o,l)=>i.createElement("span",{key:l,className:"inline-flex items-center rounded-full bg-indigo-100 px-2.5 py-0.5 text-xs font-medium text-indigo-800"},o))),i.createElement("button",{className:"mt-4 w-full rounded-md bg-indigo-600 py-2 text-sm font-medium text-white hover:bg-indigo-700"},"Use Template")))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h2",{className:"mb-4 text-lg font-semibold text-gray-900"},"Existing Gigs"),i.createElement("div",{className:"overflow-x-auto"},i.createElement("table",{className:"min-w-full divide-y divide-gray-200"},i.createElement("thead",{className:"bg-gray-50"},i.createElement("tr",null,i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Title"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Client"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Budget"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Status"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Matches"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500"},"Actions"))),i.createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},n.map(r=>i.createElement("tr",{key:r.id},i.createElement("td",{className:"whitespace-nowrap px-6 py-4"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center"},i.createElement(Ca,{className:"h-6 w-6 text-indigo-600"})),i.createElement("div",{className:"ml-4"},i.createElement("div",{className:"text-sm font-medium text-gray-900"},r.title)))),i.createElement("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},r.client),i.createElement("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},r.budget),i.createElement("td",{className:"whitespace-nowrap px-6 py-4"},r.status==="Published"?i.createElement("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800"},i.createElement(mt,{className:"mr-1 h-3 w-3"}),"Published"):r.status==="Draft"?i.createElement("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800"},i.createElement(Hi,{className:"mr-1 h-3 w-3"}),"Draft"):i.createElement("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800"},i.createElement(Ct,{className:"mr-1 h-3 w-3"}),"Pending Approval")),i.createElement("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500"},r.matches>0?i.createElement("span",{className:"inline-flex items-center rounded-full bg-indigo-100 px-2.5 py-0.5 text-xs font-medium text-indigo-800"},r.matches," matches"):i.createElement("span",{className:"text-gray-400"},"-")),i.createElement("td",{className:"whitespace-nowrap px-6 py-4 text-right text-sm font-medium"},i.createElement("button",{className:"mr-2 text-indigo-600 hover:text-indigo-900"},i.createElement(Hi,{className:"h-4 w-4"})),i.createElement("button",{className:"text-red-600 hover:text-red-900"},i.createElement(Hr,{className:"h-4 w-4"}))))))))))},Ir="http://localhost:5011/api",_j="http://localhost:5012/api",Dj=async()=>{console.log("getReps called");try{const t=await fetch(`${Ir}/reps`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to fetch reps")}const e=await t.json();if(console.log("Parsed getReps response:",e),!Array.isArray(e))throw new Error("Invalid response format: expected an array of reps");return e}catch(t){throw console.error("Error in getReps:",t),t}},Pj=async()=>{console.log("getGigs called");try{const t=await fetch(`${Ir}/gigs`);if(!t.ok){const n=await t.json();throw new Error(n.message||"Failed to fetch gigs")}const e=await t.json();if(console.log("Parsed getGigs response:",e),!Array.isArray(e))throw new Error("Invalid response format: expected an array of gigs");return e}catch(t){throw console.error("Error in getGigs:",t),t}},Fj=async t=>{console.log("getGigsByCompanyId called with:",t);try{const e=await fetch(`${_j}/gigs/company/${t}`);if(!e.ok)throw new Error("Failed to fetch gigs by company");const n=await e.json();return console.log("Parsed getGigsByCompanyId response:",n),n.data||[]}catch(e){throw console.error("Error in getGigsByCompanyId:",e),e}},L1=async(t,e)=>{console.log("findMatchesForGig called with:",{gigId:t,weights:e});try{const n=await fetch(`${Ir}/matches/gig/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({weights:e})});if(!n.ok){let r="Failed to find matches for gig";try{r=(await n.json()).message||r}catch{r=`HTTP ${n.status}: ${n.statusText}`}throw n.status===404?r=`Gig with ID ${t} not found`:n.status===400?r=`Invalid request data for gig ${t}`:n.status===500&&(r=`Server error while processing gig ${t}`),new Error(r)}const s=await n.json();return console.log("Parsed findMatchesForGig response:",s),s.preferedmatches?s:{totalMatches:s.matches?.length||0,perfectMatches:0,partialMatches:0,noMatches:0,preferedmatches:s.matches||[],matches:s.matches||[]}}catch(n){throw console.error("Error in findMatchesForGig:",n),n.name==="TypeError"&&n.message.includes("fetch")?new Error(`Network error: Unable to connect to matching service. ${n.message}`):n.message?new Error(`Matching error: ${n.message}`):new Error(`Unknown error occurred while finding matches for gig ${t}`)}},Mj=async t=>{console.log("createGigAgent called with:",t);try{const e=await fetch(`${Ir}/gig-agents`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const s=await e.json();throw new Error(s.message||"Failed to create gig-agent")}const n=await e.json();return console.log("Parsed createGigAgent response:",n),n}catch(e){throw console.error("Error in createGigAgent:",e),e}},kA=async t=>{console.log("getGigAgentsForGig called with:",t);try{const e=await fetch(`${Ir}/gig-agents/gig/${t}`);if(!e.ok)throw new Error("Failed to fetch gig agents");const n=await e.json();return console.log("Parsed getGigAgentsForGig response:",n),n||[]}catch(e){throw console.error("Error in getGigAgentsForGig:",e),e}},p0=async t=>{try{const e=await fetch(`${Ir}/gig-agents/invited/company/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=await e.json();return console.log(" Invited agents for company:",n),n}catch(e){throw console.error("Error fetching invited agents for company:",e),e}},f0=async t=>{try{const e=await fetch(`${Ir}/gig-agents/active-agents/company/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=await e.json();return console.log(" Active agents for company:",n),n}catch(e){throw console.error("Error fetching active agents for company:",e),e}},Oj=async(t,e)=>{try{const n=await fetch(`${Ir}/gig-agents/enrollment-requests/${t}/accept`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:e})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();return console.log(" Enrollment request accepted:",s),s}catch(n){throw console.error("Error accepting enrollment request:",n),n}},Lj=async(t,e)=>{try{const n=await fetch(`${Ir}/gig-agents/enrollment-requests/${t}/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:e})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();return console.log(" Enrollment request rejected:",s),s}catch(n){throw console.error("Error rejecting enrollment request:",n),n}},g0=async t=>{try{const e=await fetch(`${Ir}/gig-agents/enrollment-requests/company/${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const n=await e.json();return console.log(" Enrollment requests for company:",n),n}catch(e){throw console.error("Error fetching enrollment requests for company:",e),e}},zj=async()=>{console.log("getAllSkills called");const t={professional:[{_id:"1",name:"Sales Management",category:"professional"},{_id:"2",name:"Customer Service",category:"professional"},{_id:"3",name:"Project Management",category:"professional"}],technical:[{_id:"4",name:"CRM Software",category:"technical"},{_id:"5",name:"Data Analysis",category:"technical"},{_id:"6",name:"Excel Advanced",category:"technical"}],soft:[{_id:"7",name:"Communication",category:"soft"},{_id:"8",name:"Leadership",category:"soft"},{_id:"9",name:"Problem Solving",category:"soft"}]};return console.log("Using mock skills data:",t),t},Bj=async()=>{console.log("getLanguages called");const t=[{_id:"1",name:"English",code:"en"},{_id:"2",name:"French",code:"fr"},{_id:"3",name:"Spanish",code:"es"},{_id:"4",name:"German",code:"de"},{_id:"5",name:"Italian",code:"it"},{_id:"6",name:"Portuguese",code:"pt"},{_id:"7",name:"Dutch",code:"nl"},{_id:"8",name:"Arabic",code:"ar"},{_id:"9",name:"Chinese",code:"zh"},{_id:"10",name:"Japanese",code:"ja"}];return console.log("Using mock languages data:",t),t},Uj=async(t,e)=>{console.log(" SAVE GIG WEIGHTS CALLED:",{gigId:t,matchingWeights:e});try{const n=await fetch(`${Ir}/gig-matching-weights/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({matchingWeights:e})});if(!n.ok){const r=await n.json();throw new Error(r.message||"Failed to save gig weights")}const s=await n.json();return console.log(" SAVE GIG WEIGHTS SUCCESS:",s),s.data||s}catch(n){throw console.error(" Error saving gig weights:",n),n}},Vj=async t=>{console.log(" GET GIG WEIGHTS CALLED:",t);try{const e=await fetch(`${Ir}/gig-matching-weights/${t}`);if(!e.ok){if(e.status===404)throw new Error("No saved weights found for this gig");const s=await e.json();throw new Error(s.message||"Failed to get gig weights")}const n=await e.json();return console.log(" GET GIG WEIGHTS SUCCESS:",n),n.data||n}catch(e){throw console.error(" Error getting gig weights:",e),e}},Wj=async t=>{console.log(" RESET GIG WEIGHTS CALLED:",t);try{const e=await fetch(`${Ir}/gig-matching-weights/${t}`,{method:"DELETE"});if(!e.ok){const n=await e.json();throw new Error(n.message||"Failed to reset gig weights")}console.log(" RESET GIG WEIGHTS SUCCESS")}catch(e){throw console.error(" Error resetting gig weights:",e),e}},SA=()=>{const[t,e]=N.useState([]),[n,s]=N.useState([]),[r,a]=N.useState(null),[o,l]=N.useState([]),[c,u]=N.useState(null),[d,m]=N.useState(!1),[h,p]=N.useState(!0),[f,y]=N.useState(!0),[x,g]=N.useState({experience:0,skills:0,industry:0,languages:0,availability:0,timezone:0,activities:0,region:0}),[b,w]=N.useState(null),[v,E]=N.useState(new Set),[k,C]=N.useState([]),[I,A]=N.useState(!1),[$,T]=N.useState(null),[F,O]=N.useState(null),[M,B]=N.useState({professional:[],technical:[],soft:[]}),[L,Y]=N.useState([]),[D,_]=N.useState(!1),[P,z]=N.useState(!1),[q,K]=N.useState(null),[ae,ne]=N.useState("matching"),[Z,ke]=N.useState(new Set),[Ae,W]=N.useState(new Set),[le,we]=N.useState([]),[de,Ee]=N.useState([]),[Re,ze]=N.useState([]),[_e,ht]=N.useState(""),[X,me]=N.useState(25),[Fe,tt]=N.useState(!1),Oe=S=>{tt(!0),S.preventDefault()},Ye=S=>{if(!Fe)return;const V=document.querySelector(".resizable-container");if(!V)return;const J=V.getBoundingClientRect(),be=(S.clientX-J.left)/J.width*100,ve=Math.max(20,Math.min(50,be));me(ve)},at=()=>{tt(!1)};i.useEffect(()=>(Fe&&(document.addEventListener("mousemove",Ye),document.addEventListener("mouseup",at)),()=>{document.removeEventListener("mousemove",Ye),document.removeEventListener("mouseup",at)}),[Fe]);const At=o.filter(S=>S.agentInfo?.name?.toLowerCase().includes(_e.toLowerCase())||S.agentInfo?.email?.toLowerCase().includes(_e.toLowerCase())||S.agentInfo?.personalInfo?.name?.toLowerCase().includes(_e.toLowerCase())||S.agentInfo?.personalInfo?.email?.toLowerCase().includes(_e.toLowerCase()));N.useEffect(()=>{(async()=>{p(!0),w(null);try{console.log("Fetching data from backend...");const V=$e.get("companyId")||"685abf28641398dc582f4c95",[J,be,ve,se]=await Promise.all([V?Fj(V):Pj(),p0(V),g0(V),f0(V)]);s(J),C(be),Ee(ve),ze(se);const[De,Ke,He]=await Promise.all([Dj(),zj(),Bj()]);e(De),B(Ke),Y(He),console.log("=== BACKEND DATA ==="),console.log("Gigs:",J),console.log("Company Invited Agents:",be),console.log("Enrollment Requests:",ve)}catch(V){console.error("Error fetching data:",V),w("Failed to fetch data. Please try again.")}finally{p(!1)}})()},[]),N.useEffect(()=>{const S=localStorage.getItem("selectedGigId");if(S&&n.length>0&&!r){console.log("Restoring selected gig from localStorage:",S);const V=n.find(J=>J._id===S);V&&wt(V)}},[n]),N.useEffect(()=>{!k||!de||!Re||(console.log(" Company Invited Agents Structure:",k),console.log(" Enrollment Requests Structure:",de),console.log(" Active Agents Structure:",Re),we(k.filter(S=>!S.isActive&&!S.hasCompletedOnboarding)),Ee(de),console.log(" Setting active agents:",Re))},[k,de,Re]);const wt=async S=>{console.log(" GIG SELECTED:",S.title,"ID:",S._id),a(S),S._id&&localStorage.setItem("selectedGigId",S._id),m(!0),w(null),l([]),u(null),ht(""),_(!1),z(!1),K(null);let V=x;try{try{const se=await Vj(S._id||"");g(se.matchingWeights),K(se.matchingWeights),_(!0),z(!1),V=se.matchingWeights,console.log(" Gig has saved weights, loaded:",se.matchingWeights)}catch(se){se.message?.includes("No saved weights found")?console.log(" No saved weights found for gig:",S._id,"- Using default weights"):se.message?.includes("Failed to fetch")?console.warn(" Network error loading weights for gig:",S._id,"- Using current weights"):console.error(" Unexpected error loading weights for gig:",S._id,se),_(!1)}const J=await kA(S._id||""),be=new Set(J.map(se=>se.agentId));E(be),console.log(" Invited reps for gig:",be),console.log("Searching for reps matching gig:",S.title),console.log(" WEIGHTS BEING SENT TO API:",V);let ve;try{ve=await L1(S._id||"",V),console.log("=== MATCHES DATA ===",ve)}catch(se){console.error(" Error finding matches for gig:",se),se.message?.includes("Failed to fetch")?console.error(" Network error: Unable to connect to matching service"):se.message?.includes("500")?console.error(" Server error: Matching service encountered an internal error"):console.error(" Unexpected error:",se.message),ve={preferedmatches:[],totalMatches:0,perfectMatches:0,partialMatches:0,noMatches:0}}if(ve.preferedmatches&&ve.preferedmatches.length>0){const se=ve.preferedmatches[0];console.log(" SCORE BREAKDOWN FOR FIRST MATCH:"),console.log("- Agent:",se.agentInfo?.name),console.log("- Total Score from API:",se.totalMatchingScore),console.log("- Skills Score:",se.skillsMatch?.score," Weight:",V.skills,"=",(se.skillsMatch?.score||0)*V.skills),console.log("- Languages Score:",se.languageMatch?.score," Weight:",V.languages,"=",(se.languageMatch?.score||0)*V.languages),console.log("- Industry Score:",se.industryMatch?.score," Weight:",V.industry,"=",(se.industryMatch?.score||0)*V.industry),console.log("- Activity Score:",se.activityMatch?.score," Weight:",V.activities,"=",(se.activityMatch?.score||0)*V.activities),console.log("- Experience Score:",se.experienceMatch?.score," Weight:",V.experience,"=",(se.experienceMatch?.score||0)*V.experience),console.log("- Timezone Score:",se.timezoneMatch?.score," Weight:",V.timezone,"=",(se.timezoneMatch?.score||0)*V.timezone),console.log("- Region Score:",se.regionMatch?.score," Weight:",V.region,"=",(se.regionMatch?.score||0)*V.region),console.log("- Availability Score:",se.availabilityMatch?.score," Weight:",V.availability,"=",(se.availabilityMatch?.score||0)*V.availability);const De=(se.skillsMatch?.score||0)*V.skills+(se.languageMatch?.score||0)*V.languages+(se.industryMatch?.score||0)*V.industry+(se.activityMatch?.score||0)*V.activities+(se.experienceMatch?.score||0)*V.experience+(se.timezoneMatch?.score||0)*V.timezone+(se.regionMatch?.score||0)*V.region+(se.availabilityMatch?.score||0)*V.availability;console.log(" CALCULATED TOTAL:",De),console.log(" API TOTAL:",se.totalMatchingScore),console.log(" DIFFERENCE:",Math.abs(De-se.totalMatchingScore))}l(ve.preferedmatches||ve.matches||[]),u(ve),setTimeout(()=>St(),100)}catch(J){console.error("Error getting matches:",J),w("Failed to get matches. Please try again."),l([]),u(null)}finally{m(!1)}},fe=(S,V)=>{const J={...x,[S]:V};if(g(J),q&&D){const be=Object.keys(J).some(ve=>Math.abs(J[ve]-q[ve])>.001);z(be)}r&&We()},We=async()=>{if(r){m(!0),w(null);try{console.log("Searching with current weights (no DB reload):",x);const S=await L1(r._id||"",x);console.log("=== MATCHES DATA WITH CURRENT WEIGHTS ===",S),l(S.preferedmatches||S.matches||[]),u(S);const V=await kA(r._id||""),J=new Set(V.map(be=>be.agentId));E(J)}catch(S){console.error("Error searching with current weights:",S),w("Failed to get matches. Please try again."),l([]),u(null)}finally{m(!1)}}},qe=()=>{const S={experience:0,skills:0,industry:0,languages:0,availability:0,timezone:0,activities:0,region:0};if(g(S),q&&D){const V=Object.keys(S).some(J=>Math.abs(S[J]-q[J])>.001);z(V)}r&&We()},je=async()=>{if(console.log(" SAVE WEIGHTS FOR GIG CALLED"),!r){console.error("No gig selected"),w("No gig selected");return}console.log(" MANUAL SAVE TRIGGERED - User clicked save button"),m(!0),w(null);try{await Uj(r._id||"",x),console.log(" Weights saved successfully for gig:",r._id),_(!0),K(x),z(!1),await We()}catch(S){console.error(" Error saving weights or searching:",S),w("Failed to save weights or search. Please try again.")}finally{m(!1)}},it=async S=>{if(!r){O("No gig selected");return}A(!0),O(null),T(null),console.log("Creating gig-rep with data:",{agentId:S.agentId,gigId:r._id,match:S});const V={agentId:S.agentId,gigId:r._id||""};console.log(" Sending minimal request data:",V);try{const J=await Mj(V);console.log("Gig-Rep created successfully:",J),E(Ke=>new Set([...Ke,S.agentId])),l(Ke=>Ke.map(He=>He.agentId===S.agentId?{...He,isInvited:!0}:He)),T(`Successfully invited ${S.agentInfo?.name} to ${r.title}`),setTimeout(()=>{T(null)},3e3);const be=$e.get("companyId")||"685abf28641398dc582f4c95",[ve,se,De]=await Promise.all([p0(be),g0(be),f0(be)]);if(C(ve),Ee(se),ze(De),r){const Ke=await L1(r._id||"",x);l(Ke.preferedmatches||Ke.matches||[]),u(Ke)}}catch(J){console.error("Error creating gig-rep:",J),O("Failed to invite rep to gig. Please try again.")}finally{A(!1)}},St=()=>{console.log(" DEBUG: All matches data:",o),console.log(" DEBUG: invitedAgents Set:",v),console.log(" DEBUG: Company Invited Reps:",k);const S=k.filter(be=>{const ve=!be.isActive&&!be.hasCompletedOnboarding;return console.log(` Company Invited Rep ${be.personalInfo?.name}:`,{status:be.status,isActive:be.isActive,hasCompletedOnboarding:be.hasCompletedOnboarding,isInvited:ve,fullData:be}),ve}),V=de;console.log(" Enrollment Requests from API:",V);const J=Re;console.log(" Active Reps from API:",J),console.log(" Organizing reps by status:"),console.log(" Invited:",S.length,S.map(be=>({name:be.personalInfo?.name,id:be._id}))),console.log(" Enrollment Requests:",V.length,V.map(be=>({name:be.personalInfo?.name,id:be._id}))),console.log(" Active:",J.length,J.map(be=>({name:be.personalInfo?.name,id:be._id}))),we(S),Ee(V),ze(J)},dt=(S,V)=>{if(!S)return"Unknown Skill";if(typeof S=="object"&&S.name)return S.name;const J=typeof S=="string"?S:S.toString();if(J.match(/^[0-9a-fA-F]{24}$/)){const ve=M[V].find(se=>se._id===J);return ve?ve.name:`${V.charAt(0).toUpperCase()+V.slice(1)} Skill`}return J},gt=S=>{if(!S)return"Unknown Language";if(typeof S=="object"&&S.name)return S.name;const V=typeof S=="string"?S:S.toString();if(V.match(/^[0-9a-fA-F]{24}$/)){let be=L.find(ve=>ve._id===V);return be?be.name:"Language"}let J=L.find(be=>be.code===V);return J||(J=L.find(be=>be._id===V)),J||(J=L.find(be=>be.name?.toLowerCase()===V.toLowerCase())),J?J.name:V},Qt=S=>{ke(V=>{const J=new Set(V);return J.has(S)?J.delete(S):J.add(S),J})},Bs=S=>{W(V=>{const J=new Set(V);return J.has(S)?J.delete(S):J.add(S),J})};return i.createElement("div",{className:"min-h-screen bg-antigravity-bg w-full max-w-full overflow-x-hidden text-antigravity-text"},i.createElement("header",{className:"bg-antigravity-primary border-b border-antigravity-primary shadow-lg"},i.createElement("div",{className:"container mx-auto px-4 py-4"},i.createElement("div",{className:"flex justify-between items-center"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"p-2 bg-white/10 rounded-lg"},i.createElement(qr,{size:24,className:"text-white"})),i.createElement("div",null,i.createElement("h1",{className:"text-2xl font-bold text-white"},"Reps Management System"),i.createElement("p",{className:"text-blue-100 text-sm"},"Manage reps through their complete lifecycle"))),i.createElement("div",{className:"hidden lg:flex items-center space-x-6 px-4 py-2 bg-white/10 border border-white/20 rounded-lg text-sm"},i.createElement("div",{className:"text-center"},i.createElement("div",{className:"font-bold text-lg text-white"},t.length),i.createElement("div",{className:"text-blue-100 text-xs"},"Total Reps")),i.createElement("div",{className:"text-center"},i.createElement("div",{className:"font-bold text-lg text-white"},le.length),i.createElement("div",{className:"text-blue-100 text-xs"},"Invited")),i.createElement("div",{className:"text-center"},i.createElement("div",{className:"font-bold text-lg text-white"},de.length),i.createElement("div",{className:"text-blue-100 text-xs"},"Requests")),i.createElement("div",{className:"text-center"},i.createElement("div",{className:"font-bold text-lg text-white"},Re.length),i.createElement("div",{className:"text-blue-100 text-xs"},"Active"))))),i.createElement("div",{className:"border-t border-white/20"},i.createElement("div",{className:"container mx-auto px-4"},i.createElement("nav",{className:"flex space-x-0"},[{id:"matching",label:"Smart Matching System",icon:"",description:"Find & match perfect reps"},{id:"invited",label:"Invited Reps",icon:"",description:"Pending invitations"},{id:"enrollment",label:"Enrollment Requests",icon:"",description:"Rep applications"},{id:"active",label:"Active Reps",icon:"",description:"Working reps"}].map(S=>i.createElement("button",{key:S.id,onClick:()=>ne(S.id),className:`flex-1 px-4 py-4 text-left transition-all duration-200 border-b-4 ${ae===S.id?"border-white bg-white/10":"border-transparent hover:bg-white/5 text-blue-100 hover:text-white"}`},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("span",{className:"text-xl"},S.icon),i.createElement("div",null,i.createElement("div",{className:`font-medium ${ae===S.id?"text-white":"text-blue-100 group-hover:text-white"}`},S.label),i.createElement("div",{className:`text-xs opacity-80 ${ae===S.id?"text-white":"text-blue-200"}`},S.description))))))))),i.createElement("main",{className:"container mx-auto p-6 w-full max-w-full overflow-hidden"},b&&i.createElement("div",{className:"mb-6 bg-red-900/20 border-l-4 border-antigravity-accent text-antigravity-accent px-4 py-3 rounded-lg shadow-md backdrop-blur-sm"},i.createElement("p",{className:"flex items-center"},i.createElement("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})),b)),h&&i.createElement("div",{className:"flex justify-center items-center py-20"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-antigravity-primary"}),i.createElement("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},i.createElement(P1,{size:24,className:"text-antigravity-primary animate-pulse"})))),!h&&i.createElement(i.Fragment,null,ae==="matching"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex justify-between items-center"},i.createElement("div",null,i.createElement("h2",{className:"text-2xl font-bold text-antigravity-text"}," Smart Matching System"),i.createElement("p",{className:"text-antigravity-muted"},"Find and match the perfect reps for your gigs")),i.createElement("button",{onClick:()=>y(!f),className:`px-4 py-2 rounded-lg transition-all duration-200 flex items-center space-x-2 text-sm font-medium ${f?"bg-antigravity-primary text-white hover:bg-indigo-700":"bg-white border border-antigravity-border text-antigravity-text hover:bg-gray-50"}`},i.createElement(Gr,{size:16,className:f?"rotate-180":""}),i.createElement("span",null,f?"Close Weights":"Adjust Weights"))),f&&i.createElement("div",{className:"bg-antigravity-surface rounded-xl shadow-lg p-6 mb-6 transform transition-all duration-300 ease-in-out border border-antigravity-border overflow-hidden"},i.createElement("div",{className:"flex justify-between items-center mb-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"p-2 bg-antigravity-primary/10 rounded-lg shadow-sm border border-antigravity-primary/20"},i.createElement(Gr,{size:20,className:"text-antigravity-primary"})),i.createElement("div",null,i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("h2",{className:"text-lg font-bold text-antigravity-text"},"Matching Weights Configuration"),P&&i.createElement("span",{className:"inline-flex items-center px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded-full text-sm font-medium animate-pulse border border-yellow-500/30"},i.createElement("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.082 16.5c-.77.833.192 2.5 1.732 2.5z"})),"Unsaved changes")),i.createElement("p",{className:"text-antigravity-muted text-sm mt-1"},"Customize how each factor influences the matching algorithm"))),i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("button",{onClick:qe,disabled:d,className:"px-6 py-3 bg-gray-600 text-white hover:bg-gray-700 rounded-xl shadow-lg transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed transform hover:-translate-y-0.5"},i.createElement("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})),i.createElement("span",{className:"font-semibold"},"Reset to Default")),r&&D&&i.createElement("button",{onClick:async()=>{if(r)try{m(!0),await Wj(r._id||""),_(!1),qe(),console.log(" Gig weights reset successfully")}catch(S){console.error(" Error resetting gig weights:",S),w("Failed to reset gig weights")}finally{m(!1)}},disabled:d,className:"px-6 py-3 bg-red-500/10 border border-red-500/30 text-red-400 hover:bg-red-500/20 rounded-xl shadow-lg transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed transform hover:-translate-y-0.5"},i.createElement("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})),i.createElement("span",{className:"font-semibold"},"Delete Saved Weights")))),i.createElement("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mb-4 w-full overflow-hidden"},Object.entries(x).map(([S,V])=>i.createElement("div",{key:`weight-${S}`,className:"bg-antigravity-bg rounded-xl p-3 shadow-md border border-antigravity-border hover:border-antigravity-primary/50 transition-all duration-200 group w-full max-w-full"},i.createElement("div",{className:"flex justify-between items-center mb-3"},i.createElement("label",{className:"text-xs font-bold text-antigravity-muted uppercase tracking-wider"},S),i.createElement("div",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round(V*100)>=20?"bg-antigravity-primary/20 text-antigravity-primary shadow-sm shadow-antigravity-primary/10":Math.round(V*100)>=10?"bg-antigravity-secondary/20 text-antigravity-secondary":"bg-antigravity-border text-antigravity-muted"}`},Math.round(V*100),"%")),i.createElement("div",{className:"relative mb-2 px-1"},i.createElement("input",{type:"range",min:"0",max:"1",step:"0.05",value:V,onChange:J=>fe(S,parseFloat(J.target.value)),className:"w-full h-1.5 bg-antigravity-surface rounded-full appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #8b5cf6 0%, #3b82f6 ${V*100}%, #2D3748 ${V*100}%, #2D3748 100%)`}}),i.createElement("div",{className:"absolute top-1/2 transform -translate-y-1/2 w-4 h-4 bg-antigravity-text rounded-full shadow-lg border-2 border-antigravity-primary pointer-events-none transition-all duration-200 group-hover:scale-110 group-hover:bg-white",style:{left:`calc(${V*100}% - 4px)`}}))))),r&&i.createElement("div",{className:"flex justify-center"},i.createElement("button",{onClick:()=>{console.log(" BUTTON CLICKED - User manually clicked save button"),je()},disabled:d,className:`group relative px-6 py-2 rounded-lg transition-all duration-200 flex items-center space-x-2 shadow-lg transform hover:-translate-y-0.5 hover:shadow-xl font-semibold text-sm disabled:opacity-50 disabled:cursor-not-allowed ${P?"bg-gradient-to-r from-antigravity-accent to-red-600 hover:from-red-500 hover:to-red-700 text-white animate-pulse":D?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white":"bg-gradient-to-r from-antigravity-primary to-antigravity-secondary hover:from-antigravity-secondary hover:to-antigravity-primary text-white"}`},i.createElement("div",{className:"absolute inset-0 rounded-lg bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-200"}),d?i.createElement("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):i.createElement("svg",{className:"w-4 h-4 group-hover:scale-110 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})),i.createElement("span",{className:"relative z-10"},d?"Saving...":P?"Save Changes":D?"Update Weights":"Save Weights"),i.createElement("div",{className:`absolute inset-0 rounded-lg blur-lg opacity-20 group-hover:opacity-40 transition-opacity duration-200 ${P?"bg-antigravity-accent":D?"bg-green-500":"bg-antigravity-primary"}`})))),r&&i.createElement("div",{className:"mb-6"},i.createElement("div",{className:"relative max-w-md mx-auto"},i.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i.createElement("svg",{className:"h-5 w-5 text-antigravity-muted",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"}))),i.createElement("input",{type:"text",placeholder:"Search reps...",value:_e,onChange:S=>ht(S.target.value),className:"block w-full pl-10 pr-3 py-3 border border-antigravity-border rounded-lg leading-5 bg-antigravity-surface placeholder-antigravity-muted focus:outline-none focus:placeholder-antigravity-text/50 focus:ring-2 focus:ring-antigravity-primary focus:border-antigravity-primary text-sm text-antigravity-text transition-all duration-200"}),_e&&i.createElement("button",{onClick:()=>ht(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center"},i.createElement("svg",{className:"h-5 w-5 text-antigravity-muted hover:text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"}))))),i.createElement("div",{className:"resizable-container flex gap-4 w-full max-w-full overflow-hidden"},i.createElement("div",{className:"bg-white rounded-xl shadow-xl p-6 overflow-hidden transition-all duration-200 flex-shrink-0 border border-indigo-100/50 backdrop-blur-sm",style:{width:`${X}%`,minWidth:"280px",maxWidth:"50%"}},i.createElement("div",{className:"flex items-center justify-between mb-6"},i.createElement("h3",{className:"text-xl font-bold text-gray-800 flex items-center space-x-2"},i.createElement("div",{className:"p-2 bg-indigo-100 rounded-lg"},i.createElement(Ca,{size:20,className:"text-indigo-600"})),i.createElement("span",{className:"bg-clip-text text-transparent bg-gradient-to-r from-indigo-600 to-violet-600"},"Available Gigs")),i.createElement("span",{className:"bg-indigo-50 text-indigo-600 py-1 px-3 rounded-full text-xs font-bold border border-indigo-100"},n.length)),i.createElement("div",{className:"space-y-3 max-h-[600px] overflow-y-auto pr-2 custom-scrollbar"},n.map(S=>{const V=Ae.has(S._id||"");return i.createElement("div",{key:S._id,className:`group relative rounded-xl border transition-all duration-300 ${r?._id===S._id?"border-indigo-500 shadow-xl bg-gradient-to-br from-indigo-600 to-violet-600 text-white transform scale-[1.02] ring-2 ring-indigo-200 ring-offset-2":"bg-white border-gray-100 hover:border-indigo-200 hover:shadow-lg hover:bg-indigo-50/30"}`},i.createElement("div",{className:"cursor-pointer p-4",onClick:()=>wt(S)},i.createElement("div",{className:"flex items-center space-x-3 mb-3"},i.createElement("div",{className:`p-2.5 rounded-xl transition-colors duration-200 ${r?._id===S._id?"bg-white/20 backdrop-blur-sm":"bg-indigo-50 group-hover:bg-white shadow-sm"}`},i.createElement(Ca,{size:18,className:`${r?._id===S._id?"text-white":"text-indigo-600"}`})),i.createElement("div",{className:"flex-1 min-w-0"},i.createElement("h4",{className:`font-bold text-sm mb-0.5 ${r?._id===S._id?"text-white":"text-gray-800"}`},S.title),i.createElement("p",{className:`text-xs truncate font-medium ${r?._id===S._id?"text-indigo-100":"text-gray-500"}`},S.companyName))),r?._id===S._id&&i.createElement("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center"},i.createElement("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})))),i.createElement("div",{className:"px-4 pb-4"},i.createElement("button",{onClick:J=>{J.stopPropagation(),Bs(S._id||"")},className:`w-full flex items-center justify-center space-x-2 px-3 py-2 rounded-lg transition-all duration-200 text-sm font-medium ${r?._id===S._id?"bg-white/20 text-white hover:bg-white/30 backdrop-blur-sm":"bg-indigo-50/50 hover:bg-indigo-100 text-indigo-700"}`},i.createElement("span",null,"View Details"),i.createElement("svg",{className:`w-4 h-4 transform transition-transform duration-200 ${V?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})))),V&&i.createElement("div",{className:"px-4 pb-4 border-t border-antigravity-border bg-white overflow-hidden"},i.createElement("div",{className:"pt-4 space-y-4 text-sm overflow-hidden text-antigravity-text"},S.industries&&S.industries.length>0&&i.createElement("div",null,i.createElement("p",{className:"text-antigravity-muted font-medium mb-2"},"Industries:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.industries.map((J,be)=>{const ve=J.name||(typeof J=="string"&&!J.match(/^[0-9a-fA-F]{24}$/)?J:"Industry");return i.createElement("span",{key:be,className:"px-2 py-1 bg-orange-100 text-orange-700 border border-orange-200 rounded text-xs font-medium"},ve)}))),S.activities&&S.activities.length>0&&i.createElement("div",null,i.createElement("p",{className:"text-antigravity-muted font-medium mb-2"},"Activities:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.activities.map((J,be)=>{const ve=J.name||(typeof J=="string"&&!J.match(/^[0-9a-fA-F]{24}$/)?J:"Activity");return i.createElement("span",{key:be,className:"px-2 py-1 bg-teal-100 text-teal-700 border border-teal-200 rounded text-xs font-medium"},ve)}))),i.createElement("div",{className:"flex items-center justify-between"},i.createElement("span",{className:"text-antigravity-muted font-medium"},"Experience:"),i.createElement("span",{className:"font-semibold text-antigravity-text"},S.seniority?.yearsExperience||"N/A"," years")),S.skills?.languages&&S.skills.languages.length>0&&i.createElement("div",null,i.createElement("p",{className:"text-antigravity-muted font-medium mb-2"},"Languages:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.skills.languages.map((J,be)=>i.createElement("span",{key:be,className:"px-2 py-1 bg-purple-100 text-purple-700 border border-purple-200 rounded text-xs font-medium"},gt(J.language||J.iso639_1||J),J.proficiency&&i.createElement("span",{className:"ml-1 text-purple-800"},"(",J.proficiency,")"))))),S.availability&&i.createElement("div",null,i.createElement("span",{className:"text-antigravity-muted font-medium"},"Availability:"),i.createElement("p",{className:"font-semibold text-antigravity-text"},S.availability.schedule?`${S.availability.schedule.length} days/week`:S.availability.hoursPerWeek?`${S.availability.hoursPerWeek}h/week`:S.availability.workingHours&&typeof S.availability.workingHours=="string"?S.availability.workingHours:"Flexible")),S.skills?.professional&&S.skills.professional.length>0&&i.createElement("div",null,i.createElement("p",{className:"text-antigravity-muted font-medium mb-2"},"Professional Skills:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.skills.professional.map((J,be)=>i.createElement("span",{key:`prof-${be}`,className:"px-2 py-1 bg-blue-100 text-blue-700 border border-blue-200 rounded text-xs font-medium"},dt(J.skill||J,"professional"))))),S.skills?.technical&&S.skills.technical.length>0&&i.createElement("div",null,i.createElement("p",{className:"text-antigravity-muted font-medium mb-2"},"Technical Skills:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.skills.technical.map((J,be)=>i.createElement("span",{key:`tech-${be}`,className:"px-2 py-1 bg-green-100 text-green-700 border border-green-200 rounded text-xs font-medium"},dt(J.skill||J,"technical"))))),S.skills?.soft&&S.skills.soft.length>0&&i.createElement("div",null,i.createElement("p",{className:"text-antigravity-muted font-medium mb-2"},"Soft Skills:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.skills.soft.map((J,be)=>i.createElement("span",{key:`soft-${be}`,className:"px-2 py-1 bg-pink-100 text-pink-700 border border-pink-200 rounded text-xs font-medium"},dt(J.skill||J,"soft"))))),i.createElement("div",{className:"grid grid-cols-2 gap-4 text-sm"},S.region&&i.createElement("div",null,i.createElement("span",{className:"text-antigravity-muted font-medium"},"Region:"),i.createElement("p",{className:"font-semibold text-antigravity-text"},typeof S.region=="string"?S.region:S.region.name||"Unknown Region")),S.timezone&&i.createElement("div",null,i.createElement("span",{className:"text-antigravity-muted font-medium"},"Timezone:"),i.createElement("p",{className:"font-semibold text-antigravity-text"},typeof S.timezone=="string"?S.timezone:S.timezone.name||S.timezone.timezoneName||"Unknown Timezone"))))))}))),i.createElement("div",{className:`flex-shrink-0 w-1 bg-antigravity-border hover:bg-antigravity-primary cursor-col-resize transition-colors duration-200 rounded-full flex items-center justify-center group ${Fe?"bg-antigravity-primary":""}`,onMouseDown:Oe,title:"Drag to resize"},i.createElement("div",{className:"w-0.5 h-8 bg-antigravity-muted group-hover:bg-white rounded-full transition-colors duration-200"})),i.createElement("div",{className:"bg-antigravity-surface rounded-xl shadow-lg p-6 overflow-hidden transition-all duration-200 flex-1 min-w-0 border border-antigravity-border"},i.createElement("h3",{className:"text-xl font-semibold text-antigravity-text mb-4 flex items-center space-x-2"},i.createElement(qr,{size:20,className:"text-antigravity-primary"}),i.createElement("span",null,r?`Matches for "${r.title}"`:"Select a Gig to See Matches")),r?d?i.createElement("div",{className:"flex justify-center items-center py-12"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-antigravity-primary"}),i.createElement("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},i.createElement(P1,{size:16,className:"text-antigravity-primary animate-pulse"})))):At.length>0?i.createElement("div",{className:"space-y-3 max-h-96 overflow-y-auto"},At.map((S,V)=>{const J=Re.some(He=>{const xt=He.agentId?._id||He.agentId,en=He.gigId?._id||He.gigId;return xt===S.agentId&&en===r?._id}),be=S.isInvited!==void 0?S.isInvited:v.has(S.agentId),ve=J||S.isEnrolled||S.status==="accepted"||S.agentResponse==="accepted"||S.enrollmentStatus==="accepted"||S.agentInfo?.status==="accepted",se=Math.round((S.totalMatchingScore||0)*100),De=se>=70?"bg-white border-green-500/30 hover:border-green-500/60 shadow-lg":se>=50?"bg-white border-yellow-500/30 hover:border-yellow-500/60 shadow-lg":"bg-white border-red-500/30 hover:border-red-500/60 shadow-lg",Ke=Z.has(S.agentId);return i.createElement("div",{key:`match-${S.agentId}-${V}`,className:`rounded-xl p-6 border transition-all duration-300 ${De}`},i.createElement("div",{className:"flex items-center justify-between mb-4"},i.createElement("div",{className:"flex-1 min-w-0"},i.createElement("div",{className:"flex items-center gap-3 mb-2"},i.createElement("h4",{className:"text-lg font-bold text-antigravity-text truncate cursor-pointer hover:text-antigravity-primary transition-colors",onClick:()=>Qt(S.agentId)},S.agentInfo?.name),i.createElement("div",{className:`px-4 py-2 rounded-full text-sm font-bold shadow-sm ${se>=70?"bg-green-500 text-white":se>=50?"bg-yellow-500 text-white":"bg-red-500 text-white"}`},se,"% Match")),i.createElement("p",{className:"text-sm text-antigravity-muted truncate"},S.agentInfo?.email),i.createElement("div",{className:"flex items-center gap-4 text-xs text-antigravity-muted mt-1"},(S.agentInfo?.timezone?.countryName||S.agentInfo?.location)&&i.createElement("span",null," ",S.agentInfo?.timezone?.countryName||S.agentInfo?.location),S.agentInfo?.timezone?.gmtDisplay&&S.agentInfo.timezone.gmtDisplay!=="Unknown"&&i.createElement("span",null," ",S.agentInfo.timezone.gmtDisplay),S.agentInfo?.professionalSummary?.yearsOfExperience&&i.createElement("span",null," ",S.agentInfo.professionalSummary.yearsOfExperience.toString().replace(/\s+years?/gi,"")," years exp."),S.agentInfo?.personalInfo?.languages&&S.agentInfo.personalInfo.languages.length>0&&i.createElement("span",null," ",S.agentInfo.personalInfo.languages.length," languages"))),i.createElement("div",{className:"flex-shrink-0 ml-4"},ve?i.createElement("span",{className:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"},"Enrolled"):S.alreadyEnrolled?i.createElement("span",{className:"inline-flex items-center px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-sm font-medium"},"Already Enrolled"):be?i.createElement("span",{className:"inline-flex items-center px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},"Invited"):i.createElement("button",{className:"inline-flex items-center px-3 py-1 bg-antigravity-primary text-white rounded-lg hover:bg-indigo-700 transition-all duration-200 text-sm font-medium gap-1 shadow-sm",onClick:()=>it(S),disabled:I},i.createElement(P1,{className:"w-4 h-4"}),"Invite"))),i.createElement("div",{className:"flex justify-center mt-4"},i.createElement("button",{onClick:()=>Qt(S.agentId),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-indigo-600 to-indigo-700 hover:from-indigo-700 hover:to-indigo-800 text-white rounded-lg transition-all duration-200 text-sm font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5"},i.createElement("span",null,Ke?"Hide Details":"View Details"),i.createElement("svg",{className:`w-4 h-4 transform transition-transform duration-200 ${Ke?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})))),Ke&&i.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200 space-y-6 overflow-hidden"},i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 w-full max-w-full overflow-hidden"},S.skillsMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Skills Match"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.skillsMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.skillsMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.skillsMatch.score||0)*100),"%")),S.skillsMatch.details?.matchingSkills&&S.skillsMatch.details.matchingSkills.length>0&&i.createElement("div",{className:"space-y-1"},i.createElement("p",{className:"text-xs text-antigravity-muted mb-2"},"Matched Skills:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.skillsMatch.details.matchingSkills.slice(0,3).map((He,xt)=>i.createElement("span",{key:xt,className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium"},He.skill?.name||He.skillName||dt(He._id||He.skillId||He,He.category||"professional"))),S.skillsMatch.details.matchingSkills.length>3&&i.createElement("span",{className:"px-2 py-1 bg-antigravity-bg text-antigravity-muted rounded text-xs"},"+",S.skillsMatch.details.matchingSkills.length-3)))),S.languageMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Languages"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.languageMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.languageMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.languageMatch.score||0)*100),"%")),S.languageMatch.details?.matchingLanguages&&S.languageMatch.details.matchingLanguages.length>0&&i.createElement("div",{className:"space-y-1"},i.createElement("p",{className:"text-xs text-antigravity-muted mb-2"},"Matched Languages:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.languageMatch.details.matchingLanguages.slice(0,3).map((He,xt)=>i.createElement("span",{key:xt,className:"px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs font-medium"},He.language?.name||He.languageName||gt(He.language||He.code||He),He.agentLevel&&i.createElement("span",{className:"ml-1 text-purple-800"},"(",He.agentLevel,")"))),S.languageMatch.details.matchingLanguages.length>3&&i.createElement("span",{className:"px-2 py-1 bg-antigravity-bg text-antigravity-muted rounded text-xs"},"+",S.languageMatch.details.matchingLanguages.length-3)))),S.industryMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Industry"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.industryMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.industryMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.industryMatch.score||0)*100),"%")),S.industryMatch.details?.matchingIndustries&&S.industryMatch.details.matchingIndustries.length>0&&i.createElement("div",{className:"space-y-1"},i.createElement("p",{className:"text-xs text-antigravity-muted mb-2"},"Matched Industries:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.industryMatch.details.matchingIndustries.slice(0,2).map((He,xt)=>i.createElement("span",{key:xt,className:"px-2 py-1 bg-orange-100 text-orange-700 rounded text-xs font-medium"},He.industry?.name||He.industryName||He.name||He)),S.industryMatch.details.matchingIndustries.length>2&&i.createElement("span",{className:"px-2 py-1 bg-antigravity-bg text-antigravity-muted rounded text-xs"},"+",S.industryMatch.details.matchingIndustries.length-2)))),S.experienceMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Experience"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.experienceMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.experienceMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.experienceMatch.score||0)*100),"%")),i.createElement("div",{className:"text-xs text-antigravity-muted"},i.createElement("p",null,"Rep: ",S.agentInfo?.professionalSummary?.yearsOfExperience||"N/A"," years"),i.createElement("p",null,"Required: ",r?.seniority?.yearsExperience||"N/A"," years")))),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 w-full max-w-full overflow-hidden"},S.timezoneMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Timezone"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.timezoneMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.timezoneMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.timezoneMatch.score||0)*100),"%")),i.createElement("div",{className:"text-xs text-antigravity-muted"},i.createElement("p",null,"Rep: ",S.agentInfo?.timezone?.gmtDisplay||"N/A"),i.createElement("p",null,"Zone: ",S.agentInfo?.timezone?.timezoneName||S.agentInfo?.availability?.timeZone?.zoneName||"N/A"),i.createElement("p",null,"Location: ",S.agentInfo?.timezone?.countryName||S.agentInfo?.personalInfo?.country?.name||S.agentInfo?.location||"N/A"))),S.regionMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Region"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.regionMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.regionMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.regionMatch.score||0)*100),"%")),i.createElement("div",{className:"text-xs text-antigravity-muted"},i.createElement("p",null,"Country: ",S.agentInfo?.timezone?.countryName||S.agentInfo?.personalInfo?.country?.name||"N/A"),i.createElement("p",null,"Code: ",S.agentInfo?.timezone?.countryCode||S.agentInfo?.personalInfo?.country?.code||"N/A"))),S.availabilityMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Availability"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.availabilityMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.availabilityMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.availabilityMatch.score||0)*100),"%")),i.createElement("div",{className:"text-xs text-antigravity-muted"},i.createElement("p",null,"Schedule: ",S.agentInfo?.availability?.schedule?.length||0," days/week"))),S.activityMatch&&i.createElement("div",{className:"bg-antigravity-surface rounded-lg p-4 shadow-sm"},i.createElement("div",{className:"flex items-center justify-between mb-2"},i.createElement("h5",{className:"font-semibold text-antigravity-text"},"Activities"),i.createElement("span",{className:`px-2 py-1 rounded text-xs font-bold ${Math.round((S.activityMatch.score||0)*100)>=70?"bg-green-100 text-green-800":Math.round((S.activityMatch.score||0)*100)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},Math.round((S.activityMatch.score||0)*100),"%")),S.activityMatch.details?.matchingActivities&&S.activityMatch.details.matchingActivities.length>0&&i.createElement("div",{className:"space-y-1"},i.createElement("p",{className:"text-xs text-antigravity-muted mb-2"},"Matched Activities:"),i.createElement("div",{className:"flex flex-wrap gap-1"},S.activityMatch.details.matchingActivities.slice(0,2).map((He,xt)=>i.createElement("span",{key:xt,className:"px-2 py-1 bg-teal-100 text-teal-700 rounded text-xs font-medium"},He.activity?.name||He.activityName||He.name||He)),S.activityMatch.details.matchingActivities.length>2&&i.createElement("span",{className:"px-2 py-1 bg-antigravity-bg text-antigravity-muted rounded text-xs"},"+",S.activityMatch.details.matchingActivities.length-2)))))))})):_e?i.createElement("div",{className:"text-center py-8"},i.createElement("div",{className:"bg-antigravity-surface rounded-xl p-6 max-w-md mx-auto"},i.createElement("svg",{className:"w-12 h-12 text-antigravity-muted mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})),i.createElement("p",{className:"text-antigravity-text mb-2"},'No reps found for "',_e,'"'),i.createElement("p",{className:"text-sm text-antigravity-muted"},"Try adjusting your search terms"))):i.createElement("div",{className:"text-center py-8"},i.createElement("div",{className:"bg-antigravity-surface rounded-xl p-6 max-w-md mx-auto"},i.createElement(Ca,{size:24,className:"text-antigravity-muted mx-auto mb-2"}),i.createElement("p",{className:"text-antigravity-text"},"No matches found for this gig."))):i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"bg-antigravity-bg rounded-xl p-8 max-w-md mx-auto border border-antigravity-border"},i.createElement(Ca,{size:48,className:"text-antigravity-muted mx-auto mb-4"}),i.createElement("p",{className:"text-antigravity-text text-lg mb-2"},"No gig selected"),i.createElement("p",{className:"text-sm text-antigravity-muted"},"Choose a gig from the left to see matching reps"))),$&&i.createElement("div",{className:"mt-4 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg"},i.createElement("div",{className:"flex items-center"},i.createElement("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})),$)),F&&i.createElement("div",{className:"mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg"},i.createElement("div",{className:"flex items-center"},i.createElement("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})),F))))),ae==="invited"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center space-x-3 mb-2"},i.createElement("h2",{className:"text-2xl font-bold text-antigravity-text"}," Invited Reps"),i.createElement("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm font-medium border border-yellow-200"},le.length," Pending")),i.createElement("p",{className:"text-antigravity-muted"},"Reps who have been invited but haven't responded yet"),i.createElement("div",{className:"bg-antigravity-surface rounded-xl shadow-lg p-6"},le.length>0?i.createElement("div",{className:"space-y-4"},le.map((S,V)=>(console.log(" Invited Agent Data:",S),i.createElement("div",{key:`invited-${S._id}-${V}`,className:"bg-yellow-50 border border-yellow-200 rounded-xl p-5 hover:shadow-md transition-all duration-200"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex-1"},i.createElement("h3",{className:"text-lg font-bold text-gray-900"},S.personalInfo?.name),i.createElement("p",{className:"text-antigravity-muted"},S.personalInfo?.email),i.createElement("div",{className:"mt-2 space-y-1"},i.createElement("p",{className:"text-sm text-yellow-600 font-medium bg-yellow-100/50 inline-block px-2 py-0.5 rounded"},"Invited  Waiting for response"),(S.gigId?.title||S.gig?.title)&&i.createElement("p",{className:"text-sm text-antigravity-muted"},i.createElement("span",{className:"font-medium"},"Gig:")," ",S.gigId?.title||S.gig?.title))),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("span",{className:"inline-flex items-center px-3 py-2 bg-yellow-900/40 text-yellow-300 rounded-lg text-sm font-medium"}," Pending"))))))):i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"bg-antigravity-bg rounded-xl p-8 max-w-md mx-auto border border-antigravity-border"},i.createElement("div",{className:"text-6xl mb-4"},""),i.createElement("p",{className:"text-antigravity-text text-lg mb-2"},"No pending invitations"),i.createElement("p",{className:"text-sm text-antigravity-muted"},"All invitations have been responded to."))))),ae==="enrollment"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center space-x-3 mb-2"},i.createElement("h2",{className:"text-2xl font-bold text-antigravity-text"}," Enrollment Requests"),i.createElement("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium border border-blue-200"},de.length," Requests")),i.createElement("p",{className:"text-antigravity-muted"},"Reps who accepted invitations and are requesting to join"),i.createElement("div",{className:"bg-antigravity-surface rounded-xl shadow-lg p-6"},de.length>0?i.createElement("div",{className:"space-y-4"},de.map((S,V)=>i.createElement("div",{key:`enrollment-${S._id}-${V}`,className:"bg-blue-50 border border-blue-200 rounded-xl p-5 hover:shadow-md transition-all duration-200"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex-1"},i.createElement("h3",{className:"text-lg font-bold text-gray-900"},S.agentId?.personalInfo?.name),i.createElement("p",{className:"text-antigravity-muted"},S.agentId?.personalInfo?.email),i.createElement("div",{className:"mt-2 space-y-1"},i.createElement("p",{className:"text-sm text-blue-600 font-medium"},i.createElement("span",{className:"font-medium"},"Status:")," ",S.enrollmentStatus),(S.gigId?.title||S.gig?.title)&&i.createElement("p",{className:"text-sm text-antigravity-muted"},i.createElement("span",{className:"font-medium"},"Gig:")," ",S.gigId?.title||S.gig?.title),S.notes&&i.createElement("p",{className:"text-sm text-antigravity-muted italic"},'"',S.notes,'"'))),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("button",{onClick:async()=>{try{await Oj(S._id,"Welcome to the team! We are delighted to have you.");const J=$e.get("companyId")||"",[be,ve,se]=await Promise.all([p0(J),g0(J),f0(J)]);C(be),Ee(ve),ze(se)}catch(J){console.error("Error accepting enrollment request:",J)}},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all duration-200 text-sm font-medium"}," Approve"),i.createElement("button",{onClick:async()=>{try{await Lj(S._id,"Sorry, we cannot proceed with your application at this time.");const J=$e.get("companyId")||"",[be,ve,se]=await Promise.all([p0(J),g0(J),f0(J)]);C(be),Ee(ve),ze(se)}catch(J){console.error("Error rejecting enrollment request:",J)}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all duration-200 text-sm font-medium"}," Reject")))))):i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"bg-antigravity-bg rounded-xl p-8 max-w-md mx-auto border border-antigravity-border"},i.createElement("div",{className:"text-6xl mb-4"},""),i.createElement("p",{className:"text-antigravity-text text-lg mb-2"},"No enrollment requests"),i.createElement("p",{className:"text-sm text-antigravity-muted"},"No reps are waiting for approval."))))),ae==="active"&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center space-x-3 mb-2"},i.createElement("h2",{className:"text-2xl font-bold text-antigravity-text"}," Active Reps"),i.createElement("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium border border-green-200"},Re.length," Active")),i.createElement("p",{className:"text-antigravity-muted"},"Reps who are approved and actively working"),i.createElement("div",{className:"bg-antigravity-surface rounded-xl shadow-lg p-6"},Re.length>0?i.createElement("div",{className:"space-y-4"},Re.map((S,V)=>i.createElement("div",{key:`active-${S._id}-${V}`,className:"bg-green-50 border border-green-200 rounded-xl p-5 hover:shadow-md transition-all duration-200"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex-1"},i.createElement("div",{className:"flex items-center gap-3 mb-2"},i.createElement("h3",{className:"text-lg font-bold text-gray-900"},S.agentId?.personalInfo?.name),i.createElement("span",{className:"inline-flex items-center px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium border border-green-200"}," Active")),i.createElement("p",{className:"text-antigravity-muted mb-2"},S.agentId?.personalInfo?.email),i.createElement("div",{className:"mt-3 space-y-2"},(S.gigId?.title||S.gig?.title)&&i.createElement("div",{className:"mb-2"},i.createElement("p",{className:"text-sm text-antigravity-muted"},i.createElement("span",{className:"font-medium"},"Gig:")," ",S.gigId?.title||S.gig?.title)),i.createElement("div",{className:"flex items-center gap-4 text-sm"},i.createElement("span",{className:"text-antigravity-muted"},i.createElement("span",{className:"font-medium"},"Experience:")," ",S.agentId?.professionalSummary?.yearsOfExperience," years"),i.createElement("span",{className:"text-antigravity-muted"},i.createElement("span",{className:"font-medium"},"Role:")," ",S.agentId?.professionalSummary?.currentRole)),i.createElement("div",{className:"flex flex-wrap gap-2"},S.agentId?.professionalSummary?.keyExpertise?.slice(0,5).map((J,be)=>i.createElement("span",{key:be,className:"px-2 py-1 bg-green-900/30 text-green-300 rounded text-xs"},J)),S.agentId?.professionalSummary?.keyExpertise?.length>5&&i.createElement("span",{className:"px-2 py-1 bg-antigravity-bg text-antigravity-muted rounded text-xs"},"+",S.agentId.professionalSummary.keyExpertise.length-5," more")),i.createElement("div",{className:"flex flex-wrap gap-4 text-sm text-antigravity-muted"},i.createElement("div",null,i.createElement("span",{className:"font-medium"},"Availability:")," ",S.agentId?.availability?.schedule?.length," days/week"),i.createElement("div",null,i.createElement("span",{className:"font-medium"},"Status:")," ",S.agentId?.onboardingProgress?.currentPhase===4?"Fully Onboarded":"In Progress"),i.createElement("div",null,i.createElement("span",{className:"font-medium"},"Languages:")," ",S.agentId?.personalInfo?.languages?.length||0)))),i.createElement("div",{className:"flex flex-col items-end space-y-2"},i.createElement("button",{className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-all duration-200 text-sm font-medium"},"Manage Profile")))))):i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"bg-antigravity-bg rounded-xl p-8 max-w-md mx-auto border border-antigravity-border"},i.createElement("div",{className:"text-6xl mb-4"},""),i.createElement("p",{className:"text-antigravity-text text-lg mb-2"},"No active reps"),i.createElement("p",{className:"text-sm text-antigravity-muted"},"Start by finding matches and inviting reps."))))))))};var z1={};Object.defineProperty(z1,"__esModule",{value:!0}),z1.parse=Yj,z1.serialize=Zj;const jj=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Gj=/^[\u0021-\u003A\u003C-\u007E]*$/,Hj=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,qj=/^[\u0020-\u003A\u003D-\u007E]*$/,Kj=Object.prototype.toString,Xj=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function Yj(t,e){const n=new Xj,s=t.length;if(s<2)return n;const r=e?.decode||Jj;let a=0;do{const o=t.indexOf("=",a);if(o===-1)break;const l=t.indexOf(";",a),c=l===-1?s:l;if(o>c){a=t.lastIndexOf(";",o-1)+1;continue}const u=CA(t,a,o),d=IA(t,o,u),m=t.slice(u,d);if(n[m]===void 0){let h=CA(t,o+1,c),p=IA(t,c,h);const f=r(t.slice(h,p));n[m]=f}a=c+1}while(a<s);return n}function CA(t,e,n){do{const s=t.charCodeAt(e);if(s!==32&&s!==9)return e}while(++e<n);return n}function IA(t,e,n){for(;e>n;){const s=t.charCodeAt(--e);if(s!==32&&s!==9)return e+1}return n}function Zj(t,e,n){const s=n?.encode||encodeURIComponent;if(!jj.test(t))throw new TypeError(`argument name is invalid: ${t}`);const r=s(e);if(!Gj.test(r))throw new TypeError(`argument val is invalid: ${e}`);let a=t+"="+r;if(!n)return a;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);a+="; Max-Age="+n.maxAge}if(n.domain){if(!Hj.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);a+="; Domain="+n.domain}if(n.path){if(!qj.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);a+="; Path="+n.path}if(n.expires){if(!Qj(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);a+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(a+="; HttpOnly"),n.secure&&(a+="; Secure"),n.partitioned&&(a+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":a+="; Priority=Low";break;case"medium":a+="; Priority=Medium";break;case"high":a+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":a+="; SameSite=Strict";break;case"lax":a+="; SameSite=Lax";break;case"none":a+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return a}function Jj(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function Qj(t){return Kj.call(t)==="[object Date]"}function eG(t={}){let{initialEntries:e=["/"],initialIndex:n,v5Compat:s=!1}=t,r;r=e.map((p,f)=>d(p,typeof p=="string"?null:p.state,f===0?"default":void 0));let a=c(n??r.length-1),o="POP",l=null;function c(p){return Math.min(Math.max(p,0),r.length-1)}function u(){return r[a]}function d(p,f=null,y){let x=nG(r?u().pathname:"/",p,f,y);return Aa(x.pathname.charAt(0)==="/",`relative pathnames are not supported in memory history: ${JSON.stringify(p)}`),x}function m(p){return typeof p=="string"?p:x0(p)}return{get index(){return a},get action(){return o},get location(){return u()},createHref:m,createURL(p){return new URL(m(p),"http://localhost")},encodeLocation(p){let f=typeof p=="string"?Ju(p):p;return{pathname:f.pathname||"",search:f.search||"",hash:f.hash||""}},push(p,f){o="PUSH";let y=d(p,f);a+=1,r.splice(a,r.length,y),s&&l&&l({action:o,location:y,delta:1})},replace(p,f){o="REPLACE";let y=d(p,f);r[a]=y,s&&l&&l({action:o,location:y,delta:0})},go(p){o="POP";let f=c(a+p),y=r[f];a=f,l&&l({action:o,location:y,delta:p})},listen(p){return l=p,()=>{l=null}}}}function as(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Aa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tG(){return Math.random().toString(36).substring(2,10)}function nG(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ju(e):e,state:n,key:e&&e.key||s||tG()}}function x0({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ju(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function $A(t,e,n="/"){return sG(t,e,n,!1)}function sG(t,e,n,s){let r=typeof e=="string"?Ju(e):e,a=Qo(r.pathname||"/",n);if(a==null)return null;let o=TA(t);rG(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=fG(a);l=hG(o[c],u,s)}return l}function TA(t,e=[],n=[],s=""){let r=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(as(c.relativePath.startsWith(s),`Absolute route path "${c.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(s.length));let u=ei([s,c.relativePath]),d=n.concat(c);a.children&&a.children.length>0&&(as(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),TA(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:dG(u,a.index),routesMeta:d})};return t.forEach((a,o)=>{if(a.path===""||!a.path?.includes("?"))r(a,o);else for(let l of AA(a.path))r(a,o,l)}),e}function AA(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let o=AA(s.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),r&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function rG(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:mG(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var aG=/^:[\w-]+$/,oG=3,iG=2,lG=1,cG=10,uG=-2,RA=t=>t==="*";function dG(t,e){let n=t.split("/"),s=n.length;return n.some(RA)&&(s+=uG),e&&(s+=iG),n.filter(r=>!RA(r)).reduce((r,a)=>r+(aG.test(a)?oG:a===""?lG:cG),s)}function mG(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function hG(t,e,n=!1){let{routesMeta:s}=t,r={},a="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,d=a==="/"?e:e.slice(a.length)||"/",m=y0({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!m&&u&&n&&!s[s.length-1].route.index&&(m=y0({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!m)return null;Object.assign(r,m.params),o.push({params:r,pathname:ei([a,m.pathname]),pathnameBase:bG(ei([a,m.pathnameBase])),route:h}),m.pathnameBase!=="/"&&(a=ei([a,m.pathnameBase]))}return o}function y0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=pG(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let a=r[0],o=a.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((u,{paramName:d,isOptional:m},h)=>{if(d==="*"){let f=l[h]||"";o=a.slice(0,a.length-f.length).replace(/(.)\/+$/,"$1")}const p=l[h];return m&&!p?u[d]=void 0:u[d]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function pG(t,e=!1,n=!0){Aa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function fG(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Aa(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Qo(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function gG(t,e="/"){let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Ju(t):t;return{pathname:n?n.startsWith("/")?n:xG(n,e):e,search:wG(s),hash:vG(r)}}function xG(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function B1(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function yG(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function _A(t){let e=yG(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function DA(t,e,n,s=!1){let r;typeof t=="string"?r=Ju(t):(r={...t},as(!r.pathname||!r.pathname.includes("?"),B1("?","pathname","search",r)),as(!r.pathname||!r.pathname.includes("#"),B1("#","pathname","hash",r)),as(!r.search||!r.search.includes("#"),B1("#","search","hash",r)));let a=t===""||r.pathname==="",o=a?"/":r.pathname,l;if(o==null)l=n;else{let m=e.length-1;if(!s&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),m-=1;r.pathname=h.join("/")}l=m>=0?e[m]:"/"}let c=gG(r,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var ei=t=>t.join("/").replace(/\/\/+/g,"/"),bG=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wG=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,vG=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function EG(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var PA=["POST","PUT","PATCH","DELETE"];new Set(PA);var NG=["GET",...PA];new Set(NG);var Qu=N.createContext(null);Qu.displayName="DataRouter";var b0=N.createContext(null);b0.displayName="DataRouterState";var FA=N.createContext({isTransitioning:!1});FA.displayName="ViewTransition";var kG=N.createContext(new Map);kG.displayName="Fetchers";var SG=N.createContext(null);SG.displayName="Await";var no=N.createContext(null);no.displayName="Navigation";var w0=N.createContext(null);w0.displayName="Location";var ti=N.createContext({outlet:null,matches:[],isDataRoute:!1});ti.displayName="Route";var U1=N.createContext(null);U1.displayName="RouteError";function CG(t,{relative:e}={}){as(ah(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=N.useContext(no),{hash:r,pathname:a,search:o}=oh(t,{relative:e}),l=a;return n!=="/"&&(l=a==="/"?n:ei([n,a])),s.createHref({pathname:l,search:o,hash:r})}function ah(){return N.useContext(w0)!=null}function nc(){return as(ah(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(w0).location}var MA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function OA(t){N.useContext(no).static||N.useLayoutEffect(t)}function LA(){let{isDataRoute:t}=N.useContext(ti);return t?zG():IG()}function IG(){as(ah(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Qu),{basename:e,navigator:n}=N.useContext(no),{matches:s}=N.useContext(ti),{pathname:r}=nc(),a=JSON.stringify(_A(s)),o=N.useRef(!1);return OA(()=>{o.current=!0}),N.useCallback((c,u={})=>{if(Aa(o.current,MA),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=DA(c,JSON.parse(a),r,u.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ei([e,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[e,n,a,r,t])}N.createContext(null);function oh(t,{relative:e}={}){let{matches:n}=N.useContext(ti),{pathname:s}=nc(),r=JSON.stringify(_A(n));return N.useMemo(()=>DA(t,JSON.parse(r),s,e==="path"),[t,r,s,e])}function $G(t,e,n,s){as(ah(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r,static:a}=N.useContext(no),{matches:o}=N.useContext(ti),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",m=l&&l.route;{let b=m&&m.path||"";BA(u,!m||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let h=nc(),p;p=h;let f=p.pathname||"/",y=f;if(d!=="/"){let b=d.replace(/^\//,"").split("/");y="/"+f.replace(/^\//,"").split("/").slice(b.length).join("/")}let x=!a&&n&&n.matches&&n.matches.length>0?n.matches:$A(t,{pathname:y});return Aa(m||x!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Aa(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),DG(x&&x.map(b=>Object.assign({},b,{params:Object.assign({},c,b.params),pathname:ei([d,r.encodeLocation?r.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?d:ei([d,r.encodeLocation?r.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),o,n,s)}function TG(){let t=LG(),e=EG(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:a},"ErrorBoundary")," or"," ",N.createElement("code",{style:a},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:r},n):null,o)}var AG=N.createElement(TG,null),RG=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?N.createElement(ti.Provider,{value:this.props.routeContext},N.createElement(U1.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _G({routeContext:t,match:e,children:n}){let s=N.useContext(Qu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(ti.Provider,{value:t},n)}function DG(t,e=[],n=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let r=t,a=n?.errors;if(a!=null){let c=r.findIndex(u=>u.route.id&&a?.[u.route.id]!==void 0);as(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),r=r.slice(0,Math.min(r.length,c+1))}let o=!1,l=-1;if(n)for(let c=0;c<r.length;c++){let u=r[c];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(l=c),u.route.id){let{loaderData:d,errors:m}=n,h=u.route.loader&&!d.hasOwnProperty(u.route.id)&&(!m||m[u.route.id]===void 0);if(u.route.lazy||h){o=!0,l>=0?r=r.slice(0,l+1):r=[r[0]];break}}}return r.reduceRight((c,u,d)=>{let m,h=!1,p=null,f=null;n&&(m=a&&u.route.id?a[u.route.id]:void 0,p=u.route.errorElement||AG,o&&(l<0&&d===0?(BA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):l===d&&(h=!0,f=u.route.hydrateFallbackElement||null)));let y=e.concat(r.slice(0,d+1)),x=()=>{let g;return m?g=p:h?g=f:u.route.Component?g=N.createElement(u.route.Component,null):u.route.element?g=u.route.element:g=c,N.createElement(_G,{match:u,routeContext:{outlet:c,matches:y,isDataRoute:n!=null},children:g})};return n&&(u.route.ErrorBoundary||u.route.errorElement||d===0)?N.createElement(RG,{location:n.location,revalidation:n.revalidation,component:p,error:m,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}function V1(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function PG(t){let e=N.useContext(Qu);return as(e,V1(t)),e}function FG(t){let e=N.useContext(b0);return as(e,V1(t)),e}function MG(t){let e=N.useContext(ti);return as(e,V1(t)),e}function W1(t){let e=MG(t),n=e.matches[e.matches.length-1];return as(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function OG(){return W1("useRouteId")}function LG(){let t=N.useContext(U1),e=FG("useRouteError"),n=W1("useRouteError");return t!==void 0?t:e.errors?.[n]}function zG(){let{router:t}=PG("useNavigate"),e=W1("useNavigate"),n=N.useRef(!1);return OA(()=>{n.current=!0}),N.useCallback(async(r,a={})=>{Aa(n.current,MA),n.current&&(typeof r=="number"?t.navigate(r):await t.navigate(r,{fromRouteId:e,...a}))},[t,e])}var zA={};function BA(t,e,n){!e&&!zA[t]&&(zA[t]=!0,Aa(!1,n))}N.memo(BG);function BG({routes:t,future:e,state:n}){return $G(t,void 0,n,e)}function UG({basename:t,children:e,initialEntries:n,initialIndex:s}){let r=N.useRef();r.current==null&&(r.current=eG({initialEntries:n,initialIndex:s,v5Compat:!0}));let a=r.current,[o,l]=N.useState({action:a.action,location:a.location}),c=N.useCallback(u=>{N.startTransition(()=>l(u))},[l]);return N.useLayoutEffect(()=>a.listen(c),[a,c]),N.createElement(VG,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a})}function VG({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:r,static:a=!1}){as(!ah(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:o,navigator:r,static:a,future:{}}),[o,r,a]);typeof n=="string"&&(n=Ju(n));let{pathname:c="/",search:u="",hash:d="",state:m=null,key:h="default"}=n,p=N.useMemo(()=>{let f=Qo(c,o);return f==null?null:{location:{pathname:f,search:u,hash:d,state:m,key:h},navigationType:s}},[o,c,u,d,m,h,s]);return Aa(p!=null,`<Router basename="${o}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:N.createElement(no.Provider,{value:l},N.createElement(w0.Provider,{children:e,value:p}))}var v0="get",E0="application/x-www-form-urlencoded";function N0(t){return t!=null&&typeof t.tagName=="string"}function WG(t){return N0(t)&&t.tagName.toLowerCase()==="button"}function jG(t){return N0(t)&&t.tagName.toLowerCase()==="form"}function GG(t){return N0(t)&&t.tagName.toLowerCase()==="input"}function HG(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function qG(t,e){return t.button===0&&(!e||e==="_self")&&!HG(t)}var k0=null;function KG(){if(k0===null)try{new FormData(document.createElement("form"),0),k0=!1}catch{k0=!0}return k0}var XG=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function j1(t){return t!=null&&!XG.has(t)?(Aa(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${E0}"`),null):t}function YG(t,e){let n,s,r,a,o;if(jG(t)){let l=t.getAttribute("action");s=l?Qo(l,e):null,n=t.getAttribute("method")||v0,r=j1(t.getAttribute("enctype"))||E0,a=new FormData(t)}else if(WG(t)||GG(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(s=c?Qo(c,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||v0,r=j1(t.getAttribute("formenctype"))||j1(l.getAttribute("enctype"))||E0,a=new FormData(l,t),!KG()){let{name:u,type:d,value:m}=t;if(d==="image"){let h=u?`${u}.`:"";a.append(`${h}x`,"0"),a.append(`${h}y`,"0")}else u&&a.append(u,m)}}else{if(N0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=v0,s=null,r=E0,o=t}return a&&r==="text/plain"&&(o=a,a=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:a,body:o}}function G1(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function ZG(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function JG(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function QG(t,e,n){let s=await Promise.all(t.map(async r=>{let a=e.routes[r.route.id];if(a){let o=await ZG(a,n);return o.links?o.links():[]}return[]}));return s8(s.flat(1).filter(JG).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function UA(t,e,n,s,r,a){let o=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>n[u].pathname!==c.pathname||n[u].route.path?.endsWith("*")&&n[u].params["*"]!==c.params["*"];return a==="assets"?e.filter((c,u)=>o(c,u)||l(c,u)):a==="data"?e.filter((c,u)=>{let d=s.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(o(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let m=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function e8(t,e,{includeHydrateFallback:n}={}){return t8(t.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function t8(t){return[...new Set(t)]}function n8(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function s8(t,e){let n=new Set;return new Set(e),t.reduce((s,r)=>{let a=JSON.stringify(n8(r));return n.has(a)||(n.add(a),s.push({key:a,link:r})),s},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var r8=new Set([100,101,204,205]);function a8(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Qo(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function VA(){let t=N.useContext(Qu);return G1(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function o8(){let t=N.useContext(b0);return G1(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var H1=N.createContext(void 0);H1.displayName="FrameworkContext";function WA(){let t=N.useContext(H1);return G1(t,"You must render this element inside a <HydratedRouter> element"),t}function i8(t,e){let n=N.useContext(H1),[s,r]=N.useState(!1),[a,o]=N.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:m}=e,h=N.useRef(null);N.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let y=g=>{g.forEach(b=>{o(b.isIntersecting)})},x=new IntersectionObserver(y,{threshold:.5});return h.current&&x.observe(h.current),()=>{x.disconnect()}}},[t]),N.useEffect(()=>{if(s){let y=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(y)}}},[s]);let p=()=>{r(!0)},f=()=>{r(!1),o(!1)};return n?t!=="intent"?[a,h,{}]:[a,h,{onFocus:ih(l,p),onBlur:ih(c,f),onMouseEnter:ih(u,p),onMouseLeave:ih(d,f),onTouchStart:ih(m,p)}]:[!1,h,{}]}function ih(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function l8({page:t,...e}){let{router:n}=VA(),s=N.useMemo(()=>$A(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?N.createElement(u8,{page:t,matches:s,...e}):null}function c8(t){let{manifest:e,routeModules:n}=WA(),[s,r]=N.useState([]);return N.useEffect(()=>{let a=!1;return QG(t,e,n).then(o=>{a||r(o)}),()=>{a=!0}},[t,e,n]),s}function u8({page:t,matches:e,...n}){let s=nc(),{manifest:r,routeModules:a}=WA(),{basename:o}=VA(),{loaderData:l,matches:c}=o8(),u=N.useMemo(()=>UA(t,e,c,r,s,"data"),[t,e,c,r,s]),d=N.useMemo(()=>UA(t,e,c,r,s,"assets"),[t,e,c,r,s]),m=N.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let f=new Set,y=!1;if(e.forEach(g=>{let b=r.routes[g.route.id];!b||!b.hasLoader||(!u.some(w=>w.route.id===g.route.id)&&g.route.id in l&&a[g.route.id]?.shouldRevalidate||b.hasClientLoader?y=!0:f.add(g.route.id))}),f.size===0)return[];let x=a8(t,o);return y&&f.size>0&&x.searchParams.set("_routes",e.filter(g=>f.has(g.route.id)).map(g=>g.route.id).join(",")),[x.pathname+x.search]},[o,l,s,r,u,e,t,a]),h=N.useMemo(()=>e8(d,r),[d,r]),p=c8(d);return N.createElement(N.Fragment,null,m.map(f=>N.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...n})),h.map(f=>N.createElement("link",{key:f,rel:"modulepreload",href:f,...n})),p.map(({key:f,link:y})=>N.createElement("link",{key:f,...y})))}function d8(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var jA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{jA&&(window.__reactRouterVersion="7.6.0")}catch{}var GA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HA=N.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:r,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:m,...h},p){let{basename:f}=N.useContext(no),y=typeof u=="string"&&GA.test(u),x,g=!1;if(typeof u=="string"&&y&&(x=u,jA))try{let A=new URL(window.location.href),$=u.startsWith("//")?new URL(A.protocol+u):new URL(u),T=Qo($.pathname,f);$.origin===A.origin&&T!=null?u=T+$.search+$.hash:g=!0}catch{Aa(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=CG(u,{relative:r}),[w,v,E]=i8(s,h),k=f8(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:r,viewTransition:m});function C(A){e&&e(A),A.defaultPrevented||k(A)}let I=N.createElement("a",{...h,...E,href:x||b,onClick:g||a?e:C,ref:d8(p,v),target:c,"data-discover":!y&&n==="render"?"true":void 0});return w&&!y?N.createElement(N.Fragment,null,I,N.createElement(l8,{page:b})):I});HA.displayName="Link";var m8=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:r=!1,style:a,to:o,viewTransition:l,children:c,...u},d){let m=oh(o,{relative:u.relative}),h=nc(),p=N.useContext(b0),{navigator:f,basename:y}=N.useContext(no),x=p!=null&&w8(m)&&l===!0,g=f.encodeLocation?f.encodeLocation(m).pathname:m.pathname,b=h.pathname,w=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;n||(b=b.toLowerCase(),w=w?w.toLowerCase():null,g=g.toLowerCase()),w&&y&&(w=Qo(w,y)||w);const v=g!=="/"&&g.endsWith("/")?g.length-1:g.length;let E=b===g||!r&&b.startsWith(g)&&b.charAt(v)==="/",k=w!=null&&(w===g||!r&&w.startsWith(g)&&w.charAt(g.length)==="/"),C={isActive:E,isPending:k,isTransitioning:x},I=E?e:void 0,A;typeof s=="function"?A=s(C):A=[s,E?"active":null,k?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let $=typeof a=="function"?a(C):a;return N.createElement(HA,{...u,"aria-current":I,className:A,ref:d,style:$,to:o,viewTransition:l},typeof c=="function"?c(C):c)});m8.displayName="NavLink";var h8=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:r,state:a,method:o=v0,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:m,...h},p)=>{let f=y8(),y=b8(l,{relative:u}),x=o.toLowerCase()==="get"?"get":"post",g=typeof l=="string"&&GA.test(l),b=w=>{if(c&&c(w),w.defaultPrevented)return;w.preventDefault();let v=w.nativeEvent.submitter,E=v?.getAttribute("formmethod")||o;f(v||w.currentTarget,{fetcherKey:e,method:E,navigate:n,replace:r,state:a,relative:u,preventScrollReset:d,viewTransition:m})};return N.createElement("form",{ref:p,method:x,action:y,onSubmit:s?c:b,...h,"data-discover":!g&&t==="render"?"true":void 0})});h8.displayName="Form";function p8(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qA(t){let e=N.useContext(Qu);return as(e,p8(t)),e}function f8(t,{target:e,replace:n,state:s,preventScrollReset:r,relative:a,viewTransition:o}={}){let l=LA(),c=nc(),u=oh(t,{relative:a});return N.useCallback(d=>{if(qG(d,e)){d.preventDefault();let m=n!==void 0?n:x0(c)===x0(u);l(t,{replace:m,state:s,preventScrollReset:r,relative:a,viewTransition:o})}},[c,l,u,n,s,e,t,r,a,o])}var g8=0,x8=()=>`__${String(++g8)}__`;function y8(){let{router:t}=qA("useSubmit"),{basename:e}=N.useContext(no),n=OG();return N.useCallback(async(s,r={})=>{let{action:a,method:o,encType:l,formData:c,body:u}=YG(s,e);if(r.navigate===!1){let d=r.fetcherKey||x8();await t.fetch(d,n,r.action||a,{preventScrollReset:r.preventScrollReset,formData:c,body:u,formMethod:r.method||o,formEncType:r.encType||l,flushSync:r.flushSync})}else await t.navigate(r.action||a,{preventScrollReset:r.preventScrollReset,formData:c,body:u,formMethod:r.method||o,formEncType:r.encType||l,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,e,n])}function b8(t,{relative:e}={}){let{basename:n}=N.useContext(no),s=N.useContext(ti);as(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),a={...oh(t||".",{relative:e})},o=nc();if(t==null){a.search=o.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(m=>m).forEach(m=>l.append("index",m));let d=l.toString();a.search=d?`?${d}`:""}}return(!t||t===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:ei([n,a.pathname])),x0(a)}function w8(t,e={}){let n=N.useContext(FA);as(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=qA("useViewTransitionState"),r=oh(t,{relative:e.relative});if(!n.isTransitioning)return!1;let a=Qo(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=Qo(n.nextLocation.pathname,s)||n.nextLocation.pathname;return y0(r.pathname,o)!=null||y0(r.pathname,a)!=null}[...r8];const v8=()=>{const t=LA(),e=(n,s)=>{const r=s?`?gigId=${s}`:"";t(`/agent-details/${n}${r}`)};return i.createElement(SA,{onAgentSelect:e})};function KA(t,e){return function(){return t.apply(e,arguments)}}const{toString:E8}=Object.prototype,{getPrototypeOf:q1}=Object,{iterator:S0,toStringTag:XA}=Symbol,C0=(t=>e=>{const n=E8.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Ra=t=>(t=t.toLowerCase(),e=>C0(e)===t),I0=t=>e=>typeof e===t,{isArray:ed}=Array,lh=I0("undefined");function N8(t){return t!==null&&!lh(t)&&t.constructor!==null&&!lh(t.constructor)&&or(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const YA=Ra("ArrayBuffer");function k8(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&YA(t.buffer),e}const S8=I0("string"),or=I0("function"),ZA=I0("number"),$0=t=>t!==null&&typeof t=="object",C8=t=>t===!0||t===!1,T0=t=>{if(C0(t)!=="object")return!1;const e=q1(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(XA in t)&&!(S0 in t)},I8=Ra("Date"),$8=Ra("File"),T8=Ra("Blob"),A8=Ra("FileList"),R8=t=>$0(t)&&or(t.pipe),_8=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||or(t.append)&&((e=C0(t))==="formdata"||e==="object"&&or(t.toString)&&t.toString()==="[object FormData]"))},D8=Ra("URLSearchParams"),[P8,F8,M8,O8]=["ReadableStream","Request","Response","Headers"].map(Ra),L8=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ch(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),ed(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{const a=n?Object.getOwnPropertyNames(t):Object.keys(t),o=a.length;let l;for(s=0;s<o;s++)l=a[s],e.call(null,t[l],l,t)}}function JA(t,e){e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const sc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,QA=t=>!lh(t)&&t!==sc;function K1(){const{caseless:t}=QA(this)&&this||{},e={},n=(s,r)=>{const a=t&&JA(e,r)||r;T0(e[a])&&T0(s)?e[a]=K1(e[a],s):T0(s)?e[a]=K1({},s):ed(s)?e[a]=s.slice():e[a]=s};for(let s=0,r=arguments.length;s<r;s++)arguments[s]&&ch(arguments[s],n);return e}const z8=(t,e,n,{allOwnKeys:s}={})=>(ch(e,(r,a)=>{n&&or(r)?t[a]=KA(r,n):t[a]=r},{allOwnKeys:s}),t),B8=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),U8=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},V8=(t,e,n,s)=>{let r,a,o;const l={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),a=r.length;a-- >0;)o=r[a],(!s||s(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=n!==!1&&q1(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},W8=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},j8=t=>{if(!t)return null;if(ed(t))return t;let e=t.length;if(!ZA(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},G8=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&q1(Uint8Array)),H8=(t,e)=>{const s=(t&&t[S0]).call(t);let r;for(;(r=s.next())&&!r.done;){const a=r.value;e.call(t,a[0],a[1])}},q8=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},K8=Ra("HTMLFormElement"),X8=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),eR=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Y8=Ra("RegExp"),tR=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};ch(n,(r,a)=>{let o;(o=e(r,a,t))!==!1&&(s[a]=o||r)}),Object.defineProperties(t,s)},Z8=t=>{tR(t,(e,n)=>{if(or(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(or(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},J8=(t,e)=>{const n={},s=r=>{r.forEach(a=>{n[a]=!0})};return ed(t)?s(t):s(String(t).split(e)),n},Q8=()=>{},e7=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function t7(t){return!!(t&&or(t.append)&&t[XA]==="FormData"&&t[S0])}const n7=t=>{const e=new Array(10),n=(s,r)=>{if($0(s)){if(e.indexOf(s)>=0)return;if(!("toJSON"in s)){e[r]=s;const a=ed(s)?[]:{};return ch(s,(o,l)=>{const c=n(o,r+1);!lh(c)&&(a[l]=c)}),e[r]=void 0,a}}return s};return n(t,0)},s7=Ra("AsyncFunction"),r7=t=>t&&($0(t)||or(t))&&or(t.then)&&or(t.catch),nR=((t,e)=>t?setImmediate:e?((n,s)=>(sc.addEventListener("message",({source:r,data:a})=>{r===sc&&a===n&&s.length&&s.shift()()},!1),r=>{s.push(r),sc.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",or(sc.postMessage)),a7=typeof queueMicrotask<"u"?queueMicrotask.bind(sc):typeof process<"u"&&process.nextTick||nR,pe={isArray:ed,isArrayBuffer:YA,isBuffer:N8,isFormData:_8,isArrayBufferView:k8,isString:S8,isNumber:ZA,isBoolean:C8,isObject:$0,isPlainObject:T0,isReadableStream:P8,isRequest:F8,isResponse:M8,isHeaders:O8,isUndefined:lh,isDate:I8,isFile:$8,isBlob:T8,isRegExp:Y8,isFunction:or,isStream:R8,isURLSearchParams:D8,isTypedArray:G8,isFileList:A8,forEach:ch,merge:K1,extend:z8,trim:L8,stripBOM:B8,inherits:U8,toFlatObject:V8,kindOf:C0,kindOfTest:Ra,endsWith:W8,toArray:j8,forEachEntry:H8,matchAll:q8,isHTMLForm:K8,hasOwnProperty:eR,hasOwnProp:eR,reduceDescriptors:tR,freezeMethods:Z8,toObjectSet:J8,toCamelCase:X8,noop:Q8,toFiniteNumber:e7,findKey:JA,global:sc,isContextDefined:QA,isSpecCompliantForm:t7,toJSONObject:n7,isAsyncFn:s7,isThenable:r7,setImmediate:nR,asap:a7,isIterable:t=>t!=null&&or(t[S0])};function yt(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}pe.inherits(yt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:pe.toJSONObject(this.config),code:this.code,status:this.status}}});const sR=yt.prototype,rR={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{rR[t]={value:t}}),Object.defineProperties(yt,rR),Object.defineProperty(sR,"isAxiosError",{value:!0}),yt.from=(t,e,n,s,r,a)=>{const o=Object.create(sR);return pe.toFlatObject(t,o,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),yt.call(o,t.message,e,n,s,r),o.cause=t,o.name=t.name,a&&Object.assign(o,a),o};const o7=null;function X1(t){return pe.isPlainObject(t)||pe.isArray(t)}function aR(t){return pe.endsWith(t,"[]")?t.slice(0,-2):t}function oR(t,e,n){return t?t.concat(e).map(function(r,a){return r=aR(r),!n&&a?"["+r+"]":r}).join(n?".":""):e}function i7(t){return pe.isArray(t)&&!t.some(X1)}const l7=pe.toFlatObject(pe,{},null,function(e){return/^is[A-Z]/.test(e)});function A0(t,e,n){if(!pe.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=pe.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,x){return!pe.isUndefined(x[y])});const s=n.metaTokens,r=n.visitor||d,a=n.dots,o=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&pe.isSpecCompliantForm(e);if(!pe.isFunction(r))throw new TypeError("visitor must be a function");function u(f){if(f===null)return"";if(pe.isDate(f))return f.toISOString();if(!c&&pe.isBlob(f))throw new yt("Blob is not supported. Use a Buffer instead.");return pe.isArrayBuffer(f)||pe.isTypedArray(f)?c&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function d(f,y,x){let g=f;if(f&&!x&&typeof f=="object"){if(pe.endsWith(y,"{}"))y=s?y:y.slice(0,-2),f=JSON.stringify(f);else if(pe.isArray(f)&&i7(f)||(pe.isFileList(f)||pe.endsWith(y,"[]"))&&(g=pe.toArray(f)))return y=aR(y),g.forEach(function(w,v){!(pe.isUndefined(w)||w===null)&&e.append(o===!0?oR([y],v,a):o===null?y:y+"[]",u(w))}),!1}return X1(f)?!0:(e.append(oR(x,y,a),u(f)),!1)}const m=[],h=Object.assign(l7,{defaultVisitor:d,convertValue:u,isVisitable:X1});function p(f,y){if(!pe.isUndefined(f)){if(m.indexOf(f)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(f),pe.forEach(f,function(g,b){(!(pe.isUndefined(g)||g===null)&&r.call(e,g,pe.isString(b)?b.trim():b,y,h))===!0&&p(g,y?y.concat(b):[b])}),m.pop()}}if(!pe.isObject(t))throw new TypeError("data must be an object");return p(t),e}function iR(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function Y1(t,e){this._pairs=[],t&&A0(t,this,e)}const lR=Y1.prototype;lR.append=function(e,n){this._pairs.push([e,n])},lR.toString=function(e){const n=e?function(s){return e.call(this,s,iR)}:iR;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function c7(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function cR(t,e,n){if(!e)return t;const s=n&&n.encode||c7;pe.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let a;if(r?a=r(e,n):a=pe.isURLSearchParams(e)?e.toString():new Y1(e,n).toString(s),a){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class uR{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){pe.forEach(this.handlers,function(s){s!==null&&e(s)})}}const dR={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},u7={isBrowser:!0,classes:{URLSearchParams:typeof URLSearchParams<"u"?URLSearchParams:Y1,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]},Z1=typeof window<"u"&&typeof document<"u",J1=typeof navigator=="object"&&navigator||void 0,d7=Z1&&(!J1||["ReactNative","NativeScript","NS"].indexOf(J1.product)<0),m7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",h7=Z1&&window.location.href||"http://localhost",Ts={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Z1,hasStandardBrowserEnv:d7,hasStandardBrowserWebWorkerEnv:m7,navigator:J1,origin:h7},Symbol.toStringTag,{value:"Module"})),...u7};function p7(t,e){return A0(t,new Ts.classes.URLSearchParams,Object.assign({visitor:function(n,s,r,a){return Ts.isNode&&pe.isBuffer(n)?(this.append(s,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function f7(t){return pe.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function g7(t){const e={},n=Object.keys(t);let s;const r=n.length;let a;for(s=0;s<r;s++)a=n[s],e[a]=t[a];return e}function mR(t){function e(n,s,r,a){let o=n[a++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=a>=n.length;return o=!o&&pe.isArray(r)?r.length:o,c?(pe.hasOwnProp(r,o)?r[o]=[r[o],s]:r[o]=s,!l):((!r[o]||!pe.isObject(r[o]))&&(r[o]=[]),e(n,s,r[o],a)&&pe.isArray(r[o])&&(r[o]=g7(r[o])),!l)}if(pe.isFormData(t)&&pe.isFunction(t.entries)){const n={};return pe.forEachEntry(t,(s,r)=>{e(f7(s),r,n,0)}),n}return null}function x7(t,e,n){if(pe.isString(t))try{return(e||JSON.parse)(t),pe.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(0,JSON.stringify)(t)}const uh={transitional:dR,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,a=pe.isObject(e);if(a&&pe.isHTMLForm(e)&&(e=new FormData(e)),pe.isFormData(e))return r?JSON.stringify(mR(e)):e;if(pe.isArrayBuffer(e)||pe.isBuffer(e)||pe.isStream(e)||pe.isFile(e)||pe.isBlob(e)||pe.isReadableStream(e))return e;if(pe.isArrayBufferView(e))return e.buffer;if(pe.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return p7(e,this.formSerializer).toString();if((l=pe.isFileList(e))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return A0(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return a||r?(n.setContentType("application/json",!1),x7(e)):e}],transformResponse:[function(e){const n=this.transitional||uh.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(pe.isResponse(e)||pe.isReadableStream(e))return e;if(e&&pe.isString(e)&&(s&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?yt.from(l,yt.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ts.classes.FormData,Blob:Ts.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};pe.forEach(["delete","get","head","post","put","patch"],t=>{uh.headers[t]={}});const y7=pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),b7=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),s=o.substring(r+1).trim(),!(!n||e[n]&&y7[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},hR=Symbol("internals");function dh(t){return t&&String(t).trim().toLowerCase()}function R0(t){return t===!1||t==null?t:pe.isArray(t)?t.map(R0):String(t)}function w7(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const v7=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Q1(t,e,n,s,r){if(pe.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!pe.isString(e)){if(pe.isString(s))return e.indexOf(s)!==-1;if(pe.isRegExp(s))return s.test(e)}}function E7(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function N7(t,e){const n=pe.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,a,o){return this[s].call(this,e,r,a,o)},configurable:!0})})}class ir{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function a(l,c,u){const d=dh(c);if(!d)throw new Error("header name must be a non-empty string");const m=pe.findKey(r,d);(!m||r[m]===void 0||u===!0||u===void 0&&r[m]!==!1)&&(r[m||c]=R0(l))}const o=(l,c)=>pe.forEach(l,(u,d)=>a(u,d,c));if(pe.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(pe.isString(e)&&(e=e.trim())&&!v7(e))o(b7(e),n);else if(pe.isObject(e)&&pe.isIterable(e)){let l={},c,u;for(const d of e){if(!pe.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?pe.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,n)}else e!=null&&a(n,e,s);return this}get(e,n){if(e=dh(e),e){const s=pe.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return w7(r);if(pe.isFunction(n))return n.call(this,r,s);if(pe.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=dh(e),e){const s=pe.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||Q1(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function a(o){if(o=dh(o),o){const l=pe.findKey(s,o);l&&(!n||Q1(s,s[l],l,n))&&(delete s[l],r=!0)}}return pe.isArray(e)?e.forEach(a):a(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const a=n[s];(!e||Q1(this,this[a],a,e,!0))&&(delete this[a],r=!0)}return r}normalize(e){const n=this,s={};return pe.forEach(this,(r,a)=>{const o=pe.findKey(s,a);if(o){n[o]=R0(r),delete n[a];return}const l=e?E7(a):String(a).trim();l!==a&&delete n[a],n[l]=R0(r),s[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return pe.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&pe.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[hR]=this[hR]={accessors:{}}).accessors,r=this.prototype;function a(o){const l=dh(o);s[l]||(N7(r,o),s[l]=!0)}return pe.isArray(e)?e.forEach(a):a(e),this}}ir.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),pe.reduceDescriptors(ir.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}}),pe.freezeMethods(ir);function eE(t,e){const n=this||uh,s=e||n,r=ir.from(s.headers);let a=s.data;return pe.forEach(t,function(l){a=l.call(n,a,r.normalize(),e?e.status:void 0)}),r.normalize(),a}function pR(t){return!!(t&&t.__CANCEL__)}function td(t,e,n){yt.call(this,t??"canceled",yt.ERR_CANCELED,e,n),this.name="CanceledError"}pe.inherits(td,yt,{__CANCEL__:!0});function fR(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new yt("Request failed with status code "+n.status,[yt.ERR_BAD_REQUEST,yt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function k7(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function S7(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,a=0,o;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),d=s[a];o||(o=u),n[r]=c,s[r]=u;let m=a,h=0;for(;m!==r;)h+=n[m++],m=m%t;if(r=(r+1)%t,r===a&&(a=(a+1)%t),u-o<e)return;const p=d&&u-d;return p?Math.round(h*1e3/p):void 0}}function C7(t,e){let n=0,s=1e3/e,r,a;const o=(u,d=Date.now())=>{n=d,r=null,a&&(clearTimeout(a),a=null),t.apply(null,u)};return[(...u)=>{const d=Date.now(),m=d-n;m>=s?o(u,d):(r=u,a||(a=setTimeout(()=>{a=null,o(r)},s-m)))},()=>r&&o(r)]}const _0=(t,e,n=3)=>{let s=0;const r=S7(50,250);return C7(a=>{const o=a.loaded,l=a.lengthComputable?a.total:void 0,c=o-s,u=r(c),d=o<=l;s=o;const m={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(m)},n)},gR=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},xR=t=>(...e)=>pe.asap(()=>t(...e)),I7=Ts.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Ts.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Ts.origin),Ts.navigator&&/(msie|trident)/i.test(Ts.navigator.userAgent)):()=>!0,$7=Ts.hasStandardBrowserEnv?{write(t,e,n,s,r,a){const o=[t+"="+encodeURIComponent(e)];pe.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),pe.isString(s)&&o.push("path="+s),pe.isString(r)&&o.push("domain="+r),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function T7(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function A7(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function yR(t,e,n){let s=!T7(e);return t&&(s||n==!1)?A7(t,e):e}const bR=t=>t instanceof ir?{...t}:t;function rc(t,e){e=e||{};const n={};function s(u,d,m,h){return pe.isPlainObject(u)&&pe.isPlainObject(d)?pe.merge.call({caseless:h},u,d):pe.isPlainObject(d)?pe.merge({},d):pe.isArray(d)?d.slice():d}function r(u,d,m,h){if(pe.isUndefined(d)){if(!pe.isUndefined(u))return s(void 0,u,m,h)}else return s(u,d,m,h)}function a(u,d){if(!pe.isUndefined(d))return s(void 0,d)}function o(u,d){if(pe.isUndefined(d)){if(!pe.isUndefined(u))return s(void 0,u)}else return s(void 0,d)}function l(u,d,m){if(m in e)return s(u,d);if(m in t)return s(void 0,u)}const c={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,m)=>r(bR(u),bR(d),m,!0)};return pe.forEach(Object.keys(Object.assign({},t,e)),function(d){const m=c[d]||r,h=m(t[d],e[d],d);pe.isUndefined(h)&&m!==l||(n[d]=h)}),n}const wR=t=>{const e=rc({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:a,headers:o,auth:l}=e;e.headers=o=ir.from(o),e.url=cR(yR(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(pe.isFormData(n)){if(Ts.hasStandardBrowserEnv||Ts.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((c=o.getContentType())!==!1){const[u,...d]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Ts.hasStandardBrowserEnv&&(s&&pe.isFunction(s)&&(s=s(e)),s||s!==!1&&I7(e.url))){const u=r&&a&&$7.read(a);u&&o.set(r,u)}return e},R7=typeof XMLHttpRequest<"u"&&function(t){return new Promise(function(n,s){const r=wR(t);let a=r.data;const o=ir.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=r,d,m,h,p,f;function y(){p&&p(),f&&f(),r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let x=new XMLHttpRequest;x.open(r.method.toUpperCase(),r.url,!0),x.timeout=r.timeout;function g(){if(!x)return;const w=ir.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),E={data:!l||l==="text"||l==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:w,config:t,request:x};fR(function(C){n(C),y()},function(C){s(C),y()},E),x=null}"onloadend"in x?x.onloadend=g:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(g)},x.onabort=function(){x&&(s(new yt("Request aborted",yt.ECONNABORTED,t,x)),x=null)},x.onerror=function(){s(new yt("Network Error",yt.ERR_NETWORK,t,x)),x=null},x.ontimeout=function(){let v=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const E=r.transitional||dR;r.timeoutErrorMessage&&(v=r.timeoutErrorMessage),s(new yt(v,E.clarifyTimeoutError?yt.ETIMEDOUT:yt.ECONNABORTED,t,x)),x=null},a===void 0&&o.setContentType(null),"setRequestHeader"in x&&pe.forEach(o.toJSON(),function(v,E){x.setRequestHeader(E,v)}),pe.isUndefined(r.withCredentials)||(x.withCredentials=!!r.withCredentials),l&&l!=="json"&&(x.responseType=r.responseType),u&&([h,f]=_0(u,!0),x.addEventListener("progress",h)),c&&x.upload&&([m,p]=_0(c),x.upload.addEventListener("progress",m),x.upload.addEventListener("loadend",p)),(r.cancelToken||r.signal)&&(d=w=>{x&&(s(!w||w.type?new td(null,t,x):w),x.abort(),x=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const b=k7(r.url);if(b&&Ts.protocols.indexOf(b)===-1){s(new yt("Unsupported protocol "+b+":",yt.ERR_BAD_REQUEST,t));return}x.send(a||null)})},_7=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const a=function(u){if(!r){r=!0,l();const d=u instanceof Error?u:this.reason;s.abort(d instanceof yt?d:new td(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,a(new yt(`timeout ${e} of ms exceeded`,yt.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),t=null)};t.forEach(u=>u.addEventListener("abort",a));const{signal:c}=s;return c.unsubscribe=()=>pe.asap(l),c}},D7=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},P7=async function*(t,e){for await(const n of F7(t))yield*D7(n,e)},F7=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},vR=(t,e,n,s)=>{const r=P7(t,e);let a=0,o,l=c=>{o||(o=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await r.next();if(u){l(),c.close();return}let m=d.byteLength;if(n){let h=a+=m;n(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},D0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",ER=D0&&typeof ReadableStream=="function",M7=D0&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),NR=(t,...e)=>{try{return!!t(...e)}catch{return!1}},O7=ER&&NR(()=>{let t=!1;const e=new Request(Ts.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),kR=64*1024,tE=ER&&NR(()=>pe.isReadableStream(new Response("").body)),P0={stream:tE&&(t=>t.body)};D0&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!P0[e]&&(P0[e]=pe.isFunction(t[e])?n=>n[e]():(n,s)=>{throw new yt(`Response type '${e}' is not supported`,yt.ERR_NOT_SUPPORT,s)})})})(new Response);const L7=async t=>{if(t==null)return 0;if(pe.isBlob(t))return t.size;if(pe.isSpecCompliantForm(t))return(await new Request(Ts.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(pe.isArrayBufferView(t)||pe.isArrayBuffer(t))return t.byteLength;if(pe.isURLSearchParams(t)&&(t=t+""),pe.isString(t))return(await M7(t)).byteLength},z7=async(t,e)=>{const n=pe.toFiniteNumber(t.getContentLength());return n??L7(e)},nE={http:o7,xhr:R7,fetch:D0&&(async t=>{let{url:e,method:n,data:s,signal:r,cancelToken:a,timeout:o,onDownloadProgress:l,onUploadProgress:c,responseType:u,headers:d,withCredentials:m="same-origin",fetchOptions:h}=wR(t);u=u?(u+"").toLowerCase():"text";let p=_7([r,a&&a.toAbortSignal()],o),f;const y=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let x;try{if(c&&O7&&n!=="get"&&n!=="head"&&(x=await z7(d,s))!==0){let E=new Request(e,{method:"POST",body:s,duplex:"half"}),k;if(pe.isFormData(s)&&(k=E.headers.get("content-type"))&&d.setContentType(k),E.body){const[C,I]=gR(x,_0(xR(c)));s=vR(E.body,kR,C,I)}}pe.isString(m)||(m=m?"include":"omit");const g="credentials"in Request.prototype;f=new Request(e,{...h,signal:p,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:s,duplex:"half",credentials:g?m:void 0});let b=await fetch(f);const w=tE&&(u==="stream"||u==="response");if(tE&&(l||w&&y)){const E={};["status","statusText","headers"].forEach(A=>{E[A]=b[A]});const k=pe.toFiniteNumber(b.headers.get("content-length")),[C,I]=l&&gR(k,_0(xR(l),!0))||[];b=new Response(vR(b.body,kR,C,()=>{I&&I(),y&&y()}),E)}u=u||"text";let v=await P0[pe.findKey(P0,u)||"text"](b,t);return!w&&y&&y(),await new Promise((E,k)=>{fR(E,k,{data:v,headers:ir.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:f})})}catch(g){throw y&&y(),g&&g.name==="TypeError"&&/Load failed|fetch/i.test(g.message)?Object.assign(new yt("Network Error",yt.ERR_NETWORK,t,f),{cause:g.cause||g}):yt.from(g,g&&g.code,t,f)}})};pe.forEach(nE,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const SR=t=>`- ${t}`,B7=t=>pe.isFunction(t)||t===null||t===!1,CR={getAdapter:t=>{t=pe.isArray(t)?t:[t];const{length:e}=t;let n,s;const r={};for(let a=0;a<e;a++){n=t[a];let o;if(s=n,!B7(n)&&(s=nE[(o=String(n)).toLowerCase()],s===void 0))throw new yt(`Unknown adapter '${o}'`);if(s)break;r[o||"#"+a]=s}if(!s){const a=Object.entries(r).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=e?a.length>1?`since :
`+a.map(SR).join(`
`):" "+SR(a[0]):"as no adapter specified";throw new yt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:nE};function sE(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new td(null,t)}function IR(t){return sE(t),t.headers=ir.from(t.headers),t.data=eE.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),CR.getAdapter(t.adapter||uh.adapter)(t).then(function(s){return sE(t),s.data=eE.call(t,t.transformResponse,s),s.headers=ir.from(s.headers),s},function(s){return pR(s)||(sE(t),s&&s.response&&(s.response.data=eE.call(t,t.transformResponse,s.response),s.response.headers=ir.from(s.response.headers))),Promise.reject(s)})}const $R="1.9.0",F0={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{F0[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const TR={};F0.transitional=function(e,n,s){function r(a,o){return"[Axios v"+$R+"] Transitional option '"+a+"'"+o+(s?". "+s:"")}return(a,o,l)=>{if(e===!1)throw new yt(r(o," has been removed"+(n?" in "+n:"")),yt.ERR_DEPRECATED);return n&&!TR[o]&&(TR[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,o,l):!0}},F0.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function U7(t,e,n){if(typeof t!="object")throw new yt("options must be an object",yt.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const a=s[r],o=e[a];if(o){const l=t[a],c=l===void 0||o(l,a,t);if(c!==!0)throw new yt("option "+a+" must be "+c,yt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new yt("Unknown option "+a,yt.ERR_BAD_OPTION)}}const M0={assertOptions:U7,validators:F0},so=M0.validators;class ac{constructor(e){this.defaults=e||{},this.interceptors={request:new uR,response:new uR}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const a=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?a&&!String(s.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+a):s.stack=a}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=rc(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:a}=n;s!==void 0&&M0.assertOptions(s,{silentJSONParsing:so.transitional(so.boolean),forcedJSONParsing:so.transitional(so.boolean),clarifyTimeoutError:so.transitional(so.boolean)},!1),r!=null&&(pe.isFunction(r)?n.paramsSerializer={serialize:r}:M0.assertOptions(r,{encode:so.function,serialize:so.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),M0.assertOptions(n,{baseUrl:so.spelling("baseURL"),withXsrfToken:so.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=a&&pe.merge(a.common,a[n.method]);a&&pe.forEach(["delete","get","head","post","put","patch","common"],f=>{delete a[f]}),n.headers=ir.concat(o,a);const l=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,l.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let d,m=0,h;if(!c){const f=[IR.bind(this),void 0];for(f.unshift.apply(f,l),f.push.apply(f,u),h=f.length,d=Promise.resolve(n);m<h;)d=d.then(f[m++],f[m++]);return d}h=l.length;let p=n;for(m=0;m<h;){const f=l[m++],y=l[m++];try{p=f(p)}catch(x){y.call(this,x);break}}try{d=IR.call(this,p)}catch(f){return Promise.reject(f)}for(m=0,h=u.length;m<h;)d=d.then(u[m++],u[m++]);return d}getUri(e){e=rc(this.defaults,e);const n=yR(e.baseURL,e.url,e.allowAbsoluteUrls);return cR(n,e.params,e.paramsSerializer)}}pe.forEach(["delete","get","head","options"],function(e){ac.prototype[e]=function(n,s){return this.request(rc(s||{},{method:e,url:n,data:(s||{}).data}))}}),pe.forEach(["post","put","patch"],function(e){function n(s){return function(a,o,l){return this.request(rc(l||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}ac.prototype[e]=n(),ac.prototype[e+"Form"]=n(!0)});class rE{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(r=>{if(!s._listeners)return;let a=s._listeners.length;for(;a-- >0;)s._listeners[a](r);s._listeners=null}),this.promise.then=r=>{let a;const o=new Promise(l=>{s.subscribe(l),a=l}).then(r);return o.cancel=function(){s.unsubscribe(a)},o},e(function(a,o,l){s.reason||(s.reason=new td(a,o,l),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new rE(function(r){e=r}),cancel:e}}}function V7(t){return function(n){return t.apply(null,n)}}function W7(t){return pe.isObject(t)&&t.isAxiosError===!0}const aE={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(aE).forEach(([t,e])=>{aE[e]=t});function AR(t){const e=new ac(t),n=KA(ac.prototype.request,e);return pe.extend(n,ac.prototype,e,{allOwnKeys:!0}),pe.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return AR(rc(t,r))},n}const Ie=AR(uh);Ie.Axios=ac,Ie.CanceledError=td,Ie.CancelToken=rE,Ie.isCancel=pR,Ie.VERSION=$R,Ie.toFormData=A0,Ie.AxiosError=yt,Ie.Cancel=Ie.CanceledError,Ie.all=function(e){return Promise.all(e)},Ie.spread=V7,Ie.isAxiosError=W7,Ie.mergeConfig=rc,Ie.AxiosHeaders=ir,Ie.formToJSON=t=>mR(pe.isHTMLForm(t)?new FormData(t):t),Ie.getAdapter=CR.getAdapter,Ie.HttpStatusCode=aE,Ie.default=Ie;const RR=()=>{const[t,e]=N.useState(null),[n,s]=N.useState([]),[r,a]=N.useState("all"),[o,l]=N.useState([]),[c,u]=N.useState(null),[d,m]=N.useState(!0),[h,p]=N.useState(null),[f,y]=N.useState("main"),[x,g]=N.useState(null),[b,w]=N.useState({}),[v,E]=N.useState({}),[k,C]=N.useState(["Monday","Tuesday"]),[I,A]=N.useState({start:"09:00",end:"17:00"}),[$,T]=N.useState([]),[F,O]=N.useState(!1),[M,B]=N.useState(null),[L,Y]=N.useState([]),[D,_]=N.useState([]),[P,z]=N.useState([]);N.useEffect(()=>{W(),q(),K(),ae(),ne()},[]);const q=async()=>{try{const S=$e.get("companyId");if(!S){console.error(" Company ID not found for company details");return}const V=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/companies/${S}/details`);console.log(" Company details fetched:",V.data.data),u(V.data.data)}catch(S){console.error(" Error fetching company details:",S)}},K=async()=>{try{const S=await Ie.get("undefined/activities");S.data&&S.data.success&&Array.isArray(S.data.data)?(console.log(" Activities fetched:",S.data.data),Y(S.data.data)):(console.warn(" Invalid activities response format"),Y([]))}catch(S){console.error(" Error fetching activities:",S),Y([])}},ae=async()=>{try{const S=await Ie.get("undefined/industries");S.data&&S.data.success&&Array.isArray(S.data.data)?(console.log(" Industries fetched:",S.data.data),_(S.data.data)):(console.warn(" Invalid industries response format"),_([]))}catch(S){console.error(" Error fetching industries:",S),_([])}},ne=async()=>{try{const S=await Ie.get("undefined/languages");S.data&&S.data.success&&Array.isArray(S.data.data)?(console.log(" Languages fetched:",S.data.data),z(S.data.data)):(console.warn(" Invalid languages response format"),z([]))}catch(S){console.error(" Error fetching languages:",S),z([])}},Z=S=>{if(!L||!Array.isArray(L))return S;const V=L.find(J=>J._id===S);return V?V.name:S},ke=S=>{if(!D||!Array.isArray(D))return S;const V=D.find(J=>J._id===S);return V?V.name:S},Ae=S=>{if(!P||!Array.isArray(P))return S;const V=P.find(J=>J._id===S);return V?V.name:S},W=async()=>{console.log(" Starting fetchGigs..."),m(!0),p(null);try{const S=$e.get("companyId"),V=$e.get("gigId"),J=$e.get("userId");if(console.log(" Cookies found:",{companyId:S,gigId:V,userId:J}),!S)throw console.error(" Company ID not found in cookies"),new Error("Company ID not found");const be=`undefined/gigs/company/${S}`;console.log(" Fetching from API:",be);const ve=await fetch(be,{headers:{Authorization:`Bearer ${V}:${J}`,"Content-Type":"application/json"}});if(console.log(" API Response status:",ve.status),console.log(" API Response headers:",Object.fromEntries(ve.headers.entries())),!ve.ok)throw console.error(" API request failed:",ve.status,ve.statusText),new Error("Failed to fetch gigs");const se=await ve.json();if(console.log(" Raw API data:",se),se.data){console.log(" Found gigs data, transforming...");const De=se.data.map(Ke=>{const He={_id:Ke._id,title:Ke.title,description:Ke.description,status:Ke.status||"pending",category:Ke.category,budget:Ke.commission?.baseAmount&&Ke.commission.baseAmount!=="0"?`$${Ke.commission.baseAmount}`:null,companyId:Ke.companyId,companyName:Ke.companyName||Ke.company?.name||c?.name||"Company",createdAt:Ke.createdAt,updatedAt:Ke.updatedAt,submittedBy:Ke.submittedBy||Ke.companyName||Ke.company?.name||c?.name||"Company",issues:Ke.issues||[]};return console.log(" Transformed gig:",He),He});console.log(" Setting gigs state with",De.length,"gigs"),l(De)}else console.warn(" No data property in API response"),l([])}catch(S){console.error(" Error fetching gigs:",S),p(S instanceof Error?S.message:"Failed to fetch gigs")}finally{console.log(" fetchGigs completed, setting loading to false"),m(!1)}},le=S=>{console.log(" Toggling gig expansion:",S,"Current expanded:",t),e(t===S?null:S)},we=S=>{console.log(" Toggling gig selection:",S,"Currently selected:",n),n.includes(S)?s(n.filter(V=>V!==S)):s([...n,S])},de=()=>{console.log(" Selecting all gigs. Current selected:",n.length,"Total filtered:",Ee.length),n.length===Ee.length?s([]):s(Ee.map(S=>S._id))},Ee=o.filter(S=>{if(r==="all")return!0;const J={pending:["pending","to_activate","draft","submitted"],approved:["approved","active","published"],rejected:["rejected","declined","cancelled","inactive"],archived:["archived"]}[r]||[r],be=J.includes(S.status);return console.log(` Filtering gig ${S._id} (${S.title}): status="${S.status}", filter="${r}", validStatuses=${JSON.stringify(J)}, isMatch=${be}`),be});console.log(" Filtered gigs:",{filter:r,totalGigs:o.length,filteredCount:Ee.length,gigs:Ee.map(S=>({id:S._id,title:S.title,status:S.status}))});const Re=S=>{if(console.log(" Formatting date:",S),!S)return console.log(" No date string provided"),"Invalid date";try{const V=new Date(S);if(isNaN(V.getTime()))return console.log(" Invalid date format"),"Invalid date";const be=Math.floor((new Date().getTime()-V.getTime())/(1e3*60*60));let ve;if(be<1)ve="Just now";else if(be<24)ve=`${be} hours ago`;else{const se=Math.floor(be/24);se===1?ve="1 day ago":ve=`${se} days ago`}return console.log(" Formatted result:",ve),ve}catch(V){return console.error(" Error formatting date:",V),"Error formatting date"}},ze=S=>{const V={to_activate:"To active",pending:"Pending",draft:"Draft",submitted:"Submitted",approved:"Approved",active:"Active",published:"Published",rejected:"Rejected",declined:"Declined",cancelled:"Cancelled",inactive:"Inactive",archived:"Archived"};return V[S]?V[S]:S.replace(/_/g," ").replace(/\b\w/g,J=>J.toUpperCase())},_e=async S=>{try{console.log(" Approving gig:",S);const V=$e.get("companyId"),J=$e.get("userId"),be=$e.get("gigId");if(console.log(" Auth tokens:",{companyId:V,userId:J,gigId:be}),!V||!J)throw new Error("Missing authentication tokens");const ve=`undefined/gigs/${S}`;console.log(" API URL:",ve);const se={status:"active"};console.log(" Request body:",se);const De=await fetch(ve,{method:"PUT",headers:{Authorization:`Bearer ${be}:${J}`,"Content-Type":"application/json"},body:JSON.stringify(se)});if(console.log(" Response status:",De.status),console.log(" Response headers:",Object.fromEntries(De.headers.entries())),!De.ok){const He=await De.text();throw console.error(" API Error response:",He),new Error(`Failed to approve gig: ${De.status} ${De.statusText}`)}const Ke=await De.json();console.log(" Gig approved successfully:",Ke),l(He=>He.map(xt=>xt._id===S?{...xt,status:"active"}:xt)),await ht()}catch(V){console.error(" Error approving gig:",V),p(V instanceof Error?V.message:"Failed to approve gig")}},ht=async()=>{try{const S=$e.get("companyId");if(!S){console.warn("Company ID not found, cannot complete last phase and step");return}console.log(" Completing last phase and step due to active gig");const V=await fetch(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${S}/onboarding/complete-last`,{method:"PUT",headers:{"Content-Type":"application/json"}});if(V.ok){const J=await V.json();console.log(" Last phase and step completed successfully:",J)}else console.warn(" Failed to complete last phase and step:",V.status)}catch(S){console.error(" Error completing last phase and step:",S)}},X=async S=>{try{console.log(" Rejecting gig:",S);const V=$e.get("companyId"),J=$e.get("userId"),be=$e.get("gigId");if(console.log(" Auth tokens:",{companyId:V,userId:J,gigId:be}),!V||!J)throw new Error("Missing authentication tokens");const ve=`undefined/gigs/${S}`;console.log(" API URL:",ve);const se={status:"inactive"};console.log(" Request body:",se);const De=await fetch(ve,{method:"PUT",headers:{Authorization:`Bearer ${be}:${J}`,"Content-Type":"application/json"},body:JSON.stringify(se)});if(console.log(" Response status:",De.status),console.log(" Response headers:",Object.fromEntries(De.headers.entries())),!De.ok){const He=await De.text();throw console.error(" API Error response:",He),new Error(`Failed to reject gig: ${De.status} ${De.statusText}`)}const Ke=await De.json();console.log(" Gig rejected successfully:",Ke),l(He=>He.map(xt=>xt._id===S?{...xt,status:"inactive"}:xt)),await me()}catch(V){console.error(" Error rejecting gig:",V),p(V instanceof Error?V.message:"Failed to reject gig")}},me=async()=>{try{const S=$e.get("companyId");if(!S){console.warn("Company ID not found, cannot check step 13 status");return}const V=o.some(J=>J.status==="active"||J.status==="approved"||J.status==="published");if(console.log(" Checking step 13 status after gig status change:",{totalGigs:o.length,hasActiveGig:V,gigStatuses:o.map(J=>J.status)}),!V){console.log(" No active gigs found - updating phase and step statuses");const J=await fetch(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${S}/onboarding/phases/4/steps/13`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"in_progress"})}),be=await fetch(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${S}/onboarding/current-phase`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({phase:4})});J.ok&&be.ok?console.log(" Step 13 and phase 4 statuses updated successfully"):console.warn(" Failed to update step 13 or phase 4 status:",{stepStatus:J.status,phaseStatus:be.status})}}catch(S){console.error(" Error checking step 13 status:",S)}},Fe=async S=>{try{console.log(" Fetching skills data for gig");const V=[],J=[],be=[];console.log(" Gig skills structure:",S.skills),S.skills?.professional&&S.skills.professional.forEach(se=>{console.log(" Professional skill object:",se);const De=se.skill?.$oid||se.skill?._id||se.skill||se._id;De?(V.push(De),console.log(" Added professional skill ID:",De)):console.warn(" Could not extract professional skill ID from:",se)}),S.skills?.technical&&S.skills.technical.forEach(se=>{console.log(" Technical skill object:",se);const De=se.skill?.$oid||se.skill?._id||se.skill||se._id;De?(J.push(De),console.log(" Added technical skill ID:",De)):console.warn(" Could not extract technical skill ID from:",se)}),S.skills?.soft&&S.skills.soft.forEach(se=>{console.log(" Soft skill object:",se);const De=se.skill?.$oid||se.skill?._id||se.skill||se._id;De?(be.push(De),console.log(" Added soft skill ID:",De)):console.warn(" Could not extract soft skill ID from:",se)}),console.log(" Skills IDs by category:",{professional:V,technical:J,soft:be});const ve={};if(V.length>0)try{const se=await fetch("undefined/skills/professional");if(se.ok){const De=se.headers.get("content-type");if(De&&De.includes("application/json")){const Ke=await se.json();if(console.log(" Fetched professional skills response:",Ke),Ke.success&&Ke.data&&Array.isArray(Ke.data)){const He=Ke.data;console.log(" Professional skills data:",He),V.forEach(xt=>{const en=He.find(Po=>Po._id===xt);en?(ve[xt]=en,console.log(` Matched professional skill ${xt}:`,en.name)):console.warn(` Professional skill ${xt} not found`)})}else console.warn(" Invalid response format for professional skills")}else console.warn(" Response is not JSON for professional skills")}else console.warn(" Failed to fetch professional skills:",se.status,se.statusText)}catch(se){console.warn(" Error fetching professional skills:",se)}if(J.length>0)try{const se=await fetch("undefined/skills/technical");if(se.ok){const De=se.headers.get("content-type");if(De&&De.includes("application/json")){const Ke=await se.json();if(console.log(" Fetched technical skills response:",Ke),Ke.success&&Ke.data&&Array.isArray(Ke.data)){const He=Ke.data;console.log(" Technical skills data:",He),J.forEach(xt=>{const en=He.find(Po=>Po._id===xt);en?(ve[xt]=en,console.log(` Matched technical skill ${xt}:`,en.name)):console.warn(` Technical skill ${xt} not found`)})}else console.warn(" Invalid response format for technical skills")}else console.warn(" Response is not JSON for technical skills")}else console.warn(" Failed to fetch technical skills:",se.status,se.statusText)}catch(se){console.warn(" Error fetching technical skills:",se)}if(be.length>0)try{const se=await fetch("undefined/skills/soft");if(se.ok){const De=se.headers.get("content-type");if(De&&De.includes("application/json")){const Ke=await se.json();if(console.log(" Fetched soft skills response:",Ke),Ke.success&&Ke.data&&Array.isArray(Ke.data)){const He=Ke.data;console.log(" Soft skills data:",He),be.forEach(xt=>{const en=He.find(Po=>Po._id===xt);en?(ve[xt]=en,console.log(` Matched soft skill ${xt}:`,en.name)):console.warn(` Soft skill ${xt} not found`)})}else console.warn(" Invalid response format for soft skills")}else console.warn(" Response is not JSON for soft skills")}else console.warn(" Failed to fetch soft skills:",se.status,se.statusText)}catch(se){console.warn(" Error fetching soft skills:",se)}w(ve),console.log(" All skills data fetched and set:",ve)}catch(V){console.error(" Error fetching skills data:",V)}},tt=async S=>{try{console.log(" Fetching timezone data for gig");const V=S.availability?.time_zone;if(console.log(" Timezone ID from gig:",V),!V){console.log(" No timezone ID found in gig data");return}try{const J=await fetch("undefined/timezones");if(J.ok){const be=J.headers.get("content-type");if(be&&be.includes("application/json")){const ve=await J.json();if(console.log(" Fetched timezones response:",ve),ve.success&&ve.data&&Array.isArray(ve.data)){const se=ve.data;console.log(" Timezones data:",se);const De=se.find(Ke=>Ke._id===V);De?(E({[V]:De}),console.log(` Matched timezone ${V}:`,De.zoneName)):console.warn(` Timezone ${V} not found`)}else console.warn(" Invalid response format for timezones")}else console.warn(" Response is not JSON for timezones")}else console.warn(" Failed to fetch timezones:",J.status,J.statusText)}catch(J){console.warn(" Error fetching timezones:",J)}}catch(V){console.error(" Error fetching timezone data:",V)}},Oe=async S=>{try{console.log(" Fetching destination zone data for gig");const V=S.destination_zone;if(console.log(" Destination zone from gig:",V),!V){console.log(" No destination zone found in gig data");return}try{const be=await fetch("undefined/timezones/country/FR");if(be.ok){const ve=be.headers.get("content-type");if(ve&&ve.includes("application/json")){const se=await be.json();if(console.log(" Fetched destination zone timezones response:",se),se.success&&se.data&&Array.isArray(se.data)&&se.data.length>0){const De=se.data[0];E(Ke=>({...Ke,0:De})),console.log(" Set destination zone timezone:",De.countryName)}else console.warn(" Invalid response format for destination zone timezones")}else console.warn(" Response is not JSON for destination zone timezones")}else console.warn(" Failed to fetch destination zone timezones:",be.status,be.statusText)}catch(J){console.warn(" Error fetching destination zone timezones:",J)}}catch(V){console.error(" Error fetching destination zone data:",V)}},Ye=async S=>{try{console.log(" Archiving gig:",S);const V=$e.get("companyId"),J=$e.get("userId"),be=$e.get("gigId");if(console.log(" Auth tokens:",{companyId:V,userId:J,gigId:be}),!V||!J)throw new Error("Missing authentication tokens");const ve=`undefined/gigs/${S}`;console.log(" API URL:",ve);const se={status:"archived"};console.log(" Request body:",se);const De=await fetch(ve,{method:"PUT",headers:{Authorization:`Bearer ${be}:${J}`,"Content-Type":"application/json"},body:JSON.stringify(se)});if(console.log(" Response status:",De.status),console.log(" Response headers:",Object.fromEntries(De.headers.entries())),!De.ok){const He=await De.text();throw console.error(" API Error response:",He),new Error(`Failed to archive gig: ${De.status} ${De.statusText}`)}const Ke=await De.json();console.log(" Gig archived successfully:",Ke),l(He=>He.map(xt=>xt._id===S?{...xt,status:"archived"}:xt)),await me()}catch(V){console.error(" Error archiving gig:",V),p(V instanceof Error?V.message:"Failed to archive gig")}},at=async S=>{try{console.log(" Previewing gig:",S);const V=$e.get("companyId"),J=$e.get("userId"),be=$e.get("gigId");if(console.log(" Auth tokens:",{companyId:V,userId:J,gigId:be}),!V||!J)throw new Error("Missing authentication tokens");const ve=`undefined/gigs/${S}`;console.log(" API URL:",ve);const se=await fetch(ve,{method:"GET",headers:{Authorization:`Bearer ${be}:${J}`,"Content-Type":"application/json"}});if(console.log(" Response status:",se.status),!se.ok){const Ke=await se.text();throw console.error(" API Error response:",Ke),new Error(`Failed to fetch gig details: ${se.status} ${se.statusText}`)}const De=await se.json();console.log(" Gig details for preview:",De),console.log(" Date fields:",{createdAt:De.data?.createdAt,updatedAt:De.data?.updatedAt}),g(De.data),await Fe(De.data),await tt(De.data),await Oe(De.data),y("preview")}catch(V){console.error(" Error previewing gig:",V),p(V instanceof Error?V.message:"Failed to preview gig")}},At=async S=>{try{console.log(" Editing gig:",S);const V=$e.get("companyId"),J=$e.get("userId"),be=$e.get("gigId");if(console.log(" Auth tokens:",{companyId:V,userId:J,gigId:be}),!V||!J)throw new Error("Missing authentication tokens");const ve=`undefined/gigs/${S}`;console.log(" API URL:",ve);const se=await fetch(ve,{method:"GET",headers:{Authorization:`Bearer ${be}:${J}`,"Content-Type":"application/json"}});if(console.log(" Response status:",se.status),!se.ok){const Ke=await se.text();throw console.error(" API Error response:",Ke),new Error(`Failed to fetch gig details for editing: ${se.status} ${se.statusText}`)}const De=await se.json();console.log(" Current gig data for editing:",De),console.log(" Date fields:",{createdAt:De.data?.createdAt,updatedAt:De.data?.updatedAt}),g(De.data),await Fe(De.data),await tt(De.data),await Oe(De.data),y("edit")}catch(V){console.error(" Error editing gig:",V),p(V instanceof Error?V.message:"Failed to edit gig")}},wt=async()=>{console.log(" Approving selected gigs:",n);for(const S of n)await _e(S);s([])},fe=async()=>{console.log(" Rejecting selected gigs:",n);for(const S of n)await X(S);s([])},We=()=>{y("main"),g(null)},qe=S=>{C(V=>V.includes(S)?V.filter(J=>J!==S):[...V,S])},je=S=>{switch(S){case"9-5":A({start:"09:00",end:"17:00"});break;case"early":A({start:"06:00",end:"14:00"});break;case"late":A({start:"14:00",end:"22:00"});break;case"evening":A({start:"18:00",end:"02:00"});break}},it=()=>{if(k.length===0)return;const S={id:Date.now(),days:[...k],startTime:I.start,endTime:I.end,displayText:`${k.join(" et ")} de ${I.start} jusqu' ${I.end}`};T(V=>[...V,S]),C(["Monday","Tuesday"]),A({start:"09:00",end:"17:00"}),O(!1)},St=S=>{B(S),C(S.days),A({start:S.startTime,end:S.endTime}),O(!0)},dt=()=>{if(!M||k.length===0)return;const S={...M,days:[...k],startTime:I.start,endTime:I.end,displayText:`${k.join(" et ")} de ${I.start} jusqu' ${I.end}`};T(V=>V.map(J=>J.id===M.id?S:J)),B(null),C(["Monday","Tuesday"]),A({start:"09:00",end:"17:00"}),O(!1)},gt=S=>{T(V=>V.filter(J=>J.id!==S))},Qt=S=>{const[V,J]=S.split(":"),be=parseInt(V),ve=be>=12?"PM":"AM";return`${be===0?12:be>12?be-12:be}:${J} ${ve}`},Bs=async()=>{try{const S=document.getElementById("activities"),V=document.getElementById("industries"),J=document.getElementById("languages"),be=Array.from(S?.selectedOptions||[]).map(en=>en.value),ve=Array.from(V?.selectedOptions||[]).map(en=>en.value),se=Array.from(J?.selectedOptions||[]).map(en=>en.value),De=document.getElementById("seniority_level")?.value,Ke=document.getElementById("years_experience")?.value,He={activities:be,industries:ve,languages:se,seniority:{level:De,yearsExperience:parseInt(Ke)||0}};console.log(" Saving gig changes:",He);const xt=await Ie.put(`undefined/gigs/${x._id}`,He,{headers:{"Content-Type":"application/json"}});xt.data.success?(console.log(" Gig updated successfully"),g({...x,...He}),y("preview")):console.error(" Failed to update gig:",xt.data.message)}catch(S){console.error(" Error saving changes:",S)}};return d?(console.log(" Rendering loading state"),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Approval & Publishing")),i.createElement("div",{className:"rounded-lg bg-white shadow p-8"},i.createElement("div",{className:"text-center"},i.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mx-auto"}),i.createElement("p",{className:"mt-2 text-gray-500"},"Loading gigs..."))))):h?(console.log(" Rendering error state:",h),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Approval & Publishing")),i.createElement("div",{className:"rounded-lg bg-white shadow p-8"},i.createElement("div",{className:"text-center"},i.createElement(Xm,{className:"h-8 w-8 text-red-500 mx-auto"}),i.createElement("p",{className:"mt-2 text-red-600"},h),i.createElement("button",{onClick:W,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},"Retry"))))):(console.log(" Rendering main component with",o.length,"gigs"),f==="preview"&&x?i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("button",{onClick:We,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-900 transition-colors"},i.createElement(Zl,{size:16}),"Back to Approval"),i.createElement("div",{className:"h-6 w-px bg-gray-300"}),i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Preview: ",x.title))),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},i.createElement(hn,{className:"h-6 w-6 text-blue-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Basic Information")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(ys,{className:"h-4 w-4 text-blue-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Title")),i.createElement("p",{className:"text-sm text-gray-900 font-medium"},x.title)),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Sa,{className:"h-4 w-4 text-purple-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Category")),i.createElement("p",{className:"text-sm text-gray-900 font-medium"},x.category||"Not specified")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Status")),i.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${x.status==="active"||x.status==="approved"?"bg-green-100 text-green-800":x.status==="pending"||x.status==="to_activate"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},x.status)),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(gs,{className:"h-4 w-4 text-indigo-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Destination Zone")),i.createElement("p",{className:"text-sm text-gray-900 font-medium"},v[0]?.countryName||x.destination_zone||"Not specified"))),i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ho,{className:"h-4 w-4 text-orange-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Company")),i.createElement("p",{className:"text-sm text-gray-900 font-medium"},x.companyName||c?.name||"Not specified")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ia,{className:"h-4 w-4 text-emerald-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Created")),i.createElement("p",{className:"text-sm text-gray-900 font-medium"},x.createdAt?Re(x.createdAt):"Not available")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ct,{className:"h-4 w-4 text-cyan-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Updated")),i.createElement("p",{className:"text-sm text-gray-900 font-medium"},x.updatedAt?Re(x.updatedAt):"Not available")))),i.createElement("div",{className:"mt-6 bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(hn,{className:"h-4 w-4 text-blue-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Description")),i.createElement("p",{className:"text-sm text-gray-900 leading-relaxed"},x.description))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 border border-green-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},i.createElement(ys,{className:"h-6 w-6 text-green-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Activities & Industries")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-green-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Activities")),i.createElement("div",{className:"flex flex-wrap gap-2"},x.activities?.map((S,V)=>i.createElement("span",{key:V,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border border-green-200"},S?.name||Z(S)))||i.createElement("span",{className:"text-sm text-gray-500 italic"},"No activities specified"))),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-green-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ho,{className:"h-4 w-4 text-emerald-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Industries")),i.createElement("div",{className:"flex flex-wrap gap-2"},x.industries?.map((S,V)=>i.createElement("span",{key:V,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-emerald-100 to-teal-100 text-emerald-800 border border-emerald-200"},S?.name||ke(S)))||i.createElement("span",{className:"text-sm text-gray-500 italic"},"No industries specified"))))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},i.createElement(Sa,{className:"h-6 w-6 text-purple-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Seniority Requirements")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(ys,{className:"h-4 w-4 text-purple-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Level")),i.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-purple-100 to-violet-100 text-purple-800 border border-purple-200"},x.seniority?.level||"Not specified")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ct,{className:"h-4 w-4 text-violet-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Years of Experience")),i.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-violet-100 to-purple-100 text-violet-800 border border-violet-200"},x.seniority?.yearsExperience||"Not specified")))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-orange-50 to-amber-50 border border-orange-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-orange-100 rounded-lg"},i.createElement(Sa,{className:"h-6 w-6 text-orange-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Skills & Languages")),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(ys,{className:"h-4 w-4 text-purple-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Professional Skills")),i.createElement("div",{className:"flex flex-wrap gap-2"},x.skills?.professional?.map((S,V)=>{const J=S?.skill?.name||b[S?.skill?._id]?.name||`Skill ${S?.skill?._id||"Unknown"}`;return i.createElement("span",{key:V,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-purple-100 to-violet-100 text-purple-800 border border-purple-200"},J," (Level ",S?.level||"N/A",")")})||i.createElement("span",{className:"text-sm text-gray-500 italic"},"No professional skills specified"))),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Gr,{className:"h-4 w-4 text-orange-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Technical Skills")),i.createElement("div",{className:"flex flex-wrap gap-2"},x.skills?.technical?.map((S,V)=>{const J=S?.skill?.name||b[S?.skill?._id]?.name||`Skill ${S?.skill?._id||"Unknown"}`;return i.createElement("span",{key:V,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-orange-100 to-amber-100 text-orange-800 border border-orange-200"},J," (Level ",S?.level||"N/A",")")})||i.createElement("span",{className:"text-sm text-gray-500 italic"},"No technical skills specified"))),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(qr,{className:"h-4 w-4 text-pink-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Soft Skills")),i.createElement("div",{className:"flex flex-wrap gap-2"},x.skills?.soft?.map((S,V)=>{const J=S?.skill?.name||b[S?.skill?._id]?.name||`Skill ${S?.skill?._id||"Unknown"}`;return i.createElement("span",{key:V,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-pink-100 to-rose-100 text-pink-800 border border-pink-200"},J," (Level ",S?.level||"N/A",")")})||i.createElement("span",{className:"text-sm text-gray-500 italic"},"No soft skills specified"))),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-orange-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(gs,{className:"h-4 w-4 text-indigo-500"}),i.createElement("span",{className:"text-sm font-semibold text-gray-700"},"Languages")),i.createElement("div",{className:"flex flex-wrap gap-2"},x.skills?.languages?.map((S,V)=>i.createElement("span",{key:V,className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gradient-to-r from-indigo-100 to-blue-100 text-indigo-800 border border-indigo-200"},S?.language?.name||Ae(S?.language)," (",S?.proficiency||"N/A",")"))||i.createElement("span",{className:"text-sm text-gray-500 italic"},"No languages specified"))))),i.createElement("div",{className:"rounded-lg bg-white shadow p-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Schedule & Availability"),i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Time Zone:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},(()=>{const S=x.availability?.time_zone;if(S&&typeof S=="object")return`${S.zoneName} (${S.countryName})`;const V=v[S];return V?`${V.zoneName} (${V.countryName})`:S||"Not specified"})())),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Flexibility:"),i.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},x.availability?.flexibility?.map((S,V)=>i.createElement("span",{key:V,className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},S))||i.createElement("span",{className:"text-sm text-gray-500"},"No flexibility options specified")))),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Weekly Schedule:"),i.createElement("div",{className:"mt-2 space-y-2"},x.availability?.schedule?.map((S,V)=>i.createElement("div",{key:V,className:"flex justify-between items-center py-2 px-3 bg-gray-50 rounded-md"},i.createElement("span",{className:"text-sm font-medium text-gray-900"},S?.day||"Unknown"),i.createElement("span",{className:"text-sm text-gray-600"},S?.hours?.start||"N/A"," - ",S?.hours?.end||"N/A")))||i.createElement("span",{className:"text-sm text-gray-500"},"No schedule specified"))),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Minimum Hours (Daily):"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.availability?.minimumHours?.daily||"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Minimum Hours (Weekly):"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.availability?.minimumHours?.weekly||"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Minimum Hours (Monthly):"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.availability?.minimumHours?.monthly||"Not specified"))))),i.createElement("div",{className:"rounded-lg bg-white shadow p-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Commission & Compensation"),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"space-y-3"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Base:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.base||"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Base Amount:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.baseAmount?`${x.commission.baseAmount} ${x.commission.currency?.symbol||""}`:"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Bonus:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.bonus||"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Bonus Amount:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.bonusAmount?`${x.commission.bonusAmount} ${x.commission.currency?.symbol||""}`:"Not specified"))),i.createElement("div",{className:"space-y-3"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Transaction Commission:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.transactionCommission?.type||"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Commission Amount:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.transactionCommission?.amount?`${x.commission.transactionCommission.amount} ${x.commission?.currency?.symbol||""}`:"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Minimum Volume:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission?.minimumVolume?.amount?`${x.commission.minimumVolume.amount} ${x.commission.minimumVolume.unit} ${x.commission.minimumVolume.period}`:"Not specified"))),x.commission?.additionalDetails&&i.createElement("div",{className:"mt-4 pt-4 border-t border-gray-200"},i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Additional Details:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.commission.additionalDetails)))),i.createElement("div",{className:"rounded-lg bg-white shadow p-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Team Structure"),i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Team Size:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},x.team?.size||"Not specified")),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Territories:"),i.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},x.team?.territories?.map((S,V)=>i.createElement("span",{key:V,className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},S.flags&&i.createElement("img",{src:S.flags.png,alt:S.flags.alt,className:"w-3 h-2 rounded-sm"}),S.name?.common||S))||i.createElement("span",{className:"text-sm text-gray-500"},"No territories specified")))),i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Team Structure:"),i.createElement("div",{className:"mt-2 space-y-2"},x.team?.structure?.map((S,V)=>i.createElement("div",{key:V,className:"flex justify-between items-center py-2 px-3 bg-gray-50 rounded-md"},i.createElement("span",{className:"text-sm font-medium text-gray-900"},S?.roleId||"Unknown"," (",S?.count||0,")"),i.createElement("span",{className:"text-sm text-gray-600"},S?.seniority?.level||"N/A"," - ",S?.seniority?.yearsExperience||"N/A"," years")))||i.createElement("span",{className:"text-sm text-gray-500"},"No team structure specified"))))),x.issues&&x.issues.length>0&&i.createElement("div",{className:"rounded-lg bg-yellow-50 border border-yellow-200 p-6"},i.createElement("h2",{className:"text-lg font-semibold text-yellow-800 mb-4"},"Issues Requiring Attention"),i.createElement("ul",{className:"list-disc space-y-1 pl-5 text-sm text-yellow-700"},x.issues.map((S,V)=>i.createElement("li",{key:V},S)))))):f==="edit"&&x?i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("button",{onClick:We,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-900 transition-colors"},i.createElement(Zl,{size:16}),"Back to Approval"),i.createElement("div",{className:"h-6 w-px bg-gray-300"}),i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Edit: ",x.title))),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},i.createElement(hn,{className:"h-6 w-6 text-blue-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Basic Information")),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(ys,{className:"h-4 w-4 text-blue-500"}),i.createElement("label",{htmlFor:"title",className:"text-sm font-semibold text-gray-700"},"Gig Title")),i.createElement("input",{type:"text",id:"title",defaultValue:x.title,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter gig title"})),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(hn,{className:"h-4 w-4 text-blue-500"}),i.createElement("label",{htmlFor:"description",className:"text-sm font-semibold text-gray-700"},"Description")),i.createElement("textarea",{id:"description",rows:4,defaultValue:x.description,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter gig description"})),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Sa,{className:"h-4 w-4 text-purple-500"}),i.createElement("label",{htmlFor:"category",className:"text-sm font-semibold text-gray-700"},"Category")),i.createElement("input",{type:"text",id:"category",defaultValue:x.category,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter category"})),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(gs,{className:"h-4 w-4 text-indigo-500"}),i.createElement("label",{htmlFor:"destination_zone",className:"text-sm font-semibold text-gray-700"},"Destination Zone")),i.createElement("input",{type:"text",id:"destination_zone",defaultValue:x.destination_zone,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter destination zone"}),v[0]&&i.createElement("p",{className:"mt-2 text-xs text-gray-500 bg-gray-50 px-2 py-1 rounded"},"Country: ",v[0].countryName))))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-green-50 to-emerald-50 border border-green-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-green-100 rounded-lg"},i.createElement(ys,{className:"h-6 w-6 text-green-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Activities & Industries")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-green-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("label",{htmlFor:"activities",className:"text-sm font-semibold text-gray-700"},"Activities")),i.createElement("select",{id:"activities",multiple:!0,defaultValue:x.activities||[],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 min-h-[120px]"},L.map(S=>i.createElement("option",{key:S._id,value:S._id},S.name," - ",S.category))),i.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Hold Ctrl/Cmd to select multiple activities")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-green-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ho,{className:"h-4 w-4 text-emerald-500"}),i.createElement("label",{htmlFor:"industries",className:"text-sm font-semibold text-gray-700"},"Industries")),i.createElement("select",{id:"industries",multiple:!0,defaultValue:x.industries||[],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 min-h-[120px]"},D.map(S=>i.createElement("option",{key:S._id,value:S._id},S.name))),i.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Hold Ctrl/Cmd to select multiple industries")))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},i.createElement(Sa,{className:"h-6 w-6 text-purple-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Seniority Requirements")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(ys,{className:"h-4 w-4 text-purple-500"}),i.createElement("label",{htmlFor:"seniority_level",className:"text-sm font-semibold text-gray-700"},"Seniority Level")),i.createElement("select",{id:"seniority_level",defaultValue:x.seniority?.level,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500"},i.createElement("option",{value:""},"Select level"),i.createElement("option",{value:"Entry-Level"},"Entry-Level"),i.createElement("option",{value:"Mid-Level"},"Mid-Level"),i.createElement("option",{value:"Senior"},"Senior"),i.createElement("option",{value:"Expert"},"Expert"))),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ct,{className:"h-4 w-4 text-violet-500"}),i.createElement("label",{htmlFor:"years_experience",className:"text-sm font-semibold text-gray-700"},"Years of Experience")),i.createElement("input",{type:"number",id:"years_experience",defaultValue:x.seniority?.yearsExperience,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter years of experience"})))),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},i.createElement(T1,{className:"h-6 w-6 text-blue-600"})),i.createElement("div",null,i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Base Commission"),i.createElement("p",{className:"text-sm text-gray-600"},"Set the fixed base rate and requirements"))),i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement("div",null,i.createElement("label",{htmlFor:"commission_per_call",className:"block text-sm font-semibold text-gray-700 mb-2"},"Per call compensation"),i.createElement("div",{className:"relative"},i.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i.createElement("span",{className:"text-gray-500 sm:text-sm"},"$")),i.createElement("input",{type:"number",id:"commission_per_call",step:"0.01",defaultValue:x.commission?.commission_per_call,className:"w-full pl-8 pr-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount per call"})))),i.createElement("div",{className:"mt-6 bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-4"},i.createElement(ys,{className:"h-4 w-4 text-blue-500"}),i.createElement("h3",{className:"text-sm font-semibold text-gray-700"},"Minimum Requirements")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},i.createElement("div",null,i.createElement("label",{htmlFor:"target_amount",className:"block text-xs font-medium text-gray-500 mb-1"},"Target Amount"),i.createElement("input",{type:"number",id:"target_amount",defaultValue:x.commission?.minimumVolume?.amount,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter target"})),i.createElement("div",null,i.createElement("label",{htmlFor:"unit_type",className:"block text-xs font-medium text-gray-500 mb-1"},"Unit"),i.createElement("select",{id:"unit_type",defaultValue:x.commission?.minimumVolume?.unit,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},i.createElement("option",{value:""},"Select unit"),i.createElement("option",{value:"Calls"},"Calls"),i.createElement("option",{value:"Sales"},"Sales"),i.createElement("option",{value:"Transactions"},"Transactions"))),i.createElement("div",null,i.createElement("label",{htmlFor:"period",className:"block text-xs font-medium text-gray-500 mb-1"},"Period"),i.createElement("select",{id:"period",defaultValue:x.commission?.minimumVolume?.period,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},i.createElement("option",{value:""},"Select period"),i.createElement("option",{value:"Daily"},"Daily"),i.createElement("option",{value:"Weekly"},"Weekly"),i.createElement("option",{value:"Monthly"},"Monthly")))))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},i.createElement(Ta,{className:"h-6 w-6 text-purple-600"})),i.createElement("div",null,i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Transaction Commission"),i.createElement("p",{className:"text-sm text-gray-600"},"Define per-transaction rewards"))),i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement("div",null,i.createElement("label",{htmlFor:"transaction_commission",className:"block text-sm font-semibold text-gray-700 mb-2"},"Commission Amount"),i.createElement("div",{className:"relative"},i.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i.createElement("span",{className:"text-gray-500 sm:text-sm"},"$")),i.createElement("input",{type:"number",id:"transaction_commission",step:"0.01",defaultValue:x.commission?.transactionCommission,className:"w-full pl-8 pr-3 py-2 border border-purple-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter amount"}))))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-amber-50 to-yellow-50 border border-amber-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-amber-100 rounded-lg"},i.createElement(Sa,{className:"h-6 w-6 text-amber-600"})),i.createElement("div",null,i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Performance Bonus"),i.createElement("p",{className:"text-sm text-gray-600"},"Set additional performance-based rewards"))),i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement("div",null,i.createElement("label",{htmlFor:"bonus_amount",className:"block text-sm font-semibold text-gray-700 mb-2"},"Bonus Amount"),i.createElement("div",{className:"relative"},i.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},i.createElement("span",{className:"text-gray-500 sm:text-sm"},"$")),i.createElement("input",{type:"text",id:"bonus_amount",defaultValue:x.commission?.bonusAmount,className:"w-full pl-8 pr-3 py-2 border border-amber-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500 focus:border-amber-500",placeholder:"Enter bonus amount"}))))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-gray-50 to-slate-50 border border-gray-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-gray-100 rounded-lg"},i.createElement(gs,{className:"h-6 w-6 text-gray-600"})),i.createElement("div",null,i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Currency Settings"),i.createElement("p",{className:"text-sm text-gray-600"},"Select the currency for all commission calculations"))),i.createElement("div",{className:"max-w-md"},i.createElement("label",{htmlFor:"currency",className:"block text-sm font-semibold text-gray-700 mb-2"},"Currency"),i.createElement("select",{id:"currency",defaultValue:x.commission?.currency?.$oid||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500"},i.createElement("option",{value:""},"Select currency"),i.createElement("option",{value:"EUR"},"EUR ()"),i.createElement("option",{value:"USD"},"USD ($)"),i.createElement("option",{value:"GBP"},"GBP ()"),i.createElement("option",{value:"CAD"},"CAD (C$)"),i.createElement("option",{value:"AUD"},"AUD (A$)"))))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-pink-50 to-rose-50 border border-pink-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-pink-100 rounded-lg"},i.createElement(qr,{className:"h-6 w-6 text-pink-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Team Structure")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-pink-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(qr,{className:"h-4 w-4 text-pink-500"}),i.createElement("label",{htmlFor:"team_size",className:"text-sm font-semibold text-gray-700"},"Team Size")),i.createElement("input",{type:"number",id:"team_size",defaultValue:x.team?.size,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500",placeholder:"Enter team size"})),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-pink-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(to,{className:"h-4 w-4 text-rose-500"}),i.createElement("label",{htmlFor:"territories",className:"text-sm font-semibold text-gray-700"},"Territories")),i.createElement("input",{type:"text",id:"territories",defaultValue:x.team?.territories?.map(S=>S.name?.common||S).join(", "),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-pink-500",placeholder:"Enter territories (comma separated)"})))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-cyan-50 to-blue-50 border border-cyan-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-cyan-100 rounded-lg"},i.createElement(Ct,{className:"h-6 w-6 text-cyan-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Schedule & Availability")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(gs,{className:"h-4 w-4 text-cyan-500"}),i.createElement("label",{htmlFor:"timezone",className:"text-sm font-semibold text-gray-700"},"Time Zone")),i.createElement("input",{type:"text",id:"timezone",defaultValue:x.availability?.time_zone?.zoneName||x.availability?.time_zone||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",placeholder:"Enter timezone"})),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Gr,{className:"h-4 w-4 text-blue-500"}),i.createElement("label",{htmlFor:"flexibility",className:"text-sm font-semibold text-gray-700"},"Flexibility")),i.createElement("input",{type:"text",id:"flexibility",defaultValue:x.availability?.flexibility?.join(", "),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500",placeholder:"Enter flexibility options (comma separated)"}))),i.createElement("div",{className:"bg-white rounded-lg p-6 border border-cyan-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Working Days"),i.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map(S=>i.createElement("button",{key:S,onClick:()=>qe(S),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${k.includes(S)?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},S))),i.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},i.createElement("div",{className:"flex items-center gap-2 mb-4"},i.createElement(Ct,{className:"h-4 w-4 text-blue-500"}),i.createElement("h4",{className:"text-sm font-semibold text-gray-700"},"Working Hours")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ho,{className:"h-4 w-4 text-orange-500"}),i.createElement("label",{className:"text-xs font-medium text-gray-500"},"Start Time")),i.createElement("div",{className:"flex items-center gap-2"},i.createElement("span",{className:"text-lg font-bold text-gray-900"},I.start),i.createElement(Ct,{className:"h-4 w-4 text-gray-400"}))),i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-2 mb-2"},i.createElement(Ho,{className:"h-4 w-4 text-purple-500"}),i.createElement("label",{className:"text-xs font-medium text-gray-500"},"End Time")),i.createElement("div",{className:"flex items-center gap-2"},i.createElement("span",{className:"text-lg font-bold text-gray-900"},I.end),i.createElement(Ct,{className:"h-4 w-4 text-gray-400"})))),i.createElement("div",{className:"bg-gray-100 rounded-lg px-3 py-2 flex items-center justify-between"},i.createElement("span",{className:"text-sm font-medium text-gray-700"},"Working Hours:"),i.createElement("div",{className:"flex items-center gap-2"},i.createElement("span",{className:"text-sm font-bold text-gray-900"},Qt(I.start)," - ",Qt(I.end)),i.createElement(Ct,{className:"h-4 w-4 text-gray-400"}))),i.createElement("div",{className:"mt-4 flex flex-wrap gap-2"},i.createElement("button",{onClick:()=>je("9-5"),className:"flex flex-col items-center p-3 rounded-lg border border-gray-200 hover:border-orange-300 hover:bg-orange-50 transition-colors"},i.createElement(FW,{className:"h-5 w-5 text-orange-500 mb-1"}),i.createElement("span",{className:"text-xs font-medium text-gray-700"},"9-5")),i.createElement("button",{onClick:()=>je("early"),className:"flex flex-col items-center p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors"},i.createElement(MW,{className:"h-5 w-5 text-blue-500 mb-1"}),i.createElement("span",{className:"text-xs font-medium text-gray-700"},"Early")),i.createElement("button",{onClick:()=>je("late"),className:"flex flex-col items-center p-3 rounded-lg border border-gray-200 hover:border-purple-300 hover:bg-purple-50 transition-colors"},i.createElement(Ct,{className:"h-5 w-5 text-purple-500 mb-1"}),i.createElement("span",{className:"text-xs font-medium text-gray-700"},"Late")),i.createElement("button",{onClick:()=>je("evening"),className:"flex flex-col items-center p-3 rounded-lg border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors"},i.createElement(RW,{className:"h-5 w-5 text-blue-600 mb-1"}),i.createElement("span",{className:"text-xs font-medium text-gray-700"},"Evening"))),i.createElement("div",{className:"mt-4 flex gap-2"},M?i.createElement(i.Fragment,null,i.createElement("button",{onClick:dt,className:"px-4 py-2 bg-blue-600 text-white rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors"},"Update Schedule"),i.createElement("button",{onClick:()=>{B(null),C(["Monday","Tuesday"]),A({start:"09:00",end:"17:00"}),O(!1)},className:"px-4 py-2 bg-gray-500 text-white rounded-lg text-sm font-medium hover:bg-gray-600 transition-colors"},"Cancel")):i.createElement("button",{onClick:it,className:"px-4 py-2 bg-green-600 text-white rounded-lg text-sm font-medium hover:bg-green-700 transition-colors"},"Add Schedule")))),$.length>0&&i.createElement("div",{className:"mt-6 bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Current Schedules"),i.createElement("div",{className:"space-y-3"},$.map(S=>i.createElement("div",{key:S.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},i.createElement("div",{className:"flex items-center gap-3"},i.createElement(Ct,{className:"h-4 w-4 text-cyan-500"}),i.createElement("span",{className:"text-sm font-medium text-gray-900"},S.displayText)),i.createElement("div",{className:"flex gap-2"},i.createElement("button",{onClick:()=>St(S),className:"p-1 text-blue-600 hover:bg-blue-50 rounded"},i.createElement(Hi,{className:"h-4 w-4"})),i.createElement("button",{onClick:()=>gt(S.id),className:"p-1 text-red-600 hover:bg-red-50 rounded"},i.createElement(Hr,{className:"h-4 w-4"}))))))),i.createElement("div",{className:"mt-6 bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("div",{className:"flex items-center gap-2 mb-4"},i.createElement(Ct,{className:"h-4 w-4 text-cyan-500"}),i.createElement("h3",{className:"text-sm font-semibold text-gray-700"},"Minimum Hours")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},i.createElement("div",null,i.createElement("label",{htmlFor:"min_hours_daily",className:"block text-xs font-medium text-gray-500 mb-1"},"Daily"),i.createElement("input",{type:"number",id:"min_hours_daily",defaultValue:x.availability?.minimumHours?.daily,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"Hours"})),i.createElement("div",null,i.createElement("label",{htmlFor:"min_hours_weekly",className:"block text-xs font-medium text-gray-500 mb-1"},"Weekly"),i.createElement("input",{type:"number",id:"min_hours_weekly",defaultValue:x.availability?.minimumHours?.weekly,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"Hours"})),i.createElement("div",null,i.createElement("label",{htmlFor:"min_hours_monthly",className:"block text-xs font-medium text-gray-500 mb-1"},"Monthly"),i.createElement("input",{type:"number",id:"min_hours_monthly",defaultValue:x.availability?.minimumHours?.monthly,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500",placeholder:"Hours"}))))),i.createElement("div",{className:"flex justify-end space-x-3"},i.createElement("button",{type:"button",onClick:We,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50"},"Cancel"),i.createElement("button",{type:"button",onClick:Bs,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700"},"Save Changes")))):i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Approval & Publishing")),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{className:`rounded-lg px-4 py-2 ${n.length>0?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,disabled:n.length===0,onClick:wt},"Approve Selected"),i.createElement("button",{className:`rounded-lg px-4 py-2 ${n.length>0?"bg-red-600 text-white hover:bg-red-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,disabled:n.length===0,onClick:fe},"Reject Selected"))),i.createElement("div",{className:"flex space-x-1 rounded-lg bg-white p-1 shadow"},i.createElement("button",{className:`flex-1 rounded-md py-2 text-sm font-medium ${r==="all"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:bg-gray-100"}`,onClick:()=>{console.log(" Filter changed to: all"),a("all")}},"All"),i.createElement("button",{className:`flex-1 rounded-md py-2 text-sm font-medium ${r==="approved"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:bg-gray-100"}`,onClick:()=>{console.log(" Filter changed to: approved"),a("approved")}},"Active"),i.createElement("button",{className:`flex-1 rounded-md py-2 text-sm font-medium ${r==="rejected"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:bg-gray-100"}`,onClick:()=>{console.log(" Filter changed to: rejected"),a("rejected")}},"Inactive"),i.createElement("button",{className:`flex-1 rounded-md py-2 text-sm font-medium ${r==="archived"?"bg-indigo-100 text-indigo-700":"text-gray-500 hover:bg-gray-100"}`,onClick:()=>{console.log(" Filter changed to: archived"),a("archived")}},"Archived")),i.createElement("div",{className:"rounded-lg bg-white shadow"},i.createElement("div",{className:"flex items-center justify-between border-b border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("button",{onClick:de},n.length===Ee.length&&Ee.length>0?i.createElement(eA,{className:"h-5 w-5 text-indigo-600"}):i.createElement(hA,{className:"h-5 w-5 text-gray-400"})),i.createElement("span",{className:"font-medium text-gray-700"},n.length," of ",Ee.length," selected")),i.createElement("div",{className:"text-sm text-gray-500"},Ee.filter(S=>S.status==="pending").length," pending approval")),Ee.length===0?i.createElement("div",{className:"p-8 text-center"},i.createElement("p",{className:"text-gray-500"},"No gigs found matching the current filter.")):i.createElement("div",{className:"divide-y divide-gray-200"},Ee.map(S=>i.createElement("div",{key:S._id,className:"hover:bg-gray-50"},i.createElement("div",{className:"flex items-center p-4"},i.createElement("div",{className:"mr-3"},i.createElement("button",{onClick:()=>we(S._id)},n.includes(S._id)?i.createElement(eA,{className:"h-5 w-5 text-indigo-600"}):i.createElement(hA,{className:"h-5 w-5 text-gray-400"}))),i.createElement("div",{className:"flex flex-1 cursor-pointer items-center justify-between",onClick:()=>le(S._id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center"},i.createElement(Ca,{className:"h-6 w-6 text-indigo-600"})),i.createElement("div",null,i.createElement("h3",{className:"text-base font-medium text-gray-900"},S.title),i.createElement("p",{className:"text-sm text-gray-500"},S.category||"No category",S.budget&&`  ${S.budget}`))),i.createElement("div",{className:"flex items-center space-x-4"},(S.status==="pending"||S.status==="to_activate"||S.status==="draft"||S.status==="submitted")&&i.createElement("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800"},i.createElement(Ct,{className:"mr-1 h-3 w-3"}),S.status==="to_activate"?"To active":ze(S.status)),(S.status==="approved"||S.status==="active"||S.status==="published")&&i.createElement("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800"},i.createElement(mt,{className:"mr-1 h-3 w-3"}),ze(S.status)),(S.status==="rejected"||S.status==="declined"||S.status==="cancelled"||S.status==="inactive")&&i.createElement("span",{className:"inline-flex items-center rounded-full bg-red-100 px-2.5 py-0.5 text-xs font-medium text-red-800"},i.createElement(qi,{className:"mr-1 h-3 w-3"}),ze(S.status)),S.status==="archived"&&i.createElement("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800"},i.createElement(Ct,{className:"mr-1 h-3 w-3"}),ze(S.status)),t===S._id?i.createElement(Zm,{className:"h-5 w-5 text-gray-400"}):i.createElement(Hu,{className:"h-5 w-5 text-gray-400"})))),t===S._id&&i.createElement("div",{className:"border-t border-gray-100 bg-gray-50 p-4"},i.createElement("div",{className:"mb-4 grid grid-cols-1 gap-4 sm:grid-cols-3"},i.createElement("div",null,i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Company"),i.createElement("p",{className:"text-sm font-medium text-gray-900"},c?.name||S.submittedBy||"Company")),i.createElement("div",null,i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Created"),i.createElement("p",{className:"text-sm font-medium text-gray-900"},Re(S.createdAt))),i.createElement("div",null,i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Status"),i.createElement("p",{className:"text-sm font-medium text-gray-900 capitalize"},S.status))),S.description&&i.createElement("div",{className:"mb-4"},i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Description"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},S.description)),S.issues&&S.issues.length>0&&i.createElement("div",{className:"mb-4 rounded-md bg-yellow-50 p-3"},i.createElement("div",{className:"flex"},i.createElement("div",{className:"flex-shrink-0"},i.createElement(Xm,{className:"h-5 w-5 text-yellow-400"})),i.createElement("div",{className:"ml-3"},i.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Issues Requiring Attention"),i.createElement("div",{className:"mt-2 text-sm text-yellow-700"},i.createElement("ul",{className:"list-disc space-y-1 pl-5"},S.issues.map((V,J)=>i.createElement("li",{key:J},V))))))),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{onClick:()=>at(S._id),className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},i.createElement(Qm,{className:"mr-2 h-4 w-4"}),"Preview"),i.createElement("button",{onClick:()=>At(S._id),className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},i.createElement(Hi,{className:"mr-2 h-4 w-4"}),"Edit"),i.createElement("button",{className:"inline-flex items-center rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},i.createElement(cA,{className:"mr-2 h-4 w-4"}),"Comment"),(S.status==="pending"||S.status==="to_activate"||S.status==="draft"||S.status==="submitted")&&i.createElement(i.Fragment,null,i.createElement("button",{onClick:()=>_e(S._id),className:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700"},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Active"),i.createElement("button",{onClick:()=>X(S._id),className:"inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700"},i.createElement(qi,{className:"mr-2 h-4 w-4"}),"Inactive"),i.createElement("button",{onClick:()=>Ye(S._id),className:"inline-flex items-center rounded-md bg-gray-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-700"},i.createElement(Ct,{className:"mr-2 h-4 w-4"}),"Archived")),(S.status==="approved"||S.status==="active"||S.status==="published")&&i.createElement(i.Fragment,null,i.createElement("button",{onClick:()=>X(S._id),className:"inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700"},i.createElement(qi,{className:"mr-2 h-4 w-4"}),"Inactive"),i.createElement("button",{onClick:()=>Ye(S._id),className:"inline-flex items-center rounded-md bg-gray-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-700"},i.createElement(Ct,{className:"mr-2 h-4 w-4"}),"Archived")),(S.status==="rejected"||S.status==="declined"||S.status==="cancelled"||S.status==="inactive")&&i.createElement(i.Fragment,null,i.createElement("button",{onClick:()=>_e(S._id),className:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700"},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Active"),i.createElement("button",{onClick:()=>Ye(S._id),className:"inline-flex items-center rounded-md bg-gray-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-700"},i.createElement(Ct,{className:"mr-2 h-4 w-4"}),"Archived")),S.status==="archived"&&i.createElement(i.Fragment,null,i.createElement("button",{onClick:()=>_e(S._id),className:"inline-flex items-center rounded-md bg-green-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700"},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Active"),i.createElement("button",{onClick:()=>X(S._id),className:"inline-flex items-center rounded-md bg-red-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700"},i.createElement(qi,{className:"mr-2 h-4 w-4"}),"Inactive"))))))))))},j7=()=>{const[t,e]=N.useState(1),[n,s]=N.useState("30d"),r=[{id:1,title:"Web Development Project",client:"XYZ Corp",views:245,applications:18,conversionRate:"7.3%",trend:"up",trendValue:"+12%",suggestions:[{type:"high",text:"Add more specific technical requirements to attract qualified candidates"},{type:"medium",text:"Include information about the development team structure"},{type:"low",text:"Consider increasing the budget range to attract more senior developers"}]},{id:2,title:"Digital Marketing Campaign",client:"ABC Inc",views:187,applications:9,conversionRate:"4.8%",trend:"down",trendValue:"-5%",suggestions:[{type:"high",text:"Specify target audience demographics and platforms"},{type:"high",text:"Include examples of successful campaigns you admire"},{type:"medium",text:"Add KPIs and success metrics to the description"}]},{id:3,title:"Mobile App Development",client:"Tech Startup",views:312,applications:24,conversionRate:"7.7%",trend:"up",trendValue:"+18%",suggestions:[{type:"medium",text:"Clarify whether this is for iOS, Android, or both platforms"},{type:"low",text:"Add information about the app's target user base"}]}],a=o=>{e(t===o?null:o)};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Optimization & Performance"),i.createElement("div",{className:"flex space-x-2"},i.createElement("select",{className:"rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm",value:n,onChange:o=>s(o.target.value)},i.createElement("option",{value:"7d"},"Last 7 days"),i.createElement("option",{value:"30d"},"Last 30 days"),i.createElement("option",{value:"90d"},"Last 90 days"),i.createElement("option",{value:"all"},"All time")),i.createElement("button",{className:"rounded-lg bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700"},i.createElement($a,{className:"h-5 w-5"})))),i.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4"},i.createElement("div",{className:"rounded-lg bg-white p-4 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Gigs"),i.createElement("p",{className:"text-2xl font-semibold text-gray-900"},"24")),i.createElement("div",{className:"rounded-full bg-indigo-100 p-3 text-indigo-600"},i.createElement(Ca,{className:"h-6 w-6"}))),i.createElement("div",{className:"mt-4 flex items-center text-sm"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("span",{className:"ml-1 text-green-500"},"+8%"),i.createElement("span",{className:"ml-1 text-gray-500"},"from last period"))),i.createElement("div",{className:"rounded-lg bg-white p-4 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Views"),i.createElement("p",{className:"text-2xl font-semibold text-gray-900"},"3,842")),i.createElement("div",{className:"rounded-full bg-indigo-100 p-3 text-indigo-600"},i.createElement($1,{className:"h-6 w-6"}))),i.createElement("div",{className:"mt-4 flex items-center text-sm"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("span",{className:"ml-1 text-green-500"},"+15%"),i.createElement("span",{className:"ml-1 text-gray-500"},"from last period"))),i.createElement("div",{className:"rounded-lg bg-white p-4 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("p",{className:"text-sm font-medium text-gray-500"},"Applications"),i.createElement("p",{className:"text-2xl font-semibold text-gray-900"},"267")),i.createElement("div",{className:"rounded-full bg-indigo-100 p-3 text-indigo-600"},i.createElement(tA,{className:"h-6 w-6"}))),i.createElement("div",{className:"mt-4 flex items-center text-sm"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("span",{className:"ml-1 text-green-500"},"+12%"),i.createElement("span",{className:"ml-1 text-gray-500"},"from last period"))),i.createElement("div",{className:"rounded-lg bg-white p-4 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("p",{className:"text-sm font-medium text-gray-500"},"Avg. Conversion Rate"),i.createElement("p",{className:"text-2xl font-semibold text-gray-900"},"6.9%")),i.createElement("div",{className:"rounded-full bg-indigo-100 p-3 text-indigo-600"},i.createElement(Ta,{className:"h-6 w-6"}))),i.createElement("div",{className:"mt-4 flex items-center text-sm"},i.createElement(Ta,{className:"h-4 w-4 text-green-500"}),i.createElement("span",{className:"ml-1 text-green-500"},"+2.1%"),i.createElement("span",{className:"ml-1 text-gray-500"},"from last period")))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h2",{className:"mb-4 text-lg font-semibold text-gray-900"},"Performance Trends"),i.createElement("div",{className:"h-64 rounded-lg bg-gray-100 flex items-center justify-center"},i.createElement("p",{className:"text-gray-500"},"Performance chart visualization would appear here")),i.createElement("div",{className:"mt-4 flex justify-center space-x-4"},i.createElement("button",{className:"rounded-full bg-indigo-100 px-4 py-1 text-sm font-medium text-indigo-700"},"Views"),i.createElement("button",{className:"rounded-full px-4 py-1 text-sm font-medium text-gray-500 hover:bg-gray-100"},"Applications"),i.createElement("button",{className:"rounded-full px-4 py-1 text-sm font-medium text-gray-500 hover:bg-gray-100"},"Conversion Rate"),i.createElement("button",{className:"rounded-full px-4 py-1 text-sm font-medium text-gray-500 hover:bg-gray-100"},"Matches"))),i.createElement("div",{className:"space-y-4"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Gig Optimization"),r.map(o=>i.createElement("div",{key:o.id,className:"rounded-lg bg-white shadow"},i.createElement("div",{className:"flex cursor-pointer items-center justify-between p-4",onClick:()=>a(o.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-indigo-100 flex items-center justify-center"},i.createElement(Ca,{className:"h-6 w-6 text-indigo-600"})),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900"},o.title),i.createElement("p",{className:"text-sm text-gray-500"},o.client))),i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:"text-right"},i.createElement("p",{className:"text-sm font-medium text-gray-900"},o.conversionRate," conversion"),i.createElement("div",{className:"flex items-center justify-end"},o.trend==="up"?i.createElement(Ta,{className:"h-4 w-4 text-green-500"}):i.createElement(OW,{className:"h-4 w-4 text-red-500"}),i.createElement("span",{className:`ml-1 text-sm ${o.trend==="up"?"text-green-500":"text-red-500"}`},o.trendValue))),t===o.id?i.createElement(Zm,{className:"h-5 w-5 text-gray-400"}):i.createElement(Hu,{className:"h-5 w-5 text-gray-400"}))),t===o.id&&i.createElement("div",{className:"border-t border-gray-200 p-4"},i.createElement("div",{className:"mb-4 grid grid-cols-1 gap-4 sm:grid-cols-3"},i.createElement("div",{className:"rounded-lg bg-gray-50 p-3"},i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Views"),i.createElement("p",{className:"text-lg font-semibold text-gray-900"},o.views)),i.createElement("div",{className:"rounded-lg bg-gray-50 p-3"},i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Applications"),i.createElement("p",{className:"text-lg font-semibold text-gray-900"},o.applications)),i.createElement("div",{className:"rounded-lg bg-gray-50 p-3"},i.createElement("p",{className:"text-xs font-medium text-gray-500"},"Conversion Rate"),i.createElement("p",{className:"text-lg font-semibold text-gray-900"},o.conversionRate))),i.createElement("div",{className:"rounded-lg bg-indigo-50 p-4"},i.createElement("div",{className:"flex items-start"},i.createElement(Yu,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-indigo-900"},"AI Optimization Suggestions"),i.createElement("ul",{className:"mt-2 space-y-2"},o.suggestions.map((l,c)=>i.createElement("li",{key:c,className:"flex items-start"},l.type==="high"?i.createElement("span",{className:"mr-2 mt-0.5 h-2 w-2 rounded-full bg-red-500"}):l.type==="medium"?i.createElement("span",{className:"mr-2 mt-0.5 h-2 w-2 rounded-full bg-yellow-500"}):i.createElement("span",{className:"mr-2 mt-0.5 h-2 w-2 rounded-full bg-green-500"}),i.createElement("span",{className:"text-sm text-indigo-700"},l.text)))),i.createElement("div",{className:"mt-3 flex space-x-3"},i.createElement("button",{className:"rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Apply All"),i.createElement("button",{className:"rounded-md bg-white px-3 py-1.5 text-sm font-medium text-indigo-600 shadow-sm ring-1 ring-inset ring-indigo-300 hover:bg-indigo-50"},"Review Individually"))))))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h2",{className:"mb-4 text-lg font-semibold text-gray-900"},"Best Practices"),i.createElement("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2"},i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("h3",{className:"flex items-center text-base font-medium text-gray-900"},i.createElement(mt,{className:"mr-2 h-5 w-5 text-green-500"}),"High-Converting Gig Elements"),i.createElement("ul",{className:"mt-2 space-y-2 pl-7"},i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Clear, specific titles that include key skills"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Detailed project scope with measurable deliverables"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Competitive budget ranges based on market rates"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Clear timeline expectations with milestones"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Information about the client's company/team"))),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("h3",{className:"flex items-center text-base font-medium text-gray-900"},i.createElement(Sn,{className:"mr-2 h-5 w-5 text-red-500"}),"Common Conversion Blockers"),i.createElement("ul",{className:"mt-2 space-y-2 pl-7"},i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Vague or generic project descriptions"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Unrealistic budget expectations"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Too many required skills (skill bloat)"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Missing information about work environment"),i.createElement("li",{className:"flex items-center text-sm text-gray-700"},i.createElement(Un,{className:"mr-2 h-4 w-4 text-indigo-600"}),"Unclear communication expectations")))),i.createElement("div",{className:"mt-4 rounded-lg bg-gray-50 p-4"},i.createElement("h3",{className:"text-base font-medium text-gray-900"},"Resources"),i.createElement("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-2"},i.createElement("a",{href:"#",className:"flex items-center rounded-md p-2 text-sm text-indigo-600 hover:bg-indigo-50"},i.createElement(Jm,{className:"mr-2 h-4 w-4"}),"Guide: Writing High-Converting Gig Descriptions"),i.createElement("a",{href:"#",className:"flex items-center rounded-md p-2 text-sm text-indigo-600 hover:bg-indigo-50"},i.createElement(Jm,{className:"mr-2 h-4 w-4"}),"Template: Optimized Gig Structure"),i.createElement("a",{href:"#",className:"flex items-center rounded-md p-2 text-sm text-indigo-600 hover:bg-indigo-50"},i.createElement(Jm,{className:"mr-2 h-4 w-4"}),"Case Study: Top-Performing Gigs Analysis"),i.createElement("a",{href:"#",className:"flex items-center rounded-md p-2 text-sm text-indigo-600 hover:bg-indigo-50"},i.createElement(Jm,{className:"mr-2 h-4 w-4"}),"Webinar: Maximizing Gig Visibility and Conversions")))))},ni=Ie.create({baseURL:"http://localhost:3003/api",headers:{"Content-Type":"application/json"},timeout:3e4,validateStatus:t=>t>=200&&t<500});class Kr extends Error{constructor(e,n,s,r){super(e),this.code=n,this.status=s,this.details=r,this.name="PhoneNumberServiceError"}}const _R=t=>t!==null&&typeof t=="object"&&"response"in t,si=(t,e)=>{if(console.error(` Error in ${e}:`,t),_R(t)){const s=t.response?.status,r=t.response?.data;throw console.error(" Response status:",s),console.error(" Response data:",r),console.error(" Request config:",t.config),s===404?new Kr("Resource not found","NOT_FOUND",s,r):s===400?new Kr("Invalid request parameters","INVALID_PARAMETERS",s,r):s===401?new Kr("Authentication required","UNAUTHORIZED",s,r):s===403?new Kr("Operation not allowed","FORBIDDEN",s,r):s===429?new Kr("Rate limit exceeded","RATE_LIMIT",s,r):s&&s>=500?new Kr("Server error occurred","SERVER_ERROR",s,r):new Kr(t.message||"Unknown error occurred","UNKNOWN_ERROR",s,r)}const n=t instanceof Error?t.message:"Unknown error occurred";throw new Kr(n,"UNKNOWN_ERROR")},Xr={listPhoneNumbers:async t=>{try{const e=await ni.get(`/phone-numbers/gig/${t}/check`);return console.log(" Listed phone numbers:",e.data),e.data}catch(e){throw si(e,"listPhoneNumbers")}},searchPhoneNumbers:async(t,e="telnyx")=>{try{const n=e==="twilio"?"/phone-numbers/search/twilio":"/phone-numbers/search";console.log(` Searching ${e} numbers for ${t}`);const s=await ni.get(n,{params:{countryCode:t}});if(!s.data||typeof s.data=="string")return console.warn(" Invalid response format:",s.data),[];const r=s.data.map(a=>({...a,provider:e}));return console.log(` Found ${r.length} numbers for ${t}`),r}catch(n){return _R(n)&&n.response?.status===500?(console.warn(` ${e} API error, returning empty array`),[]):si(n,"searchPhoneNumbers")}},purchasePhoneNumber:async t=>{const{phoneNumber:e,provider:n,gigId:s,requirementGroupId:r,bundleSid:a,addressSid:o}=t;if(!s)throw new Kr("gigId is required to purchase a phone number","MISSING_PARAMETER");if(!e)throw new Kr("phoneNumber is required","MISSING_PARAMETER");if(!t.companyId)throw new Kr("companyId is required to purchase a phone number","MISSING_PARAMETER");if(n==="telnyx"&&!r)throw new Kr("requirementGroupId is required for Telnyx numbers","MISSING_PARAMETER");try{const l=n==="twilio"?"/phone-numbers/purchase/twilio":"/phone-numbers/purchase";console.log(` Purchasing ${n} number ${e} for gig ${s}`,r?`with requirement group ${r}`:"");const c={phoneNumber:e,provider:n,gigId:s,companyId:t.companyId,requirementGroupId:r};n==="twilio"&&(a&&(c.bundleSid=a),o&&(c.addressSid=o));const u=await ni.post(l,c);return console.log(" Purchase successful:",u.data),u.data}catch(l){return si(l,"purchasePhoneNumber")}},getTwilioRequirements:async(t,e="local")=>{try{return(await ni.get("/phone-numbers/twilio/requirements",{params:{countryCode:t,type:e}})).data}catch(n){return si(n,"getTwilioRequirements")}},createTwilioEndUser:async t=>{try{return(await ni.post("/phone-numbers/twilio/end-users",t)).data}catch(e){return si(e,"createTwilioEndUser")}},createTwilioDocument:async(t,e,n,s)=>{try{const r=new FormData;return r.append("file",t),r.append("friendlyName",e),r.append("type",n),r.append("attributes",JSON.stringify(s)),(await ni.post("/phone-numbers/twilio/documents",r,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(r){return si(r,"createTwilioDocument")}},createTwilioBundle:async t=>{try{return(await ni.post("/phone-numbers/twilio/bundles",t)).data}catch(e){return si(e,"createTwilioBundle")}},assignItemToBundle:async(t,e)=>{try{return(await ni.post(`/phone-numbers/twilio/bundles/${t}/items`,{objectSid:e})).data}catch(n){return si(n,"assignItemToBundle")}},submitTwilioBundle:async t=>{try{return(await ni.post(`/phone-numbers/twilio/bundles/${t}/submit`)).data}catch(e){return si(e,"submitTwilioBundle")}}},DR=t=>t!==null&&typeof t=="object"&&"response"in t,Yr={async checkCountryRequirements(t){try{console.log(` Checking requirements for ${t}`);const e=await Ie.get(`undefined/requirements/countries/${t}/requirements`);return console.log(" Requirements:",e.data),e.data}catch(e){throw console.error(" Error checking requirements:",e),e}},async getOrCreateGroup(t,e){try{console.log(` Getting/creating requirement group for ${t} in ${e}`);try{const n=await Ie.get(`undefined/requirement-groups/companies/${t}/zones/${e}`);return console.log(" Found existing group:",n.data),{group:n.data,isNew:!1}}catch(n){if(DR(n)&&n.response?.status===404){console.log(" No existing group found, creating new one...");try{const s=await Ie.post("undefined/requirement-groups",{companyId:t,destinationZone:e});return console.log(" Created new group:",s.data),{group:s.data,isNew:!0}}catch(s){if(DR(s)){if(s.response?.status===400)throw new Error(s.response.data.message||"Invalid request parameters");if(s.response?.status===409)return console.log(" Group was created by another request, retrying get..."),{group:(await Ie.get(`undefined/requirement-groups/companies/${t}/zones/${e}`)).data,isNew:!1}}throw s}}throw n}}catch(n){throw console.error(" Error getting/creating group:",n),n}},async submitDocument(t,e,n){try{console.log(` Submitting document for ${t}, field ${e}`);const s=new FormData;s.append("file",n);const r=await Ie.post(`undefined/requirements/groups/${t}/documents/${e}`,s,{headers:{"Content-Type":"multipart/form-data"}});return console.log(" Document submitted:",r.data),r.data}catch(s){throw console.error(" Error submitting document:",s),s}},async submitTextValue(t,e,n){try{console.log(` Submitting text value for ${t}, field ${e}`);const s=await Ie.post(`undefined/requirements/groups/${t}/values/${e}`,{value:n});return console.log(" Value submitted:",s.data),s.data}catch(s){throw console.error(" Error submitting value:",s),s}},async checkGroupStatus(t){try{console.log(` Checking status for group ${t}`);const e=await Ie.get(`undefined/requirements/groups/${t}/status`);return console.log(" Status:",e.data),e.data}catch(e){throw console.error(" Error checking status:",e),e}},async getDetailedGroupStatus(t){try{console.log(` Getting detailed status for group ${t}`);const e=await Ie.get(`undefined/requirement-groups/${t}/status`);return console.log(" Detailed status:",e.data),e.data}catch(e){throw console.error(" Error getting detailed status:",e),e}},async validateRequirements(t){try{console.log(` Validating requirements for group ${t}`);const e=await Ie.post(`undefined/requirements/groups/${t}/validate`);return console.log(" Validation result:",e.data),e.data}catch(e){throw console.error(" Error validating requirements:",e),e}}},G7=({requirements:t,existingValues:e,onSubmit:n,onCancel:s})=>{const[r,a]=N.useState(()=>!e||!Array.isArray(e)?{}:e.reduce((g,b)=>(b.value&&b.field&&(g[b.field]=b.value),g),{})),[o,l]=N.useState({}),[c,u]=N.useState(!1),[d,m]=N.useState(()=>!e||!Array.isArray(e)?{}:e.reduce((g,b)=>{if(b.value&&b.field)try{const w=JSON.parse(b.value);typeof w=="object"&&w!==null&&(g[b.field]=w)}catch{console.log("Not a JSON string for address field:",b.field)}return g},{})),h=(g,b)=>{a(w=>({...w,[g]:b})),l(w=>({...w,[g]:""}))},p=(g,b)=>{b&&(a(w=>({...w,[g]:b})),l(w=>({...w,[g]:""})))},f=()=>{const g={};let b=!0;return t.forEach(w=>{const v=r[w.id];if(!v){g[w.id]="This field is required",b=!1;return}if(w.type==="document"&&v instanceof File&&(v.size>5*1024*1024&&(g[w.id]="File size must be less than 5MB",b=!1),["image/jpeg","image/png","application/pdf"].includes(v.type)||(g[w.id]="Only JPG, PNG and PDF files are allowed",b=!1)),w.acceptance_criteria){const{min_length:E,max_length:k}=w.acceptance_criteria;typeof v=="string"&&(E&&v.length<E&&(g[w.id]=`Minimum length is ${E} characters`,b=!1),k&&v.length>k&&(g[w.id]=`Maximum length is ${k} characters`,b=!1))}}),l(g),b},y=async g=>{if(g.preventDefault(),!!f()){u(!0);try{await n(r)}catch(b){console.error("Error submitting requirements:",b),l(w=>({...w,submit:b instanceof Error?b.message:"Failed to submit requirements"}))}finally{u(!1)}}},x=g=>{const b=o[g.id],w=r[g.id],E=(()=>{switch(g.type){case"document":return hn;case"address":return to;case"textual":return g.name.toLowerCase().includes("contact")?Ql:g.name.toLowerCase().includes("business")?Ho:Zu;default:return hn}})();return i.createElement("div",{key:g.id,className:"space-y-4 bg-gray-50 p-6 rounded-lg border border-gray-200"},i.createElement("div",{className:"flex items-start justify-between"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(E,{className:"h-5 w-5 text-gray-400"}),i.createElement("label",{className:"block text-sm font-medium text-gray-700"},g.name,g.acceptance_criteria.time_limit&&i.createElement("span",{className:"ml-1 text-xs text-yellow-600"},"(within ",g.acceptance_criteria.time_limit,")"))),w&&!b&&i.createElement(mt,{className:"h-5 w-5 text-green-500"})),i.createElement("p",{className:"text-sm text-gray-500"},g.description),g.type==="document"?i.createElement("div",{className:"mt-1 flex items-center space-x-3"},i.createElement("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:k=>p(g.id,k.target.files?.[0]||null),className:"hidden",id:`file-${g.id}`}),i.createElement("label",{htmlFor:`file-${g.id}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},i.createElement(Xo,{className:"-ml-1 mr-2 h-5 w-5"}),"Choose File"),w instanceof File&&i.createElement("span",{className:"text-sm text-gray-500"},w.name)):i.createElement("div",{className:"mt-1"},g.type==="address"?i.createElement("div",{className:"space-y-2"},i.createElement("input",{type:"text",placeholder:"Street address",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:d[g.id]?.street||"",onChange:k=>{m(C=>({...C,[g.id]:{...C[g.id],street:k.target.value}})),h(g.id,JSON.stringify({...d[g.id],street:k.target.value}))}}),i.createElement("div",{className:"grid grid-cols-2 gap-2"},i.createElement("input",{type:"text",placeholder:"City",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:d[g.id]?.city||"",onChange:k=>{m(C=>({...C,[g.id]:{...C[g.id],city:k.target.value}})),h(g.id,JSON.stringify({...d[g.id],city:k.target.value}))}}),i.createElement("input",{type:"text",placeholder:"Postal code",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:d[g.id]?.postalCode||"",onChange:k=>{m(C=>({...C,[g.id]:{...C[g.id],postalCode:k.target.value}})),h(g.id,JSON.stringify({...d[g.id],postalCode:k.target.value}))}})),i.createElement("div",{className:"grid grid-cols-2 gap-2"},i.createElement("input",{type:"text",placeholder:"State/Province",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:d[g.id]?.state||"",onChange:k=>{m(C=>({...C,[g.id]:{...C[g.id],state:k.target.value}})),h(g.id,JSON.stringify({...d[g.id],state:k.target.value}))}}),i.createElement("input",{type:"text",placeholder:"Country",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",value:d[g.id]?.country||"",onChange:k=>{m(C=>({...C,[g.id]:{...C[g.id],country:k.target.value}})),h(g.id,JSON.stringify({...d[g.id],country:k.target.value}))}}))):i.createElement("input",{type:"text",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:g.example,value:typeof w=="string"?w:"",onChange:k=>h(g.id,k.target.value)})),b&&i.createElement("p",{className:"mt-1 text-sm text-red-600"},b),g.example&&!b&&i.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Example: ",g.example))};return i.createElement("form",{onSubmit:y,className:"space-y-6"},i.createElement("div",{className:"bg-white shadow sm:rounded-lg"},i.createElement("div",{className:"px-4 py-5 sm:p-6 space-y-8"},i.createElement("h3",{className:"text-lg font-medium leading-6 text-gray-900"},"Required Information"),i.createElement("div",{className:"mt-2 max-w-xl text-sm text-gray-500"},i.createElement("p",null,"Please provide the following information to purchase phone numbers in this region. All documents must be clear and legible.")),i.createElement("div",{className:"mt-5 space-y-6"},t.map(x)),o.submit&&i.createElement("div",{className:"mt-4 rounded-md bg-red-50 p-4"},i.createElement("div",{className:"flex"},i.createElement(Sn,{className:"h-5 w-5 text-red-400"}),i.createElement("div",{className:"ml-3"},i.createElement("h3",{className:"text-sm font-medium text-red-800"},"Error submitting requirements"),i.createElement("div",{className:"mt-2 text-sm text-red-700"},o.submit)))),i.createElement("div",{className:"mt-5 flex justify-end space-x-3"},i.createElement("button",{type:"button",onClick:s,className:"rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},"Cancel"),i.createElement("button",{type:"submit",disabled:c,className:"inline-flex justify-center rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50"},c?i.createElement(i.Fragment,null,i.createElement("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},i.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})),"Submitting..."):"Submit Requirements")))))},H7=({isOpen:t,onClose:e,purchaseStatus:n,purchaseResponse:s,selectedNumber:r,countryReq:a,requirementStatus:o,provider:l,purchaseError:c,onSubmitRequirements:u,onConfirmPurchase:d,onSetPurchaseStatus:m,onSetSelectedNumber:h,onSetShowPurchaseModal:p})=>{const[f,y]=i.useState(""),[x,g]=i.useState("");return i.useState(!1),i.useEffect(()=>{t&&(y(""),g(""))},[t]),t?i.createElement(i.Fragment,null,i.createElement("div",{className:"fixed inset-0 z-40 bg-black/50 backdrop-blur-sm pointer-events-none"}),i.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},i.createElement("div",{className:"w-full max-w-2xl rounded-lg bg-white shadow-2xl"},i.createElement("div",{className:"relative border-b border-gray-200 p-4"},i.createElement("h3",{className:"pr-8 text-lg font-medium text-gray-900"},n==="confirming"&&"Confirm Purchase",n==="requirements"&&"Complete Requirements",n==="purchasing"&&"Purchasing Number...",n==="success"&&"Purchase Successful!",n==="error"&&"Purchase Failed"),i.createElement("button",{onClick:()=>{p(!1),m("idle"),h(null)},className:"absolute right-4 top-4 text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500"},i.createElement("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})),i.createElement("span",{className:"sr-only"},"Close"))),i.createElement("div",{className:"max-h-[calc(100vh-16rem)] overflow-y-auto p-6"},n==="requirements"?i.createElement(G7,{requirements:a.requirements||[],onSubmit:u,onCancel:()=>{p(!1),m("idle"),h(null)}}):n==="confirming"&&i.createElement("div",{className:"space-y-4"},i.createElement("p",{className:"text-sm text-gray-500"},"Are you sure you want to purchase the number ",i.createElement("span",{className:"font-medium"},r),"?"),l==="telnyx"&&i.createElement("div",{className:`rounded-lg ${o.isComplete?"bg-green-50":"bg-yellow-50"} p-4`},i.createElement("div",{className:"flex"},o.isComplete?i.createElement(mt,{className:"h-5 w-5 text-green-400"}):i.createElement(Sn,{className:"h-5 w-5 text-yellow-400"}),i.createElement("div",{className:"ml-3"},i.createElement("p",{className:"text-sm text-gray-600"},o.isComplete?"Your company is approved to purchase numbers.":i.createElement(i.Fragment,null,"Requirements are needed for this number.",i.createElement("button",{onClick:()=>m("requirements"),className:"ml-2 text-indigo-600 hover:text-indigo-500"},"Complete now"))))))),n==="purchasing"&&i.createElement("div",{className:"flex items-center justify-center space-x-2"},i.createElement("div",{className:"h-6 w-6 animate-spin rounded-full border-b-2 border-indigo-600"}),i.createElement("p",{className:"text-sm text-gray-500"},"Processing your purchase...")),n==="success"&&i.createElement("div",{className:"text-center"},i.createElement(mt,{className:"mx-auto mb-4 h-12 w-12 text-green-500"}),i.createElement("p",{className:"text-sm text-gray-500"},"Number ",i.createElement("span",{className:"font-medium"},s?.phoneNumber||r)," has been ordered!"),i.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Status: ",i.createElement("span",{className:`font-medium ${s?.status==="active"?"text-green-600":s?.status==="pending"?"text-yellow-600":"text-gray-600"}`},s?.status||"Unknown")),i.createElement("div",{className:"mt-4 text-sm text-gray-500"},i.createElement("p",null,"Features:"),i.createElement("div",{className:"mt-2 flex justify-center space-x-4"},s?.features&&Object.entries(s.features).map(([b,w])=>i.createElement("span",{key:b,className:`px-2 py-1 rounded-full ${w?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},b)))),i.createElement("p",{className:"mt-4 text-xs text-gray-500"},"You can check the number status in the Purchased Numbers section.")),n==="error"&&i.createElement("div",{className:"text-center"},i.createElement(Sn,{className:"mx-auto mb-4 h-12 w-12 text-red-500"}),i.createElement("p",{className:"text-sm text-red-600"},c||"An error occurred while purchasing the number"),i.createElement("p",{className:"mt-2 text-sm text-gray-500"},"Please try again or contact support if the issue persists."),i.createElement("button",{onClick:()=>{m("confirming")},className:"mt-4 inline-flex items-center rounded-md bg-indigo-50 px-3 py-2 text-sm font-medium text-indigo-600 hover:bg-indigo-100"},"Try Again"))),i.createElement("div",{className:"border-t border-gray-200 p-4"},i.createElement("div",{className:"flex justify-end space-x-3"},n==="confirming"&&i.createElement(i.Fragment,null,i.createElement("button",{onClick:()=>{p(!1),m("idle"),h(null)},className:"rounded-md px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50"},"Cancel"),i.createElement("button",{onClick:()=>d({bundleSid:f,addressSid:x}),className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"},"Confirm Purchase")),(n==="error"||n==="success")&&i.createElement("button",{onClick:()=>{p(!1),m("idle"),h(null)},className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"},"Close")))))):null};var q7=Object.defineProperty,K7=(t,e,n)=>e in t?q7(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oE=(t,e,n)=>(K7(t,typeof e!="symbol"?e+"":e,n),n);let X7=class{constructor(){oE(this,"current",this.detect()),oE(this,"handoffState","pending"),oE(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},ri=new X7;function O0(t){var e,n;return ri.isServer?null:t?"ownerDocument"in t?t.ownerDocument:"current"in t?(n=(e=t.current)==null?void 0:e.ownerDocument)!=null?n:document:null:document}function L0(t){typeof queueMicrotask=="function"?queueMicrotask(t):Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e}))}function ai(){let t=[],e={addEventListener(n,s,r,a){return n.addEventListener(s,r,a),e.add(()=>n.removeEventListener(s,r,a))},requestAnimationFrame(...n){let s=requestAnimationFrame(...n);return e.add(()=>cancelAnimationFrame(s))},nextFrame(...n){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...n))},setTimeout(...n){let s=setTimeout(...n);return e.add(()=>clearTimeout(s))},microTask(...n){let s={current:!0};return L0(()=>{s.current&&n[0]()}),e.add(()=>{s.current=!1})},style(n,s,r){let a=n.style.getPropertyValue(s);return Object.assign(n.style,{[s]:r}),this.add(()=>{Object.assign(n.style,{[s]:a})})},group(n){let s=ai();return n(s),this.add(()=>s.dispose())},add(n){return t.includes(n)||t.push(n),()=>{let s=t.indexOf(n);if(s>=0)for(let r of t.splice(s,1))r()}},dispose(){for(let n of t.splice(0))n()}};return e}function z0(){let[t]=N.useState(ai);return N.useEffect(()=>()=>t.dispose(),[t]),t}let lr=(t,e)=>{ri.isServer?N.useEffect(t,e):N.useLayoutEffect(t,e)};function oc(t){let e=N.useRef(t);return lr(()=>{e.current=t},[t]),e}let tn=function(t){let e=oc(t);return i.useCallback((...n)=>e.current(...n),[e])};function mh(t){return N.useMemo(()=>t,Object.values(t))}let Y7=N.createContext(void 0);function Z7(){return N.useContext(Y7)}function iE(...t){return Array.from(new Set(t.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function oi(t,e,...n){if(t in e){let r=e[t];return typeof r=="function"?r(...n):r}let s=new Error(`Tried to handle "${t}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(r=>`"${r}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,oi),s}var B0=(t=>(t[t.None=0]="None",t[t.RenderStrategy=1]="RenderStrategy",t[t.Static=2]="Static",t))(B0||{}),Yi=(t=>(t[t.Unmount=0]="Unmount",t[t.Hidden=1]="Hidden",t))(Yi||{});function Zr(){let t=Q7();return N.useCallback(e=>J7({mergeRefs:t,...e}),[t])}function J7({ourProps:t,theirProps:e,slot:n,defaultTag:s,features:r,visible:a=!0,name:o,mergeRefs:l}){l=l??eH;let c=PR(e,t);if(a)return U0(c,n,s,o,l);let u=r??0;if(u&2){let{static:d=!1,...m}=c;if(d)return U0(m,n,s,o,l)}if(u&1){let{unmount:d=!0,...m}=c;return oi(d?0:1,{0(){return null},1(){return U0({...m,hidden:!0,style:{display:"none"}},n,s,o,l)}})}return U0(c,n,s,o,l)}function U0(t,e={},n,s,r){let{as:a=n,children:o,refName:l="ref",...c}=lE(t,["unmount","static"]),u=t.ref!==void 0?{[l]:t.ref}:{},d=typeof o=="function"?o(e):o;"className"in c&&c.className&&typeof c.className=="function"&&(c.className=c.className(e)),c["aria-labelledby"]&&c["aria-labelledby"]===c.id&&(c["aria-labelledby"]=void 0);let m={};if(e){let h=!1,p=[];for(let[f,y]of Object.entries(e))typeof y=="boolean"&&(h=!0),y===!0&&p.push(f.replace(/([A-Z])/g,x=>`-${x.toLowerCase()}`));if(h){m["data-headlessui-state"]=p.join(" ");for(let f of p)m[`data-${f}`]=""}}if(hh(a)&&(Object.keys(ic(c)).length>0||Object.keys(ic(m)).length>0))if(!N.isValidElement(d)||Array.isArray(d)&&d.length>1||nH(d)){if(Object.keys(ic(c)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${s} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(ic(c)).concat(Object.keys(ic(m))).map(h=>`  - ${h}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(h=>`  - ${h}`).join(`
`)].join(`
`))}else{let h=d.props,p=h?.className,f=typeof p=="function"?(...g)=>iE(p(...g),c.className):iE(p,c.className),y=f?{className:f}:{},x=PR(d.props,ic(lE(c,["ref"])));for(let g in m)g in x&&delete m[g];return N.cloneElement(d,Object.assign({},x,m,u,{ref:r(tH(d),u.ref)},y))}return N.createElement(a,Object.assign({},lE(c,["ref"]),!hh(a)&&u,!hh(a)&&m),d)}function Q7(){let t=N.useRef([]),e=N.useCallback(n=>{for(let s of t.current)s!=null&&(typeof s=="function"?s(n):s.current=n)},[]);return(...n)=>{if(!n.every(s=>s==null))return t.current=n,e}}function eH(...t){return t.every(e=>e==null)?void 0:e=>{for(let n of t)n!=null&&(typeof n=="function"?n(e):n.current=e)}}function PR(...t){if(t.length===0)return{};if(t.length===1)return t[0];let e={},n={};for(let s of t)for(let r in s)r.startsWith("on")&&typeof s[r]=="function"?(n[r]!=null||(n[r]=[]),n[r].push(s[r])):e[r]=s[r];if(e.disabled||e["aria-disabled"])for(let s in n)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(s)&&(n[s]=[r=>{var a;return(a=r?.preventDefault)==null?void 0:a.call(r)}]);for(let s in n)Object.assign(e,{[s](r,...a){let o=n[s];for(let l of o){if((r instanceof Event||r?.nativeEvent instanceof Event)&&r.defaultPrevented)return;l(r,...a)}}});return e}function cr(t){var e;return Object.assign(N.forwardRef(t),{displayName:(e=t.displayName)!=null?e:t.name})}function ic(t){let e=Object.assign({},t);for(let n in e)e[n]===void 0&&delete e[n];return e}function lE(t,e=[]){let n=Object.assign({},t);for(let s of e)s in n&&delete n[s];return n}function tH(t){return i.version.split(".")[0]>="19"?t.props.ref:t.ref}function hh(t){return t===N.Fragment||t===Symbol.for("react.fragment")}function nH(t){return hh(t.type)}let sH="span";var V0=(t=>(t[t.None=1]="None",t[t.Focusable=2]="Focusable",t[t.Hidden=4]="Hidden",t))(V0||{});function rH(t,e){var n;let{features:s=1,...r}=t,a={ref:e,"aria-hidden":(s&2)===2?!0:(n=r["aria-hidden"])!=null?n:void 0,hidden:(s&4)===4?!0:void 0,style:{position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0",...(s&4)===4&&(s&2)!==2&&{display:"none"}}};return Zr()({ourProps:a,theirProps:r,slot:{},defaultTag:sH,name:"Hidden"})}let cE=cr(rH);function aH(t){return typeof t!="object"||t===null?!1:"nodeType"in t}function Zi(t){return aH(t)&&"tagName"in t}function lc(t){return Zi(t)&&"accessKey"in t}function Ji(t){return Zi(t)&&"tabIndex"in t}function oH(t){return Zi(t)&&"style"in t}function iH(t){return lc(t)&&t.nodeName==="IFRAME"}function lH(t){return lc(t)&&t.nodeName==="INPUT"}let FR=Symbol();function cH(t,e=!0){return Object.assign(t,{[FR]:e})}function ro(...t){let e=N.useRef(t);N.useEffect(()=>{e.current=t},[t]);let n=tn(s=>{for(let r of e.current)r!=null&&(typeof r=="function"?r(s):r.current=s)});return t.every(s=>s==null||s?.[FR])?void 0:n}let uE=N.createContext(null);uE.displayName="DescriptionContext";function MR(){let t=N.useContext(uE);if(t===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,MR),e}return t}function uH(){let[t,e]=N.useState([]);return[t.length>0?t.join(" "):void 0,N.useMemo(()=>function(n){let s=tn(a=>(e(o=>[...o,a]),()=>e(o=>{let l=o.slice(),c=l.indexOf(a);return c!==-1&&l.splice(c,1),l}))),r=N.useMemo(()=>({register:s,slot:n.slot,name:n.name,props:n.props,value:n.value}),[s,n.slot,n.name,n.props,n.value]);return i.createElement(uE.Provider,{value:r},n.children)},[e])]}let dH="p";function mH(t,e){let n=N.useId(),s=Z7(),{id:r=`headlessui-description-${n}`,...a}=t,o=MR(),l=ro(e);lr(()=>o.register(r),[r,o.register]);let c=mh({...o.slot,disabled:s||!1}),u={ref:l,...o.props,id:r};return Zr()({ourProps:u,theirProps:a,slot:c,defaultTag:dH,name:o.name||"Description"})}let hH=cr(mH),pH=Object.assign(hH,{});var OR=(t=>(t.Space=" ",t.Enter="Enter",t.Escape="Escape",t.Backspace="Backspace",t.Delete="Delete",t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t.Home="Home",t.End="End",t.PageUp="PageUp",t.PageDown="PageDown",t.Tab="Tab",t))(OR||{});let fH=N.createContext(()=>{});function gH({value:t,children:e}){return i.createElement(fH.Provider,{value:t},e)}let LR=class extends Map{constructor(e){super(),this.factory=e}get(e){let n=super.get(e);return n===void 0&&(n=this.factory(e),this.set(e,n)),n}};var xH=Object.defineProperty,yH=(t,e,n)=>e in t?xH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bH=(t,e,n)=>(yH(t,e+"",n),n),zR=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},Jr=(t,e,n)=>(zR(t,e,"read from private field"),n?n.call(t):e.get(t)),dE=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},BR=(t,e,n,s)=>(zR(t,e,"write to private field"),e.set(t,n),n),ao,ph,fh;let wH=class{constructor(e){dE(this,ao,{}),dE(this,ph,new LR(()=>new Set)),dE(this,fh,new Set),bH(this,"disposables",ai()),BR(this,ao,e),ri.isServer&&this.disposables.microTask(()=>{this.dispose()})}dispose(){this.disposables.dispose()}get state(){return Jr(this,ao)}subscribe(e,n){if(ri.isServer)return()=>{};let s={selector:e,callback:n,current:e(Jr(this,ao))};return Jr(this,fh).add(s),this.disposables.add(()=>{Jr(this,fh).delete(s)})}on(e,n){return ri.isServer?()=>{}:(Jr(this,ph).get(e).add(n),this.disposables.add(()=>{Jr(this,ph).get(e).delete(n)}))}send(e){let n=this.reduce(Jr(this,ao),e);if(n!==Jr(this,ao)){BR(this,ao,n);for(let s of Jr(this,fh)){let r=s.selector(Jr(this,ao));UR(s.current,r)||(s.current=r,s.callback(r))}for(let s of Jr(this,ph).get(e.type))s(Jr(this,ao),e)}}};ao=new WeakMap,ph=new WeakMap,fh=new WeakMap;function UR(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:Array.isArray(t)&&Array.isArray(e)?t.length!==e.length?!1:mE(t[Symbol.iterator](),e[Symbol.iterator]()):t instanceof Map&&e instanceof Map||t instanceof Set&&e instanceof Set?t.size!==e.size?!1:mE(t.entries(),e.entries()):VR(t)&&VR(e)?mE(Object.entries(t)[Symbol.iterator](),Object.entries(e)[Symbol.iterator]()):!1}function mE(t,e){do{let n=t.next(),s=e.next();if(n.done&&s.done)return!0;if(n.done||s.done||!Object.is(n.value,s.value))return!1}while(!0)}function VR(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||Object.getPrototypeOf(e)===null}var vH=Object.defineProperty,EH=(t,e,n)=>e in t?vH(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,WR=(t,e,n)=>(EH(t,typeof e!="symbol"?e+"":e,n),n),NH=(t=>(t[t.Push=0]="Push",t[t.Pop=1]="Pop",t))(NH||{});let kH={0(t,e){let n=e.id,s=t.stack,r=t.stack.indexOf(n);if(r!==-1){let a=t.stack.slice();return a.splice(r,1),a.push(n),s=a,{...t,stack:s}}return{...t,stack:[...t.stack,n]}},1(t,e){let n=e.id,s=t.stack.indexOf(n);if(s===-1)return t;let r=t.stack.slice();return r.splice(s,1),{...t,stack:r}}},SH=class LB extends wH{constructor(){super(...arguments),WR(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),WR(this,"selectors",{isTop:(e,n)=>e.stack[e.stack.length-1]===n,inStack:(e,n)=>e.stack.includes(n)})}static new(){return new LB({stack:[]})}reduce(e,n){return oi(n.type,kH,e,n)}};const jR=new LR(()=>SH.new());var GR={exports:{}},HR={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gh=N;function CH(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var IH=typeof Object.is=="function"?Object.is:CH,$H=gh.useSyncExternalStore,TH=gh.useRef,AH=gh.useEffect,RH=gh.useMemo,_H=gh.useDebugValue;HR.useSyncExternalStoreWithSelector=function(t,e,n,s,r){var a=TH(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=RH(function(){function c(p){if(!u){if(u=!0,d=p,p=s(p),r!==void 0&&o.hasValue){var f=o.value;if(r(f,p))return m=f}return m=p}if(f=m,IH(d,p))return f;var y=s(p);return r!==void 0&&r(f,y)?(d=p,f):(d=p,m=y)}var u=!1,d,m,h=n===void 0?null:n;return[function(){return c(e())},h===null?void 0:function(){return c(h())}]},[e,n,s,r]);var l=$H(t,a[0],a[1]);return AH(function(){o.hasValue=!0,o.value=l},[l]),_H(l),l},GR.exports=HR;var DH=GR.exports;function qR(t,e,n=UR){return DH.useSyncExternalStoreWithSelector(tn(s=>t.subscribe(PH,s)),tn(()=>t.state),tn(()=>t.state),tn(e),n)}function PH(t){return t}function xh(t,e){let n=N.useId(),s=jR.get(e),[r,a]=qR(s,N.useCallback(o=>[s.selectors.isTop(o,n),s.selectors.inStack(o,n)],[s,n]));return lr(()=>{if(t)return s.actions.push(n),()=>s.actions.pop(n)},[s,t,n]),t?a?r:!0:!1}let hE=new Map,yh=new Map;function KR(t){var e;let n=(e=yh.get(t))!=null?e:0;return yh.set(t,n+1),n!==0?()=>XR(t):(hE.set(t,{"aria-hidden":t.getAttribute("aria-hidden"),inert:t.inert}),t.setAttribute("aria-hidden","true"),t.inert=!0,()=>XR(t))}function XR(t){var e;let n=(e=yh.get(t))!=null?e:1;if(n===1?yh.delete(t):yh.set(t,n-1),n!==1)return;let s=hE.get(t);s&&(s["aria-hidden"]===null?t.removeAttribute("aria-hidden"):t.setAttribute("aria-hidden",s["aria-hidden"]),t.inert=s.inert,hE.delete(t))}function FH(t,{allowed:e,disallowed:n}={}){let s=xh(t,"inert-others");lr(()=>{var r,a;if(!s)return;let o=ai();for(let c of(r=n?.())!=null?r:[])c&&o.add(KR(c));let l=(a=e?.())!=null?a:[];for(let c of l){if(!c)continue;let u=O0(c);if(!u)continue;let d=c.parentElement;for(;d&&d!==u.body;){for(let m of d.children)l.some(h=>m.contains(h))||o.add(KR(m));d=d.parentElement}}return o.dispose},[s,e,n])}function MH(t,e,n){let s=oc(r=>{let a=r.getBoundingClientRect();a.x===0&&a.y===0&&a.width===0&&a.height===0&&n()});N.useEffect(()=>{if(!t)return;let r=e===null?null:lc(e)?e:e.current;if(!r)return;let a=ai();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>s.current(r));o.observe(r),a.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>s.current(r));o.observe(r),a.add(()=>o.disconnect())}return()=>a.dispose()},[e,s,t])}let W0=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","details>summary","textarea:not([disabled])"].map(t=>`${t}:not([tabindex='-1'])`).join(","),OH=["[data-autofocus]"].map(t=>`${t}:not([tabindex='-1'])`).join(",");var ii=(t=>(t[t.First=1]="First",t[t.Previous=2]="Previous",t[t.Next=4]="Next",t[t.Last=8]="Last",t[t.WrapAround=16]="WrapAround",t[t.NoScroll=32]="NoScroll",t[t.AutoFocus=64]="AutoFocus",t))(ii||{}),pE=(t=>(t[t.Error=0]="Error",t[t.Overflow=1]="Overflow",t[t.Success=2]="Success",t[t.Underflow=3]="Underflow",t))(pE||{}),LH=(t=>(t[t.Previous=-1]="Previous",t[t.Next=1]="Next",t))(LH||{});function zH(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(W0)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}function BH(t=document.body){return t==null?[]:Array.from(t.querySelectorAll(OH)).sort((e,n)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(n.tabIndex||Number.MAX_SAFE_INTEGER)))}var YR=(t=>(t[t.Strict=0]="Strict",t[t.Loose=1]="Loose",t))(YR||{});function UH(t,e=0){var n;return t===((n=O0(t))==null?void 0:n.body)?!1:oi(e,{0(){return t.matches(W0)},1(){let s=t;for(;s!==null;){if(s.matches(W0))return!0;s=s.parentElement}return!1}})}var VH=(t=>(t[t.Keyboard=0]="Keyboard",t[t.Mouse=1]="Mouse",t))(VH||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",t=>{t.metaKey||t.altKey||t.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",t=>{t.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:t.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function li(t){t?.focus({preventScroll:!0})}let WH=["textarea","input"].join(",");function jH(t){var e,n;return(n=(e=t?.matches)==null?void 0:e.call(t,WH))!=null?n:!1}function GH(t,e=n=>n){return t.slice().sort((n,s)=>{let r=e(n),a=e(s);if(r===null||a===null)return 0;let o=r.compareDocumentPosition(a);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function bh(t,e,{sorted:n=!0,relativeTo:s=null,skipElements:r=[]}={}){let a=Array.isArray(t)?t.length>0?t[0].ownerDocument:document:t.ownerDocument,o=Array.isArray(t)?n?GH(t):t:e&64?BH(t):zH(t);r.length>0&&o.length>1&&(o=o.filter(p=>!r.some(f=>f!=null&&"current"in f?f?.current===p:f===p))),s=s??a.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(s))-1;if(e&4)return Math.max(0,o.indexOf(s))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=e&32?{preventScroll:!0}:{},d=0,m=o.length,h;do{if(d>=m||d+m<=0)return 0;let p=c+d;if(e&16)p=(p+m)%m;else{if(p<0)return 3;if(p>=m)return 1}h=o[p],h?.focus(u),d+=l}while(h!==a.activeElement);return e&6&&jH(h)&&h.select(),2}function ZR(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function HH(){return/Android/gi.test(window.navigator.userAgent)}function JR(){return ZR()||HH()}function j0(t,e,n,s){let r=oc(n);N.useEffect(()=>{if(!t)return;function a(o){r.current(o)}return document.addEventListener(e,a,s),()=>document.removeEventListener(e,a,s)},[t,e,s])}function QR(t,e,n,s){let r=oc(n);N.useEffect(()=>{if(!t)return;function a(o){r.current(o)}return window.addEventListener(e,a,s),()=>window.removeEventListener(e,a,s)},[t,e,s])}const e_=30;function qH(t,e,n){let s=oc(n),r=N.useCallback(function(l,c){if(l.defaultPrevented)return;let u=c(l);if(u===null||!u.getRootNode().contains(u)||!u.isConnected)return;let d=function m(h){return typeof h=="function"?m(h()):Array.isArray(h)||h instanceof Set?h:[h]}(e);for(let m of d)if(m!==null&&(m.contains(u)||l.composed&&l.composedPath().includes(m)))return;return!UH(u,YR.Loose)&&u.tabIndex!==-1&&l.preventDefault(),s.current(l,u)},[s,e]),a=N.useRef(null);j0(t,"pointerdown",l=>{var c,u;JR()||(a.current=((u=(c=l.composedPath)==null?void 0:c.call(l))==null?void 0:u[0])||l.target)},!0),j0(t,"pointerup",l=>{if(JR()||!a.current)return;let c=a.current;return a.current=null,r(l,()=>c)},!0);let o=N.useRef({x:0,y:0});j0(t,"touchstart",l=>{o.current.x=l.touches[0].clientX,o.current.y=l.touches[0].clientY},!0),j0(t,"touchend",l=>{let c={x:l.changedTouches[0].clientX,y:l.changedTouches[0].clientY};if(!(Math.abs(c.x-o.current.x)>=e_||Math.abs(c.y-o.current.y)>=e_))return r(l,()=>Ji(l.target)?l.target:null)},!0),QR(t,"blur",l=>r(l,()=>iH(window.document.activeElement)?window.document.activeElement:null),!0)}function G0(...t){return N.useMemo(()=>O0(...t),[...t])}function t_(t,e,n,s){let r=oc(n);N.useEffect(()=>{t=t??window;function a(o){r.current(o)}return t.addEventListener(e,a,s),()=>t.removeEventListener(e,a,s)},[t,e,s])}function KH(t){return N.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getSnapshot)}function XH(t,e){let n=t(),s=new Set;return{getSnapshot(){return n},subscribe(r){return s.add(r),()=>s.delete(r)},dispatch(r,...a){let o=e[r].call(n,...a);o&&(n=o,s.forEach(l=>l()))}}}function YH(){let t;return{before({doc:e}){var n;let s=e.documentElement,r=(n=e.defaultView)!=null?n:window;t=Math.max(0,r.innerWidth-s.clientWidth)},after({doc:e,d:n}){let s=e.documentElement,r=Math.max(0,s.clientWidth-s.offsetWidth),a=Math.max(0,t-r);n.style(s,"paddingRight",`${a}px`)}}}function ZH(){return ZR()?{before({doc:t,d:e,meta:n}){function s(r){return n.containers.flatMap(a=>a()).some(a=>a.contains(r))}e.microTask(()=>{var r;if(window.getComputedStyle(t.documentElement).scrollBehavior!=="auto"){let l=ai();l.style(t.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let a=(r=window.scrollY)!=null?r:window.pageYOffset,o=null;e.addEventListener(t,"click",l=>{if(Ji(l.target))try{let c=l.target.closest("a");if(!c)return;let{hash:u}=new URL(c.href),d=t.querySelector(u);Ji(d)&&!s(d)&&(o=d)}catch{}},!0),e.addEventListener(t,"touchstart",l=>{if(Ji(l.target)&&oH(l.target))if(s(l.target)){let c=l.target;for(;c.parentElement&&s(c.parentElement);)c=c.parentElement;e.style(c,"overscrollBehavior","contain")}else e.style(l.target,"touchAction","none")}),e.addEventListener(t,"touchmove",l=>{if(Ji(l.target)){if(lH(l.target))return;if(s(l.target)){let c=l.target;for(;c.parentElement&&c.dataset.headlessuiPortal!==""&&!(c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth);)c=c.parentElement;c.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let c=(l=window.scrollY)!=null?l:window.pageYOffset;a!==c&&window.scrollTo(0,a),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function JH(){return{before({doc:t,d:e}){e.style(t.documentElement,"overflow","hidden")}}}function QH(t){let e={};for(let n of t)Object.assign(e,n(e));return e}let cc=XH(()=>new Map,{PUSH(t,e){var n;let s=(n=this.get(t))!=null?n:{doc:t,count:0,d:ai(),meta:new Set};return s.count++,s.meta.add(e),this.set(t,s),this},POP(t,e){let n=this.get(t);return n&&(n.count--,n.meta.delete(e)),this},SCROLL_PREVENT({doc:t,d:e,meta:n}){let s={doc:t,d:e,meta:QH(n)},r=[ZH(),YH(),JH()];r.forEach(({before:a})=>a?.(s)),r.forEach(({after:a})=>a?.(s))},SCROLL_ALLOW({d:t}){t.dispose()},TEARDOWN({doc:t}){this.delete(t)}});cc.subscribe(()=>{let t=cc.getSnapshot(),e=new Map;for(let[n]of t)e.set(n,n.documentElement.style.overflow);for(let n of t.values()){let s=e.get(n.doc)==="hidden",r=n.count!==0;(r&&!s||!r&&s)&&cc.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),n.count===0&&cc.dispatch("TEARDOWN",n)}});function e9(t,e,n=()=>({containers:[]})){let s=KH(cc),r=e?s.get(e):void 0,a=r?r.count>0:!1;return lr(()=>{if(!(!e||!t))return cc.dispatch("PUSH",e,n),()=>cc.dispatch("POP",e,n)},[t,e]),a}function t9(t,e,n=()=>[document.body]){let s=xh(t,"scroll-lock");e9(s,e,r=>{var a;return{containers:[...(a=r.containers)!=null?a:[],n]}})}function n9(t=0){let[e,n]=N.useState(t),s=N.useCallback(c=>n(c),[]),r=N.useCallback(c=>n(u=>u|c),[]),a=N.useCallback(c=>(e&c)===c,[e]),o=N.useCallback(c=>n(u=>u&~c),[]),l=N.useCallback(c=>n(u=>u^c),[]);return{flags:e,setFlag:s,addFlag:r,hasFlag:a,removeFlag:o,toggleFlag:l}}var s9={},n_,s_;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((n_=process==null?void 0:s9)==null?void 0:n_.NODE_ENV)==="test"&&typeof((s_=Element?.prototype)==null?void 0:s_.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var r9=(t=>(t[t.None=0]="None",t[t.Closed=1]="Closed",t[t.Enter=2]="Enter",t[t.Leave=4]="Leave",t))(r9||{});function a9(t){let e={};for(let n in t)t[n]===!0&&(e[`data-${n}`]="");return e}function o9(t,e,n,s){let[r,a]=N.useState(n),{hasFlag:o,addFlag:l,removeFlag:c}=n9(t&&r?3:0),u=N.useRef(!1),d=N.useRef(!1),m=z0();return lr(()=>{var h;if(t){if(n&&a(!0),!e){n&&l(3);return}return(h=s?.start)==null||h.call(s,n),i9(e,{inFlight:u,prepare(){d.current?d.current=!1:d.current=u.current,u.current=!0,!d.current&&(n?(l(3),c(4)):(l(4),c(2)))},run(){d.current?n?(c(3),l(4)):(c(4),l(3)):n?c(1):l(1)},done(){var p;d.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(u.current=!1,c(7),n||a(!1),(p=s?.end)==null||p.call(s,n))}})}},[t,n,e,m]),t?[r,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function i9(t,{prepare:e,run:n,done:s,inFlight:r}){let a=ai();return c9(t,{prepare:e,inFlight:r}),a.nextFrame(()=>{n(),a.requestAnimationFrame(()=>{a.add(l9(t,s))})}),a.dispose}function l9(t,e){var n,s;let r=ai();if(!t)return r.dispose;let a=!1;r.add(()=>{a=!0});let o=(s=(n=t.getAnimations)==null?void 0:n.call(t).filter(l=>l instanceof CSSTransition))!=null?s:[];return o.length===0?(e(),r.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{a||e()}),r.dispose)}function c9(t,{inFlight:e,prepare:n}){if(e!=null&&e.current){n();return}let s=t.style.transition;t.style.transition="none",n(),t.offsetHeight,t.style.transition=s}function fE(t,e){let n=N.useRef([]),s=tn(t);N.useEffect(()=>{let r=[...n.current];for(let[a,o]of e.entries())if(n.current[a]!==o){let l=s(e,r);return n.current=e,l}},[s,...e])}let H0=N.createContext(null);H0.displayName="OpenClosedContext";var _a=(t=>(t[t.Open=1]="Open",t[t.Closed=2]="Closed",t[t.Closing=4]="Closing",t[t.Opening=8]="Opening",t))(_a||{});function q0(){return N.useContext(H0)}function u9({value:t,children:e}){return i.createElement(H0.Provider,{value:t},e)}function d9({children:t}){return i.createElement(H0.Provider,{value:null},t)}function m9(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let Qi=[];m9(()=>{function t(e){if(!Ji(e.target)||e.target===document.body||Qi[0]===e.target)return;let n=e.target;n=n.closest(W0),Qi.unshift(n??e.target),Qi=Qi.filter(s=>s!=null&&s.isConnected),Qi.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function r_(t){let e=tn(t),n=N.useRef(!1);N.useEffect(()=>(n.current=!1,()=>{n.current=!0,L0(()=>{n.current&&e()})}),[e])}let a_=N.createContext(!1);function h9(){return N.useContext(a_)}function o_(t){return i.createElement(a_.Provider,{value:t.force},t.children)}function p9(t){let e=h9(),n=N.useContext(l_),[s,r]=N.useState(()=>{var a;if(!e&&n!==null)return(a=n.current)!=null?a:null;if(ri.isServer)return null;let o=t?.getElementById("headlessui-portal-root");if(o)return o;if(t===null)return null;let l=t.createElement("div");return l.setAttribute("id","headlessui-portal-root"),t.body.appendChild(l)});return N.useEffect(()=>{s!==null&&(t!=null&&t.body.contains(s)||t==null||t.body.appendChild(s))},[s,t]),N.useEffect(()=>{e||n!==null&&r(n.current)},[n,r,e]),s}let i_=N.Fragment,f9=cr(function(t,e){let{ownerDocument:n=null,...s}=t,r=N.useRef(null),a=ro(cH(h=>{r.current=h}),e),o=G0(r),l=n??o,c=p9(l),u=N.useContext(gE),d=z0(),m=Zr();return r_(()=>{var h;c&&c.childNodes.length<=0&&((h=c.parentElement)==null||h.removeChild(c))}),c?YT.createPortal(i.createElement("div",{"data-headlessui-portal":"",ref:h=>{d.dispose(),u&&h&&d.add(u.register(h))}},m({ourProps:{ref:a},theirProps:s,slot:{},defaultTag:i_,name:"Portal"})),c):null});function g9(t,e){let n=ro(e),{enabled:s=!0,ownerDocument:r,...a}=t,o=Zr();return s?i.createElement(f9,{...a,ownerDocument:r,ref:n}):o({ourProps:{ref:n},theirProps:a,slot:{},defaultTag:i_,name:"Portal"})}let x9=N.Fragment,l_=N.createContext(null);function y9(t,e){let{target:n,...s}=t,r={ref:ro(e)},a=Zr();return i.createElement(l_.Provider,{value:n},a({ourProps:r,theirProps:s,defaultTag:x9,name:"Popover.Group"}))}let gE=N.createContext(null);function b9(){let t=N.useContext(gE),e=N.useRef([]),n=tn(a=>(e.current.push(a),t&&t.register(a),()=>s(a))),s=tn(a=>{let o=e.current.indexOf(a);o!==-1&&e.current.splice(o,1),t&&t.unregister(a)}),r=N.useMemo(()=>({register:n,unregister:s,portals:e}),[n,s,e]);return[e,N.useMemo(()=>function({children:a}){return i.createElement(gE.Provider,{value:r},a)},[r])]}let w9=cr(g9),c_=cr(y9),v9=Object.assign(w9,{Group:c_});function E9(t,e=typeof document<"u"?document.defaultView:null,n){let s=xh(t,"escape");t_(e,"keydown",r=>{s&&(r.defaultPrevented||r.key===OR.Escape&&n(r))})}function N9(){var t;let[e]=N.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[n,s]=N.useState((t=e?.matches)!=null?t:!1);return lr(()=>{if(!e)return;function r(a){s(a.matches)}return e.addEventListener("change",r),()=>e.removeEventListener("change",r)},[e]),n}function k9({defaultContainers:t=[],portals:e,mainTreeNode:n}={}){let s=G0(n),r=tn(()=>{var a,o;let l=[];for(let c of t)c!==null&&(Zi(c)?l.push(c):"current"in c&&Zi(c.current)&&l.push(c.current));if(e!=null&&e.current)for(let c of e.current)l.push(c);for(let c of(a=s?.querySelectorAll("html > *, body > *"))!=null?a:[])c!==document.body&&c!==document.head&&Zi(c)&&c.id!=="headlessui-portal-root"&&(n&&(c.contains(n)||c.contains((o=n?.getRootNode())==null?void 0:o.host))||l.some(u=>c.contains(u))||l.push(c));return l});return{resolveContainers:r,contains:tn(a=>r().some(o=>o.contains(a)))}}let u_=N.createContext(null);function d_({children:t,node:e}){let[n,s]=N.useState(null),r=m_(e??n);return i.createElement(u_.Provider,{value:r},t,r===null&&i.createElement(cE,{features:V0.Hidden,ref:a=>{var o,l;if(a){for(let c of(l=(o=O0(a))==null?void 0:o.querySelectorAll("html > *, body > *"))!=null?l:[])if(c!==document.body&&c!==document.head&&Zi(c)&&c!=null&&c.contains(a)){s(c);break}}}}))}function m_(t=null){var e;return(e=N.useContext(u_))!=null?e:t}function S9(){let t=typeof document>"u";return"useSyncExternalStore"in VC?(e=>e.useSyncExternalStore)(VC)(()=>()=>{},()=>!1,()=>!t):!1}function K0(){let t=S9(),[e,n]=N.useState(ri.isHandoffComplete);return e&&ri.isHandoffComplete===!1&&n(!1),N.useEffect(()=>{e!==!0&&n(!0)},[e]),N.useEffect(()=>ri.handoff(),[]),t?!1:e}function xE(){let t=N.useRef(!1);return lr(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var wh=(t=>(t[t.Forwards=0]="Forwards",t[t.Backwards=1]="Backwards",t))(wh||{});function C9(){let t=N.useRef(0);return QR(!0,"keydown",e=>{e.key==="Tab"&&(t.current=e.shiftKey?1:0)},!0),t}function h_(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let n of t.current)Zi(n.current)&&e.add(n.current);return e}let I9="div";var uc=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(uc||{});function $9(t,e){let n=N.useRef(null),s=ro(n,e),{initialFocus:r,initialFocusFallback:a,containers:o,features:l=15,...c}=t;K0()||(l=0);let u=G0(n);_9(l,{ownerDocument:u});let d=D9(l,{ownerDocument:u,container:n,initialFocus:r,initialFocusFallback:a});P9(l,{ownerDocument:u,container:n,containers:o,previousActiveElement:d});let m=C9(),h=tn(b=>{if(!lc(n.current))return;let w=n.current;(v=>v())(()=>{oi(m.current,{[wh.Forwards]:()=>{bh(w,ii.First,{skipElements:[b.relatedTarget,a]})},[wh.Backwards]:()=>{bh(w,ii.Last,{skipElements:[b.relatedTarget,a]})}})})}),p=xh(!!(l&2),"focus-trap#tab-lock"),f=z0(),y=N.useRef(!1),x={ref:s,onKeyDown(b){b.key=="Tab"&&(y.current=!0,f.requestAnimationFrame(()=>{y.current=!1}))},onBlur(b){if(!(l&4))return;let w=h_(o);lc(n.current)&&w.add(n.current);let v=b.relatedTarget;Ji(v)&&v.dataset.headlessuiFocusGuard!=="true"&&(p_(w,v)||(y.current?bh(n.current,oi(m.current,{[wh.Forwards]:()=>ii.Next,[wh.Backwards]:()=>ii.Previous})|ii.WrapAround,{relativeTo:b.target}):Ji(b.target)&&li(b.target)))}},g=Zr();return i.createElement(i.Fragment,null,p&&i.createElement(cE,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:V0.Focusable}),g({ourProps:x,theirProps:c,defaultTag:I9,name:"FocusTrap"}),p&&i.createElement(cE,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:h,features:V0.Focusable}))}let T9=cr($9),A9=Object.assign(T9,{features:uc});function R9(t=!0){let e=N.useRef(Qi.slice());return fE(([n],[s])=>{s===!0&&n===!1&&L0(()=>{e.current.splice(0)}),s===!1&&n===!0&&(e.current=Qi.slice())},[t,Qi,e]),tn(()=>{var n;return(n=e.current.find(s=>s!=null&&s.isConnected))!=null?n:null})}function _9(t,{ownerDocument:e}){let n=!!(t&8),s=R9(n);fE(()=>{n||e?.activeElement===e?.body&&li(s())},[n]),r_(()=>{n&&li(s())})}function D9(t,{ownerDocument:e,container:n,initialFocus:s,initialFocusFallback:r}){let a=N.useRef(null),o=xh(!!(t&1),"focus-trap#initial-focus"),l=xE();return fE(()=>{if(t===0)return;if(!o){r!=null&&r.current&&li(r.current);return}let c=n.current;c&&L0(()=>{if(!l.current)return;let u=e?.activeElement;if(s!=null&&s.current){if(s?.current===u){a.current=u;return}}else if(c.contains(u)){a.current=u;return}if(s!=null&&s.current)li(s.current);else{if(t&16){if(bh(c,ii.First|ii.AutoFocus)!==pE.Error)return}else if(bh(c,ii.First)!==pE.Error)return;if(r!=null&&r.current&&(li(r.current),e?.activeElement===r.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}a.current=e?.activeElement})},[r,o,t]),a}function P9(t,{ownerDocument:e,container:n,containers:s,previousActiveElement:r}){let a=xE(),o=!!(t&4);t_(e?.defaultView,"focus",l=>{if(!o||!a.current)return;let c=h_(s);lc(n.current)&&c.add(n.current);let u=r.current;if(!u)return;let d=l.target;lc(d)?p_(c,d)?(r.current=d,li(d)):(l.preventDefault(),l.stopPropagation(),li(u)):li(r.current)},!0)}function p_(t,e){for(let n of t)if(n.contains(e))return!0;return!1}function f_(t){var e;return!!(t.enter||t.enterFrom||t.enterTo||t.leave||t.leaveFrom||t.leaveTo)||!hh((e=t.as)!=null?e:x_)||i.Children.count(t.children)===1}let X0=N.createContext(null);X0.displayName="TransitionContext";var F9=(t=>(t.Visible="visible",t.Hidden="hidden",t))(F9||{});function M9(){let t=N.useContext(X0);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}function O9(){let t=N.useContext(Y0);if(t===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return t}let Y0=N.createContext(null);Y0.displayName="NestingContext";function Z0(t){return"children"in t?Z0(t.children):t.current.filter(({el:e})=>e.current!==null).filter(({state:e})=>e==="visible").length>0}function g_(t,e){let n=oc(t),s=N.useRef([]),r=xE(),a=z0(),o=tn((p,f=Yi.Hidden)=>{let y=s.current.findIndex(({el:x})=>x===p);y!==-1&&(oi(f,{[Yi.Unmount](){s.current.splice(y,1)},[Yi.Hidden](){s.current[y].state="hidden"}}),a.microTask(()=>{var x;!Z0(s)&&r.current&&((x=n.current)==null||x.call(n))}))}),l=tn(p=>{let f=s.current.find(({el:y})=>y===p);return f?f.state!=="visible"&&(f.state="visible"):s.current.push({el:p,state:"visible"}),()=>o(p,Yi.Unmount)}),c=N.useRef([]),u=N.useRef(Promise.resolve()),d=N.useRef({enter:[],leave:[]}),m=tn((p,f,y)=>{c.current.splice(0),e&&(e.chains.current[f]=e.chains.current[f].filter(([x])=>x!==p)),e?.chains.current[f].push([p,new Promise(x=>{c.current.push(x)})]),e?.chains.current[f].push([p,new Promise(x=>{Promise.all(d.current[f].map(([g,b])=>b)).then(()=>x())})]),f==="enter"?u.current=u.current.then(()=>e?.wait.current).then(()=>y(f)):y(f)}),h=tn((p,f,y)=>{Promise.all(d.current[f].splice(0).map(([x,g])=>g)).then(()=>{var x;(x=c.current.shift())==null||x()}).then(()=>y(f))});return N.useMemo(()=>({children:s,register:l,unregister:o,onStart:m,onStop:h,wait:u,chains:d}),[l,o,s,m,h,d,u])}let x_=N.Fragment,y_=B0.RenderStrategy;function L9(t,e){var n,s;let{transition:r=!0,beforeEnter:a,afterEnter:o,beforeLeave:l,afterLeave:c,enter:u,enterFrom:d,enterTo:m,entered:h,leave:p,leaveFrom:f,leaveTo:y,...x}=t,[g,b]=N.useState(null),w=N.useRef(null),v=f_(t),E=ro(...v?[w,e,b]:e===null?[]:[e]),k=(n=x.unmount)==null||n?Yi.Unmount:Yi.Hidden,{show:C,appear:I,initial:A}=M9(),[$,T]=N.useState(C?"visible":"hidden"),F=O9(),{register:O,unregister:M}=F;lr(()=>O(w),[O,w]),lr(()=>{if(k===Yi.Hidden&&w.current){if(C&&$!=="visible"){T("visible");return}return oi($,{hidden:()=>M(w),visible:()=>O(w)})}},[$,w,O,M,C,k]);let B=K0();lr(()=>{if(v&&B&&$==="visible"&&w.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[w,$,B,v]);let L=A&&!I,Y=I&&C&&A,D=N.useRef(!1),_=g_(()=>{D.current||(T("hidden"),M(w))},F),P=tn(ke=>{D.current=!0;let Ae=ke?"enter":"leave";_.onStart(w,Ae,W=>{W==="enter"?a?.():W==="leave"&&l?.()})}),z=tn(ke=>{let Ae=ke?"enter":"leave";D.current=!1,_.onStop(w,Ae,W=>{W==="enter"?o?.():W==="leave"&&c?.()}),Ae==="leave"&&!Z0(_)&&(T("hidden"),M(w))});N.useEffect(()=>{v&&r||(P(C),z(C))},[C,v,r]);let q=!(!r||!v||!B||L),[,K]=o9(q,g,C,{start:P,end:z}),ae=ic({ref:E,className:((s=iE(x.className,Y&&u,Y&&d,K.enter&&u,K.enter&&K.closed&&d,K.enter&&!K.closed&&m,K.leave&&p,K.leave&&!K.closed&&f,K.leave&&K.closed&&y,!K.transition&&C&&h))==null?void 0:s.trim())||void 0,...a9(K)}),ne=0;$==="visible"&&(ne|=_a.Open),$==="hidden"&&(ne|=_a.Closed),C&&$==="hidden"&&(ne|=_a.Opening),!C&&$==="visible"&&(ne|=_a.Closing);let Z=Zr();return i.createElement(Y0.Provider,{value:_},i.createElement(u9,{value:ne},Z({ourProps:ae,theirProps:x,defaultTag:x_,features:y_,visible:$==="visible",name:"Transition.Child"})))}function z9(t,e){let{show:n,appear:s=!1,unmount:r=!0,...a}=t,o=N.useRef(null),l=f_(t),c=ro(...l?[o,e]:e===null?[]:[e]);K0();let u=q0();if(n===void 0&&u!==null&&(n=(u&_a.Open)===_a.Open),n===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[d,m]=N.useState(n?"visible":"hidden"),h=g_(()=>{n||m("hidden")}),[p,f]=N.useState(!0),y=N.useRef([n]);lr(()=>{p!==!1&&y.current[y.current.length-1]!==n&&(y.current.push(n),f(!1))},[y,n]);let x=N.useMemo(()=>({show:n,appear:s,initial:p}),[n,s,p]);lr(()=>{n?m("visible"):!Z0(h)&&o.current!==null&&m("hidden")},[n,h]);let g={unmount:r},b=tn(()=>{var E;p&&f(!1),(E=t.beforeEnter)==null||E.call(t)}),w=tn(()=>{var E;p&&f(!1),(E=t.beforeLeave)==null||E.call(t)}),v=Zr();return i.createElement(Y0.Provider,{value:h},i.createElement(X0.Provider,{value:x},v({ourProps:{...g,as:N.Fragment,children:i.createElement(b_,{ref:c,...g,...a,beforeEnter:b,beforeLeave:w})},theirProps:{},defaultTag:N.Fragment,features:y_,visible:d==="visible",name:"Transition"})))}function B9(t,e){let n=N.useContext(X0)!==null,s=q0()!==null;return i.createElement(i.Fragment,null,!n&&s?i.createElement(yE,{ref:e,...t}):i.createElement(b_,{ref:e,...t}))}let yE=cr(z9),b_=cr(L9),bE=cr(B9),J0=Object.assign(yE,{Child:bE,Root:yE});var U9=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(U9||{}),V9=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(V9||{});let W9={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},wE=N.createContext(null);wE.displayName="DialogContext";function Q0(t){let e=N.useContext(wE);if(e===null){let n=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Q0),n}return e}function j9(t,e){return oi(e.type,W9,t,e)}let w_=cr(function(t,e){let n=N.useId(),{id:s=`headlessui-dialog-${n}`,open:r,onClose:a,initialFocus:o,role:l="dialog",autoFocus:c=!0,__demoMode:u=!1,unmount:d=!1,...m}=t,h=N.useRef(!1);l=function(){return l==="dialog"||l==="alertdialog"?l:(h.current||(h.current=!0,console.warn(`Invalid role [${l}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let p=q0();r===void 0&&p!==null&&(r=(p&_a.Open)===_a.Open);let f=N.useRef(null),y=ro(f,e),x=G0(f),g=r?0:1,[b,w]=N.useReducer(j9,{titleId:null,descriptionId:null,panelRef:N.createRef()}),v=tn(()=>a(!1)),E=tn(K=>w({type:0,id:K})),k=K0()?g===0:!1,[C,I]=b9(),A={get current(){var K;return(K=b.panelRef.current)!=null?K:f.current}},$=m_(),{resolveContainers:T}=k9({mainTreeNode:$,portals:C,defaultContainers:[A]}),F=p!==null?(p&_a.Closing)===_a.Closing:!1;FH(u||F?!1:k,{allowed:tn(()=>{var K,ae;return[(ae=(K=f.current)==null?void 0:K.closest("[data-headlessui-portal]"))!=null?ae:null]}),disallowed:tn(()=>{var K;return[(K=$?.closest("body > *:not(#headlessui-portal-root)"))!=null?K:null]})});let O=jR.get(null);lr(()=>{if(k)return O.actions.push(s),()=>O.actions.pop(s)},[O,s,k]);let M=qR(O,N.useCallback(K=>O.selectors.isTop(K,s),[O,s]));qH(M,T,K=>{K.preventDefault(),v()}),E9(M,x?.defaultView,K=>{K.preventDefault(),K.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),v()}),t9(u||F?!1:k,x,T),MH(k,f,v);let[B,L]=uH(),Y=N.useMemo(()=>[{dialogState:g,close:v,setTitleId:E,unmount:d},b],[g,v,E,d,b]),D=mh({open:g===0}),_={ref:y,id:s,role:l,tabIndex:-1,"aria-modal":u?void 0:g===0?!0:void 0,"aria-labelledby":b.titleId,"aria-describedby":B,unmount:d},P=!N9(),z=uc.None;k&&!u&&(z|=uc.RestoreFocus,z|=uc.TabLock,c&&(z|=uc.AutoFocus),P&&(z|=uc.InitialFocus));let q=Zr();return i.createElement(d9,null,i.createElement(o_,{force:!0},i.createElement(v9,null,i.createElement(wE.Provider,{value:Y},i.createElement(c_,{target:f},i.createElement(o_,{force:!1},i.createElement(L,{slot:D},i.createElement(I,null,i.createElement(A9,{initialFocus:o,initialFocusFallback:f,containers:T,features:z},i.createElement(gH,{value:v},q({ourProps:_,theirProps:m,slot:D,defaultTag:G9,features:H9,visible:g===0,name:"Dialog"})))))))))))}),G9="div",H9=B0.RenderStrategy|B0.Static;function q9(t,e){let{transition:n=!1,open:s,...r}=t,a=q0(),o=t.hasOwnProperty("open")||a!==null,l=t.hasOwnProperty("onClose");if(!o&&!l)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!o)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!l)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!a&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(s!==void 0||n)&&!r.static?i.createElement(d_,null,i.createElement(J0,{show:s,transition:n,unmount:r.unmount},i.createElement(w_,{ref:e,...r}))):i.createElement(d_,null,i.createElement(w_,{ref:e,open:s,...r}))}let K9="div";function X9(t,e){let n=N.useId(),{id:s=`headlessui-dialog-panel-${n}`,transition:r=!1,...a}=t,[{dialogState:o,unmount:l},c]=Q0("Dialog.Panel"),u=ro(e,c.panelRef),d=mh({open:o===0}),m=tn(x=>{x.stopPropagation()}),h={ref:u,id:s,onClick:m},p=r?bE:N.Fragment,f=r?{unmount:l}:{},y=Zr();return i.createElement(p,{...f},y({ourProps:h,theirProps:a,slot:d,defaultTag:K9,name:"Dialog.Panel"}))}let Y9="div";function Z9(t,e){let{transition:n=!1,...s}=t,[{dialogState:r,unmount:a}]=Q0("Dialog.Backdrop"),o=mh({open:r===0}),l={ref:e,"aria-hidden":!0},c=n?bE:N.Fragment,u=n?{unmount:a}:{},d=Zr();return i.createElement(c,{...u},d({ourProps:l,theirProps:s,slot:o,defaultTag:Y9,name:"Dialog.Backdrop"}))}let J9="h2";function Q9(t,e){let n=N.useId(),{id:s=`headlessui-dialog-title-${n}`,...r}=t,[{dialogState:a,setTitleId:o}]=Q0("Dialog.Title"),l=ro(e);N.useEffect(()=>(o(s),()=>o(null)),[s,o]);let c=mh({open:a===0}),u={ref:l,id:s};return Zr()({ourProps:u,theirProps:r,slot:c,defaultTag:J9,name:"Dialog.Title"})}let eq=cr(q9),tq=cr(X9);cr(Z9);let nq=cr(Q9),vE=Object.assign(eq,{Panel:tq,Title:nq,Description:pH});const sq={async uploadDocument(t,e,n){try{const s=new FormData;return s.append("file",t),e&&s.append("filename",e),n&&s.append("customer_reference",n),(await Ie.post("undefined/documents",s,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){throw console.error("Error uploading document:",s),s}}},rq={async createAddress(t){try{return console.log(" Address service - data to send:",t),(await Ie.post("undefined/addresses",t)).data}catch(e){throw console.error("Error creating address:",e),e}}},aq={async updateRequirements(t,e){try{await Ie.patch(`undefined/requirement-groups/${t}/requirements`,{requirements:e})}catch(n){throw console.error("Error updating requirements:",n),n}},async updateTextValue(t,e,n){return this.updateRequirements(t,[{requirementId:e,value:n}])}},oq=({requirements:t,existingValues:e,requirementGroupId:n,destinationZone:s,onCancel:r})=>{const a=t.map($=>{let T,F;switch($.type){case"document":T=hn,F=$.name;break;case"address":T=to,F=$.name;break;case"textual":T=Zu,F=$.name;break;default:T=Zu,F=$.name}return{id:$.id,label:F,icon:T,requirement:$}}),o=n||null,l=N.useCallback(()=>{if(!e)return 0;const $=new Set(e.filter(T=>T.status==="completed").map(T=>T.field));return a.findIndex(T=>!$.has(T.id))||0},[a,e]),[c,u]=N.useState(l),[d,m]=N.useState(()=>!e||!Array.isArray(e)?{}:e.reduce(($,T)=>{if(!T.value)return $;try{if(t.find(O=>O.id===T.field)?.type==="textual"){const O=T.value.replace(/^"|"$/g,"");$[T.field]=O,$[`${T.field}_details`]={value:O,status:T.status,submittedAt:T.submittedAt}}else{const O=JSON.parse(T.value);typeof O=="object"&&O!==null&&($[T.field]=O,$[`${T.field}_details`]={...O,status:T.status,submittedAt:T.submittedAt})}}catch(F){console.error("Error parsing value for field:",T.field,F)}return $},{})),[h,p]=N.useState({}),[f,y]=N.useState([]),[x,g]=N.useState(()=>{const $=e?.reduce((T,F)=>{if(F.value&&F.field)try{let O;typeof F.value=="string"?O=JSON.parse(F.value):O=F.value,typeof O=="object"&&O!==null&&(O.businessName||O.streetAddress||O.id)&&(T[F.field]={businessName:O.businessName||"",streetAddress:O.streetAddress||"",locality:O.locality||"",postalCode:O.postalCode||"",countryCode:s,extendedAddress:O.extendedAddress||"",administrativeArea:O.administrativeArea||""})}catch{console.log("Not a valid address data for field:",F.field)}return T},{})||{};return console.log(" Initial address fields:",{existingValues:e,initialFields:$,destinationZone:s}),$}),b=a[c],w=b?.requirement;console.log("Current step data:",{currentStepIndex:c,currentStep:b,currentRequirement:w,requirementGroupId:o,values:d}),i.useEffect(()=>{if(!t||t.length===0){console.warn("No requirements found:",{requirements:t});return}if(a.length===0){console.warn("No steps available from requirements:",{requirements:t,steps:a});return}},[t,a]);const v=N.useCallback(async()=>{if(!w||!b)return!1;const $={};let T=!0;const F=d[b.id];!F&&!e?.find(M=>M.field===b.id)&&($[b.id]="This field is required",T=!1);const O=e?.find(M=>M.field===b.id);if(O&&O.status==="completed")return!0;if(!T)return p($),!1;try{switch(w.type){case"document":if(F instanceof File){if(F.size>5*1024*1024)throw new Error("File size must be less than 5MB");if(!["image/jpeg","image/png","application/pdf"].includes(F.type))throw new Error("Only JPG, PNG and PDF files are allowed")}break;case"address":if(!o)throw new Error("Requirement group ID is missing");const M=typeof F=="string"?JSON.parse(F):F;if(!M.businessName||!M.streetAddress||!M.locality||!M.postalCode)throw new Error("Required address fields are missing");break;case"textual":if(w.acceptance_criteria){const{min_length:B,max_length:L}=w.acceptance_criteria;if(B&&F.length<B)throw new Error(`Minimum length is ${B} characters`);if(L&&F.length>L)throw new Error(`Maximum length is ${L} characters`)}break}return!0}catch(M){return console.error("Validation error:",M),p({[b.id]:M instanceof Error?M.message:"Validation failed"}),!1}},[b,w,d]),E=async()=>{if(!b||!w){console.error("Missing current step or requirement data");return}if(!o){console.error("Missing requirement group ID"),p({submit:"Configuration error: Missing requirement group ID"});return}if(console.log("Processing step:",{currentStep:b,currentRequirement:w,requirementGroupId:o,value:d[b.id]}),!await v()){console.error("Validation failed");return}try{const T=d[b.id];if(!T){console.error("No value provided for current step");return}let F=T;switch(w.type){case"document":if(T instanceof File){console.log("Uploading new document:",T.name);const M=`${w.name.toLowerCase().replace(/\s+/g,"_")}_${new Date().toISOString()}`,B=await sq.uploadDocument(T,M,o);if(console.log("Upload result:",B),!B.id)throw new Error("Document upload failed - no ID received");F=B.id}else typeof T=="object"&&T!==null?(console.log("Using existing document ID:",T.id),F=T.id):typeof T=="string"&&(console.log("Using existing document ID (string):",T),F=T);break;case"address":if(typeof T=="object"&&T.id)console.log("Using existing address ID:",T.id),F=T.id;else{const B={...typeof T=="string"?JSON.parse(T):T,countryCode:s};console.log(" Creating new address:",B);const L=await rq.createAddress(B);if(console.log(" Address creation response:",L),!L.id)throw new Error("Failed to create address - no ID received");F=L.id}break;case"textual":F=T;break;default:throw new Error(`Unsupported requirement type: ${w.type}`)}console.log("Updating requirement group:",{groupId:o,requirementId:w.id,value:F});const O={requirementId:w.id,value:F};console.log(" Update payload:",O),await aq.updateRequirements(o,[O]),f.includes(c)||y(M=>[...M,c]),c<a.length-1?u(M=>M+1):C()}catch(T){console.error("Error processing step:",T),p(F=>({...F,[b.id]:T instanceof Error?T.message:"Failed to process step"}))}},k=()=>{c>0&&u($=>$-1)},C=async()=>{await v()&&r()},I=$=>{let T=x[$.id]||{};T.countryCode||(T.countryCode=s);const F=h[$.id],O=(M,B)=>{const L={...T,[M]:B,countryCode:s};g(Y=>({...Y,[$.id]:L})),m(Y=>({...Y,[$.id]:JSON.stringify(L)}))};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4"},i.createElement("div",{className:"col-span-2"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"Business Name ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("input",{type:"text",placeholder:"Enter your business name",className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm transition-colors",value:T.businessName||"",onChange:M=>O("businessName",M.target.value)})),i.createElement("div",{className:"col-span-2"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"Street Address ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("input",{type:"text",placeholder:"Enter your street address",className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm transition-colors",value:T.streetAddress||"",onChange:M=>O("streetAddress",M.target.value)})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"City ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("input",{type:"text",placeholder:"Enter city name",className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm transition-colors",value:T.locality||"",onChange:M=>O("locality",M.target.value)})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"Postal Code ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("input",{type:"text",placeholder:"Enter postal code",className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm transition-colors",value:T.postalCode||"",onChange:M=>O("postalCode",M.target.value)})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"State/Province"),i.createElement("input",{type:"text",placeholder:"Enter state or province (optional)",className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm transition-colors",value:T.administrativeArea||"",onChange:M=>O("administrativeArea",M.target.value)})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"Country Code"),i.createElement("input",{type:"text",className:"block w-full rounded-lg border-gray-300 bg-gray-50 shadow-sm text-sm transition-colors cursor-not-allowed",value:s.toUpperCase(),readOnly:!0,disabled:!0}))),i.createElement("div",{className:"pt-4"},i.createElement("div",{className:"flex items-center space-x-2 mb-3"},i.createElement("div",{className:"h-px flex-1 bg-gray-200"}),i.createElement("span",{className:"text-sm font-medium text-gray-500"},"Optional Information"),i.createElement("div",{className:"h-px flex-1 bg-gray-200"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1 text-left"},"Extended Address"),i.createElement("input",{type:"text",placeholder:"Apartment, Suite, Unit, Building, etc.",className:"block w-full rounded-lg border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm transition-colors",value:T.extendedAddress||"",onChange:M=>O("extendedAddress",M.target.value)}))),F&&i.createElement("p",{className:"mt-1 text-sm text-red-600"},F))},A=$=>{const T=h[$.id],F=d[$.id],O=e?.find(B=>B.field===$.id),M=O?.status==="completed";return i.createElement("div",{key:$.id,className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},i.createElement("div",{className:"flex items-start justify-between mb-4"},i.createElement("div",{className:"flex items-start space-x-3"},i.createElement("div",{className:"mt-1"},(()=>{const B=$.type==="document"?hn:$.type==="address"?to:Zu;return i.createElement(B,{className:"h-5 w-5 text-indigo-500"})})()),i.createElement("div",null,i.createElement("label",{className:"block text-base font-medium text-gray-900"},$.name.replace(" (National)","")),$.acceptance_criteria.time_limit&&i.createElement("div",{className:"mt-1 inline-flex items-center px-2 py-1 rounded-full bg-yellow-100 text-yellow-800 text-xs"},"Required within ",$.acceptance_criteria.time_limit),i.createElement("p",{className:"mt-1 text-sm text-gray-500 max-w-2xl"},$.description))),(F||e?.find(B=>B.field===$.id)?.status==="approved")&&!T&&i.createElement("div",{className:"flex items-center space-x-2 text-green-600"},i.createElement(mt,{className:"h-5 w-5"}),i.createElement("span",{className:"text-sm font-medium"},"Completed"))),i.createElement("div",{className:"border-t border-gray-200 my-4"}),$.type==="document"?i.createElement("div",{className:"mt-1 flex items-center space-x-3"},M&&O?.value?i.createElement("div",{className:"space-y-3"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:"flex flex-col"},i.createElement("span",{className:"text-sm font-medium text-gray-700"},JSON.parse(O.value).filename),i.createElement("span",{className:"text-xs text-gray-500"},O?.submittedAt&&`Submitted: ${new Date(O.submittedAt).toLocaleString()}`)),i.createElement("a",{href:`undefined/documents/${JSON.parse(O.value).id}/download`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-1 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"View Document"),i.createElement(mt,{className:"h-5 w-5 text-green-500"}))),i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:B=>{const L=B.target.files?.[0];L&&(m(Y=>({...Y,[$.id]:L})),p(Y=>({...Y,[$.id]:""})))},className:"hidden",id:`file-${$.id}`}),i.createElement("label",{htmlFor:`file-${$.id}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},i.createElement(Xo,{className:"-ml-1 mr-2 h-5 w-5"}),"Change Document"),d[$.id]instanceof File&&i.createElement("span",{className:"text-sm text-gray-500"},"New file selected: ",d[$.id].name))):i.createElement(i.Fragment,null,i.createElement("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:B=>{const L=B.target.files?.[0];L&&(m(Y=>({...Y,[$.id]:L})),p(Y=>({...Y,[$.id]:""})))},className:"hidden",id:`file-${$.id}`}),i.createElement("label",{htmlFor:`file-${$.id}`,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},i.createElement(Xo,{className:"-ml-1 mr-2 h-5 w-5"}),"Choose File"),F instanceof File&&i.createElement("span",{className:"text-sm text-gray-500"},F.name))):$.type==="address"?I($):i.createElement("div",{className:"space-y-2"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex-grow"},i.createElement("input",{type:"text",className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:$.example,value:F||d[`${$.id}_details`]?.value||"",onChange:B=>{m(L=>({...L,[$.id]:B.target.value})),p(L=>({...L,[$.id]:""}))}}),O?.status==="completed"&&O?.submittedAt&&i.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Last submitted: ",new Date(O.submittedAt).toLocaleString())),O?.status==="completed"&&i.createElement(mt,{className:"h-5 w-5 text-green-500"}))),T&&i.createElement("p",{className:"mt-1 text-sm text-red-600"},T),$.example&&!T&&i.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Example: ",$.example))};return i.createElement("div",{className:"space-y-6"},i.createElement("nav",{"aria-label":"Progress",className:"px-8 py-4 bg-white rounded-lg shadow-sm"},i.createElement("ol",{role:"list",className:"flex items-center justify-between"},a.map(($,T)=>{const F=$.icon,O=T===c,M=f.includes(T),B=T===a.length-1;return i.createElement("li",{key:$.id,className:`relative flex-1 ${B?"":"pr-8"}`},i.createElement("div",{className:"group flex items-center"},i.createElement("div",{className:"flex items-center justify-center"},i.createElement("div",{className:`
                        relative flex h-10 w-10 items-center justify-center rounded-full border-2 transition-all duration-200
                        ${O?"border-indigo-600 bg-indigo-600 ring-2 ring-indigo-100":M?"border-green-500 bg-green-500":"border-gray-300 bg-white"}
                      `},i.createElement(F,{className:`h-5 w-5 transition-colors
                          ${O||M?"text-white":"text-gray-500"}
                        `}),M&&!O&&i.createElement(mt,{className:"absolute h-4 w-4 text-white"}))),!B&&i.createElement("div",{className:`absolute left-0 top-5 -z-10 h-0.5 w-full transition-colors duration-200
                        ${M?"bg-green-500":"bg-gray-300"}
                      `,style:{left:"50%",width:"100%"}})),i.createElement("div",{className:"mt-3"},i.createElement("span",{className:`block text-center text-sm font-medium transition-colors duration-200
                      ${O?"text-indigo-600":M?"text-green-600":"text-gray-500"}
                    `},$.label)))}))),i.createElement("div",{className:"mt-8 space-y-6"},w&&A(w)),h.submit&&i.createElement("div",{className:"rounded-md bg-red-50 p-4"},i.createElement("div",{className:"flex"},i.createElement(Sn,{className:"h-5 w-5 text-red-400"}),i.createElement("div",{className:"ml-3"},i.createElement("h3",{className:"text-sm font-medium text-red-800"},"Error submitting requirements"),i.createElement("div",{className:"mt-2 text-sm text-red-700"},h.submit)))),i.createElement("div",{className:"mt-8 flex justify-between"},i.createElement("button",{type:"button",onClick:r,className:"rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},"Cancel"),i.createElement("div",{className:"flex space-x-3"},c>0&&i.createElement("button",{type:"button",onClick:k,className:"inline-flex items-center rounded-md border border-gray-300 bg-white py-2 px-4 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},i.createElement(Zl,{className:"mr-2 h-4 w-4"}),"Back"),i.createElement("button",{type:"button",onClick:E,className:"inline-flex items-center rounded-md border border-transparent bg-indigo-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},c===a.length-1?"Finish":i.createElement(i.Fragment,null,"Next",i.createElement(Un,{className:"ml-2 h-4 w-4"}))))))},iq=({isOpen:t,onClose:e,countryCode:n,requirements:s,existingValues:r,requirementGroupId:a,onSubmit:o})=>i.createElement(J0,{appear:!0,show:t,as:N.Fragment},i.createElement(vE,{as:"div",className:"relative z-50",onClose:()=>{},static:!0},i.createElement(J0.Child,{as:N.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0"},i.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-25"})),i.createElement("div",{className:"fixed inset-0 overflow-y-auto"},i.createElement("div",{className:"flex min-h-full items-center justify-center p-4 text-center"},i.createElement(J0.Child,{as:N.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95"},i.createElement(vE.Panel,{className:"w-full max-w-4xl transform overflow-hidden rounded-2xl bg-white shadow-xl transition-all"},i.createElement("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4"},i.createElement(vE.Title,{as:"div",className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h3",{className:"text-xl font-semibold text-white"},"Complete Requirements"),i.createElement("p",{className:"mt-1 text-sm text-indigo-100"},"Required information for ",n," phone numbers")),i.createElement("button",{type:"button",className:"rounded-full p-1 text-indigo-100 hover:bg-indigo-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-white",onClick:e},i.createElement(Yo,{className:"h-6 w-6"})))),i.createElement("div",{className:"px-6 py-4 bg-gray-50"},i.createElement("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6 rounded-r-lg"},i.createElement("div",{className:"flex"},i.createElement("div",{className:"flex-shrink-0"},i.createElement("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},i.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))),i.createElement("div",{className:"ml-3"},i.createElement("p",{className:"text-sm text-yellow-700"},"Please ensure all documents are clear, legible, and in the correct format."))))),i.createElement("div",{className:"px-6 pb-6"},i.createElement(oq,{requirements:s,existingValues:r,requirementGroupId:a,destinationZone:n.toLowerCase(),onSubmit:o,onCancel:e})))))))),v_=({onBackToOnboarding:t})=>{const[e,n]=N.useState("twilio"),[s,r]=N.useState(null),[a,o]=N.useState(null),[l,c]=N.useState(null),[u,d]=N.useState([]),[m,h]=N.useState(!1),[p,f]=N.useState(!1);N.useEffect(()=>{const X=()=>{const me=$e.get("companyId");return console.log(" Reading companyId cookie:",me),me?(o(me),c(null),!0):!1};if(!X()){console.log(" CompanyId cookie not found on first read, setting up retry interval");const me=setInterval(()=>{X()?(console.log(" CompanyId cookie found on retry"),clearInterval(me)):(console.log(" CompanyId cookie still not found on retry"),c("Required company ID not found. Please refresh the page if this persists."))},2e3);return()=>clearInterval(me)}},[]);const[y,x]=N.useState([]),[g,b]=N.useState(""),[w,v]=N.useState([]),[E,k]=N.useState([]),[C,I]=N.useState("idle"),[A,$]=N.useState(null),[T,F]=N.useState(null),[O,M]=N.useState(!1),[B,L]=N.useState(!1),[Y,D]=N.useState(null),[_,P]=N.useState({hasRequirements:!1}),[z,q]=N.useState({isChecking:!1,hasRequirements:!1,isComplete:!1,error:null}),K=[{id:"twilio",name:"Twilio",logo:Ql},{id:"telnyx",name:"Telnyx",logo:gs}];N.useEffect(()=>{if(!a){console.log("Waiting for company ID...");return}console.log(" Company ID available, fetching initial data..."),le(),W()},[a]),N.useEffect(()=>{s&&(console.log(" Selected gig changed, fetching existing numbers..."),we())},[s]),N.useEffect(()=>{if(s&&u.length>0){const X=u.find(me=>me._id===s);X&&X.destination_zone&&X.destination_zone.cca2&&(console.log(" Setting destination zone from selected gig:",X.destination_zone.cca2),b(X.destination_zone.cca2))}else b("")},[s,u]),N.useEffect(()=>{if(y.some(me=>me.status==="pending")){console.log(" Setting up auto-refresh for pending numbers");const me=setInterval(we,3e4);return()=>clearInterval(me)}},[y]);const[ae,ne]=N.useState(null),Z=async()=>{if(!s)return!1;try{console.log(" Checking if gig has a phone number:",s);const X=await Xr.listPhoneNumbers(s);return X?.hasNumber&&X.number?(console.log(" Found existing number for gig"),x([X.number]),q({isChecking:!1,hasRequirements:!1,isComplete:!0,error:null}),(e==="telnyx"||e==="twilio")&&Ee(),!0):!1}catch(X){return console.error(" Error checking gig numbers:",X),!1}},ke=async X=>{if(!s||!a||await Z())return;const Fe=u.find(Oe=>Oe._id===s);if(!Fe?.destination_zone?.cca2){console.error("No destination zone found for gig");return}const tt=X||Fe.destination_zone.cca2;b(tt),Ee(tt);try{q(Ye=>({...Ye,isChecking:!0}));const Oe=await Xr.getTwilioRequirements(tt);if(console.log("Twilio Requirements:",Oe),Oe&&Oe.requirements){const Ye=[];Oe.endUserType&&Ye.push({id:"end_user",name:`${Oe.endUserType} Information`,type:"textual",description:`Please provide details for ${Oe.endUserType}`,example:"Business Name / Individual Name",acceptance_criteria:{}}),Array.isArray(Oe.requirements)&&Oe.requirements.forEach((at,At)=>{Ye.push({id:at.sid||`doc_${At}`,name:at.friendlyName||at.name||"Supporting Document",type:"document",description:at.description||"Upload required document",example:"Passport, Utility Bill",acceptance_criteria:{}})}),P({hasRequirements:Ye.length>0,requirements:Ye}),q({isChecking:!1,hasRequirements:Ye.length>0,isComplete:!1,error:null,groupId:Oe.regulationSid,totalRequirements:Ye.length,pendingRequirements:Ye.length,completedRequirements:[]})}else q({isChecking:!1,hasRequirements:!1,isComplete:!0,error:null})}catch(Oe){console.error("Error fetching Twilio requirements:",Oe),q(Ye=>({...Ye,isChecking:!1,error:"Failed to fetch requirements"}))}},Ae=async X=>{if(!s||!a||await Z())return;const Fe=u.find(Ye=>Ye._id===s);if(!Fe?.destination_zone?.cca2){console.error("No destination zone found for gig");return}const tt=X||Fe.destination_zone.cca2;b(tt);try{const Ye=await Xr.searchPhoneNumbers(tt,"telnyx");if(v(Array.isArray(Ye)?Ye:[]),!Array.isArray(Ye)||Ye.length===0){console.log("No available numbers for this destination zone, skipping requirements check"),q({isChecking:!1,hasRequirements:!1,isComplete:!1,error:null});return}}catch(Ye){console.error("Error checking available numbers:",Ye)}const Oe=$e.get(`telnyxRequirementGroup_${a}_${tt}`);if(Oe)try{const{group:Ye}=await Yr.getOrCreateGroup(a,tt);await new Promise(wt=>setTimeout(wt,1e3));const at=await Yr.getDetailedGroupStatus(Oe),At=Math.round(at.completedRequirements.length/at.totalRequirements*100);at.isComplete?q({isChecking:!1,hasRequirements:!1,isComplete:!0,error:null,groupId:Oe,telnyxId:Ye.telnyxId,completionPercentage:100,completedRequirements:at.completedRequirements,totalRequirements:at.totalRequirements,pendingRequirements:0}):q({isChecking:!1,hasRequirements:!0,isComplete:!1,error:null,groupId:Oe,telnyxId:Ye.telnyxId,completionPercentage:At,completedRequirements:at.completedRequirements,totalRequirements:at.totalRequirements,pendingRequirements:at.pendingRequirements}),Ee()}catch(Ye){console.error("Failed to load requirement group:",Ye),$e.remove(`telnyxRequirementGroup_${a}_${tt}`),Ae()}else try{const Ye=await Yr.checkCountryRequirements(tt);if(P(Ye),Ye.hasRequirements){const{group:at,isNew:At}=await Yr.getOrCreateGroup(a,tt);if(At)q({isChecking:!1,hasRequirements:!0,isComplete:!1,error:null,groupId:at._id,telnyxId:at.telnyxId,completionPercentage:0,completedRequirements:[],totalRequirements:Ye.requirements?.length||0,pendingRequirements:Ye.requirements?.length||0});else{const wt=await Yr.getDetailedGroupStatus(at._id),fe=Math.round(wt.completedRequirements.length/wt.totalRequirements*100);q({isChecking:!1,hasRequirements:!0,isComplete:wt.isComplete,error:null,groupId:at._id,telnyxId:at.telnyxId,completionPercentage:fe,completedRequirements:wt.completedRequirements,totalRequirements:wt.totalRequirements,pendingRequirements:wt.pendingRequirements})}$e.set(`telnyxRequirementGroup_${a}_${tt}`,at._id,{expires:30})}else q({isChecking:!1,hasRequirements:!1,isComplete:!0,error:null});Ee()}catch(Ye){console.error("Failed to check country requirements:",Ye),q({isChecking:!1,hasRequirements:!1,isComplete:!1,error:"Failed to check requirements"})}};N.useEffect(()=>{if(q({isChecking:!1,hasRequirements:!1,isComplete:!1,error:null}),v([]),$(null),I("idle"),F(null),M(!1),L(!1),!s||!a)return;const me=u.find(Fe=>Fe._id===s)?.destination_zone?.cca2;e==="telnyx"?Ae(me):e==="twilio"?ke(me):(Z(),me&&Ee(me))},[e]),N.useEffect(()=>{if(!s||!a)return;v([]),$(null),I("idle"),F(null),M(!1),L(!1);const me=u.find(Fe=>Fe._id===s)?.destination_zone?.cca2;e==="telnyx"?Ae(me):e==="twilio"?ke(me):(Z(),me&&Ee(me))},[s]);const W=async()=>{try{if(!a)return;console.log(" Checking step 5 status for company:",a);try{const me=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${a}/onboarding`);if(console.log(" API response for onboarding:",me.data),me.data&&me.data.completedSteps&&Array.isArray(me.data.completedSteps)){const Fe=me.data.completedSteps;if(Fe.includes(5)){console.log(" Step 5 is already completed according to API"),k(Fe);return}else console.log(" Step 5 is not completed according to API")}}catch{console.log(" Could not fetch onboarding status from API, falling back to localStorage")}const X=localStorage.getItem("companyOnboardingProgress");if(X)try{const me=JSON.parse(X);me.completedSteps&&Array.isArray(me.completedSteps)&&(console.log(" Found completed steps in localStorage:",me.completedSteps),k(me.completedSteps))}catch(me){console.error("Error parsing stored progress:",me)}}catch(X){console.error("Error checking completed steps:",X)}},le=async()=>{if(a)try{h(!0),console.log(" Fetching gigs for company:",a);const X=await Ie.get(`undefined/gigs/company/${a}`);console.log(" Gigs response:",X.data);const me=X.data;me&&Array.isArray(me.data)?(d(me.data),console.log(" Loaded gigs:",me.data.length)):(d([]),console.log(" No gigs found in response"))}catch(X){console.error(" Error fetching gigs:",X),d([])}finally{h(!1)}},we=async()=>{try{if(!s){console.error(" No selectedGigId available"),x([]);return}console.log(" Checking numbers for gig:",s);const X=await Xr.listPhoneNumbers(s);console.log(" Check result:",X),X?.hasNumber&&X.number?x([X.number]):x([])}catch(X){console.error(" Error checking gig numbers:",X),x([])}},de=X=>X.phoneNumber||X.phone_number||"",Ee=async X=>{const me=X||g;if(!me){console.error("Destination zone not available");return}console.log(" Searching phone numbers with destination zone:",me),console.log(" Using provider:",e);try{const Fe=await Xr.searchPhoneNumbers(me,e);console.log(" Phone numbers found:",Fe),v(Array.isArray(Fe)?Fe:[])}catch(Fe){console.error("Error searching numbers:",Fe),v([])}},Re=async(X,me)=>{if(!s||!a){console.error(" Required IDs missing:",{selectedGigId:s,companyId:a}),$("Configuration error: Required IDs not found"),I("error");return}try{if(console.log(" Starting purchase process:",{phoneNumber:X,provider:e,selectedGigId:s,requirementStatus:z,options:me}),e==="telnyx"){if(z.isChecking){$("Please wait while we check requirements..."),I("error");return}if(z.error){$("Cannot proceed: Failed to check requirements"),I("error");return}if(z.hasRequirements&&!z.isComplete){$("Please complete the requirements before purchasing"),I("error");return}if(z.hasRequirements&&!z.groupId){$("Missing requirement group ID. Please try again."),I("error");return}}if($(null),I("purchasing"),!a)throw new Error("Company ID is required");const Fe={phoneNumber:X,provider:e,gigId:s,companyId:a,requirementGroupId:e==="telnyx"?z.telnyxId:void 0,bundleSid:me?.bundleSid,addressSid:me?.addressSid};console.log(" Purchase request data:",Fe);const tt=await Xr.purchasePhoneNumber(Fe);if(console.log(" Purchase response:",tt),!tt||tt.error){const Oe=tt?.message||tt?.error||"Failed to purchase number";throw new Error(Oe)}console.log(" Number purchased successfully!"),v(Oe=>Oe.filter(Ye=>de(Ye)!==X)),await we(),I("success"),D(tt?.data||{phoneNumber:X,status:e==="twilio"?"active":"pending",features:{voice:!0,sms:!0,mms:!0},provider:e})}catch(Fe){console.error(" Error purchasing number:",Fe),I("error"),$(Fe instanceof Error?Fe.message:"Failed to purchase number. Please try again.")}},ze=async()=>{try{if(!a)throw console.error("Company ID not found in cookies"),new Error("Company ID not found. Please refresh the page and try again.");if(!s){alert(" Please select a gig before saving the configuration.");return}console.log(" Completing telephony setup...");try{const me=(await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${a}/onboarding`)).data?.completedSteps||[],Fe=me.includes(5)?me:[...me,5],tt=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${a}/onboarding`,{completedSteps:Fe,currentPhase:2});console.log(" Telephony setup step 5 marked as completed via general onboarding:",tt.data)}catch{console.log(" Could not update via general onboarding API, trying individual step endpoint...");try{const me=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${a}/onboarding/phases/2/steps/5`,{status:"completed"});console.log(" Telephony setup step 5 marked as completed via individual endpoint:",me.data)}catch{console.log(" Individual step endpoint also failed, proceeding with localStorage only")}}k(X=>{const me=X.includes(5)?X:[...X,5],Fe={currentPhase:2,completedSteps:me,lastUpdated:new Date().toISOString()};return localStorage.setItem("companyOnboardingProgress",JSON.stringify(Fe)),me}),$e.set("telephonyStepCompleted","true",{expires:7}),await new Promise(X=>setTimeout(X,200)),t?setTimeout(()=>{t()},100):window.history&&window.history.pushState?(window.history.pushState({},"","/app11"),window.dispatchEvent(new PopStateEvent("popstate"))):window.dispatchEvent(new CustomEvent("telephonySetupCompleted",{detail:{stepId:5,status:"completed"}}))}catch(X){console.error("Error updating onboarding progress:",X),X instanceof Error?console.log(`Error: ${X.message}`):console.log("An error occurred while saving the configuration. Please try again.")}},_e=async X=>{try{if(console.log(" Submitting requirements:",X),!a)throw new Error("Company ID is required");if(e==="twilio"){const me=z.groupId;if(!me)throw new Error("Regulation SID missing");const Fe=X.end_user;let tt;Fe&&(tt=(await Xr.createTwilioEndUser({friendlyName:typeof Fe=="string"?Fe:"End User",type:_.requirements?.find(At=>At.id==="end_user")?.name.split(" ")[0].toLowerCase()||"individual",attributes:{}})).sid,console.log(" Created Twilio End User:",tt));const Ye=(await Xr.createTwilioBundle({friendlyName:`Bundle for ${g}`,email:"admin@example.com",regulationSid:me,isoCountry:g})).sid;console.log(" Created Twilio Bundle:",Ye),tt&&await Xr.assignItemToBundle(Ye,tt);for(const[at,At]of Object.entries(X))if(at!=="end_user"&&At instanceof File){const fe=await Xr.createTwilioDocument(At,At.name,"supporting_document",{});console.log(` Uploaded Document ${at}:`,fe.sid),await Xr.assignItemToBundle(Ye,fe.sid)}await Xr.submitTwilioBundle(Ye),console.log(" Submitted Twilio Bundle"),ne({bundleSid:Ye}),q(at=>({...at,isComplete:!0})),I("confirming")}else{let me=z.groupId;if(me)console.log(" Using existing requirement group:",me);else{const{group:tt}=await Yr.getOrCreateGroup(a,g);me=tt._id,console.log(" Created new requirement group:",tt)}for(const[tt,Oe]of Object.entries(X))Oe instanceof File?await Yr.submitDocument(me,tt,Oe):await Yr.submitTextValue(me,tt,Oe);const Fe=await Yr.validateRequirements(me);if(console.log(" Validation result:",Fe),Fe.isValid)q(tt=>({...tt,isComplete:!0})),I("confirming");else throw new Error("Some requirements are still missing or invalid")}}catch(me){console.error(" Error submitting requirements:",me),$(me instanceof Error?me.message:"Failed to submit requirements"),I("error")}},ht=async X=>{if(T){I("purchasing");try{await Re(T,X||ae||{})}catch(me){I("error"),$(me instanceof Error?me.message:"Failed to purchase number")}}};return i.createElement("div",{className:"space-y-6"},l&&i.createElement("div",{className:"rounded-lg bg-yellow-50 p-4"},i.createElement("div",{className:"flex"},i.createElement(Sn,{className:"h-5 w-5 text-yellow-400"}),i.createElement("div",{className:"ml-3"},i.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Configuration Error"),i.createElement("div",{className:"mt-2 text-sm text-yellow-700"},i.createElement("p",null,l))))),i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Telephony Setup"),E.includes(5)&&i.createElement(mt,{className:"h-6 w-6 text-green-500"})),i.createElement("p",{className:"text-sm text-gray-500"},"Configure your call center infrastructure")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:`rounded-lg px-4 py-2 text-sm font-medium transition-all duration-200 ${E.includes(5)?"bg-green-600 text-white cursor-not-allowed":s?"bg-indigo-600 text-white hover:bg-indigo-700 hover:shadow-md":"bg-gray-400 text-white cursor-not-allowed"}`,onClick:E.includes(5)||!s?void 0:ze,disabled:E.includes(5)||!s,title:s?"":"Please select a gig first"},E.includes(5)?i.createElement("span",{className:"flex items-center"},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Configuration Saved"):s?"Save Configuration":i.createElement("span",{className:"flex items-center"},i.createElement(Sn,{className:"mr-2 h-4 w-4"}),"Select Gig First")))),i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-blue-50 to-indigo-100 p-6 shadow-lg border border-blue-200"},i.createElement("div",{className:"flex items-center space-x-3 mb-2"},i.createElement("div",{className:"flex-shrink-0"},i.createElement("div",{className:"rounded-full bg-blue-500 p-2"},i.createElement(Ca,{className:"h-5 w-5 text-white"}))),i.createElement("div",{className:"flex-1"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("h3",{className:"text-xl font-semibold text-blue-900"},"Select Gig"),i.createElement("span",{className:"inline-flex items-center rounded-full bg-red-500 px-3 py-1 text-xs font-semibold text-white shadow-sm"},"Required")),i.createElement("p",{className:"mt-1 text-sm text-blue-700"},"Choose the gig for which you want to configure telephony ",i.createElement("span",{className:"text-blue-600 font-medium"},"*")))),m?i.createElement("div",{className:"mt-6 flex items-center justify-center space-x-3 p-4 rounded-lg bg-white/50 backdrop-blur-sm"},i.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-200 border-t-blue-600"}),i.createElement("span",{className:"text-sm font-medium text-blue-700"},"Loading gigs...")):u.length>0?i.createElement("div",{className:"mt-6"},i.createElement("div",{className:"relative gig-dropdown"},i.createElement("button",{type:"button",className:`relative w-full rounded-xl border-2 py-4 pl-5 pr-12 text-left text-base font-medium transition-all duration-300 shadow-md ${s?"border-blue-400 bg-blue-50 text-blue-900 focus:border-blue-500 focus:ring-blue-500 shadow-blue-200/50":"border-blue-200 bg-white text-blue-800 focus:border-blue-400 focus:ring-blue-400 hover:border-blue-300"} focus:outline-none focus:ring-2 focus:ring-opacity-50`,onClick:()=>f(!p)},i.createElement("span",{className:"flex items-center"},s?(()=>{const X=u.find(me=>me._id===s);return X?i.createElement(i.Fragment,null,X.title," - ",X.destination_zone.name.common,i.createElement("img",{src:X.destination_zone.flags?.png,alt:X.destination_zone.flags?.alt,className:"inline-block w-6 h-4 ml-2 rounded-sm border border-gray-200 object-cover"})):"Select a gig..."})():" Select a gig (required)..."),i.createElement("span",{className:"absolute inset-y-0 right-0 flex items-center pr-4"},i.createElement(Hu,{className:`h-5 w-5 text-blue-400 transition-transform ${p?"rotate-180":""}`}))),p&&i.createElement("div",{className:"absolute z-10 mt-1 w-full bg-white border-2 border-blue-200 rounded-xl shadow-lg max-h-60 overflow-auto"},u.map(X=>i.createElement("button",{key:X._id,type:"button",className:"relative w-full px-5 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none transition-colors duration-150 first:rounded-t-xl last:rounded-b-xl",onClick:()=>{r(X._id),f(!1)}},i.createElement("div",{className:"flex items-center"},i.createElement("span",{className:"text-blue-800 font-medium"}," ",X.title," - ",X.destination_zone.name.common),i.createElement("img",{src:X.destination_zone.flags?.png,alt:X.destination_zone.flags?.alt,className:"inline-block w-6 h-4 ml-2 rounded-sm border border-gray-200 object-cover"}))))),s&&i.createElement("div",{className:"absolute inset-y-0 right-10 flex items-center pointer-events-none"},i.createElement(mt,{className:"h-6 w-6 text-blue-500 drop-shadow-sm"})))):i.createElement("div",{className:"mt-6 rounded-xl bg-gradient-to-r from-blue-50 to-indigo-50 p-6 border-2 border-blue-200"},i.createElement("div",{className:"flex items-start space-x-3"},i.createElement("div",{className:"flex-shrink-0"},i.createElement("div",{className:"rounded-full bg-blue-100 p-2"},i.createElement(Sn,{className:"h-6 w-6 text-blue-500"}))),i.createElement("div",{className:"flex-1"},i.createElement("h3",{className:"text-lg font-semibold text-blue-900 mb-2"},"No Gigs Found"),i.createElement("p",{className:"text-sm text-blue-700 leading-relaxed"},"No gigs were found for this company. Please create a gig first before configuring telephony."))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Select Provider"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-3"},K.map(X=>{const me=X.logo;return i.createElement("button",{key:X.id,className:`flex items-center justify-center rounded-lg border p-4 ${e===X.id?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>n(X.id)},i.createElement(me,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("span",{className:"font-medium text-gray-900"},X.name))}))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"flex items-center justify-between mb-4"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Phone Numbers"),g&&s&&(()=>{const X=u.find(me=>me._id===s);return X?i.createElement("span",{className:"text-sm text-gray-600"},"Destination Zone: ",i.createElement("span",{className:"font-medium"},X.destination_zone.name.common)):null})()),e==="telnyx"&&z.hasRequirements&&!z.isComplete&&i.createElement("div",{className:"mb-4 rounded-lg bg-yellow-50 p-4"},i.createElement("div",{className:"flex"},i.createElement(Sn,{className:"h-5 w-5 text-yellow-400"}),i.createElement("div",{className:"ml-3 flex-grow"},i.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Requirements Needed"),i.createElement("div",{className:"mt-2 text-sm text-yellow-700"},i.createElement("p",null,"To purchase numbers in this country, you need to complete all required information."),z.completionPercentage!==void 0&&i.createElement("div",{className:"mt-2"},i.createElement("div",{className:"flex items-center justify-between mb-1"},i.createElement("span",{className:"text-xs font-medium text-yellow-800"},"Progress: ",z.completionPercentage,"%"),i.createElement("span",{className:"text-xs font-medium text-yellow-800"},z.completedRequirements?.length||0," / ",z.totalRequirements||0)),i.createElement("div",{className:"w-full bg-yellow-200 rounded-full h-2"},i.createElement("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-300",style:{width:`${z.completionPercentage}%`}}))),i.createElement("button",{onClick:async()=>{if(_.requirements?.length)L(!0);else{const X=u.find(me=>me._id===s);if(X?.destination_zone?.cca2){const me=await Yr.checkCountryRequirements(X.destination_zone.cca2);P(me),me.requirements?.length?L(!0):console.warn("No requirements found for country:",X.destination_zone.cca2)}}},className:"mt-3 inline-flex items-center rounded-md bg-yellow-100 px-3 py-2 text-sm font-medium text-yellow-800 hover:bg-yellow-200 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2"},z.completedRequirements?.length?"Continue Requirements":"Start Requirements"))))),e==="telnyx"?i.createElement("div",{className:"mb-6 space-y-2"},i.createElement("h4",{className:"text-sm font-medium text-gray-700"},"Purchased Telnyx Numbers"),i.createElement("div",{className:"grid gap-2"},Array.isArray(y)&&y.filter(X=>X.provider==="telnyx").length>0?y.filter(X=>X.provider==="telnyx").map(X=>i.createElement("div",{key:X.phoneNumber,className:"flex items-center justify-between rounded-lg border p-3"},i.createElement("div",{className:"flex flex-col"},i.createElement("span",{className:"font-medium"},X.phoneNumber),i.createElement("span",{className:"text-sm text-gray-500"},"Status: ",X.status)),i.createElement("div",{className:"flex items-center"},i.createElement("span",{className:`px-2 py-1 text-xs rounded-full ${X.status==="active"?"bg-green-100 text-green-800":X.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`},X.status)))):i.createElement("div",{className:"rounded-lg border border-gray-200 p-4 text-center text-gray-500"},"No phone number purchased for this gig yet"))):e==="twilio"&&i.createElement("div",{className:"mb-6 space-y-2"},i.createElement("h4",{className:"text-sm font-medium text-gray-700"},"Purchased Twilio Numbers"),i.createElement("div",{className:"grid gap-2"},Array.isArray(y)&&y.filter(X=>X.provider==="twilio").length>0?y.filter(X=>X.provider==="twilio").map(X=>i.createElement("div",{key:X.phoneNumber,className:"flex items-center justify-between rounded-lg border p-3"},i.createElement("div",{className:"flex flex-col"},i.createElement("span",{className:"font-medium"},X.phoneNumber),i.createElement("span",{className:"text-sm text-gray-500"},"Status: ",X.status)),i.createElement("div",{className:"flex items-center"},i.createElement("span",{className:`px-2 py-1 text-xs rounded-full ${X.status==="active"?"bg-green-100 text-green-800":X.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`},X.status)))):i.createElement("div",{className:"rounded-lg border border-gray-200 p-4 text-center text-gray-500"},"No Twilio numbers purchased yet")),Array.isArray(w)&&w.length>0?i.createElement("div",{className:"mt-4"},i.createElement("h4",{className:"text-sm font-medium text-gray-700 mb-2"},"Available Numbers"),i.createElement("div",{className:"grid gap-2"},w.map(X=>{const me=de(X);return i.createElement("div",{key:me,className:"flex items-center justify-between rounded-lg border p-3"},i.createElement("div",{className:"flex flex-col"},i.createElement("span",{className:"font-medium"},me),X.locality&&i.createElement("span",{className:"text-sm text-gray-500"},X.locality,", ",X.region)),i.createElement("button",{onClick:()=>{F(me),I("confirming"),M(!0)},disabled:y.length>0,className:`rounded-md px-3 py-1 text-sm text-white ${y.length>0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,title:y.length>0?"A number is already purchased for this gig":void 0},"Purchase"))}))):g&&i.createElement("div",{className:"mt-4 rounded-lg bg-yellow-50 p-4"},i.createElement("div",{className:"flex"},i.createElement("div",{className:"flex-shrink-0"},i.createElement(Sn,{className:"h-5 w-5 text-yellow-400"})),i.createElement("div",{className:"ml-3 flex-1"},i.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"No Numbers Available"),i.createElement("div",{className:"mt-2 text-sm text-yellow-700"},i.createElement("p",null,"No phone numbers available for this destination with Twilio."),i.createElement("p",{className:"mt-1"},"Try Telnyx instead or contact support if the issue persists.")),i.createElement("div",{className:"mt-3"},i.createElement("button",{onClick:()=>n("telnyx"),className:"rounded-md px-3 py-1 text-xs text-white bg-indigo-600 hover:bg-indigo-700"},"Try Telnyx Instead")))))),g&&e==="telnyx"&&i.createElement("div",{className:"mb-6 space-y-2"},i.createElement("h4",{className:"text-sm font-medium text-gray-700"},"Available Numbers (Destination: ",(()=>{const X=u.find(me=>me._id===s);return X?X.destination_zone.name.common:g})(),")"),i.createElement("div",{className:"grid gap-2"},Array.isArray(w)&&w.length>0?w.map(X=>{const me=de(X),Fe=y.length>0||z.hasRequirements&&!z.isComplete,tt=y.length>0?"A number is already purchased for this gig":z.hasRequirements&&!z.isComplete?"Please complete the requirements before purchasing":void 0;return i.createElement("div",{key:me,className:"flex items-center justify-between rounded-lg border p-3"},i.createElement("div",{className:"flex flex-col"},i.createElement("span",{className:"font-medium"},me),X.locality&&i.createElement("span",{className:"text-sm text-gray-500"},X.locality,", ",X.region)),i.createElement("div",{className:"flex items-center gap-2"},Fe&&i.createElement("span",{className:"text-xs text-gray-500 italic mr-2"},tt),i.createElement("button",{onClick:()=>{F(me),I("confirming"),M(!0)},disabled:Fe,className:`rounded-md px-3 py-1 text-sm text-white ${Fe?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,title:tt},"Purchase")))}):i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center justify-center"},i.createElement(Sn,{className:"h-5 w-5 text-yellow-400 mr-2"}),i.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"No Numbers Available")),i.createElement("div",{className:"mt-2 text-sm text-center text-gray-500"},i.createElement("p",{className:"mb-2"},"No Telnyx phone numbers are currently available for this destination."),i.createElement("p",{className:"text-sm text-gray-400"},"You can try again later or contact support if you need immediate assistance.")))))),i.createElement(H7,{isOpen:O,onClose:async()=>{C==="success"&&await we(),e==="telnyx"&&await Ee(),M(!1),I("idle"),F(null),D(null)},purchaseStatus:C,purchaseResponse:Y,selectedNumber:T,countryReq:_,requirementStatus:z,provider:e,purchaseError:A,onSubmitRequirements:_e,onConfirmPurchase:ht,onSetPurchaseStatus:I,onSetSelectedNumber:F,onSetShowPurchaseModal:M}),i.createElement(iq,{isOpen:B,onClose:async()=>{if(z.groupId)try{const X=await Yr.getDetailedGroupStatus(z.groupId),me=Math.round(X.completedRequirements.length/X.totalRequirements*100);q(Fe=>({...Fe,isComplete:X.isComplete,completionPercentage:me,completedRequirements:X.completedRequirements,totalRequirements:X.totalRequirements,pendingRequirements:X.pendingRequirements,hasRequirements:X.isComplete?!1:Fe.hasRequirements}))}catch(X){console.error("Error updating requirement status on close:",X)}L(!1)},countryCode:g,requirements:_.requirements||[],existingValues:z.completedRequirements?.map(X=>({field:X.id,value:JSON.stringify(X.value),status:X.status,submittedAt:X.submittedAt})),requirementGroupId:z.groupId,requirementStatus:z,onSubmit:async X=>{try{if(await _e(X),z.groupId){const me=await Yr.getDetailedGroupStatus(z.groupId),Fe=Math.round(me.completedRequirements.length/me.totalRequirements*100);q(tt=>({...tt,isComplete:me.isComplete,completionPercentage:Fe,completedRequirements:me.completedRequirements,totalRequirements:me.totalRequirements,pendingRequirements:me.pendingRequirements,hasRequirements:me.isComplete?!1:tt.hasRequirements}))}L(!1)}catch(me){console.error("Error submitting requirements:",me)}}}))};/*!
* sweetalert2 v11.22.0
* Released under the MIT License.
*/function E_(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function lq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N_(t,e){return t.get(E_(t,e))}function cq(t,e,n){lq(t,e),e.set(t,n)}function uq(t,e,n){return t.set(E_(t,e),n),n}const dq=100,ot={},mq=()=>{ot.previousActiveElement instanceof HTMLElement?(ot.previousActiveElement.focus(),ot.previousActiveElement=null):document.body&&document.body.focus()},hq=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,s=window.scrollY;ot.restoreFocusTimeout=setTimeout(()=>{mq(),e()},dq),window.scrollTo(n,s)}),k_="swal2-",xe=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"].reduce((t,e)=>(t[e]=k_+e,t),{}),ex=["success","warning","info","question","error"].reduce((t,e)=>(t[e]=k_+e,t),{}),S_="SweetAlert2:",EE=t=>t.charAt(0).toUpperCase()+t.slice(1),Hs=t=>{console.warn(`${S_} ${typeof t=="object"?t.join(" "):t}`)},dc=t=>{console.error(`${S_} ${t}`)},C_=[],pq=t=>{C_.includes(t)||(C_.push(t),Hs(t))},I_=(t,e=null)=>{pq(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},tx=t=>typeof t=="function"?t():t,NE=t=>t&&typeof t.toPromise=="function",vh=t=>NE(t)?t.toPromise():Promise.resolve(t),kE=t=>t&&Promise.resolve(t)===t,qs=()=>document.body.querySelector(`.${xe.container}`),Eh=t=>{const e=qs();return e?e.querySelector(t):null},$r=t=>Eh(`.${t}`),Lt=()=>$r(xe.popup),nd=()=>$r(xe.icon),fq=()=>$r(xe["icon-content"]),$_=()=>$r(xe.title),SE=()=>$r(xe["html-container"]),T_=()=>$r(xe.image),CE=()=>$r(xe["progress-steps"]),nx=()=>$r(xe["validation-message"]),oo=()=>Eh(`.${xe.actions} .${xe.confirm}`),sd=()=>Eh(`.${xe.actions} .${xe.cancel}`),mc=()=>Eh(`.${xe.actions} .${xe.deny}`),gq=()=>$r(xe["input-label"]),rd=()=>Eh(`.${xe.loader}`),Nh=()=>$r(xe.actions),A_=()=>$r(xe.footer),sx=()=>$r(xe["timer-progress-bar"]),IE=()=>$r(xe.close),xq=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,$E=()=>{const t=Lt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((a,o)=>{const l=parseInt(a.getAttribute("tabindex")||"0"),c=parseInt(o.getAttribute("tabindex")||"0");return l>c?1:l<c?-1:0}),s=t.querySelectorAll(xq),r=Array.from(s).filter(a=>a.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(r))].filter(a=>ur(a))},TE=()=>ci(document.body,xe.shown)&&!ci(document.body,xe["toast-shown"])&&!ci(document.body,xe["no-backdrop"]),rx=()=>{const t=Lt();return t?ci(t,xe.toast):!1},yq=()=>{const t=Lt();return t?t.hasAttribute("data-loading"):!1},Tr=(t,e)=>{if(t.textContent="",e){const s=new DOMParser().parseFromString(e,"text/html"),r=s.querySelector("head");r&&Array.from(r.childNodes).forEach(o=>{t.appendChild(o)});const a=s.querySelector("body");a&&Array.from(a.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?t.appendChild(o.cloneNode(!0)):t.appendChild(o)})}},ci=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let s=0;s<n.length;s++)if(!t.classList.contains(n[s]))return!1;return!0},bq=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(xe).includes(n)&&!Object.values(ex).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Ar=(t,e,n)=>{if(bq(t,e),!e.customClass)return;const s=e.customClass[n];if(s){if(typeof s!="string"&&!s.forEach){Hs(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof s}"`);return}Wt(t,s)}},ax=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${xe.popup} > .${xe[e]}`);case"checkbox":return t.querySelector(`.${xe.popup} > .${xe.checkbox} input`);case"radio":return t.querySelector(`.${xe.popup} > .${xe.radio} input:checked`)||t.querySelector(`.${xe.popup} > .${xe.radio} input:first-child`);case"range":return t.querySelector(`.${xe.popup} > .${xe.range} input`);default:return t.querySelector(`.${xe.popup} > .${xe.input}`)}},R_=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},__=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(s=>{Array.isArray(t)?t.forEach(r=>{n?r.classList.add(s):r.classList.remove(s)}):n?t.classList.add(s):t.classList.remove(s)}))},Wt=(t,e)=>{__(t,e,!0)},Qr=(t,e)=>{__(t,e,!1)},el=(t,e)=>{const n=Array.from(t.children);for(let s=0;s<n.length;s++){const r=n[s];if(r instanceof HTMLElement&&ci(r,e))return r}},hc=(t,e,n)=>{n===`${parseInt(n)}`&&(n=parseInt(n)),n||parseInt(n)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},os=(t,e="flex")=>{t&&(t.style.display=e)},As=t=>{t&&(t.style.display="none")},AE=(t,e="block")=>{t&&new MutationObserver(()=>{kh(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},D_=(t,e,n,s)=>{const r=t.querySelector(e);r&&r.style.setProperty(n,s)},kh=(t,e,n="flex")=>{e?os(t,n):As(t)},ur=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),wq=()=>!ur(oo())&&!ur(mc())&&!ur(sd()),RE=t=>t.scrollHeight>t.clientHeight,vq=(t,e)=>{let n=t;for(;n&&n!==e;){if(RE(n))return!0;n=n.parentElement}return!1},P_=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),s=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||s>0},_E=(t,e=!1)=>{const n=sx();n&&ur(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},Eq=()=>{const t=sx();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),s=e/n*100;t.style.width=`${s}%`},Nq=()=>typeof window>"u"||typeof document>"u",kq=`
 <div aria-labelledby="${xe.title}" aria-describedby="${xe["html-container"]}" class="${xe.popup}" tabindex="-1">
   <button type="button" class="${xe.close}"></button>
   <ul class="${xe["progress-steps"]}"></ul>
   <div class="${xe.icon}"></div>
   <img class="${xe.image}" />
   <h2 class="${xe.title}" id="${xe.title}"></h2>
   <div class="${xe["html-container"]}" id="${xe["html-container"]}"></div>
   <input class="${xe.input}" id="${xe.input}" />
   <input type="file" class="${xe.file}" />
   <div class="${xe.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${xe.select}" id="${xe.select}"></select>
   <div class="${xe.radio}"></div>
   <label class="${xe.checkbox}">
     <input type="checkbox" id="${xe.checkbox}" />
     <span class="${xe.label}"></span>
   </label>
   <textarea class="${xe.textarea}" id="${xe.textarea}"></textarea>
   <div class="${xe["validation-message"]}" id="${xe["validation-message"]}"></div>
   <div class="${xe.actions}">
     <div class="${xe.loader}"></div>
     <button type="button" class="${xe.confirm}"></button>
     <button type="button" class="${xe.deny}"></button>
     <button type="button" class="${xe.cancel}"></button>
   </div>
   <div class="${xe.footer}"></div>
   <div class="${xe["timer-progress-bar-container"]}">
     <div class="${xe["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),Sq=()=>{const t=qs();return t?(t.remove(),Qr([document.documentElement,document.body],[xe["no-backdrop"],xe["toast-shown"],xe["has-column"]]),!0):!1},pc=()=>{ot.currentInstance.resetValidationMessage()},Cq=()=>{const t=Lt(),e=el(t,xe.input),n=el(t,xe.file),s=t.querySelector(`.${xe.range} input`),r=t.querySelector(`.${xe.range} output`),a=el(t,xe.select),o=t.querySelector(`.${xe.checkbox} input`),l=el(t,xe.textarea);e.oninput=pc,n.onchange=pc,a.onchange=pc,o.onchange=pc,l.oninput=pc,s.oninput=()=>{pc(),r.value=s.value},s.onchange=()=>{pc(),r.value=s.value}},Iq=t=>typeof t=="string"?document.querySelector(t):t,$q=t=>{const e=Lt();e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true")},Tq=t=>{window.getComputedStyle(t).direction==="rtl"&&Wt(qs(),xe.rtl)},Aq=t=>{const e=Sq();if(Nq()){dc("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=xe.container,e&&Wt(n,xe["no-transition"]),Tr(n,kq),n.dataset.swal2Theme=t.theme;const s=Iq(t.target);s.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),$q(t),Tq(s),Cq()},DE=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?Rq(t,e):t&&Tr(e,t)},Rq=(t,e)=>{t.jquery?_q(e,t):Tr(e,t.toString())},_q=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},Dq=(t,e)=>{const n=Nh(),s=rd();!n||!s||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?As(n):os(n),Ar(n,e,"actions"),Pq(n,s,e),Tr(s,e.loaderHtml||""),Ar(s,e,"loader"))};function Pq(t,e,n){const s=oo(),r=mc(),a=sd();!s||!r||!a||(FE(s,"confirm",n),FE(r,"deny",n),FE(a,"cancel",n),Fq(s,r,a,n),n.reverseButtons&&(n.toast?(t.insertBefore(a,s),t.insertBefore(r,s)):(t.insertBefore(a,e),t.insertBefore(r,e),t.insertBefore(s,e))))}function Fq(t,e,n,s){if(!s.buttonsStyling){Qr([t,e,n],xe.styled);return}Wt([t,e,n],xe.styled),s.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",s.confirmButtonColor),s.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",s.denyButtonColor),s.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",s.cancelButtonColor),PE(t),PE(e),PE(n)}function PE(t){const e=window.getComputedStyle(t);if(e.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-focus-box-shadow",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function FE(t,e,n){const s=EE(e);kh(t,n[`show${s}Button`],"inline-block"),Tr(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=xe[e],Ar(t,n,`${e}Button`)}const Mq=(t,e)=>{const n=IE();n&&(Tr(n,e.closeButtonHtml||""),Ar(n,e,"closeButton"),kh(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},Oq=(t,e)=>{const n=qs();n&&(Lq(n,e.backdrop),zq(n,e.position),Bq(n,e.grow),Ar(n,e,"container"))};function Lq(t,e){typeof e=="string"?t.style.background=e:e||Wt([document.documentElement,document.body],xe["no-backdrop"])}function zq(t,e){e&&(e in xe?Wt(t,xe[e]):(Hs('The "position" parameter is not valid, defaulting to "center"'),Wt(t,xe.center)))}function Bq(t,e){e&&Wt(t,xe[`grow-${e}`])}var on={innerParams:new WeakMap,domCache:new WeakMap};const Uq=["input","file","range","select","radio","checkbox","textarea"],Vq=(t,e)=>{const n=Lt();if(!n)return;const s=on.innerParams.get(t),r=!s||e.input!==s.input;Uq.forEach(a=>{const o=el(n,xe[a]);o&&(Gq(a,e.inputAttributes),o.className=xe[a],r&&As(o))}),e.input&&(r&&Wq(e),Hq(e))},Wq=t=>{if(!t.input)return;if(!Pn[t.input]){dc(`Unexpected type of input! Expected ${Object.keys(Pn).join(" | ")}, got "${t.input}"`);return}const e=F_(t.input);if(!e)return;const n=Pn[t.input](e,t);os(e),t.inputAutoFocus&&setTimeout(()=>{R_(n)})},jq=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},Gq=(t,e)=>{const n=Lt();if(!n)return;const s=ax(n,t);if(s){jq(s);for(const r in e)s.setAttribute(r,e[r])}},Hq=t=>{if(!t.input)return;const e=F_(t.input);e&&Ar(e,t,"input")},ME=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},Sh=(t,e,n)=>{if(n.inputLabel){const s=document.createElement("label"),r=xe["input-label"];s.setAttribute("for",t.id),s.className=r,typeof n.customClass=="object"&&Wt(s,n.customClass.inputLabel),s.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",s)}},F_=t=>{const e=Lt();if(e)return el(e,xe[t]||xe.input)},ox=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:kE(e)||Hs(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},Pn={};Pn.text=Pn.email=Pn.password=Pn.number=Pn.tel=Pn.url=Pn.search=Pn.date=Pn["datetime-local"]=Pn.time=Pn.week=Pn.month=(t,e)=>(ox(t,e.inputValue),Sh(t,t,e),ME(t,e),t.type=e.input,t),Pn.file=(t,e)=>(Sh(t,t,e),ME(t,e),t),Pn.range=(t,e)=>{const n=t.querySelector("input"),s=t.querySelector("output");return ox(n,e.inputValue),n.type=e.input,ox(s,e.inputValue),Sh(n,t,e),t},Pn.select=(t,e)=>{if(t.textContent="",e.inputPlaceholder){const n=document.createElement("option");Tr(n,e.inputPlaceholder),n.value="",n.disabled=!0,n.selected=!0,t.appendChild(n)}return Sh(t,t,e),t},Pn.radio=t=>(t.textContent="",t),Pn.checkbox=(t,e)=>{const n=ax(Lt(),"checkbox");n.value="1",n.checked=!!e.inputValue;const s=t.querySelector("span");return Tr(s,e.inputPlaceholder||e.inputLabel),n},Pn.textarea=(t,e)=>{ox(t,e.inputValue),ME(t,e),Sh(t,t,e);const n=s=>parseInt(window.getComputedStyle(s).marginLeft)+parseInt(window.getComputedStyle(s).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const s=parseInt(window.getComputedStyle(Lt()).width),r=()=>{if(!document.body.contains(t))return;const a=t.offsetWidth+n(t);a>s?Lt().style.width=`${a}px`:hc(Lt(),"width",e.width)};new MutationObserver(r).observe(t,{attributes:!0,attributeFilter:["style"]})}}),t};const qq=(t,e)=>{const n=SE();n&&(AE(n),Ar(n,e,"htmlContainer"),e.html?(DE(e.html,n),os(n,"block")):e.text?(n.textContent=e.text,os(n,"block")):As(n),Vq(t,e))},Kq=(t,e)=>{const n=A_();n&&(AE(n),kh(n,e.footer,"block"),e.footer&&DE(e.footer,n),Ar(n,e,"footer"))},Xq=(t,e)=>{const n=on.innerParams.get(t),s=nd();if(!s)return;if(n&&e.icon===n.icon){L_(s,e),M_(s,e);return}if(!e.icon&&!e.iconHtml){As(s);return}if(e.icon&&Object.keys(ex).indexOf(e.icon)===-1){dc(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),As(s);return}os(s),L_(s,e),M_(s,e),Wt(s,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",O_)},M_=(t,e)=>{for(const[n,s]of Object.entries(ex))e.icon!==n&&Qr(t,s);Wt(t,e.icon&&ex[e.icon]),Jq(t,e),O_(),Ar(t,e,"icon")},O_=()=>{const t=Lt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let s=0;s<n.length;s++)n[s].style.backgroundColor=e},Yq=`
  <div class="swal2-success-circular-line-left"></div>
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>
  <div class="swal2-success-circular-line-right"></div>
`,Zq=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,L_=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,s="";e.iconHtml?s=z_(e.iconHtml):e.icon==="success"?(s=Yq,n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?s=Zq:e.icon&&(s=z_({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==s.trim()&&Tr(t,s)},Jq=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])D_(t,n,"background-color",e.iconColor);D_(t,".swal2-success-ring","border-color",e.iconColor)}},z_=t=>`<div class="${xe["icon-content"]}">${t}</div>`,Qq=(t,e)=>{const n=T_();if(n){if(!e.imageUrl){As(n);return}os(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),hc(n,"width",e.imageWidth),hc(n,"height",e.imageHeight),n.className=xe.image,Ar(n,e,"image")}};let OE=!1,B_=0,U_=0,V_=0,W_=0;const eK=t=>{t.addEventListener("mousedown",ix),document.body.addEventListener("mousemove",lx),t.addEventListener("mouseup",cx),t.addEventListener("touchstart",ix),document.body.addEventListener("touchmove",lx),t.addEventListener("touchend",cx)},tK=t=>{t.removeEventListener("mousedown",ix),document.body.removeEventListener("mousemove",lx),t.removeEventListener("mouseup",cx),t.removeEventListener("touchstart",ix),document.body.removeEventListener("touchmove",lx),t.removeEventListener("touchend",cx)},ix=t=>{const e=Lt();if(t.target===e||nd().contains(t.target)){OE=!0;const n=j_(t);B_=n.clientX,U_=n.clientY,V_=parseInt(e.style.insetInlineStart)||0,W_=parseInt(e.style.insetBlockStart)||0,Wt(e,"swal2-dragging")}},lx=t=>{const e=Lt();if(OE){let{clientX:n,clientY:s}=j_(t);e.style.insetInlineStart=`${V_+(n-B_)}px`,e.style.insetBlockStart=`${W_+(s-U_)}px`}},cx=()=>{const t=Lt();OE=!1,Qr(t,"swal2-dragging")},j_=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},nK=(t,e)=>{const n=qs(),s=Lt();if(!(!n||!s)){if(e.toast){hc(n,"width",e.width),s.style.width="100%";const r=rd();r&&s.insertBefore(r,nd())}else hc(s,"width",e.width);hc(s,"padding",e.padding),e.color&&(s.style.color=e.color),e.background&&(s.style.background=e.background),As(nx()),sK(s,e),e.draggable&&!e.toast?(Wt(s,xe.draggable),eK(s)):(Qr(s,xe.draggable),tK(s))}},sK=(t,e)=>{const n=e.showClass||{};t.className=`${xe.popup} ${ur(t)?n.popup:""}`,e.toast?(Wt([document.documentElement,document.body],xe["toast-shown"]),Wt(t,xe.toast)):Wt(t,xe.modal),Ar(t,e,"popup"),typeof e.customClass=="string"&&Wt(t,e.customClass),e.icon&&Wt(t,xe[`icon-${e.icon}`])},rK=(t,e)=>{const n=CE();if(!n)return;const{progressSteps:s,currentProgressStep:r}=e;if(!s||s.length===0||r===void 0){As(n);return}os(n),n.textContent="",r>=s.length&&Hs("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),s.forEach((a,o)=>{const l=aK(a);if(n.appendChild(l),o===r&&Wt(l,xe["active-progress-step"]),o!==s.length-1){const c=oK(e);n.appendChild(c)}})},aK=t=>{const e=document.createElement("li");return Wt(e,xe["progress-step"]),Tr(e,t),e},oK=t=>{const e=document.createElement("li");return Wt(e,xe["progress-step-line"]),t.progressStepsDistance&&hc(e,"width",t.progressStepsDistance),e},iK=(t,e)=>{const n=$_();n&&(AE(n),kh(n,e.title||e.titleText,"block"),e.title&&DE(e.title,n),e.titleText&&(n.innerText=e.titleText),Ar(n,e,"title"))},G_=(t,e)=>{nK(t,e),Oq(t,e),rK(t,e),Xq(t,e),Qq(t,e),iK(t,e),Mq(t,e),qq(t,e),Dq(t,e),Kq(t,e);const n=Lt();typeof e.didRender=="function"&&n&&e.didRender(n),ot.eventEmitter.emit("didRender",n)},lK=()=>ur(Lt()),H_=()=>{var t;return(t=oo())===null||t===void 0?void 0:t.click()},cK=()=>{var t;return(t=mc())===null||t===void 0?void 0:t.click()},uK=()=>{var t;return(t=sd())===null||t===void 0?void 0:t.click()},ad=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),q_=t=>{t.keydownTarget&&t.keydownHandlerAdded&&(t.keydownTarget.removeEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1)},dK=(t,e,n)=>{q_(t),e.toast||(t.keydownHandler=s=>hK(e,s,n),t.keydownTarget=e.keydownListenerCapture?window:Lt(),t.keydownListenerCapture=e.keydownListenerCapture,t.keydownTarget.addEventListener("keydown",t.keydownHandler,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0)},LE=(t,e)=>{var n;const s=$E();if(s.length){t=t+e,t===-2&&(t=s.length-1),t===s.length?t=0:t===-1&&(t=s.length-1),s[t].focus();return}(n=Lt())===null||n===void 0||n.focus()},K_=["ArrowRight","ArrowDown"],mK=["ArrowLeft","ArrowUp"],hK=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?pK(e,t):e.key==="Tab"?fK(e):[...K_,...mK].includes(e.key)?gK(e.key):e.key==="Escape"&&xK(e,t,n)))},pK=(t,e)=>{if(!tx(e.allowEnterKey))return;const n=ax(Lt(),e.input);if(t.target&&n&&t.target instanceof HTMLElement&&t.target.outerHTML===n.outerHTML){if(["textarea","file"].includes(e.input))return;H_(),t.preventDefault()}},fK=t=>{const e=t.target,n=$E();let s=-1;for(let r=0;r<n.length;r++)if(e===n[r]){s=r;break}t.shiftKey?LE(s,-1):LE(s,1),t.stopPropagation(),t.preventDefault()},gK=t=>{const e=Nh(),n=oo(),s=mc(),r=sd();if(!e||!n||!s||!r)return;const a=[n,s,r];if(document.activeElement instanceof HTMLElement&&!a.includes(document.activeElement))return;const o=K_.includes(t)?"nextElementSibling":"previousElementSibling";let l=document.activeElement;if(l){for(let c=0;c<e.children.length;c++){if(l=l[o],!l)return;if(l instanceof HTMLButtonElement&&ur(l))break}l instanceof HTMLButtonElement&&l.focus()}},xK=(t,e,n)=>{tx(e.allowEscapeKey)&&(t.preventDefault(),n(ad.esc))};var od={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const yK=()=>{const t=qs();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},X_=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},Y_=typeof window<"u"&&!!window.GestureEvent,bK=()=>{if(Y_&&!ci(document.body,xe.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,Wt(document.body,xe.iosfix),wK()}},wK=()=>{const t=qs();if(!t)return;let e;t.ontouchstart=n=>{e=vK(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},vK=t=>{const e=t.target,n=qs(),s=SE();return!n||!s||EK(t)||NK(t)?!1:e===n||!RE(n)&&e instanceof HTMLElement&&!vq(e,s)&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(RE(s)&&s.contains(e))},EK=t=>t.touches&&t.touches.length&&t.touches[0].touchType==="stylus",NK=t=>t.touches&&t.touches.length>1,kK=()=>{if(ci(document.body,xe.iosfix)){const t=parseInt(document.body.style.top,10);Qr(document.body,xe.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},SK=()=>{const t=document.createElement("div");t.className=xe["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let id=null;const CK=t=>{id===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(id=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${id+SK()}px`)},IK=()=>{id!==null&&(document.body.style.paddingRight=`${id}px`,id=null)};function Z_(t,e,n,s){rx()?Q_(t,s):(hq(n).then(()=>Q_(t,s)),q_(ot)),Y_?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),TE()&&(IK(),kK(),X_()),$K()}function $K(){Qr([document.documentElement,document.body],[xe.shown,xe["height-auto"],xe["no-backdrop"],xe["toast-shown"]])}function tl(t){t=AK(t);const e=od.swalPromiseResolve.get(this),n=TK(this);this.isAwaitingPromise?t.isDismissed||(Ch(this),e(t)):n&&e(t)}const TK=t=>{const e=Lt();if(!e)return!1;const n=on.innerParams.get(t);if(!n||ci(e,n.hideClass.popup))return!1;Qr(e,n.showClass.popup),Wt(e,n.hideClass.popup);const s=qs();return Qr(s,n.showClass.backdrop),Wt(s,n.hideClass.backdrop),RK(t,e,n),!0};function J_(t){const e=od.swalPromiseReject.get(this);Ch(this),e&&e(t)}const Ch=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,on.innerParams.get(t)||t._destroy())},AK=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),RK=(t,e,n)=>{var s;const r=qs(),a=P_(e);typeof n.willClose=="function"&&n.willClose(e),(s=ot.eventEmitter)===null||s===void 0||s.emit("willClose",e),a?_K(t,e,r,n.returnFocus,n.didClose):Z_(t,r,n.returnFocus,n.didClose)},_K=(t,e,n,s,r)=>{ot.swalCloseEventFinishedCallback=Z_.bind(null,t,n,s,r);const a=function(o){if(o.target===e){var l;(l=ot.swalCloseEventFinishedCallback)===null||l===void 0||l.call(ot),delete ot.swalCloseEventFinishedCallback,e.removeEventListener("animationend",a),e.removeEventListener("transitionend",a)}};e.addEventListener("animationend",a),e.addEventListener("transitionend",a)},Q_=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=ot.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},ld=t=>{let e=Lt();if(e||new gc,e=Lt(),!e)return;const n=rd();rx()?As(nd()):DK(e,t),os(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},DK=(t,e)=>{const n=Nh(),s=rd();!n||!s||(!e&&ur(oo())&&(e=oo()),os(n),e&&(As(e),s.setAttribute("data-button-to-replace",e.className),n.insertBefore(s,e)),Wt([t,n],xe.loading))},PK=(t,e)=>{e.input==="select"||e.input==="radio"?zK(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(NE(e.inputValue)||kE(e.inputValue))&&(ld(oo()),BK(t,e))},FK=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return MK(n);case"radio":return OK(n);case"file":return LK(n);default:return e.inputAutoTrim?n.value.trim():n.value}},MK=t=>t.checked?1:0,OK=t=>t.checked?t.value:null,LK=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,zK=(t,e)=>{const n=Lt();if(!n)return;const s=r=>{e.input==="select"?UK(n,ux(r),e):e.input==="radio"&&VK(n,ux(r),e)};NE(e.inputOptions)||kE(e.inputOptions)?(ld(oo()),vh(e.inputOptions).then(r=>{t.hideLoading(),s(r)})):typeof e.inputOptions=="object"?s(e.inputOptions):dc(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},BK=(t,e)=>{const n=t.getInput();n&&(As(n),vh(e.inputValue).then(s=>{n.value=e.input==="number"?`${parseFloat(s)||0}`:`${s}`,os(n),n.focus(),t.hideLoading()}).catch(s=>{dc(`Error in inputValue promise: ${s}`),n.value="",os(n),n.focus(),t.hideLoading()}))};function UK(t,e,n){const s=el(t,xe.select);if(!s)return;const r=(a,o,l)=>{const c=document.createElement("option");c.value=l,Tr(c,o),c.selected=eD(l,n.inputValue),a.appendChild(c)};e.forEach(a=>{const o=a[0],l=a[1];if(Array.isArray(l)){const c=document.createElement("optgroup");c.label=o,c.disabled=!1,s.appendChild(c),l.forEach(u=>r(c,u[1],u[0]))}else r(s,l,o)}),s.focus()}function VK(t,e,n){const s=el(t,xe.radio);if(!s)return;e.forEach(a=>{const o=a[0],l=a[1],c=document.createElement("input"),u=document.createElement("label");c.type="radio",c.name=xe.radio,c.value=o,eD(o,n.inputValue)&&(c.checked=!0);const d=document.createElement("span");Tr(d,l),d.className=xe.label,u.appendChild(c),u.appendChild(d),s.appendChild(u)});const r=s.querySelectorAll("input");r.length&&r[0].focus()}const ux=t=>{const e=[];return t instanceof Map?t.forEach((n,s)=>{let r=n;typeof r=="object"&&(r=ux(r)),e.push([s,r])}):Object.keys(t).forEach(n=>{let s=t[n];typeof s=="object"&&(s=ux(s)),e.push([n,s])}),e},eD=(t,e)=>!!e&&e.toString()===t.toString(),WK=t=>{const e=on.innerParams.get(t);t.disableButtons(),e.input?tD(t,"confirm"):BE(t,!0)},jK=t=>{const e=on.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?tD(t,"deny"):zE(t,!1)},GK=(t,e)=>{t.disableButtons(),e(ad.cancel)},tD=(t,e)=>{const n=on.innerParams.get(t);if(!n.input){dc(`The "input" parameter is needed to be set when using returnInputValueOn${EE(e)}`);return}const s=t.getInput(),r=FK(t,n);n.inputValidator?HK(t,r,e):s&&!s.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||s.validationMessage)):e==="deny"?zE(t,r):BE(t,r)},HK=(t,e,n)=>{const s=on.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>vh(s.inputValidator(e,s.validationMessage))).then(a=>{t.enableButtons(),t.enableInput(),a?t.showValidationMessage(a):n==="deny"?zE(t,e):BE(t,e)})},zE=(t,e)=>{const n=on.innerParams.get(t||void 0);n.showLoaderOnDeny&&ld(mc()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>vh(n.preDeny(e,n.validationMessage))).then(r=>{r===!1?(t.hideLoading(),Ch(t)):t.close({isDenied:!0,value:typeof r>"u"?e:r})}).catch(r=>sD(t||void 0,r))):t.close({isDenied:!0,value:e})},nD=(t,e)=>{t.close({isConfirmed:!0,value:e})},sD=(t,e)=>{t.rejectPromise(e)},BE=(t,e)=>{const n=on.innerParams.get(t||void 0);n.showLoaderOnConfirm&&ld(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>vh(n.preConfirm(e,n.validationMessage))).then(r=>{ur(nx())||r===!1?(t.hideLoading(),Ch(t)):nD(t,typeof r>"u"?e:r)}).catch(r=>sD(t||void 0,r))):nD(t,e)};function dx(){const t=on.innerParams.get(this);if(!t)return;const e=on.domCache.get(this);As(e.loader),rx()?t.icon&&os(nd()):qK(e),Qr([e.popup,e.actions],xe.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const qK=t=>{const e=t.popup.getElementsByClassName(t.loader.getAttribute("data-button-to-replace"));e.length?os(e[0],"inline-block"):wq()&&As(t.actions)};function rD(){const t=on.innerParams.get(this),e=on.domCache.get(this);return e?ax(e.popup,t.input):null}function aD(t,e,n){const s=on.domCache.get(t);e.forEach(r=>{s[r].disabled=n})}function oD(t,e){const n=Lt();if(!(!n||!t))if(t.type==="radio"){const s=n.querySelectorAll(`[name="${xe.radio}"]`);for(let r=0;r<s.length;r++)s[r].disabled=e}else t.disabled=e}function iD(){aD(this,["confirmButton","denyButton","cancelButton"],!1)}function lD(){aD(this,["confirmButton","denyButton","cancelButton"],!0)}function cD(){oD(this.getInput(),!1)}function uD(){oD(this.getInput(),!0)}function dD(t){const e=on.domCache.get(this),n=on.innerParams.get(this);Tr(e.validationMessage,t),e.validationMessage.className=xe["validation-message"],n.customClass&&n.customClass.validationMessage&&Wt(e.validationMessage,n.customClass.validationMessage),os(e.validationMessage);const s=this.getInput();s&&(s.setAttribute("aria-invalid","true"),s.setAttribute("aria-describedby",xe["validation-message"]),R_(s),Wt(s,xe.inputerror))}function mD(){const t=on.domCache.get(this);t.validationMessage&&As(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Qr(e,xe.inputerror))}const cd={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},KK=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],XK={allowEnterKey:void 0},YK=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],hD=t=>Object.prototype.hasOwnProperty.call(cd,t),pD=t=>KK.indexOf(t)!==-1,fD=t=>XK[t],ZK=t=>{hD(t)||Hs(`Unknown parameter "${t}"`)},JK=t=>{YK.includes(t)&&Hs(`The parameter "${t}" is incompatible with toasts`)},QK=t=>{const e=fD(t);e&&I_(t,e)},gD=t=>{t.backdrop===!1&&t.allowOutsideClick&&Hs('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","embed-iframe","bulma","bulma-light","bulma-dark"].includes(t.theme)&&Hs(`Invalid theme "${t.theme}"`);for(const e in t)ZK(e),t.toast&&JK(e),QK(e)};function xD(t){const e=qs(),n=Lt(),s=on.innerParams.get(this);if(!n||ci(n,s.hideClass.popup)){Hs("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const r=eX(t),a=Object.assign({},s,r);gD(a),e.dataset.swal2Theme=a.theme,G_(this,a),on.innerParams.set(this,a),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const eX=t=>{const e={};return Object.keys(t).forEach(n=>{pD(n)?e[n]=t[n]:Hs(`Invalid parameter to update: ${n}`)}),e};function yD(){const t=on.domCache.get(this),e=on.innerParams.get(this);if(!e){bD(this);return}t.popup&&ot.swalCloseEventFinishedCallback&&(ot.swalCloseEventFinishedCallback(),delete ot.swalCloseEventFinishedCallback),typeof e.didDestroy=="function"&&e.didDestroy(),ot.eventEmitter.emit("didDestroy"),tX(this)}const tX=t=>{bD(t),delete t.params,delete ot.keydownHandler,delete ot.keydownTarget,delete ot.currentInstance},bD=t=>{t.isAwaitingPromise?(UE(on,t),t.isAwaitingPromise=!0):(UE(od,t),UE(on,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},UE=(t,e)=>{for(const n in t)t[n].delete(e)};var nX=Object.freeze({__proto__:null,_destroy:yD,close:tl,closeModal:tl,closePopup:tl,closeToast:tl,disableButtons:lD,disableInput:uD,disableLoading:dx,enableButtons:iD,enableInput:cD,getInput:rD,handleAwaitingPromise:Ch,hideLoading:dx,rejectPromise:J_,resetValidationMessage:mD,showValidationMessage:dD,update:xD});const sX=(t,e,n)=>{t.toast?rX(t,e,n):(oX(e),iX(e),lX(t,e,n))},rX=(t,e,n)=>{e.popup.onclick=()=>{t&&(aX(t)||t.timer||t.input)||n(ad.close)}},aX=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let mx=!1;const oX=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(mx=!0)}}},iX=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(mx=!0)}}},lX=(t,e,n)=>{e.container.onclick=s=>{if(mx){mx=!1;return}s.target===e.container&&tx(t.allowOutsideClick)&&n(ad.backdrop)}},cX=t=>typeof t=="object"&&t.jquery,wD=t=>t instanceof Element||cX(t),uX=t=>{const e={};return typeof t[0]=="object"&&!wD(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,s)=>{const r=t[s];typeof r=="string"||wD(r)?e[n]=r:r!==void 0&&dc(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof r}`)}),e};function dX(...t){return new this(...t)}function mX(t){class e extends this{_main(s,r){return super._main(s,Object.assign({},t,r))}}return e}const hX=()=>ot.timeout&&ot.timeout.getTimerLeft(),vD=()=>{if(ot.timeout)return Eq(),ot.timeout.stop()},ED=()=>{if(ot.timeout){const t=ot.timeout.start();return _E(t),t}},pX=()=>{const t=ot.timeout;return t&&(t.running?vD():ED())},fX=t=>{if(ot.timeout){const e=ot.timeout.increase(t);return _E(e,!0),e}},gX=()=>!!(ot.timeout&&ot.timeout.isRunning());let ND=!1;const VE={};function xX(t="data-swal-template"){VE[t]=this,ND||(document.body.addEventListener("click",yX),ND=!0)}const yX=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in VE){const s=e.getAttribute(n);if(s){VE[n].fire({template:s});return}}};class bX{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const s=this._getHandlersByEventName(e);s.includes(n)||s.push(n)}once(e,n){const s=(...r)=>{this.removeListener(e,s),n.apply(this,r)};this.on(e,s)}emit(e,...n){this._getHandlersByEventName(e).forEach(s=>{try{s.apply(this,n)}catch(r){console.error(r)}})}removeListener(e,n){const s=this._getHandlersByEventName(e),r=s.indexOf(n);r>-1&&s.splice(r,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}ot.eventEmitter=new bX;var wX=Object.freeze({__proto__:null,argsToParams:uX,bindClickHandler:xX,clickCancel:uK,clickConfirm:H_,clickDeny:cK,enableLoading:ld,fire:dX,getActions:Nh,getCancelButton:sd,getCloseButton:IE,getConfirmButton:oo,getContainer:qs,getDenyButton:mc,getFocusableElements:$E,getFooter:A_,getHtmlContainer:SE,getIcon:nd,getIconContent:fq,getImage:T_,getInputLabel:gq,getLoader:rd,getPopup:Lt,getProgressSteps:CE,getTimerLeft:hX,getTimerProgressBar:sx,getTitle:$_,getValidationMessage:nx,increaseTimer:fX,isDeprecatedParameter:fD,isLoading:yq,isTimerRunning:gX,isUpdatableParameter:pD,isValidParameter:hD,isVisible:lK,mixin:mX,off:(t,e)=>{if(!t){ot.eventEmitter.reset();return}e?ot.eventEmitter.removeListener(t,e):ot.eventEmitter.removeAllListeners(t)},on:(t,e)=>{ot.eventEmitter.on(t,e)},once:(t,e)=>{ot.eventEmitter.once(t,e)},resumeTimer:ED,showLoading:ld,stopTimer:vD,toggleTimer:pX});class vX{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const kD=["swal-title","swal-html","swal-footer"],EX=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return AX(n),Object.assign(NX(n),kX(n),SX(n),CX(n),IX(n),$X(n),TX(n,kD))},NX=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(s=>{fc(s,["name","value"]);const r=s.getAttribute("name"),a=s.getAttribute("value");!r||!a||(typeof cd[r]=="boolean"?e[r]=a!=="false":typeof cd[r]=="object"?e[r]=JSON.parse(a):e[r]=a)}),e},kX=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(s=>{const r=s.getAttribute("name"),a=s.getAttribute("value");!r||!a||(e[r]=new Function(`return ${a}`)())}),e},SX=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(s=>{fc(s,["type","color","aria-label"]);const r=s.getAttribute("type");!r||!["confirm","cancel","deny"].includes(r)||(e[`${r}ButtonText`]=s.innerHTML,e[`show${EE(r)}Button`]=!0,s.hasAttribute("color")&&(e[`${r}ButtonColor`]=s.getAttribute("color")),s.hasAttribute("aria-label")&&(e[`${r}ButtonAriaLabel`]=s.getAttribute("aria-label")))}),e},CX=t=>{const e={},n=t.querySelector("swal-image");return n&&(fc(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},IX=t=>{const e={},n=t.querySelector("swal-icon");return n&&(fc(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},$X=t=>{const e={},n=t.querySelector("swal-input");n&&(fc(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const s=Array.from(t.querySelectorAll("swal-input-option"));return s.length&&(e.inputOptions={},s.forEach(r=>{fc(r,["value"]);const a=r.getAttribute("value");if(!a)return;const o=r.innerHTML;e.inputOptions[a]=o})),e},TX=(t,e)=>{const n={};for(const s in e){const r=e[s],a=t.querySelector(r);a&&(fc(a,[]),n[r.replace(/^swal-/,"")]=a.innerHTML.trim())}return n},AX=t=>{const e=kD.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const s=n.tagName.toLowerCase();e.includes(s)||Hs(`Unrecognized element <${s}>`)})},fc=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&Hs([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},SD=10,RX=t=>{const e=qs(),n=Lt();typeof t.willOpen=="function"&&t.willOpen(n),ot.eventEmitter.emit("willOpen",n);const r=window.getComputedStyle(document.body).overflowY;PX(e,n,t),setTimeout(()=>{_X(e,n)},SD),TE()&&(DX(e,t.scrollbarPadding,r),yK()),!rx()&&!ot.previousActiveElement&&(ot.previousActiveElement=document.activeElement),typeof t.didOpen=="function"&&setTimeout(()=>t.didOpen(n)),ot.eventEmitter.emit("didOpen",n),Qr(e,xe["no-transition"])},hx=t=>{const e=Lt();if(t.target!==e)return;const n=qs();e.removeEventListener("animationend",hx),e.removeEventListener("transitionend",hx),n.style.overflowY="auto"},_X=(t,e)=>{P_(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",hx),e.addEventListener("transitionend",hx)):t.style.overflowY="auto"},DX=(t,e,n)=>{bK(),e&&n!=="hidden"&&CK(n),setTimeout(()=>{t.scrollTop=0})},PX=(t,e,n)=>{Wt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),os(e,"grid"),setTimeout(()=>{Wt(e,n.showClass.popup),e.style.removeProperty("opacity")},SD)):os(e,"grid"),Wt([document.documentElement,document.body],xe.shown),n.heightAuto&&n.backdrop&&!n.toast&&Wt([document.documentElement,document.body],xe["height-auto"])};var CD={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function FX(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=CD.email),t.input==="url"&&(t.inputValidator=CD.url))}function MX(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(Hs('Target parameter is not valid, defaulting to "body"'),t.target="body")}function OX(t){FX(t),t.showLoaderOnConfirm&&!t.preConfirm&&Hs(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),MX(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),Aq(t)}let io;var px=new WeakMap;class Fn{constructor(...e){if(cq(this,px,void 0),typeof window>"u")return;io=this;const n=Object.freeze(this.constructor.argsToParams(e));this.params=n,this.isAwaitingPromise=!1,uq(px,this,this._main(io.params))}_main(e,n={}){if(gD(Object.assign({},n,e)),ot.currentInstance){const a=od.swalPromiseResolve.get(ot.currentInstance),{isAwaitingPromise:o}=ot.currentInstance;ot.currentInstance._destroy(),o||a({isDismissed:!0}),TE()&&X_()}ot.currentInstance=io;const s=zX(e,n);OX(s),Object.freeze(s),ot.timeout&&(ot.timeout.stop(),delete ot.timeout),clearTimeout(ot.restoreFocusTimeout);const r=BX(io);return G_(io,s),on.innerParams.set(io,s),LX(io,r,s)}then(e){return N_(px,this).then(e)}finally(e){return N_(px,this).finally(e)}}const LX=(t,e,n)=>new Promise((s,r)=>{const a=o=>{t.close({isDismissed:!0,dismiss:o})};od.swalPromiseResolve.set(t,s),od.swalPromiseReject.set(t,r),e.confirmButton.onclick=()=>{WK(t)},e.denyButton.onclick=()=>{jK(t)},e.cancelButton.onclick=()=>{GK(t,a)},e.closeButton.onclick=()=>{a(ad.close)},sX(n,e,a),dK(ot,n,a),PK(t,n),RX(n),UX(ot,n,a),VX(e,n),setTimeout(()=>{e.container.scrollTop=0})}),zX=(t,e)=>{const n=EX(t),s=Object.assign({},cd,e,n,t);return s.showClass=Object.assign({},cd.showClass,s.showClass),s.hideClass=Object.assign({},cd.hideClass,s.hideClass),s.animation===!1&&(s.showClass={backdrop:"swal2-noanimation"},s.hideClass={}),s},BX=t=>{const e={popup:Lt(),container:qs(),actions:Nh(),confirmButton:oo(),denyButton:mc(),cancelButton:sd(),loader:rd(),closeButton:IE(),validationMessage:nx(),progressSteps:CE()};return on.domCache.set(t,e),e},UX=(t,e,n)=>{const s=sx();As(s),e.timer&&(t.timeout=new vX(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&(os(s),Ar(s,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&_E(e.timer)})))},VX=(t,e)=>{if(!e.toast){if(!tx(e.allowEnterKey)){I_("allowEnterKey"),GX();return}WX(t)||jX(t,e)||LE(-1,1)}},WX=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&ur(n))return n.focus(),!0;return!1},jX=(t,e)=>e.focusDeny&&ur(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&ur(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&ur(t.confirmButton)?(t.confirmButton.focus(),!0):!1,GX=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const t=new Date,e=localStorage.getItem("swal-initiation");e?(t.getTime()-Date.parse(e))/(1e3*60*60*24)>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const n=document.createElement("audio");n.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",n.loop=!0,document.body.appendChild(n),setTimeout(()=>{n.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${t}`)}Fn.prototype.disableButtons=lD,Fn.prototype.enableButtons=iD,Fn.prototype.getInput=rD,Fn.prototype.disableInput=uD,Fn.prototype.enableInput=cD,Fn.prototype.hideLoading=dx,Fn.prototype.disableLoading=dx,Fn.prototype.showValidationMessage=dD,Fn.prototype.resetValidationMessage=mD,Fn.prototype.close=tl,Fn.prototype.closePopup=tl,Fn.prototype.closeModal=tl,Fn.prototype.closeToast=tl,Fn.prototype.rejectPromise=J_,Fn.prototype.update=xD,Fn.prototype._destroy=yD,Object.assign(Fn,wX),Object.keys(nX).forEach(t=>{Fn[t]=function(...e){return io&&io[t]?io[t](...e):null}}),Fn.DismissReason=ad,Fn.version="11.22.0";const gc=Fn;gc.default=gc,typeof document<"u"&&function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.1s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px $swal2-outline-color;--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');class HX extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("Uncaught error:",e,n)}render(){return this.state.hasError?i.createElement("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg text-red-700"},i.createElement("h2",{className:"text-lg font-bold mb-2"},"Something went wrong"),i.createElement("p",{className:"mb-4"},"We encountered an error while displaying this component."),i.createElement("pre",{className:"text-xs bg-red-100 p-2 rounded overflow-auto max-h-40"},this.state.error?.toString()),i.createElement("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"},"Reload Page")):this.props.children}}const ID=N.createContext(null),qX=(t,e)=>e.split(".").reduce((n,s)=>n&&n[s],t),Rs=({value:t,field:e,icon:n,className:s=""})=>{const{company:r,editingField:a,editMode:o,tempValues:l,setEditingField:c,setTempValues:u,handleApplyChanges:d}=N.useContext(ID),m=a===e&&o,h=s.includes("text-white")||s.includes("text-5xl"),p=()=>{o&&(c(e),u(x=>({...x,[e]:qX(r,e)||""})))},f=x=>{x.stopPropagation(),d(e)},y=x=>{x.stopPropagation(),c(null),u(g=>({...g,[e]:void 0}))};return i.createElement("div",{className:`relative group ${s}`,onClick:p},n&&!m&&i.createElement(n,{size:18,className:"flex-shrink-0"}),m?i.createElement("div",{className:"mt-2 w-full"},i.createElement("input",{type:"text",value:l[e]||"",onClick:x=>x.stopPropagation(),onChange:x=>u(g=>({...g,[e]:x.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none ${h?"border-white/30 bg-white/20 backdrop-blur-sm text-white placeholder-white/70":"border-indigo-300 bg-white !text-black"}`,placeholder:h?t||"Enter text...":""}),i.createElement("div",{className:"absolute right-0 top-full mt-2 flex gap-2 z-50"},i.createElement("button",{onClick:f,className:"p-1.5 bg-green-500 text-white rounded-md hover:bg-green-600 shadow-lg"},i.createElement(eo,{size:14})),i.createElement("button",{onClick:y,className:"p-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 shadow-lg"},i.createElement(Yo,{size:14})))):i.createElement(i.Fragment,null,i.createElement("span",{className:h?"":"text-gray-800"},t||"Not set"),o&&i.createElement("button",{className:`absolute -right-3 -top-3 opacity-0 group-hover:opacity-100 p-1 rounded-full shadow-md transition-all ${h?"bg-white/20 backdrop-blur-sm text-white hover:text-yellow-300":"bg-white text-gray-600 hover:text-indigo-600"}`,onClick:()=>p()},i.createElement(dA,{size:12}))))};function KX(){const[t,e]=N.useState({}),[n,s]=N.useState(!0),[r,a]=N.useState(null),[o,l]=N.useState(null),[c,u]=N.useState({}),[d,m]=N.useState(!1),[h,p]=N.useState(!1),[f,y]=N.useState(!1),[x,g]=N.useState("");N.useState(!1);const[b,w]=N.useState(!1),v=$e.get("companyId");console.log("Stored companyId from cookie:",v),N.useEffect(()=>{v&&(console.log(" CompanyProfile component loaded, checking step status..."),k())},[v]),N.useEffect(()=>{t&&Object.keys(t).length>0&&v&&(console.log(" Company data loaded, checking if step should be auto-completed..."),setTimeout(()=>{k()},500))},[t,v]),N.useEffect(()=>{console.log(" useEffect triggered:",{hasCompany:!!t,isStepCompleted:b,hasBasicInfo:E()}),t&&!b&&E()&&(console.log(" Triggering automatic step completion check"),k())},[t,b]);const E=()=>{const D=t.name&&t.industry&&t.contact?.email;return console.log(" Checking basic info:",{name:t.name,industry:t.industry,email:t.contact?.email,hasInfo:D}),D},k=async()=>{try{if(!v){console.log(" No companyId available for step status check");return}console.log(" Checking step 1 status for company:",v);const D=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${v}/onboarding`);if(console.log(" API response for onboarding:",D.data),D.data&&D.data.completedSteps&&Array.isArray(D.data.completedSteps))if(D.data.completedSteps.includes(1)){console.log(" Step 1 is already completed according to API"),w(!0);return}else console.log(" Step 1 is not completed according to API");const _=localStorage.getItem("companyOnboardingProgress");if(_)try{const P=JSON.parse(_);if(console.log(" Stored progress from localStorage:",P),P.completedSteps&&Array.isArray(P.completedSteps)&&P.completedSteps.includes(1)){console.log(" Step 1 found in localStorage, setting as completed"),w(!0);return}}catch(P){console.error(" Error parsing stored progress:",P)}else console.log(" No stored progress found in localStorage");if(E()){console.log(" Auto-completing step 1 locally because basic info is present"),w(!0);const P=D.data?.completedSteps||[],z=P.includes(1)?P:[...P,1],q={currentPhase:1,completedSteps:z,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(q)),$e.set("companyProfileStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:1,phaseId:1,status:"completed",completedSteps:z}})),console.log(" Step 1 marked as completed locally and parent component notified")}else console.log(" Cannot auto-complete step 1 because basic info is missing")}catch(D){console.error(" Error checking step status:",D)}},C=t.contact&&(t.contact.email||t.contact.phone||t.contact.website||t.contact.address),I=t.socialMedia&&(t.socialMedia.linkedin||t.socialMedia.twitter||t.socialMedia.facebook||t.socialMedia.instagram),A=t.location&&t.location.lat&&t.location.lng,$=()=>t.contact?.address?`https://www.google.com/maps/embed/v1/place?key=undefined&q=${encodeURIComponent(t.contact.address)}`:A?`https://www.google.com/maps/embed/v1/view?key=YOUR_API_KEY&center=${t.location.lat},${t.location.lng}&zoom=15`:null,T=()=>t.contact?.address?`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(t.contact.address)}`:A?`https://www.google.com/maps/dir/?api=1&destination=${t.location.lat},${t.location.lng}`:null,F=D=>{g(D.target.value)},O=async()=>{try{s(!0);const D=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/companies/${v}/details`);e(D.data.data),D.data.data.logo?g(D.data.data.logo):D.data.data.logoUrl&&g(D.data.data.logoUrl)}catch{a("Erreur lors du chargement des dtails de l'entreprise.")}finally{s(!1)}},M=D=>{e(_=>{const P=JSON.parse(JSON.stringify(_));if(D.includes(".")){const z=D.split(".");let q=P;for(let K=0;K<z.length-1;K++){const ae=z[K];if(!q[ae]){const ne=z[K+1],Z=!isNaN(Number(ne));q[ae]=Z?[]:{}}q=q[ae]}q[z[z.length-1]]=c[D]}else P[D]=c[D];return P}),l(null),u({}),p(!0)},B=async()=>{try{if(console.log(" Starting save process..."),console.log(" Current company data:",t),console.log(" Has basic info:",E()),console.log(" Is step completed:",b),await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/companies/${v}`,t),console.log(" Company data saved successfully"),!b&&E()){console.log(" Marking step 1 as completed...");try{console.log(" Marking step 1 as completed in onboarding...");const _=(await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${v}/onboarding`)).data?.completedSteps||[],P=_.includes(1)?_:[..._,1],z=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${v}/onboarding`,{completedSteps:P,currentPhase:1});console.log(" Company Profile step 1 marked as completed:",z.data),w(!0);const q={currentPhase:1,completedSteps:P,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(q)),$e.set("companyProfileStepCompleted","true",{expires:7}),console.log(" Local state and storage updated after step completion")}catch(D){console.error(" Error updating onboarding progress:",D)}}else console.log(" Step not marked as completed because:",{isStepCompleted:b,hasBasicInfo:E()});p(!1),m(!0),gc.fire({title:"Success!",text:"Company profile updated successfully and step marked as completed!",icon:"success",confirmButtonText:"Ok"}),setTimeout(()=>m(!1),3e3)}catch(D){console.error("Erreur lors de la sauvegarde :",D),gc.fire({title:"Error!",text:"There was an error updating the company profile.",icon:"error",confirmButtonText:"Try Again"})}};if(N.useEffect(()=>{O()},[]),n)return i.createElement("div",{className:"min-h-screen bg-gray-50 p-4"},i.createElement("div",{className:"bg-white rounded-2xl shadow-xl w-full p-8"},i.createElement("div",{className:"animate-pulse space-y-6"},i.createElement("div",{className:"h-20 bg-gray-200 rounded-xl w-full"}),i.createElement("div",{className:"flex gap-6"},i.createElement("div",{className:"h-24 w-24 bg-gray-200 rounded-xl"}),i.createElement("div",{className:"space-y-4 flex-1"},i.createElement("div",{className:"h-10 bg-gray-200 rounded w-3/4"}),i.createElement("div",{className:"h-6 bg-gray-200 rounded w-1/2"}))),i.createElement("div",{className:"space-y-4"},[1,2,3].map(D=>i.createElement("div",{key:D,className:"h-16 bg-gray-200 rounded-xl"}))))));const L={...t,name:t.name||"Company Name",industry:t.industry||"",overview:t.overview||"",mission:t.mission||"",founded:t.founded||"",headquarters:t.headquarters||"",logoUrl:t.logo||t.logoUrl||"",contact:t.contact||{},socialMedia:t.socialMedia||{},culture:t.culture||{values:[],benefits:[],workEnvironment:"Our workplace promotes collaboration and innovation."},opportunities:t.opportunities||{roles:[],growthPotential:"We offer clear career paths and growth opportunities.",training:"We invest in continuous learning and professional development."},technology:t.technology||{stack:[],innovation:"We use cutting-edge technologies to solve complex problems."}},Y={company:t,editingField:o,editMode:f,tempValues:c,setEditingField:l,setTempValues:u,handleApplyChanges:M};return i.createElement(ID.Provider,{value:Y},i.createElement(HX,null,i.createElement("div",{className:"min-h-screen bg-gray-50"},i.createElement("div",{className:"bg-white shadow-xl"},i.createElement("div",{className:"relative h-80"},i.createElement("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?auto=format&fit=crop&q=80')"}},i.createElement("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 via-indigo-800/85 to-blue-900/80"}),i.createElement("style",null,`
                  @keyframes shine {
                    0% { transform: translateX(-200%); }
                    100% { transform: translateX(200%); }
                  }
                `)),i.createElement("div",{className:"relative h-full flex flex-col justify-end p-12 space-y-6"},i.createElement("div",{className:"flex items-center gap-6"},i.createElement("div",{className:"relative group"},i.createElement("div",{className:`w-24 h-24 bg-white rounded-2xl shadow-xl flex items-center justify-center p-4 overflow-hidden ${f?"cursor-pointer":""}`},x?i.createElement("img",{src:x,alt:L.name,className:"w-full h-full object-contain",onError:D=>{D.currentTarget.src="",g("")}}):i.createElement(gs,{className:"w-full h-full text-indigo-600"}),f&&i.createElement("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},i.createElement("div",{className:"text-white text-center"},i.createElement(Xo,{size:20,className:"mx-auto mb-1"}),i.createElement("span",{className:"text-xs"},"Edit Logo")))),f&&o==="logo"&&i.createElement("div",{className:"absolute top-full left-0 mt-2 w-64 bg-white rounded-lg shadow-lg p-3 border border-gray-200"},i.createElement("div",{className:"space-y-2"},i.createElement("label",{className:"text-sm text-gray-600 block"},"Logo URL"),i.createElement("input",{type:"text",value:x,onChange:F,placeholder:"Enter logo URL...",className:"w-full px-3 py-1.5 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none !text-black !bg-white"}),i.createElement("div",{className:"flex justify-end gap-2 mt-2"},i.createElement("button",{onClick:()=>l(null),className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800"},"Cancel"),i.createElement("button",{onClick:()=>{e(D=>({...D,logo:x})),l(null),p(!0)},className:"px-3 py-1 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},"Save")))),f&&i.createElement("button",{onClick:()=>l(o==="logo"?null:"logo"),className:"absolute -right-2 -top-2 w-6 h-6 bg-white rounded-full shadow-md flex items-center justify-center text-gray-600 hover:text-indigo-600 transition-colors"},i.createElement(A1,{size:12}))),i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-3 mb-2"},i.createElement(Rs,{value:L.name,field:"name",className:"text-5xl font-bold text-white tracking-tight"})),i.createElement("div",{className:"flex flex-wrap gap-6 text-white/90"},L.industry&&i.createElement(Rs,{value:L.industry,field:"industry",icon:yW,className:"flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm"}),L.founded&&i.createElement(Rs,{value:L.founded,field:"founded",icon:Ia,className:"flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm"}),L.headquarters&&i.createElement(Rs,{value:L.headquarters,field:"headquarters",icon:to,className:"flex items-center gap-2 bg-white/10 px-4 py-2 rounded-full backdrop-blur-sm"}))))),i.createElement("div",{className:"absolute top-6 right-6 z-10"},i.createElement("button",{onClick:()=>{const D=!f;y(D),!D&&h&&B()},className:`p-3 rounded-full shadow-lg transition-all duration-300 transform hover:scale-105 ${f?"bg-indigo-600 text-white":"bg-white/90 backdrop-blur-sm text-indigo-600 hover:bg-white"}`},f?i.createElement(mA,{size:20}):i.createElement(dA,{size:20}))))),i.createElement("div",{className:"flex"},i.createElement("div",{className:"w-80 flex-shrink-0 bg-gradient-to-b from-gray-50 to-white border-r border-gray-200"},i.createElement("div",{className:"p-6 space-y-8"},C&&i.createElement("div",{className:"space-y-4"},i.createElement("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2"},i.createElement(Ku,{className:"text-blue-600",size:20}),"Contact Information"),i.createElement("div",{className:"space-y-3"},L.contact?.email&&i.createElement(Rs,{value:L.contact.email,field:"contact.email",icon:Ku,className:"flex items-center gap-3 text-gray-600 hover:text-blue-600 transition-colors text-sm"}),L.contact?.phone&&i.createElement(Rs,{value:L.contact.phone,field:"contact.phone",icon:Ql,className:"flex items-center gap-3 text-gray-600 hover:text-blue-600 transition-colors text-sm"}),L.contact?.website&&i.createElement(Rs,{value:L.contact.website,field:"contact.website",icon:gs,className:"flex items-center gap-3 text-gray-600 hover:text-blue-600 transition-colors text-sm"}),L.contact?.address&&i.createElement(Rs,{value:L.contact.address,field:"contact.address",icon:to,className:"flex items-start gap-3 text-gray-600 text-sm"})),(L.contact?.address||A)&&i.createElement("div",{className:"mt-4"},i.createElement("div",{className:"relative w-full h-[160px] rounded-xl overflow-hidden border border-gray-200 bg-gray-50"},$()?i.createElement(i.Fragment,null,i.createElement("iframe",{src:$(),width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade",className:"absolute inset-0"}),T()&&i.createElement("a",{href:T(),target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-2 right-2 px-3 py-1.5 bg-white/90 hover:bg-white text-sm text-blue-600 rounded-lg shadow-lg backdrop-blur-sm flex items-center gap-1.5 transition-all hover:scale-105"},i.createElement(to,{size:14}),"Get Directions")):i.createElement("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500 text-sm"},i.createElement("span",null,"Map not available"))))),I&&i.createElement("div",{className:"space-y-4"},i.createElement("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2"},i.createElement(gs,{className:"text-blue-600",size:20}),"Digital Presence"),i.createElement("div",{className:"flex gap-3"},L.socialMedia?.linkedin&&i.createElement("a",{href:L.socialMedia.linkedin,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-gray-200 hover:border-blue-400 hover:text-blue-600 transition-all duration-300 text-gray-600"},i.createElement($W,{size:20})),L.socialMedia?.twitter&&i.createElement("a",{href:L.socialMedia.twitter,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-gray-200 hover:border-blue-400 hover:text-blue-600 transition-all duration-300 text-gray-600"},i.createElement(zW,{size:20})),L.socialMedia?.facebook&&i.createElement("a",{href:L.socialMedia.facebook,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-gray-200 hover:border-blue-400 hover:text-blue-600 transition-all duration-300 text-gray-600"},i.createElement(sA,{size:20})),L.socialMedia?.instagram&&i.createElement("a",{href:L.socialMedia.instagram,target:"_blank",rel:"noopener noreferrer",className:"w-10 h-10 flex items-center justify-center rounded-lg bg-white border border-gray-200 hover:border-blue-400 hover:text-blue-600 transition-all duration-300 text-gray-600"},i.createElement(IW,{size:20})))))),i.createElement("div",{className:"flex-1"},i.createElement("div",{className:"p-12 space-y-16"},i.createElement("section",{className:"relative"},i.createElement("div",{className:"absolute -left-6 top-0 bottom-0 w-1 bg-gradient-to-b from-indigo-500 to-blue-500 rounded-full"}),i.createElement("div",{className:"space-y-8"},i.createElement("div",{className:"flex items-start gap-6"},i.createElement("div",{className:"w-12 h-12 rounded-2xl bg-indigo-100 flex items-center justify-center flex-shrink-0"},i.createElement(Ym,{className:"text-indigo-600",size:24})),i.createElement("div",{className:"flex-1"},i.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Company Overview"),i.createElement(Rs,{value:L.overview,field:"overview",className:"text-gray-700 leading-relaxed text-lg"}))),L.mission&&i.createElement("div",{className:"ml-18 p-8 bg-gradient-to-br from-indigo-50 via-blue-50 to-white rounded-2xl border border-indigo-100/50 shadow-sm"},i.createElement("div",{className:"flex items-start gap-4"},i.createElement("div",{className:"w-12 h-12 rounded-2xl bg-indigo-500 flex items-center justify-center"},i.createElement(ys,{className:"text-white",size:24})),i.createElement("div",null,i.createElement("h3",{className:"text-xl font-bold text-indigo-700 mb-3"},"Our Mission"),i.createElement(Rs,{value:L.mission,field:"mission",className:"text-gray-700"})))))),i.createElement("div",{className:"grid md:grid-cols-2 gap-10"},i.createElement("section",{className:"space-y-8"},i.createElement("div",{className:"flex items-start gap-6"},i.createElement("div",{className:"w-12 h-12 rounded-2xl bg-rose-100 flex items-center justify-center flex-shrink-0"},i.createElement(SW,{className:"text-rose-600",size:24})),i.createElement("div",{className:"flex-1"},i.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Culture & Values"),i.createElement("div",{className:"space-y-4"},L.culture.values&&L.culture.values.map((D,_)=>i.createElement(Rs,{key:_,value:D,field:`culture.values.${_}`,icon:fW,className:"p-4 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md hover:scale-[1.02] transition-all duration-300"})))))),i.createElement("section",{className:"space-y-8"},i.createElement("div",{className:"flex items-start gap-6"},i.createElement("div",{className:"w-12 h-12 rounded-2xl bg-emerald-100 flex items-center justify-center flex-shrink-0"},i.createElement(LW,{className:"text-emerald-600",size:24})),i.createElement("div",{className:"flex-1"},i.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Key Benefits"),i.createElement("div",{className:"space-y-4"},L.culture.benefits&&L.culture.benefits.map((D,_)=>i.createElement(Rs,{key:_,value:D,field:`culture.benefits.${_}`,icon:Sa,className:"p-4 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md hover:scale-[1.02] transition-all duration-300"}))))))),i.createElement("section",{className:"relative"},i.createElement("div",{className:"absolute -left-6 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-500 to-indigo-500 rounded-full"}),i.createElement("div",{className:"flex items-start gap-6"},i.createElement("div",{className:"w-12 h-12 rounded-2xl bg-blue-100 flex items-center justify-center flex-shrink-0"},i.createElement(pW,{className:"text-blue-600",size:24})),i.createElement("div",{className:"flex-1"},i.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Tech Stack"),i.createElement("div",{className:"flex flex-wrap gap-3"},L.technology.stack&&L.technology.stack.map((D,_)=>i.createElement(Rs,{key:_,value:D,field:`technology.stack.${_}`,className:"px-4 py-2 bg-gray-100/50 rounded-lg text-gray-700 font-medium hover:bg-indigo-50 hover:text-indigo-600 transition-colors"}))),L.technology.innovation&&i.createElement("div",{className:"mt-6 p-6 bg-blue-50 rounded-xl border border-blue-100"},i.createElement("div",{className:"flex items-start gap-3"},i.createElement(_1,{className:"text-blue-600 mt-1",size:20}),i.createElement("div",null,i.createElement("h4",{className:"font-semibold text-blue-900 mb-1"},"Innovation Focus"),i.createElement(Rs,{value:L.technology.innovation,field:"technology.innovation",className:"text-blue-800"}))))))),i.createElement("section",{className:"space-y-8"},i.createElement("div",{className:"flex items-start gap-6"},i.createElement("div",{className:"w-12 h-12 rounded-2xl bg-purple-100 flex items-center justify-center flex-shrink-0"},i.createElement(Ca,{className:"text-purple-600",size:24})),i.createElement("div",{className:"flex-1"},i.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-6"},"Career Growth"),i.createElement("div",{className:"grid md:grid-cols-2 gap-6"},i.createElement("div",{className:"p-6 bg-white rounded-xl shadow-sm border border-gray-100"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-purple-50 rounded-lg"},i.createElement(Un,{className:"text-purple-600",size:18})),i.createElement("h3",{className:"font-semibold text-gray-900"},"Growth Potential")),i.createElement(Rs,{value:L.opportunities.growthPotential,field:"opportunities.growthPotential",className:"text-gray-600"})),i.createElement("div",{className:"p-6 bg-white rounded-xl shadow-sm border border-gray-100"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-purple-50 rounded-lg"},i.createElement(NW,{className:"text-purple-600",size:18})),i.createElement("h3",{className:"font-semibold text-gray-900"},"Learning & Development")),i.createElement(Rs,{value:L.opportunities.training,field:"opportunities.training",className:"text-gray-600"}))))))))))))}const XX=()=>{const[t,e]=N.useState("automatic"),[n,s]=N.useState([]),[r,a]=N.useState("pending"),[o,l]=N.useState(1),[c,u]=N.useState(!1),[d,m]=N.useState(null),[h,p]=N.useState(!1),f=$e.get("companyId");N.useEffect(()=>{f&&y()},[f]),N.useEffect(()=>{f&&x()&&!h&&(console.log(" KYC data changed, checking if step should be auto-completed..."),y())},[n,r,o,f,h]);const y=async()=>{try{if(!f)return;console.log(" Checking step 2 status for company:",f);const k=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${f}/onboarding/phases/1/steps/2`);if(console.log(" API response for step 2:",k.data),k.data&&k.data.status==="completed"){console.log(" Step 2 is already completed according to API"),p(!0);return}const C=localStorage.getItem("companyOnboardingProgress");if(C)try{const I=JSON.parse(C);if(I.completedSteps&&Array.isArray(I.completedSteps)&&I.completedSteps.includes(2)){console.log(" Step 2 found in localStorage, setting as completed"),p(!0);return}}catch(I){console.error(" Error parsing stored progress:",I)}if(x()&&!h){console.log(" Auto-completing step 2 locally because basic info is present"),p(!0);const I=[2],A={currentPhase:1,completedSteps:I,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(A)),$e.set("kycVerificationStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:2,phaseId:1,status:"completed",completedSteps:I}})),console.log(" Step 2 marked as completed locally and parent component notified")}}catch(k){console.error(" Error checking step status:",k);const C=localStorage.getItem("companyOnboardingProgress");if(C)try{const I=JSON.parse(C);I.completedSteps&&Array.isArray(I.completedSteps)&&I.completedSteps.includes(2)&&p(!0)}catch(I){console.error(" Error parsing stored progress:",I)}}},x=()=>{const k=n.length>=3&&r==="completed";return console.log(" Checking basic info for KYC:",{uploadedFiles:n.length,verificationStatus:r,hasInfo:k}),k},g=async()=>{try{if(!f){console.error(" No companyId available");return}console.log(" Completing KYC verification...");const k=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${f}/onboarding/phases/1/steps/2`,{status:"completed"});console.log(" Step 2 marked as completed:",k.data),p(!0);const C={currentPhase:1,completedSteps:[2],lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(C)),$e.set("kycVerificationStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:2,phaseId:1,status:"completed",completedSteps:[2]}})),console.log(" KYC verification completed and step 2 marked as completed")}catch(k){console.error(" Error completing KYC verification:",k)}},b=k=>{const C=k.target.files;if(C){const I=Array.from(C).map(A=>A.name);s([...n,...I])}},w=[{title:"Certificate of Incorporation",description:"Official document proving company registration",format:"PDF or Image",required:!0,type:"company"},{title:"Proof of Address",description:"Recent utility bill or bank statement (less than 3 months old)",format:"PDF or Image",required:!0,type:"company"},{title:"Director ID",description:"Government-issued ID of company director",format:"PDF or Image",required:!0,type:"personal"},{title:"Bank Statement",description:"Recent bank statement for account verification",format:"PDF",required:!0,type:"financial"},{title:"Tax Registration",description:"Company tax registration certificate",format:"PDF",required:!0,type:"company"},{title:"Ownership Structure",description:"Document showing company ownership structure",format:"PDF",required:!0,type:"company"}],v=[{title:"Document Collection",description:"Upload all required documents",status:o>1?"completed":o===1?"current":"pending"},{title:"Identity Verification",description:"Verify company director identity",status:o>2?"completed":o===2?"current":"pending"},{title:"Business Verification",description:"Verify business details and operations",status:o>3?"completed":o===3?"current":"pending"},{title:"Final Review",description:"Review and confirm all information",status:o>4?"completed":o===4?"current":"pending"}],E=k=>{m(k),u(!0)};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-3"},i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"KYC/KYB Verification"),h&&i.createElement("div",{className:"flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},i.createElement(eo,{className:"w-4 h-4"}),"Completed")),i.createElement("p",{className:"text-sm text-gray-500"},"Complete identity verification for your company")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:"rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},"Save Progress"),h?i.createElement("button",{className:"rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm cursor-not-allowed"},i.createElement(eo,{className:"mr-2 h-4 w-4"}),"Verification Completed"):i.createElement("button",{onClick:g,className:"rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700",disabled:!x()},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Complete Verification"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Verification Progress"),i.createElement("span",{className:"text-sm text-gray-500"},"Step ",o," of 4")),i.createElement("div",{className:"mt-4"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"absolute left-0 top-2 h-0.5 w-full bg-gray-200"},i.createElement("div",{className:"absolute h-0.5 bg-indigo-600 transition-all duration-500",style:{width:`${(o-1)*33.33}%`}})),i.createElement("div",{className:"relative flex justify-between"},v.map((k,C)=>i.createElement("div",{key:C,className:"flex flex-col items-center"},i.createElement("div",{className:`flex h-8 w-8 items-center justify-center rounded-full border-2 ${k.status==="completed"?"border-indigo-600 bg-indigo-600":k.status==="current"?"border-indigo-600 bg-white":"border-gray-300 bg-white"}`},k.status==="completed"?i.createElement(mt,{className:"h-5 w-5 text-white"}):i.createElement("span",{className:`text-sm font-medium ${k.status==="current"?"text-indigo-600":"text-gray-500"}`},C+1)),i.createElement("div",{className:"mt-2 text-center"},i.createElement("p",{className:`text-sm font-medium ${k.status==="completed"?"text-indigo-600":k.status==="current"?"text-gray-900":"text-gray-500"}`},k.title),i.createElement("p",{className:"mt-1 text-xs text-gray-500"},k.description)))))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Choose Verification Method"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"},i.createElement("button",{className:`flex items-center justify-between rounded-lg border p-4 ${t==="automatic"?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>e("automatic")},i.createElement("div",{className:"flex items-center"},i.createElement(D1,{className:"mr-3 h-6 w-6 text-indigo-600"}),i.createElement("div",{className:"text-left"},i.createElement("p",{className:"font-medium text-gray-900"},"Automatic Verification"),i.createElement("p",{className:"text-sm text-gray-500"},"Quick verification through our trusted partners"))),t==="automatic"&&i.createElement(mt,{className:"h-5 w-5 text-indigo-600"})),i.createElement("button",{className:`flex items-center justify-between rounded-lg border p-4 ${t==="manual"?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>e("manual")},i.createElement("div",{className:"flex items-center"},i.createElement(Xo,{className:"mr-3 h-6 w-6 text-indigo-600"}),i.createElement("div",{className:"text-left"},i.createElement("p",{className:"font-medium text-gray-900"},"Manual Document Upload"),i.createElement("p",{className:"text-sm text-gray-500"},"Upload required documents manually"))),t==="manual"&&i.createElement(mt,{className:"h-5 w-5 text-indigo-600"})))),t==="automatic"?i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Automatic Verification"),i.createElement("div",{className:"mt-4 space-y-4"},i.createElement("div",{className:"rounded-lg bg-gray-50 p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center"},i.createElement(dW,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("span",{className:"font-medium text-gray-900"},"Identity Verification")),i.createElement("button",{className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Start Verification")),i.createElement("p",{className:"mt-2 text-sm text-gray-500"},"Complete the verification process through our secure partner platform")),i.createElement("div",{className:"rounded-lg bg-gray-50 p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center"},i.createElement(Ym,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("span",{className:"font-medium text-gray-900"},"Business Verification")),i.createElement("button",{className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Verify Business")),i.createElement("p",{className:"mt-2 text-sm text-gray-500"},"Verify your business through official registries and databases")),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("h4",{className:"font-medium text-gray-900"},"Verification Steps"),i.createElement("ul",{className:"mt-2 space-y-2"},i.createElement("li",{className:"flex items-center text-sm text-gray-500"},i.createElement(mt,{className:"mr-2 h-4 w-4 text-green-500"}),"Prepare valid government-issued ID"),i.createElement("li",{className:"flex items-center text-sm text-gray-500"},i.createElement(mt,{className:"mr-2 h-4 w-4 text-green-500"}),"Ensure good lighting for photo capture"),i.createElement("li",{className:"flex items-center text-sm text-gray-500"},i.createElement(mt,{className:"mr-2 h-4 w-4 text-green-500"}),"Follow on-screen instructions"),i.createElement("li",{className:"flex items-center text-sm text-gray-500"},i.createElement(mt,{className:"mr-2 h-4 w-4 text-green-500"}),"Complete facial recognition check"))))):i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"mb-4 flex items-center justify-between"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Required Documents"),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("span",{className:"text-sm text-gray-500"},n.length," of ",w.length," uploaded"),i.createElement("div",{className:"h-2 w-24 rounded-full bg-gray-200"},i.createElement("div",{className:"h-2 rounded-full bg-indigo-600",style:{width:`${n.length/w.length*100}%`}})))),i.createElement("div",{className:"space-y-4"},["company","personal","financial"].map(k=>i.createElement("div",{key:k,className:"rounded-lg border border-gray-200 p-4"},i.createElement("h4",{className:"mb-3 font-medium text-gray-900 capitalize"},k," Documents"),i.createElement("div",{className:"space-y-3"},w.filter(C=>C.type===k).map((C,I)=>i.createElement("div",{key:I,className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-start justify-between"},i.createElement("div",{className:"flex items-start space-x-3"},i.createElement("div",{className:"mt-1"},i.createElement(hn,{className:"h-5 w-5 text-indigo-600"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},C.title),i.createElement("p",{className:"text-sm text-gray-500"},C.description),i.createElement("p",{className:"mt-1 text-xs text-gray-400"},"Format: ",C.format))),i.createElement("div",{className:"flex items-center space-x-2"},n.includes(C.title)?i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("button",{onClick:()=>E(C.title),className:"rounded-md bg-gray-100 p-1 text-gray-600 hover:bg-gray-200"},i.createElement(Qm,{className:"h-4 w-4"})),i.createElement("span",{className:"text-sm text-green-600"},"Uploaded"),i.createElement(mt,{className:"h-5 w-5 text-green-500"})):i.createElement("button",{onClick:()=>document.getElementById(`file-${I}`)?.click(),className:"rounded-md bg-white px-3 py-2 text-sm font-medium text-indigo-600 shadow-sm ring-1 ring-inset ring-indigo-300 hover:bg-indigo-50"},"Upload"))),i.createElement("input",{id:`file-${I}`,type:"file",className:"hidden",onChange:b,accept:".pdf,.jpg,.jpeg,.png"})))))))),c&&d&&i.createElement("div",{className:"fixed inset-0 z-50 overflow-y-auto"},i.createElement("div",{className:"flex min-h-screen items-end justify-center px-4 pb-20 pt-4 text-center sm:block sm:p-0"},i.createElement("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true"},i.createElement("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})),i.createElement("div",{className:"inline-block transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6 sm:align-middle"},i.createElement("div",{className:"absolute right-0 top-0 pr-4 pt-4"},i.createElement("button",{onClick:()=>u(!1),className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none"},i.createElement(Yo,{className:"h-6 w-6"}))),i.createElement("div",{className:"sm:flex sm:items-start"},i.createElement("div",{className:"mt-3 w-full text-center sm:ml-4 sm:mt-0 sm:text-left"},i.createElement("h3",{className:"text-lg font-medium leading-6 text-gray-900"},d),i.createElement("div",{className:"mt-4"},i.createElement("div",{className:"aspect-w-16 aspect-h-9 overflow-hidden rounded-lg bg-gray-100"},i.createElement("div",{className:"flex h-64 items-center justify-center"},i.createElement(hn,{className:"h-16 w-16 text-gray-400"}))))))))),i.createElement("div",{className:"mt-6 rounded-lg bg-yellow-50 p-4"},i.createElement("div",{className:"flex"},i.createElement("div",{className:"flex-shrink-0"},i.createElement(Sn,{className:"h-5 w-5 text-yellow-400"})),i.createElement("div",{className:"ml-3"},i.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Document Guidelines"),i.createElement("div",{className:"mt-2 text-sm text-yellow-700"},i.createElement("ul",{className:"list-disc space-y-1 pl-5"},i.createElement("li",null,"All documents must be clear and legible"),i.createElement("li",null,"Files should not exceed 5MB in size"),i.createElement("li",null,"Supported formats: PDF, JPG, PNG"),i.createElement("li",null,"Documents must be in color and not black and white"),i.createElement("li",null,"No expired documents will be accepted"))))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Verification Status"),i.createElement("div",{className:"mt-4"},i.createElement("div",{className:"flex items-center justify-between rounded-lg bg-gray-50 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},r==="completed"?i.createElement(mt,{className:"h-6 w-6 text-green-500"}):r==="failed"?i.createElement(Sn,{className:"h-6 w-6 text-red-500"}):r==="in_progress"?i.createElement($a,{className:"h-6 w-6 animate-spin text-indigo-600"}):i.createElement(Ct,{className:"h-6 w-6 text-gray-400"}),i.createElement("div",null,i.createElement("p",{className:"font-medium text-gray-900"},r==="completed"?"Verification Complete":r==="failed"?"Verification Failed":r==="in_progress"?"Verification in Progress":"Verification Pending"),i.createElement("p",{className:"text-sm text-gray-500"},r==="completed"?"Your company has been successfully verified":r==="failed"?"Please review and resubmit your documents":r==="in_progress"?"This process may take 1-2 business days":"Please submit all required documents"))),r==="completed"&&i.createElement("button",{className:"flex items-center rounded-md bg-white px-3 py-2 text-sm font-medium text-indigo-600 shadow-sm ring-1 ring-inset ring-indigo-300 hover:bg-indigo-50"},i.createElement(qu,{className:"mr-2 h-4 w-4"}),"Download Certificate")))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"flex items-start"},i.createElement("div",{className:"flex-shrink-0"},i.createElement(oA,{className:"h-6 w-6 text-gray-400"})),i.createElement("div",{className:"ml-3"},i.createElement("h3",{className:"text-sm font-medium text-gray-900"},"Need Help?"),i.createElement("div",{className:"mt-2 text-sm text-gray-500"},i.createElement("p",null,"If you're having trouble with the verification process, our support team is here to help. Contact us through our support portal or schedule a call with our verification specialists.")),i.createElement("div",{className:"mt-3"},i.createElement("a",{href:"#",className:"text-sm font-medium text-indigo-600 hover:text-indigo-500"},"Contact Support ",i.createElement(i0,{className:"ml-1 inline-block h-4 w-4"})))))))},YX=()=>{const[t,e]=N.useState(!1),[n,s]=N.useState(!1),r=$e.get("companyId");N.useEffect(()=>{r&&(o(),a())},[r]);const a=async()=>{try{if(!r)return;const u=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/companies/${r}/subscription`);if(u.data&&u.data.subscription&&!t)try{const d=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${r}/onboarding/phases/1/steps/3`,{status:"completed"});console.log(" Subscription step 3 automatically marked as completed:",d.data),e(!0);const m={currentPhase:1,completedSteps:[3],lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(m)),$e.set("subscriptionStepCompleted","true",{expires:7})}catch(d){console.error("Error auto-completing subscription step:",d)}}catch(u){console.error("Error checking existing subscription:",u)}},o=async()=>{try{if(!r)return;const u=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${r}/onboarding/phases/1/steps/3`);if(u.data&&u.data.status==="completed"){e(!0);return}const d=localStorage.getItem("companyOnboardingProgress");if(d)try{const m=JSON.parse(d);if(m.completedSteps&&Array.isArray(m.completedSteps)&&m.completedSteps.includes(3)){e(!0);return}}catch(m){console.error("Error parsing stored progress:",m)}}catch(u){console.error("Error checking step status:",u)}},l={name:"Free",value:"free",price:"0",description:"Perfect for trying out our platform",features:["Up to 5 active gigs","Basic reporting","Email support","Community access","Standard support","Basic analytics","Single phone number"]},c=async()=>{try{s(!0),console.log("Starting plan activation..."),console.log("Company ID:",r);const u=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/companies/${r}/subscription`,{subscription:"free"});if(!u.data)throw new Error("Pas de rponse du serveur pour la mise  jour du plan");console.log("Subscription update response:",u.data);const h=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${r}/onboarding/phases/1/steps/3`,{status:"completed"});if(!h.data)throw new Error("Pas de rponse du serveur pour la mise  jour de l'tape");console.log("Step completion response:",h.data),e(!0);const p={currentPhase:1,completedSteps:[3],lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(p)),$e.set("subscriptionStepCompleted","true",{expires:7}),await new Promise(f=>setTimeout(f,500)),window.location.reload()}catch(u){console.error("Error details:",u),u.response?(console.error("API Error:",{status:u.response.status,data:u.response.data,url:u.config?.url}),console.log(`Erreur lors de l'activation du plan: ${u.response.data?.message||u.message}`)):console.log("Une erreur est survenue lors de l'activation du plan")}finally{s(!1)}};return i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-2"},i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Free Plan")),i.createElement("p",{className:"mt-1 text-sm text-gray-600"},"Start using our platform with our comprehensive free plan."))),i.createElement("div",{className:"max-w-md"},i.createElement("div",{className:"rounded-lg border border-indigo-600 p-4 shadow-sm ring-1 ring-indigo-600"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h3",{className:"text-xl font-bold text-gray-900"},l.name),i.createElement("span",{className:"inline-flex items-center rounded-full bg-indigo-100 px-2 py-0.5 text-xs font-medium text-indigo-800"},"Recommended")),i.createElement("p",{className:"mt-2 text-sm text-gray-500"},l.description),i.createElement("p",{className:"mt-4"},i.createElement("span",{className:"text-3xl font-bold text-gray-900"},"$",l.price),i.createElement("span",{className:"text-sm font-medium text-gray-500"},"/month")),i.createElement("ul",{className:"mt-4 space-y-1"},l.features.map(u=>i.createElement("li",{key:u,className:"flex items-center"},i.createElement(mW,{className:"h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"ml-2 text-sm text-gray-700"},u)))),i.createElement("button",{onClick:t?void 0:c,disabled:t||n,className:`mt-6 w-full rounded-lg px-4 py-2 text-center text-sm font-semibold text-white shadow-sm transition-all ${t?"bg-green-600 cursor-not-allowed":n?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`},t?i.createElement("span",{className:"flex items-center justify-center gap-2"},i.createElement(eo,{className:"w-4 h-4"}),"Plan Already Activated"):n?"Activating Plan...":"Activate Free Plan"))))},ZX=()=>{const[t,e]=N.useState(1),[n,s]=N.useState(1),[r,a]=N.useState(!1),[o,l]=N.useState(!1),[c,u]=N.useState([]),d=$e.get("companyId");N.useEffect(()=>{d&&m()},[d]),N.useEffect(()=>{d&&h()&&!o&&(console.log(" Call script data changed, checking if step should be auto-completed..."),m())},[c,d,o]);const m=async()=>{try{if(!d)return;console.log(" Checking step 8 status for company:",d);const x=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${d}/onboarding/phases/2/steps/8`);if(console.log(" API response for step 8:",x.data),x.data&&x.data.status==="completed"){console.log(" Step 8 is already completed according to API"),l(!0);return}const g=localStorage.getItem("companyOnboardingProgress");if(g)try{const b=JSON.parse(g);if(b.completedSteps&&Array.isArray(b.completedSteps)&&b.completedSteps.includes(8)){console.log(" Step 8 found in localStorage, setting as completed"),l(!0);return}}catch(b){console.error(" Error parsing stored progress:",b)}if(h()&&!o){console.log(" Auto-completing step 8 locally because basic info is present"),l(!0);const b=[8],w={currentPhase:2,completedSteps:b,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(w)),$e.set("callScriptStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:8,phaseId:2,status:"completed",completedSteps:b}})),console.log(" Step 8 marked as completed locally and parent component notified")}}catch(x){console.error(" Error checking step status:",x);const g=localStorage.getItem("companyOnboardingProgress");if(g)try{const b=JSON.parse(g);b.completedSteps&&Array.isArray(b.completedSteps)&&b.completedSteps.includes(8)&&l(!0)}catch(b){console.error(" Error parsing stored progress:",b)}}},h=()=>{const x=c.filter(b=>b.status==="active"),g=x.length>=2&&x.every(b=>b.sections&&b.sections.length>0);return console.log(" Checking basic info for CallScript:",{activeScripts:x.length,hasInfo:g}),g},p=async()=>{try{if(!d){console.error(" No companyId available");return}console.log(" Completing call script setup...");const x=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${d}/onboarding/phases/2/steps/8`,{status:"completed"});console.log(" Step 8 marked as completed:",x.data),l(!0);const g={currentPhase:2,completedSteps:[8],lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(g)),$e.set("callScriptStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:8,phaseId:2,status:"completed",completedSteps:[8]}})),console.log(" Call script setup completed and step 8 marked as completed")}catch(x){console.error(" Error completing call script setup:",x)}};N.useEffect(()=>{u([{id:1,name:"Product Introduction",description:"Initial call script for introducing our product to potential clients",status:"active",lastModified:"2 hours ago",sections:[{id:1,title:"Opening",content:"Hi, this is [REP_NAME] from [COMPANY]. I noticed you recently showed interest in [PRODUCT/SERVICE]. Is this a good time to talk?",type:"greeting",variations:2},{id:2,title:"Value Proposition",content:"We help companies like yours [BENEFIT_1] and [BENEFIT_2], resulting in [OUTCOME].",type:"pitch",variations:3},{id:3,title:"Qualification Questions",content:`1. What challenges are you currently facing with [PAIN_POINT]?
2. How are you currently handling [PROCESS]?
3. What would make this solution ideal for your needs?`,type:"questions",variations:1}]},{id:2,name:"Objection Handling",description:"Responses to common customer objections",status:"active",lastModified:"1 day ago",sections:[{id:4,title:"Price Objection",content:"I understand that price is a concern. Let me explain our ROI calculation...",type:"response",variations:2}]}])},[]);const f=x=>{e(x),s(null)},y=x=>{s(n===x?null:x)};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-3"},i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Call Script Builder"),o&&i.createElement("div",{className:"flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},i.createElement(eo,{className:"w-4 h-4"}),"Completed")),i.createElement("p",{className:"text-sm text-gray-500"},"Create and manage conversation flows for your REPS")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:"flex items-center rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",onClick:()=>a(!r)},i.createElement(Yu,{className:"mr-2 h-4 w-4"}),"AI Assistant"),o?i.createElement("button",{className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm cursor-not-allowed"},i.createElement(eo,{className:"mr-2 h-4 w-4"}),"Setup Completed"):i.createElement("button",{onClick:p,className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700",disabled:!h()},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Complete Setup"),i.createElement("button",{className:"flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(xs,{className:"mr-2 h-4 w-4"}),"New Script"))),i.createElement("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-3"},i.createElement("div",{className:"lg:col-span-1"},i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"mb-4 text-lg font-medium text-gray-900"},"Scripts"),i.createElement("div",{className:"space-y-3"},c.map(x=>i.createElement("button",{key:x.id,className:`flex w-full items-center justify-between rounded-lg border p-3 text-left ${t===x.id?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>f(x.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement(hn,{className:`h-5 w-5 ${t===x.id?"text-indigo-600":"text-gray-400"}`}),i.createElement("div",null,i.createElement("p",{className:"font-medium text-gray-900"},x.name),i.createElement("p",{className:"text-sm text-gray-500"},x.description))),i.createElement("span",{className:`rounded-full px-2 py-1 text-xs font-medium ${x.status==="active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},x.status)))))),i.createElement("div",{className:"lg:col-span-2"},i.createElement("div",{className:"rounded-lg bg-white shadow"},i.createElement("div",{className:"border-b border-gray-200 p-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900"},c.find(x=>x.id===t)?.name),i.createElement("p",{className:"text-sm text-gray-500"},"Last modified ",c.find(x=>x.id===t)?.lastModified)),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{className:"rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(EW,{className:"h-5 w-5"})),i.createElement("button",{className:"rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(Gr,{className:"h-5 w-5"})),i.createElement("button",{className:"rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(qu,{className:"h-5 w-5"}))))),i.createElement("div",{className:"p-6"},i.createElement("div",{className:"space-y-4"},c.find(x=>x.id===t)?.sections.map(x=>i.createElement("div",{key:x.id,className:"rounded-lg border border-gray-200"},i.createElement("div",{className:"flex cursor-pointer items-center justify-between p-4",onClick:()=>y(x.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement(Ko,{className:"h-5 w-5 text-indigo-600"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},x.title),i.createElement("p",{className:"text-sm text-gray-500"},x.variations," variation",x.variations!==1?"s":""))),n===x.id?i.createElement(Zm,{className:"h-5 w-5 text-gray-400"}):i.createElement(Hu,{className:"h-5 w-5 text-gray-400"})),n===x.id&&i.createElement("div",{className:"border-t border-gray-200 p-4"},i.createElement("textarea",{className:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:4,defaultValue:x.content}),i.createElement("div",{className:"mt-4 flex items-center justify-between"},i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{className:"rounded-md bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},i.createElement(vW,{className:"mr-2 h-4 w-4 inline"}),"Add Variation"),i.createElement("button",{className:"rounded-md bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},i.createElement(gW,{className:"mr-2 h-4 w-4 inline"}),"Duplicate")),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{className:"rounded-md bg-white px-3 py-2 text-sm font-medium text-red-600 shadow-sm ring-1 ring-inset ring-red-300 hover:bg-red-50"},i.createElement(Hr,{className:"mr-2 h-4 w-4 inline"}),"Delete"),i.createElement("button",{className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(mA,{className:"mr-2 h-4 w-4 inline"}),"Save Changes"))))))),i.createElement("button",{className:"mt-4 flex w-full items-center justify-center rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},i.createElement(xs,{className:"mr-2 h-4 w-4"}),"Add New Section"))))),r&&i.createElement("div",{className:"rounded-lg bg-indigo-50 p-6"},i.createElement("div",{className:"flex items-start space-x-3"},i.createElement(Yu,{className:"h-6 w-6 text-indigo-600"}),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-indigo-900"},"AI Script Suggestions"),i.createElement("div",{className:"mt-4 space-y-4"},i.createElement("div",{className:"rounded-lg bg-white p-4 shadow-sm"},i.createElement("h4",{className:"font-medium text-gray-900"},"Opening Improvements"),i.createElement("ul",{className:"mt-2 space-y-2"},i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 mt-1 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-gray-700"},"Add a personalized element mentioning their industry")),i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 mt-1 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-gray-700"},"Include a relevant market trend or statistic"))),i.createElement("button",{className:"mt-3 text-sm font-medium text-indigo-600 hover:text-indigo-500"},"Generate Variations ")),i.createElement("div",{className:"rounded-lg bg-white p-4 shadow-sm"},i.createElement("h4",{className:"font-medium text-gray-900"},"Value Proposition Enhancement"),i.createElement("ul",{className:"mt-2 space-y-2"},i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 mt-1 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-gray-700"},"Add specific metrics or case study results")),i.createElement("li",{className:"flex items-start"},i.createElement(Un,{className:"mr-2 mt-1 h-4 w-4 text-indigo-600"}),i.createElement("span",{className:"text-sm text-gray-700"},"Include industry-specific pain points"))),i.createElement("button",{className:"mt-3 text-sm font-medium text-indigo-600 hover:text-indigo-500"},"Generate Variations ")))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Script Writing Best Practices"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-green-100 p-2 text-green-600"},i.createElement(mt,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Be Natural"),i.createElement("p",{className:"text-sm text-gray-500"},"Write conversationally and avoid robotic language")))),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-blue-100 p-2 text-blue-600"},i.createElement(Ko,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Active Listening"),i.createElement("p",{className:"text-sm text-gray-500"},"Include prompts for REPs to acknowledge customer responses")))),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-yellow-100 p-2 text-yellow-600"},i.createElement(Sn,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Handle Objections"),i.createElement("p",{className:"text-sm text-gray-500"},"Prepare responses for common customer concerns")))))))},JX=()=>{const[t,e]=N.useState(["calls","conversion"]),[n,s]=N.useState("weekly"),[r,a]=N.useState(["voice","email","chat"]),[o,l]=N.useState({email:!0,push:!1,threshold:!0}),[c,u]=N.useState(!1),d=$e.get("companyId");N.useEffect(()=>{d&&m()},[d]),N.useEffect(()=>{d&&h()&&!c&&(console.log(" Reporting setup data changed, checking if step should be auto-completed..."),m())},[t,r,n,d,c]);const m=async()=>{try{if(!d)return;console.log(" Checking step 9 status for company:",d);const w=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${d}/onboarding/phases/2/steps/9`);if(console.log(" API response for step 9:",w.data),w.data&&w.data.status==="completed"){console.log(" Step 9 is already completed according to API"),u(!0);return}const v=localStorage.getItem("companyOnboardingProgress");if(v)try{const E=JSON.parse(v);if(E.completedSteps&&Array.isArray(E.completedSteps)&&E.completedSteps.includes(9)){console.log(" Step 9 found in localStorage, setting as completed"),u(!0);return}}catch(E){console.error(" Error parsing stored progress:",E)}if(h()&&!c){console.log(" Auto-completing step 9 locally because basic info is present"),u(!0);const E=[9],k={currentPhase:2,completedSteps:E,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(k)),$e.set("reportingSetupStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:9,phaseId:2,status:"completed",completedSteps:E}})),console.log(" Step 9 marked as completed locally and parent component notified")}}catch(w){console.error(" Error checking step status:",w);const v=localStorage.getItem("companyOnboardingProgress");if(v)try{const E=JSON.parse(v);E.completedSteps&&Array.isArray(E.completedSteps)&&E.completedSteps.includes(9)&&u(!0)}catch(E){console.error(" Error parsing stored progress:",E)}}},h=()=>{const w=t.length>0&&r.length>0&&n;return console.log(" Checking basic info for ReportingSetup:",{selectedMetrics:t.length,selectedChannels:r.length,reportSchedule:n,hasInfo:w}),w},p=async()=>{try{if(!d){console.error(" No companyId available");return}console.log(" Completing reporting setup...");const w=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${d}/onboarding/phases/2/steps/9`,{status:"completed"});console.log(" Step 9 marked as completed:",w.data),u(!0);const v={currentPhase:2,completedSteps:[9],lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(v)),$e.set("reportingSetupStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:9,phaseId:2,status:"completed",completedSteps:[9]}})),console.log(" Reporting setup completed and step 9 marked as completed")}catch(w){console.error(" Error completing reporting setup:",w)}},f=[{id:"voice",name:"Voice Calls",description:"Traditional phone call metrics",icon:_W,metrics:["volume","duration","quality"]},{id:"email",name:"Email",description:"Email communication tracking",icon:Ku,metrics:["response_time","resolution_rate","volume"]},{id:"chat",name:"Live Chat",description:"Web chat interactions",icon:Ko,metrics:["response_time","satisfaction","volume"]},{id:"social",name:"Social Media",description:"Social platform engagement",icon:sA,metrics:["response_time","sentiment","engagement"]},{id:"video",name:"Video Calls",description:"Video conference metrics",icon:xA,metrics:["quality","duration","technical_issues"]},{id:"whatsapp",name:"WhatsApp",description:"WhatsApp business metrics",icon:cA,metrics:["response_time","volume","engagement"]}],y=[{id:"channel_performance",name:"Channel Performance",description:"Compare metrics across different channels",icon:$1,category:"cross_channel"},{id:"response_times",name:"Response Times",description:"Track response times per channel",icon:Ct,category:"efficiency"},{id:"resolution_rates",name:"Resolution Rates",description:"First contact and overall resolution",icon:mt,category:"quality"},{id:"customer_satisfaction",name:"Customer Satisfaction",description:"CSAT scores across channels",icon:lW,category:"quality"},{id:"channel_utilization",name:"Channel Utilization",description:"Usage patterns across channels",icon:QT,category:"efficiency"},{id:"cross_channel_journey",name:"Customer Journey",description:"Track multi-channel customer journeys",icon:gs,category:"analysis"},{id:"queue_metrics",name:"Queue Metrics",description:"Wait times and queue management",icon:qr,category:"efficiency"},{id:"channel_costs",name:"Channel Costs",description:"Cost per contact by channel",icon:T1,category:"financial"}],x=[{id:1,name:"Omnichannel Overview",description:"Cross-channel performance metrics",type:"standard",metrics:["channel_performance","response_times","customer_satisfaction"]},{id:2,name:"Channel Efficiency",description:"Response times and resolution rates",type:"custom",metrics:["response_times","resolution_rates","queue_metrics"]},{id:3,name:"Quality Monitoring",description:"Quality metrics across channels",type:"standard",metrics:["customer_satisfaction","resolution_rates"]},{id:4,name:"Customer Journey Analysis",description:"Multi-channel interaction tracking",type:"custom",metrics:["cross_channel_journey","channel_utilization"]}],g=w=>{t.includes(w)?e(t.filter(v=>v!==w)):e([...t,w])},b=w=>{r.includes(w)?a(r.filter(v=>v!==w)):a([...r,w])};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-3"},i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Multi-Channel Reporting Setup"),c&&i.createElement("div",{className:"flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},i.createElement(eo,{className:"w-4 h-4"}),"Completed")),i.createElement("p",{className:"text-sm text-gray-500"},"Configure reporting across all communication channels")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:"flex items-center rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},i.createElement(Gr,{className:"mr-2 h-4 w-4"}),"Settings"),c?i.createElement("button",{className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm cursor-not-allowed"},i.createElement(eo,{className:"mr-2 h-4 w-4"}),"Setup Completed"):i.createElement("button",{onClick:p,className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700",disabled:!h()},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Complete Setup"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Communication Channels"),i.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Select channels to include in your reports"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},f.map(w=>{const v=w.icon,E=r.includes(w.id);return i.createElement("div",{key:w.id,className:`cursor-pointer rounded-lg border p-4 ${E?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>b(w.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:`rounded-lg p-2 ${E?"bg-indigo-500 text-white":"bg-gray-100 text-gray-500"}`},i.createElement(v,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},w.name),i.createElement("p",{className:"text-sm text-gray-500"},w.description))),E&&i.createElement("div",{className:"mt-3 flex flex-wrap gap-2"},w.metrics.map(k=>i.createElement("span",{key:k,className:"inline-flex items-center rounded-full bg-indigo-100 px-2.5 py-0.5 text-xs font-medium text-indigo-800"},k.replace("_"," ")))))}))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Cross-Channel Metrics"),i.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Select metrics to track across all channels"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},y.map(w=>{const v=w.icon,E=t.includes(w.id);return i.createElement("div",{key:w.id,className:`cursor-pointer rounded-lg border p-4 ${E?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:bg-gray-50"}`,onClick:()=>g(w.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:`rounded-lg p-2 ${E?"bg-indigo-500 text-white":"bg-gray-100 text-gray-500"}`},i.createElement(v,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},w.name),i.createElement("p",{className:"text-sm text-gray-500"},w.description))))}))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Multi-Channel Dashboards"),i.createElement("div",{className:"mt-4 space-y-4"},x.map(w=>i.createElement("div",{key:w.id,className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},w.name),i.createElement("p",{className:"text-sm text-gray-500"},w.description),i.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},w.metrics.map(v=>{const E=y.find(k=>k.id===v);return E?i.createElement("span",{key:v,className:"inline-flex items-center rounded-full bg-indigo-100 px-2.5 py-0.5 text-xs font-medium text-indigo-800"},E.name):null}))),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{className:"rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(l0,{className:"h-4 w-4"})),i.createElement("button",{className:"rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(Hi,{className:"h-4 w-4"})),i.createElement("button",{className:"rounded-md p-2 text-gray-400 hover:bg-gray-100 hover:text-red-500"},i.createElement(Hr,{className:"h-4 w-4"})))))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Report Scheduling"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-6 lg:grid-cols-2"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Report Frequency"),i.createElement("select",{className:"mt-1 block w-full rounded-md border-gray-300 py-2 pl-3 pr-10 text-base focus:border-indigo-500 focus:outline-none focus:ring-indigo-500 sm:text-sm",value:n,onChange:w=>s(w.target.value)},i.createElement("option",{value:"daily"},"Daily"),i.createElement("option",{value:"weekly"},"Weekly"),i.createElement("option",{value:"monthly"},"Monthly"),i.createElement("option",{value:"quarterly"},"Quarterly"))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Delivery Method"),i.createElement("div",{className:"mt-2 space-y-4"},i.createElement("div",{className:"flex items-center"},i.createElement("input",{id:"email-notifications",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:o.email,onChange:w=>l({...o,email:w.target.checked})}),i.createElement("label",{htmlFor:"email-notifications",className:"ml-2 flex items-center text-sm text-gray-700"},i.createElement(Ku,{className:"mr-2 h-4 w-4"}),"Email Reports")),i.createElement("div",{className:"flex items-center"},i.createElement("input",{id:"push-notifications",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:o.push,onChange:w=>l({...o,push:w.target.checked})}),i.createElement("label",{htmlFor:"push-notifications",className:"ml-2 flex items-center text-sm text-gray-700"},i.createElement(uW,{className:"mr-2 h-4 w-4"}),"Push Notifications")),i.createElement("div",{className:"flex items-center"},i.createElement("input",{id:"threshold-alerts",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500",checked:o.threshold,onChange:w=>l({...o,threshold:w.target.checked})}),i.createElement("label",{htmlFor:"threshold-alerts",className:"ml-2 flex items-center text-sm text-gray-700"},i.createElement(Sn,{className:"mr-2 h-4 w-4"}),"Threshold Alerts")))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Cross-Channel Visualization"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-3"},i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement($1,{className:"h-5 w-5 text-indigo-600"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Channel Comparison"),i.createElement("p",{className:"text-sm text-gray-500"},"Compare metrics across channels")))),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement(lA,{className:"h-5 w-5 text-indigo-600"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Trend Analysis"),i.createElement("p",{className:"text-sm text-gray-500"},"Track patterns over time")))),i.createElement("div",{className:"rounded-lg border border-gray-200 p-4"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement(DW,{className:"h-5 w-5 text-indigo-600"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Channel Distribution"),i.createElement("p",{className:"text-sm text-gray-500"},"Volume distribution by channel")))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Export Options"),i.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Download or share your cross-channel reports")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:"flex items-center rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},i.createElement(l0,{className:"mr-2 h-4 w-4"}),"Share"),i.createElement("button",{className:"flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(qu,{className:"mr-2 h-4 w-4"}),"Export")))))},WE="https://harxv25comporchestratorfront.netlify.app/zoho-logo.png";class lo{static instance;config={accessToken:null,refreshToken:null,tokenExpiry:null,isConfigured:!1};constructor(){this.initializeFromServer().catch(e=>{console.debug("ZohoService: Initial configuration not found",e)})}static getInstance(){return lo.instance||(lo.instance=new lo),lo.instance}async initializeFromServer(){try{const e=$e.get("userId");if(!e){console.debug("ZohoService: No userId found in cookies");return}const n=await fetch(`undefined/zoho/config/user/${e}`,{headers:{Authorization:`Bearer ${$e.get("gigId")}:${e}`,"Content-Type":"application/json"}});if(n.ok){const s=await n.json();this.config.accessToken=s.access_token,this.config.refreshToken=s.refresh_token,this.config.tokenExpiry=Date.now()+s.expires_in*1e3,this.config.isConfigured=!0,console.debug("ZohoService: Configuration loaded successfully")}else n.status===404?console.debug("ZohoService: No configuration found for user"):console.debug("ZohoService: Failed to load configuration",n.status)}catch(e){console.debug("ZohoService: Error initializing from server",e)}}async refreshToken(){try{const e=$e.get("userId");if(!e)return console.debug("ZohoService: No userId found for token refresh"),!1;const n=await fetch(`undefined/zoho/config/user/${e}/refresh-token`,{method:"POST",headers:{Authorization:`Bearer ${$e.get("gigId")}:${e}`,"Content-Type":"application/json"}});if(n.ok){const s=await n.json();return this.config.accessToken=s.access_token,this.config.refreshToken=s.refresh_token,this.config.tokenExpiry=Date.now()+s.expires_in*1e3,console.debug("ZohoService: Token refreshed successfully"),!0}else return console.debug("ZohoService: Failed to refresh token",n.status),!1}catch(e){return console.debug("ZohoService: Error refreshing token",e),!1}}isConfigured(){return this.config.isConfigured}getAccessToken(){return this.config.accessToken}async getValidAccessToken(){try{return(!this.config.accessToken||!this.config.tokenExpiry||Date.now()>=this.config.tokenExpiry)&&!await this.refreshToken()?(console.debug("ZohoService: Failed to get valid access token"),null):this.config.accessToken}catch(e){return console.debug("ZohoService: Error getting valid access token",e),null}}resetConfiguration(){this.config={accessToken:null,refreshToken:null,tokenExpiry:null,isConfigured:!1},console.debug("ZohoService: Configuration reset")}}const $D=i.memo(({onCancelProcessing:t})=>{const e=()=>{a.current&&(a.current.abort(),a.current=null),E(!1),ve.current=!1,u(0),g(null),w(!1),He({current:0,total:0,status:"Cancelled by user (Back to Onboarding)",isProcessing:!1}),localStorage.removeItem("uploadProcessing"),localStorage.removeItem("parsedLeads"),localStorage.removeItem("validationResults"),sessionStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("parsedLeads"),sessionStorage.removeItem("validationResults"),document.body.removeAttribute("data-processing"),l(null),C([]),Qt(null);const te=document.getElementById("file-upload");te&&(te.value=""),t&&t()},n=()=>{a.current&&(a.current.abort(),a.current=null),ve.current=!1,E(!1),localStorage.clear(),sessionStorage.clear(),u(0),g(null),w(!1),C([]),Qt(null),l(null),document.body.removeAttribute("data-processing"),He({current:0,total:0,status:"EMERGENCY CANCELLED",isProcessing:!1})};N.useEffect(()=>(window.cancelUploadProcessing=e,window.emergencyCancelUpload=n,()=>{delete window.cancelUploadProcessing,delete window.emergencyCancelUpload}),[]);const s=N.useRef(!1),r=N.useRef(!1),a=N.useRef(null),[o,l]=N.useState(null),[c,u]=N.useState(0),[d,m]=N.useState(["all"]),[h,p]=N.useState(""),[f,y]=N.useState("all"),[x,g]=N.useState(null),[b,w]=N.useState(!1),[v,E]=N.useState(!1),[k,C]=N.useState([]),[I,A]=N.useState(!0),[$,T]=N.useState(!0),[F,O]=N.useState(!1),[M,B]=N.useState(0),[L,Y]=N.useState([]),[D,_]=N.useState(!1);N.useState({clientId:"",clientSecret:"",refreshToken:"",companyId:$e.get("companyId")||""});const[P,z]=N.useState(!1),[q,K]=N.useState(!1),[ae,ne]=N.useState([]),[Z,ke]=N.useState([]),[Ae,W]=N.useState(!1),[le,we]=N.useState(null),[de,Ee]=N.useState([]),[Re,ze]=N.useState(1),[_e,ht]=N.useState(1);N.useState(50);const[X,me]=N.useState(0),[Fe,tt]=N.useState([]),[Oe,Ye]=N.useState(""),[at,At]=N.useState(!1),[wt,fe]=N.useState(!1),[We,qe]=N.useState(!1),[je,it]=N.useState(null),[St,dt]=N.useState(!0),[gt,Qt]=N.useState(null),[Bs,S]=N.useState(null),[V,J]=N.useState(!1),be=N.useRef(!1),ve=N.useRef(!1),se=N.useRef(!1),De=N.useRef(null),[Ke,He]=N.useState({current:0,total:0,status:"",isProcessing:!1}),xt=()=>{He({current:0,total:0,status:"",isProcessing:!1})},en=(te,ye,Pe=!1)=>{try{const ct=hw(ye,50),Qe=mw(ct),et=JSON.stringify(Qe),Pt=Pe?3*1024*1024:1*1024*1024;return et.length>Pt?Pe?(console.warn(` Data for ${te} too large for sessionStorage (${Math.round(et.length/1024/1024)}MB)`),!1):(console.warn(` Data for ${te} too large for localStorage, using sessionStorage`),en(te,ye,!0)):(Pe?sessionStorage.setItem(te,et):localStorage.setItem(te,et),!0)}catch{console.warn(` Storage full for ${te}, cleaning up and retrying`),CC();try{const Qe=hw(ye,25),et=mw(Qe),Pt=JSON.stringify(et);return Pe?sessionStorage.setItem(te,Pt):localStorage.setItem(te,Pt),!0}catch{return Pe?(console.error(` Both localStorage and sessionStorage are full for ${te}`),!1):(console.warn(` Still full after cleanup, trying sessionStorage for ${te}`),en(te,ye,!0))}}},Po=te=>{try{let ye=localStorage.getItem(te);return ye||(ye=sessionStorage.getItem(te),ye)?JSON.parse(ye):null}catch(ye){return console.error(` Error parsing data for ${te}:`,ye),null}},mw=te=>{try{return Array.isArray(te)?te.map(ye=>({_id:ye._id,gigId:ye.gigId,userId:ye.userId,companyId:ye.companyId,Email_1:ye.Email_1,Phone:ye.Phone,Deal_Name:ye.Deal_Name,Stage:ye.Stage,Pipeline:ye.Pipeline,updatedAt:ye.updatedAt})):te}catch(ye){return console.error(" Error compressing data:",ye),te}},hw=(te,ye=100)=>{try{return Array.isArray(te)&&te.length>ye?(console.warn(` Limiting data to ${ye} items (was ${te.length})`),te.slice(-ye)):te}catch(Pe){return console.error(" Error limiting data size:",Pe),te}},CC=()=>{try{localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing");const te=["companyOnboardingProgress","kycVerificationStepCompleted"];Object.keys(localStorage).forEach(ct=>{!te.includes(ct)&&(ct.includes("leads")||ct.includes("parsed"))&&localStorage.removeItem(ct)}),Object.keys(sessionStorage).forEach(ct=>{(ct.includes("leads")||ct.includes("parsed"))&&sessionStorage.removeItem(ct)}),console.log(" Cleaned up localStorage and sessionStorage to free space")}catch(te){console.error(" Error cleaning up localStorage:",te)}},pw=(te,ye)=>{ve.current&&(u(te),He({current:te,total:100,status:ye,isProcessing:!0}))};N.useEffect(()=>{const te=localStorage.getItem("uploadProcessing")==="true",ye=o!==null,Pe=k.length>0;if(te&&!ye&&!Pe){E(!1),ve.current=!1,localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing");return}if(te&&(ye||Pe))return ve.current=!0,E(!0),()=>{};if(!se.current&&!s.current){const ct=Po("parsedLeads"),Qe=Po("validationResults");ct&&!k.length&&C(ct),Qe&&!gt&&Qt(Qe),se.current=!0,s.current=!0}},[]),N.useEffect(()=>{k.length>0&&(en("parsedLeads",k)||(console.warn(" Could not save parsed leads to storage - keeping in memory only"),C(ye=>ye.map(Pe=>({...Pe,_memoryOnly:!0}))))),window.cancelUploadProcessing||(window.cancelUploadProcessing=e),window.emergencyCancelUpload||(window.emergencyCancelUpload=n)}),N.useEffect(()=>{(k.length>0||localStorage.getItem("parsedLeads"))&&(r.current=!0)},[k.length]),N.useEffect(()=>()=>{const te=!localStorage.getItem("parsedLeads")&&!sessionStorage.getItem("parsedLeads");k.length>0&&!te&&en("parsedLeads",k)},[k]),N.useEffect(()=>{!o&&k.length===0&&localStorage.getItem("uploadProcessing")==="true"&&(E(!1),ve.current=!1,localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing"))},[o,k.length]);const fw=[{id:"all",name:"All Channels",icon:gs},{id:"voice",name:"Voice Calls",icon:Ql}],IC=async te=>{try{if(!ve.current)throw new Error("Processing cancelled by user");a.current=new AbortController;const ye=$e.get("userId"),Pe=Oe,ct=$e.get("companyId");if(!Pe)throw new Error("Please select a gig first");if(!ye||!ct)throw new Error("Missing user or company information");const Qe=new FormData;Qe.append("file",te),pw(20,"Sending file to server...");const et=await fetch("undefined/file-processing/process",{method:"POST",body:Qe,signal:a.current?.signal,headers:{Accept:"application/json"}});if(!et.ok){let Lr=`Backend error: ${et.status} ${et.statusText}`;try{const $C=await et.json();$C.error&&(Lr=$C.error)}catch{}throw new Error(Lr)}const Pt=await et.json();if(!Pt.success)throw new Error(Pt.error||"Backend processing failed");const Ot=Pt.data;if(!Ot||!Ot.leads||!Array.isArray(Ot.leads))throw new Error("Invalid response format from backend");const Si=Ot.leads.map(Lr=>({...Lr,userId:{$oid:ye},companyId:{$oid:ct},gigId:{$oid:Pe}}));return pw(100,"Processing completed!"),{...Ot,leads:Si}}catch(ye){throw console.error(" Error in processFileWithBackend:",ye),ye}},oe=async te=>{const ye=te.target.files?.[0];if(ye){if(!Oe){$t.error("Please select a gig first before uploading a file");return}const Pe=[...ae],ct=[...Z];l(null),g(null),w(!1),E(!1),u(0),C([]),Qt(null),A(!0),T(!0),xt(),localStorage.removeItem("parsedLeads"),localStorage.removeItem("validationResults"),localStorage.removeItem("uploadProcessing"),localStorage.removeItem("hasSeenImportChoiceModal"),sessionStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("parsedLeads"),sessionStorage.removeItem("validationResults"),document.body.removeAttribute("data-processing"),ve.current=!1;const Qe=document.getElementById("file-upload");Qe&&(Qe.value=""),l(ye),g(null),w(!1),E(!0),u(10),C([]),document.body.setAttribute("data-processing","true"),ve.current=!0,localStorage.setItem("uploadProcessing","true"),sessionStorage.setItem("uploadProcessing","true");try{if(!ve.current)return;const et=await IC(ye);if(et.leads.length===0){$t.error("No valid leads found in the file. Please check the file format and content."),g("No valid leads found"),E(!1),u(0);return}et.validation&&Qt(et.validation),C(et.leads);const Pt=en("parsedLeads",et.leads),Ot=en("validationResults",et.validation);Pt||(console.warn(" Could not save leads to storage - data too large, keeping in memory only"),J(!0)),Ot||console.warn(" Could not save validation results to storage - data too large"),Pe.length>0&&(ne(Pe),ke(ct)),E(!1),u(100),document.body.removeAttribute("data-processing"),ve.current=!1,localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing")}catch(et){console.error("Error uploading file:",et);const Pt=et.message||"Error uploading file";g(Pt),$t.error(Pt),u(0),E(!1)}}},ge=te=>{if(te==="all"){m(["all"]);return}if(d.includes("all")){m([te]);return}if(d.includes(te)){const ye=d.filter(Pe=>Pe!==te);m(ye.length===0?["all"]:ye)}else m([...d.filter(ye=>ye!=="all"),te])},he=async()=>{if(!(!k||k.length===0)){O(!0),B(0),Y([]),A(!1),ve.current=!0;try{const te=$e.get("userId"),ye=Oe,Pe=$e.get("companyId");console.log(" Saving leads with IDs:"),console.log(`   currentUserId: ${te}`),console.log(`   currentGigId: ${ye}`),console.log(`   currentCompanyId: ${Pe}`),console.log(`   Cookie gigId: ${$e.get("gigId")}`),console.log(`   selectedGigId: ${Oe}`);const ct=k.map(et=>({userId:et.userId?.$oid||te,companyId:et.companyId?.$oid||Pe,gigId:et.gigId?.$oid||ye,Last_Activity_Time:et.Last_Activity_Time||null,Deal_Name:et.Deal_Name||"Unnamed Lead",Email_1:et.Email_1||"no-email@placeholder.com",Phone:et.Phone||"no-phone@placeholder.com",Stage:et.Stage||"New",Pipeline:et.Pipeline||"Sales Pipeline",Activity_Tag:et.Activity_Tag||"",Telephony:et.Telephony||"",Project_Tags:et.Project_Tags||[],First_Name:et.First_Name||"",Last_Name:et.Last_Name||"",Address:et.Address||"",Postal_Code:et.Postal_Code||"",City:et.City||"",Date_of_Birth:et.Date_of_Birth||""}));if(!ve.current)throw new Error("Processing cancelled by user");u(30);const Qe=await Ie.post("undefined/leads/bulk",{leads:ct},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${ye}:${te}`},timeout:6e4});if(u(90),Qe.status===201||Qe.status===207){const et=Qe.data,Pt=et.count||(et.data?et.data.length:0);w(!0),u(100),$t.success(`Successfully saved ${Pt} contacts!`),et.data&&Array.isArray(et.data)&&(Y(et.data),ne(Ot=>[...Ot,...et.data]),ke(Ot=>[...Ot,...et.data]),me(Ot=>Ot+Pt),B(Pt)),C([]),Qt(null),localStorage.removeItem("validationResults"),sessionStorage.removeItem("validationResults");try{const Ot=$e.get("companyId");Ot&&(await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${Ot}/onboarding/phases/2/steps/6`,{status:"completed"}),localStorage.setItem("stepCompleted",JSON.stringify({stepId:6,phaseId:2,data:{success:!0,leadsSaved:Pt}})))}catch(Ot){console.error("Error updating onboarding progress:",Ot)}}else throw new Error(Qe.statusText||"Bulk save failed")}catch(te){console.error("Error in handleSaveLeads:",te);const ye=te.message||"Error saving leads";g(ye),$t.error(ye)}finally{O(!1),ve.current=!1,A(!0),T(!0),setTimeout(()=>{l(null),u(0),w(!1),C([]),g(null),Qt(null),Y([]),localStorage.removeItem("parsedLeads"),localStorage.removeItem("validationResults"),localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("parsedLeads"),sessionStorage.removeItem("validationResults"),document.body.removeAttribute("data-processing"),ve.current=!1;const te=document.getElementById("file-upload");te&&(te.value="")},2e3)}}},Be=async()=>{try{const te=$e.get("userId");if(!te){console.error("No userId found in cookies"),$t.error("User ID not found. Please log in again.");return}const Pe=encodeURIComponent("undefined/zoho/auth/callback"),ct=encodeURIComponent(te),Qe=`undefined/zoho/auth?redirect_uri=${Pe}&state=${ct}`,et=await fetch(Qe,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${te}`}});if(!et.ok){const Si=await et.json();throw console.error("Error response:",Si),new Error(Si.error||"Failed to get Zoho auth URL")}const Pt=await et.json(),Ot=new URL(Pt.authUrl);Ot.searchParams.set("state",te),window.location.href=Ot.toString()}catch(te){console.error("Error in handleZohoConnect:",te),$t.error(te?.message||"Failed to initiate Zoho authentication")}},Ge=async()=>{K(!0);try{const te=$e.get("userId"),ye=Oe||$e.get("gigId");if(!te){console.error("No userId found in cookies"),$t.error("User ID not found. Please log in again.");return}const Pe=await fetch("undefined/zoho/disconnect",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ye}:${te}`}});if(!Pe.ok){const Qe=await Pe.json();throw console.error("Error response:",Qe),new Error(Qe.message||"Failed to disconnect from Zoho")}const ct=await Pe.json();if(ct.success)lo.getInstance().resetConfiguration(),_(!1),fe(!1),Ee([]),C([]);else throw new Error(ct.message||"Failed to disconnect from Zoho")}catch(te){console.error("Error in handleZohoDisconnect:",te),$t.error(te?.message||"Failed to disconnect from Zoho")}finally{K(!1)}};N.useEffect(()=>{const te=()=>{const ye=new URLSearchParams(window.location.search),Pe=ye.get("code"),ct=ye.get("state"),Qe=ye.get("location"),et=ye.get("accounts-server"),Pt=new URLSearchParams(window.location.search);if(Pt.get("session")==="someGeneratedSessionId"){Pt.delete("session");const Ot=Pt.toString();window.history.replaceState({},"",`${window.location.pathname}${Ot?"?"+Ot:""}`)}if(Pe){if(!ct){console.error("No state parameter found in URL"),$t.error("Authentication state not found. Please try connecting again.");return}pt(Pe,ct,Qe||void 0,et||void 0)}};be.current||(be.current=!0,te())},[]);const pt=async(te,ye,Pe,ct)=>{try{const Qe=ye||$e.get("userId");if(!Qe)throw new Error("User ID not found in state parameter or cookies");const et=new URLSearchParams({code:te,state:Qe,...Pe&&{location:Pe},...ct&&{accountsServer:ct}}).toString(),Pt=await fetch(`undefined/zoho/auth/callback?${et}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${Oe||$e.get("gigId")}:${Qe}`}}),Ot=await Pt.json();if(!Pt.ok)throw new Error(Ot.error||"Failed to exchange code for tokens");_(!0)}catch(Qe){console.error("Error handling OAuth callback:",Qe),$t.error(Qe.message||"Failed to complete Zoho authentication")}};N.useEffect(()=>{v||ve.current},[D,v]);const _n=async(te,ye={},Pe)=>{const ct=$e.get("userId"),et={"Content-Type":"application/json",Authorization:`Bearer ${Pe||Oe||$e.get("gigId")}:${ct}`,...ye.headers};let Pt=await fetch(te,{...ye,headers:et});if(Pt.status===401)if((await fetch(`undefined/zoho/config/user/${ct}/refresh-token`,{method:"POST",headers:et})).ok)Pt=await fetch(te,{...ye,headers:et});else throw $t.error("Session Zoho expire. Veuillez vous reconnecter."),new Error("Zoho token expired");return Pt},wn=async()=>{if(!Oe){$t.error("Please select a gig first");return}z(!0),Ee([]);try{const te=$e.get("userId"),ye=$e.get("companyId");if(!ye){$t.error("Configuration de l'entreprise non trouve. Veuillez vous reconnecter.");return}if(!await lo.getInstance().getValidAccessToken()){$t.error("Configuration Zoho non trouve. Veuillez configurer Zoho CRM d'abord.");return}C([]);const Qe=Fe.find(Lr=>Lr._id===Oe);if(!Qe){$t.error("Gig slectionn non trouv");return}const Pt=await _n("undefined/zoho/leads/sync-all",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({userId:te,companyId:ye,gigId:Oe})},Oe);if(!Pt.ok){const Lr=await Pt.json().catch(()=>null);throw new Error(Lr?.message||`Erreur lors de la synchronisation avec Zoho pour le gig ${Qe.title}`)}const Ot=await Pt.json();if(!Ot.success)throw new Error(Ot.message||`Erreur lors de la synchronisation pour le gig ${Qe.title}`);if(!Ot.data||!Array.isArray(Ot.data.leads)){Ee([]),C([]),await Us(1,"");return}const Si=Ot.data.leads;if(console.log(" Leads imports de Zoho:",Si.length,"leads"),Ee(Si),C(Si),console.log(" Appel fetchLeads aprs import Zoho"),await Us(1,""),Si.length>0)try{const Lr=$e.get("companyId");Lr&&await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${Lr}/onboarding/phases/2/steps/6`,{status:"completed"})}catch(Lr){console.error("Error updating onboarding progress after Zoho import:",Lr)}}catch(te){console.error("Error in handleImportFromZoho:",te),$t.error(te.message||"Une erreur est survenue lors de l'importation")}finally{z(!1)}},Us=async(te=1,ye="")=>{if(!(v||ve.current)&&localStorage.getItem("uploadProcessing")!=="true"){if(!Oe){if(k.length>0||localStorage.getItem("parsedLeads"))return;!ve.current&&localStorage.getItem("uploadProcessing")!=="true"&&(ne([]),ht(0),ze(1),me(0));return}W(!0),we(null);try{let Pe;ye.trim()?(Pe=`undefined/leads/gig/${Oe}/search?search=${encodeURIComponent(ye.trim())}`,console.log(" Recherche leads avec URL:",Pe)):(Pe=`undefined/leads/gig/${Oe}?page=${te}&limit=50`,console.log(" Rcupration leads avec URL:",Pe));const ct=await fetch(Pe,{headers:{Authorization:`Bearer ${Oe}:${$e.get("userId")}`,"Content-Type":"application/json"}});if(!ct.ok)throw new Error(`Failed to fetch leads: ${ct.statusText}`);const Qe=await ct.json();if(console.log(" Rponse API leads:",Qe),!Qe.success)throw new Error("Failed to fetch leads: API returned unsuccessful response");if(!Array.isArray(Qe.data))throw new Error("Invalid response format: expected data to be an array");ne(Qe.data),ke(Qe.data),Qe.data.length>0&&(Ee([]),C([])),ye.trim()?(ht(1),ze(1),me(Qe.data.length)):(ht(Qe.totalPages),ze(Qe.currentPage),me(Qe.total))}catch(Pe){console.error("Error fetching leads:",Pe);const ct=Pe instanceof Error?Pe.message:"Failed to fetch leads";we(ct),$t.error(ct)}finally{W(!1)}}};N.useEffect(()=>{if(console.log(" useEffect principal - selectedGigId:",Oe,"isProcessing:",v,"parsedLeads:",k.length),v||ve.current){console.log(" Skipping - processing in progress");return}if(Oe)console.log(" Chargement des leads pour gigId:",Oe),Us(1,"").catch(te=>{console.error("Error in useEffect:",te),we("Failed to load leads")});else{if(console.log(" Pas de selectedGigId, clearing leads"),ve.current||localStorage.getItem("uploadProcessing")==="true"||sessionStorage.getItem("uploadProcessing")==="true"||k.length>0)return;!ve.current&&localStorage.getItem("uploadProcessing")!=="true"&&(ne([]),ht(0),ze(1))}},[Oe,v]),N.useEffect(()=>{console.log(" useEffect rechargement - realtimeLeads:",de.length,"selectedGigId:",Oe,"isProcessing:",v),de.length>0&&Oe&&!v&&(console.log(" Rechargement des leads aprs import Zoho"),Us(1,"").catch(te=>{console.error("Error reloading leads after Zoho import:",te)}))},[de.length,Oe,v]),N.useEffect(()=>{console.log(" useEffect montage - selectedGigId:",Oe,"parsedLeads:",k.length,"realtimeLeads:",de.length),Oe&&ae.length===0&&de.length===0&&!v&&(console.log(" Chargement initial des leads"),Us(1,"").catch(te=>{console.error("Error in initial load useEffect:",te),we("Failed to load leads")}))},[]),N.useEffect(()=>{if(ve.current||k.length>0)return;const te=localStorage.getItem("parsedLeads");if(!te){if(te&&k.length===0)try{const ye=JSON.parse(te);C(ye);return}catch(ye){console.error("Error restoring parsed leads during render:",ye)}k.length>0}},[ae,k.length]);const UIe=()=>{const te=[];if(_e<=5){for(let Qe=1;Qe<=_e;Qe++)te.push(i.createElement("button",{key:Qe,onClick:()=>Us(Qe),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${Qe===Re?"z-10 bg-indigo-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`},Qe));return te}te.push(i.createElement("button",{key:1,onClick:()=>Us(1,h),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${Re===1?"z-10 bg-indigo-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`},"1"));let Pe=Math.max(2,Re-1),ct=Math.min(_e-1,Re+1);Re<=3?ct=Math.min(4,_e-1):Re>=_e-2&&(Pe=Math.max(2,_e-3)),Pe>2&&te.push(i.createElement("span",{key:"start-ellipsis",className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300"},"..."));for(let Qe=Pe;Qe<=ct;Qe++)te.push(i.createElement("button",{key:Qe,onClick:()=>Us(Qe,h),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${Qe===Re?"z-10 bg-indigo-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`},Qe));return ct<_e-1&&te.push(i.createElement("span",{key:"end-ellipsis",className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-700 ring-1 ring-inset ring-gray-300"},"...")),_e>1&&te.push(i.createElement("button",{key:_e,onClick:()=>Us(_e,h),className:`relative inline-flex items-center px-4 py-2 text-sm font-semibold ${_e===Re?"z-10 bg-indigo-600 text-white focus:z-20 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 focus:z-20 focus:outline-offset-0"}`},_e)),te},VIe=async()=>{At(!0);try{const te=$e.get("companyId");if(!te)throw new Error("Company ID not found in cookies");const ye=await fetch(`undefined/gigs/company/${te}`,{headers:{Authorization:`Bearer ${Oe||$e.get("gigId")}:${$e.get("userId")}`,"Content-Type":"application/json"}});if(!ye.ok)throw new Error("Failed to fetch gigs");const Pe=await ye.json();Pe.data&&(tt(Pe.data),Pe.data.length>0&&Ye(Pe.data[0]._id))}catch(te){console.error("Error fetching gigs:",te),$t.error("Failed to load gigs")}finally{At(!1)}};N.useEffect(()=>{VIe()},[]),N.useEffect(()=>{const te=ye=>{ye.data.zohoConnected&&_(!0)};return window.addEventListener("message",te),()=>window.removeEventListener("message",te)},[]),N.useEffect(()=>{(async()=>{const Pe=lo.getInstance().isConfigured();fe(Pe),_(Pe)})()},[]),N.useEffect(()=>{localStorage.setItem("hasSeenImportChoiceModal","true"),qe(!1)},[]);const Fl=(te,ye,Pe)=>{const ct=[...k];ct[te]={...ct[te],[ye]:Pe},C(ct)},WIe=async te=>{p(te),De.current&&clearTimeout(De.current),De.current=setTimeout(async()=>{te.trim()?await Us(1,te):await Us(1)},500)},jIe=(te,ye)=>ye==="all"?te:te.filter(Pe=>ye==="active"?Pe.Stage!=="Closed":ye==="inactive"?Pe.Stage==="Closed":!0);N.useEffect(()=>{const te=jIe(ae,f);ke(te)},[ae,f]);const OB=()=>{localStorage.setItem("hasSeenImportChoiceModal","true"),qe(!1),it(null)};return i.createElement("div",{className:"space-y-4 bg-gradient-to-br from-blue-50 to-white min-h-screen p-4"},i.createElement("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},i.createElement("div",{className:"flex items-start justify-between mb-6"},i.createElement("div",{className:"flex-1"},i.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-3 flex items-center"},i.createElement(gA,{className:"mr-3 h-8 w-8 text-blue-600"}),"Upload Contacts"),i.createElement("p",{className:"text-lg text-gray-600"},"Import, manage, and organize your leads efficiently. Choose between connecting with your CRM system or uploading contact files directly.")))),i.createElement("div",{className:"bg-white rounded-xl shadow-lg border border-slate-200 p-6 transition-all duration-300 ease-in-out"},i.createElement("h4",{className:"text-xl font-bold text-slate-900 mb-6 flex items-center"},i.createElement(Gr,{className:"mr-3 h-6 w-6 text-slate-600"}),"Select a Gig"),at?i.createElement("div",{className:"flex items-center justify-center py-12"},i.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}),i.createElement("span",{className:"ml-4 text-base text-slate-600 font-medium"},"Loading gigs...")):Fe.length===0?i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"mx-auto h-16 w-16 text-slate-300 mb-4"},i.createElement(Gr,{className:"h-16 w-16"})),i.createElement("p",{className:"text-base text-slate-500 font-medium"},"No gigs available.")):i.createElement("div",{className:"max-w-lg"},i.createElement("select",{value:Oe,onChange:te=>Ye(te.target.value),className:"w-full rounded-xl border-2 border-slate-300 py-4 px-5 text-base font-medium focus:border-slate-600 focus:outline-none focus:ring-2 focus:ring-slate-200 focus:ring-offset-2 bg-white shadow-sm hover:border-slate-400 transition-all duration-200"},i.createElement("option",{value:"",className:"text-slate-500"},"Select a gig..."),Fe.map(te=>i.createElement("option",{key:te._id,value:te._id,className:"text-slate-900"},te.title))))),i.createElement("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-4"},i.createElement("div",{className:"mb-4"},i.createElement("h3",{className:"text-xl font-semibold text-gray-900 flex items-center"},i.createElement(nA,{className:"mr-2 h-5 w-5 text-blue-600"}),"Import Leads"),i.createElement("p",{className:"mt-1 text-sm text-gray-600"},"Choose your preferred method to import leads into your selected gig.")),i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-4"},i.createElement("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 hover:border-blue-300 hover:shadow-lg transition-all duration-300 transform hover:scale-[1.02] flex flex-col h-full"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement("div",{className:"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-4 border-2 border-blue-200 shadow-sm"},i.createElement("img",{src:WE,alt:"Zoho CRM",className:"h-7 w-7 object-contain"})),i.createElement("div",{className:"flex-1"},i.createElement("h4",{className:"text-xl font-bold text-blue-900"},"Zoho CRM Integration"),i.createElement("p",{className:"text-sm text-blue-700"},"Connect and sync with your Zoho CRM"))),i.createElement("div",{className:"mb-4"},wt?i.createElement("div",{className:"flex items-center justify-between bg-green-50 border border-green-200 rounded-lg p-3"},i.createElement("span",{className:"text-sm font-medium text-green-800"}," Connected to Zoho CRM"),i.createElement("button",{onClick:Ge,disabled:q,className:"px-3 py-1 text-xs font-medium text-red-700 bg-red-100 hover:bg-red-200 rounded-lg transition-colors duration-200 disabled:opacity-50"},q?"Disconnecting...":"Disconnect")):i.createElement("div",{className:"flex items-center justify-between bg-yellow-50 border border-yellow-200 rounded-lg p-3"},i.createElement("span",{className:"text-sm font-medium text-yellow-800"}," Not connected"),i.createElement("button",{onClick:Be,className:"px-3 py-1 text-xs font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 rounded-lg transition-colors duration-200"},"Connect"))),i.createElement("div",{className:"mt-auto"},i.createElement("button",{onClick:async()=>{if(!Oe){$t.error("Please select a gig first");return}await wn()},disabled:!wt||P,className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold py-4 px-6 rounded-xl hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl flex items-center justify-center"},P?i.createElement(i.Fragment,null,i.createElement($a,{className:"mr-3 h-5 w-5 animate-spin"}),"Importing from Zoho..."):wt?i.createElement(i.Fragment,null,i.createElement("img",{src:WE,alt:"Zoho",className:"h-5 w-5 mr-3 object-contain"}),"Sync with Zoho CRM"):i.createElement(i.Fragment,null,i.createElement("img",{src:WE,alt:"Zoho",className:"h-5 w-5 mr-3 object-contain"}),"Connect to Zoho CRM First")))),i.createElement("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-2xl p-6 hover:border-blue-300 hover:shadow-lg transition-all duration-300 transform hover:scale-[1.02] flex flex-col h-full","data-file-upload":!0},i.createElement("div",{className:"flex items-center mb-4"},i.createElement("div",{className:"w-12 h-12 bg-white rounded-xl flex items-center justify-center mr-4 border-2 border-blue-200 shadow-sm"},i.createElement(rA,{className:"h-6 w-6 text-blue-700"})),i.createElement("div",{className:"flex-1"},i.createElement("h4",{className:"text-xl font-bold text-blue-900"},"File Upload"),i.createElement("p",{className:"text-sm text-blue-700"},"Upload and process contact files"))),i.createElement("div",{className:"mb-4"},i.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3"},i.createElement("span",{className:"text-sm font-medium text-blue-800"}," Supported: CSV, Excel, JSON, TXT"))),i.createElement("div",{className:"mt-auto"},i.createElement("div",{className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold py-4 px-6 rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl cursor-pointer flex items-center justify-center"},i.createElement("label",{htmlFor:"file-upload",className:"cursor-pointer flex items-center justify-center w-full"},i.createElement(rA,{className:"h-5 w-5 mr-3 text-white"}),i.createElement("span",{className:"text-base font-semibold text-white"},v?i.createElement("div",{className:"flex items-center"},i.createElement($a,{className:"mr-2 h-5 w-5 animate-spin"}),"Processing..."):"Click to upload or drag and drop"),i.createElement("input",{id:"file-upload",type:"file",className:"hidden",accept:"*",onChange:oe,disabled:v})))))),o&&$&&i.createElement("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg"},i.createElement("div",{className:"flex items-center justify-between text-sm"},i.createElement("div",{className:"flex items-center"},i.createElement(hn,{className:"mr-2 h-4 w-4 text-blue-600"}),i.createElement("span",{className:"font-medium text-gray-900"},o.name)),i.createElement("button",{onClick:()=>{l(null),u(0),g(null),w(!1),C([]),Qt(null)}},i.createElement(Yo,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"}))),i.createElement("div",{className:"mt-3"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"h-3 rounded-full bg-gray-200 overflow-hidden"},i.createElement("div",{className:`h-3 rounded-full transition-all duration-300 ${x?"bg-red-500":b?"bg-green-500":"bg-gradient-to-r from-blue-500 to-indigo-500"}`,style:{width:`${c}%`,background:v&&!x&&!b?"linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%)":void 0}}))),i.createElement("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-500"},i.createElement("span",null,v&&!x&&!b?`Analyse en cours... ${c}%`:c>0?`${c}% termin`:"Prt"),i.createElement("span",null,Math.round(o.size/1024)," KB")),v&&!x&&!b&&i.createElement("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-lg"},i.createElement("div",{className:"flex items-center justify-between text-xs"},i.createElement("span",{className:"text-blue-700 font-medium"},Ke.status||"Traitement OpenAI en cours...")),i.createElement("div",{className:"mt-2 flex items-center space-x-1"},i.createElement("div",{className:"flex space-x-1"},[0,1,2].map(te=>i.createElement("div",{key:te,className:"w-2 h-2 bg-blue-400 rounded-full animate-pulse",style:{animationDelay:`${te*.2}s`,animationDuration:"1s"}}))),i.createElement("span",{className:"text-xs text-blue-600 ml-2"},"Traitement en cours...")))),x&&i.createElement("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-600"},x),b&&i.createElement("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded-lg text-sm text-green-600"},"File uploaded successfully!"),k.length>0&&!b&&!x&&I&&i.createElement("div",{className:"mt-4 space-y-4"},gt&&i.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-3"},i.createElement("h4",{className:"text-sm font-semibold text-blue-800 mb-2 flex items-center"},i.createElement(CW,{className:"mr-2 h-4 w-4"}),"AI Processing Results"),i.createElement("div",{className:"grid grid-cols-2 gap-4 text-sm"},i.createElement("div",null,i.createElement("span",{className:"text-blue-600 font-medium"},"Total Rows:")," ",gt.totalRows),i.createElement("div",null,i.createElement("span",{className:"text-green-600 font-medium"},"Valid Rows:")," ",gt.validRows>0?gt.validRows:k.length),gt.invalidRows>0&&i.createElement("div",{className:"col-span-2"},i.createElement("span",{className:"text-red-600 font-medium"},"Invalid Rows:")," ",gt.invalidRows)),gt.errors&&gt.errors.length>0&&i.createElement("div",{className:"mt-3"},i.createElement("details",{className:"text-xs"},i.createElement("summary",{className:"cursor-pointer text-blue-600 hover:text-blue-800"},"View validation errors (",gt.errors.length,")"),i.createElement("div",{className:"mt-2 space-y-1"},gt.errors.map((te,ye)=>i.createElement("div",{key:ye,className:"text-red-600 bg-red-50 p-2 rounded"},te)))))),i.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-3"},i.createElement("div",{className:"flex items-center justify-between mb-3"},i.createElement("div",{className:"flex items-center"},i.createElement(mt,{className:"mr-2 h-4 w-4"}),i.createElement("h4",{className:"text-sm font-semibold text-gray-800"},"Confirm & Edit Leads (",k.length,")"),V&&i.createElement("span",{className:"ml-2 inline-flex items-center rounded-full px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800"},i.createElement(Xm,{className:"mr-1 h-3 w-3"}),"Large dataset - memory only")),i.createElement("button",{onClick:()=>dt(!St),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-all duration-200",title:St?"Hide leads preview":"Show leads preview"},St?i.createElement(Zm,{className:"h-4 w-4"}):i.createElement(Hu,{className:"h-4 w-4"}))),St&&i.createElement(i.Fragment,null,i.createElement("p",{className:"text-xs text-gray-600 mb-3"},"Review and edit your leads before saving. Click the edit icon to modify any field."),i.createElement("div",{className:"max-h-60 overflow-y-auto"},i.createElement("div",{className:"space-y-2"},k.map((te,ye)=>i.createElement("div",{key:ye,className:"bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg p-3 border border-gray-200 hover:border-slate-300 transition-all duration-200"},i.createElement("div",{className:"flex items-center justify-between mb-3"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"w-8 h-8 bg-slate-100 rounded-full flex items-center justify-center"},i.createElement("span",{className:"text-xs font-bold text-slate-600"},ye+1)),i.createElement("span",{className:"text-sm font-semibold text-gray-900"},te.Deal_Name||"Unnamed Lead")),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("button",{onClick:()=>S(Bs===ye?null:ye),className:"text-slate-600 hover:text-slate-800 p-2 rounded-md hover:bg-slate-50 transition-colors duration-200",title:"Edit lead"},i.createElement(Hi,{className:"h-4 w-4"})),i.createElement("button",{onClick:()=>{const Pe=[...k];Pe.splice(ye,1),C(Pe)},className:"text-red-500 hover:text-red-700 p-2 rounded-md hover:bg-red-50 transition-colors duration-200",title:"Delete lead"},i.createElement(Hr,{className:"h-4 w-4"})))),Bs===ye?i.createElement("div",{className:"space-y-3 bg-white rounded-lg p-3 border border-slate-200 shadow-sm"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"First Name"),i.createElement("input",{type:"text",value:te.First_Name||"",onChange:Pe=>Fl(ye,"First_Name",Pe.target.value),placeholder:"Enter first name",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Last Name"),i.createElement("input",{type:"text",value:te.Last_Name||"",onChange:Pe=>Fl(ye,"Last_Name",Pe.target.value),placeholder:"Enter last name",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Email"),i.createElement("input",{type:"email",value:te.Email_1||"",onChange:Pe=>Fl(ye,"Email_1",Pe.target.value),placeholder:"Enter email address",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Phone"),i.createElement("input",{type:"tel",value:te.Phone||"",onChange:Pe=>Fl(ye,"Phone",Pe.target.value),placeholder:"Enter phone number",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Address"),i.createElement("input",{type:"text",value:te.Address||"",onChange:Pe=>Fl(ye,"Address",Pe.target.value),placeholder:"Enter address",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",{className:"grid grid-cols-2 gap-3"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Postal Code"),i.createElement("input",{type:"text",value:te.Postal_Code||"",onChange:Pe=>Fl(ye,"Postal_Code",Pe.target.value),placeholder:"Zip code",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"City"),i.createElement("input",{type:"text",value:te.City||"",onChange:Pe=>Fl(ye,"City",Pe.target.value),placeholder:"City",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"}))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Date of Birth"),i.createElement("input",{type:"text",value:te.Date_of_Birth||"",onChange:Pe=>Fl(ye,"Date_of_Birth",Pe.target.value),placeholder:"DD/MM/YYYY",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-slate-700 focus:border-slate-700 transition-all duration-200 bg-white shadow-sm"})),i.createElement("div",{className:"flex justify-end space-x-2 pt-2 border-t border-gray-100"},i.createElement("button",{onClick:()=>S(null),className:"px-3 py-1 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-all duration-200 border border-gray-300"},"Cancel"),i.createElement("button",{onClick:()=>{S(null)},className:"px-3 py-1 text-sm font-medium text-white bg-gradient-to-r from-slate-700 to-slate-900 rounded-lg hover:from-slate-800 hover:to-slate-950 transition-all duration-200 shadow-sm"},"Save Changes"))):i.createElement("div",{className:"grid grid-cols-2 gap-2 text-sm"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(Ku,{className:"h-4 w-4 text-gray-400"}),i.createElement("span",{className:"text-gray-600 truncate"},i.createElement("span",{className:"font-medium"},"Email:")," ",te.Email_1||"No email")),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(Ql,{className:"h-4 w-4 text-gray-400"}),i.createElement("span",{className:"text-gray-600"},i.createElement("span",{className:"font-medium"},"Phone:")," ",te.Phone||"No phone")),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(to,{className:"h-4 w-4 text-gray-400"}),i.createElement("span",{className:"text-gray-600 truncate"},i.createElement("span",{className:"font-medium"},"Adresse:")," ",te.City||"N/A")),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(Ia,{className:"h-4 w-4 text-gray-400"}),i.createElement("span",{className:"text-gray-600"},i.createElement("span",{className:"font-medium"},"DOB:")," ",te.Date_of_Birth||"N/A"))))))))),i.createElement("button",{className:"w-full rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 px-4 py-3 text-white font-bold hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl",onClick:he,disabled:F},i.createElement("div",{className:"flex items-center justify-center"},i.createElement(gA,{className:"mr-2 h-5 w-5"}),"Save ",k.length," Contacts")),F&&i.createElement("div",{className:"mt-4 space-y-3"},i.createElement("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center"},i.createElement($a,{className:"mr-3 h-5 w-5 text-green-600 animate-spin"}),i.createElement("div",null,i.createElement("h4",{className:"text-sm font-semibold text-green-800"},"Saving Contacts..."),i.createElement("p",{className:"text-xs text-green-600"},M," of ",k.length," contacts saved"))),i.createElement("div",{className:"text-right"},i.createElement("div",{className:"text-sm font-bold text-green-700"},Math.round(M/k.length*100),"%"),i.createElement("div",{className:"w-16 h-2 bg-green-200 rounded-full overflow-hidden"},i.createElement("div",{className:"h-full bg-gradient-to-r from-green-500 to-emerald-500 transition-all duration-300",style:{width:`${M/k.length*100}%`}}))))),i.createElement("button",{className:"w-full rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 px-4 py-3 text-white font-bold hover:from-green-700 hover:to-emerald-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl",disabled:!0},i.createElement("div",{className:"flex items-center justify-center"},i.createElement($a,{className:"mr-2 h-5 w-5 animate-spin"}),"Saving ",M,"/",k.length," Contacts...")))))),i.createElement("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-4"},i.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center"},i.createElement(gs,{className:"mr-2 h-5 w-5 text-blue-600"}),"Channel Filter"),i.createElement("div",{className:"flex flex-wrap gap-2"},fw.map(te=>{const ye=te.icon,Pe=d.includes(te.id);return i.createElement("button",{key:te.id,className:`flex items-center space-x-2 rounded-full px-3 py-2 text-sm font-medium transition-all duration-200 transform hover:scale-105 ${Pe?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200 hover:shadow-md"}`,onClick:()=>ge(te.id)},i.createElement(ye,{className:"h-4 w-4"}),i.createElement("span",null,te.name))}))),i.createElement("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100"},i.createElement("div",{className:"border-b border-gray-200 p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h3",{className:"text-xl font-semibold text-gray-900 flex items-center"},i.createElement(hn,{className:"mr-2 h-5 w-5 text-blue-600"}),"Leads List"),i.createElement("div",{className:"mt-2"},Oe?i.createElement("div",{className:"text-sm text-gray-600"},k.length>0&&ae.length===0?i.createElement("span",{className:"bg-green-50 text-green-700 px-3 py-1 rounded-full text-xs font-medium"},k.length," leads ready to save"):F&&L.length>0?i.createElement("span",{className:"bg-emerald-50 text-emerald-700 px-3 py-1 rounded-full text-xs font-medium"},"Showing ",L.length," recently saved leads (saving in progress...)"):ae.length>0?i.createElement("span",{className:"bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-xs font-medium"},"Showing ",Z.length," of ",ae.length," leads ",h&&`(filtered by "${h}")`):i.createElement("span",{className:"bg-gray-50 text-gray-600 px-3 py-1 rounded-full text-xs font-medium"},"No leads found")):i.createElement("p",{className:"text-sm text-gray-500"},"Please select a gig to view leads"))),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},i.createElement(Xu,{className:"h-5 w-5 text-gray-400"})),i.createElement("input",{type:"text",className:"block w-full rounded-lg border-gray-300 pl-10 focus:border-blue-600 focus:ring-blue-600 sm:text-sm shadow-sm",placeholder:"Search leads...",value:h,onChange:te=>WIe(te.target.value)})),i.createElement("select",{className:"rounded-lg border-gray-300 py-2 pl-3 pr-10 text-base focus:border-blue-600 focus:outline-none focus:ring-blue-600 sm:text-sm shadow-sm",value:f,onChange:te=>y(te.target.value)},i.createElement("option",{value:"all"},"All Status"),i.createElement("option",{value:"active"},"Active (Not Closed)"),i.createElement("option",{value:"inactive"},"Inactive (Closed)")),i.createElement("button",{onClick:()=>{p(""),Us(1)},className:"flex items-center rounded-lg bg-gradient-to-r from-blue-600 to-indigo-600 px-3 py-2 text-sm font-medium text-white shadow-md hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 transform hover:scale-105",disabled:Ae||!Oe},Ae?i.createElement(i.Fragment,null,i.createElement($a,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading..."):i.createElement(i.Fragment,null,i.createElement($a,{className:"mr-2 h-4 w-4"}),"Refresh"))))),i.createElement("div",{className:"overflow-x-auto"},i.createElement("div",{className:"max-h-96 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400"},i.createElement("div",{className:"relative"},i.createElement("table",{className:"min-w-full divide-y divide-gray-200"},i.createElement("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm text-center"},i.createElement("tr",null,i.createElement("th",{scope:"col",className:"px-3 py-3 text-xs font-semibold uppercase tracking-wider text-gray-500 bg-gray-50"},"Nom"),i.createElement("th",{scope:"col",className:"px-3 py-3 text-xs font-semibold uppercase tracking-wider text-gray-500 bg-gray-50"},"Prnom"),i.createElement("th",{scope:"col",className:"px-3 py-3 text-xs font-semibold uppercase tracking-wider text-gray-500 bg-gray-50"},"Email"),i.createElement("th",{scope:"col",className:"px-3 py-3 text-xs font-semibold uppercase tracking-wider text-gray-500 bg-gray-50"},"Adresse"),i.createElement("th",{scope:"col",className:"px-3 py-3 text-xs font-semibold uppercase tracking-wider text-gray-500 bg-gray-50"},"MOBILE"))),i.createElement("tbody",{className:"divide-y divide-gray-200 bg-white"},le?i.createElement("tr",null,i.createElement("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-red-500"},le)):Ae?i.createElement("tr",null,i.createElement("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500"},i.createElement("div",{className:"flex items-center justify-center py-8"},i.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-3"}),"Loading leads..."))):ae.length===0&&de.length===0&&!F?i.createElement("tr",null,i.createElement("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500"},i.createElement("div",{className:"flex flex-col items-center justify-center py-8"},i.createElement(hn,{className:"h-12 w-12 text-gray-300 mb-2"}),i.createElement("p",null,"No leads found"),i.createElement("p",{className:"text-xs text-gray-400 mt-1"},"Try importing some leads or check your filters")))):Z.length===0&&de.length===0&&!F?i.createElement("tr",null,i.createElement("td",{colSpan:3,className:"px-6 py-4 text-center text-sm text-gray-500"},i.createElement("div",{className:"flex flex-col items-center justify-center py-8"},i.createElement(Xu,{className:"h-12 w-12 text-gray-300 mb-2"}),i.createElement("p",null,"No leads match your search"),i.createElement("p",{className:"text-xs text-gray-400 mt-1"},"Try adjusting your search terms or filters")))):(F&&L.length>0?L:Z.length>0?Z:de.length>0?de:[]).map((te,ye)=>i.createElement("tr",{key:te._id,className:`hover:bg-gray-50 transition-colors duration-150 text-center ${ye%2===0?"bg-white":"bg-gray-50"} ${te._isPlaceholder?"opacity-75 border-l-4 border-orange-400":""}`},i.createElement("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 border-r border-gray-100"},te.Last_Name||"-"),i.createElement("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 border-r border-gray-100"},te.First_Name||"-"),i.createElement("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-900 border-r border-gray-100 italic text-blue-600"},te.Email_1||"-"),i.createElement("td",{className:"whitespace-nowrap px-3 py-4 text-sm text-gray-600 border-r border-gray-100"},te.Address||"-"),i.createElement("td",{className:"whitespace-nowrap px-3 py-4 text-sm font-semibold text-gray-900"},"+",te.Phone||"-")))))))),(Z.length>0||de.length>0)&&i.createElement("div",{className:"bg-white px-4 py-3 border-t border-gray-200"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center text-sm text-gray-700"},i.createElement("span",null,h?i.createElement(i.Fragment,null,"Showing ",i.createElement("span",{className:"font-medium"},Z.length),' results for "',h,'"'):i.createElement(i.Fragment,null,"Showing ",i.createElement("span",{className:"font-medium"},Z.length>0?Z.length:de.length)," of"," ",i.createElement("span",{className:"font-medium"},X>0?X:de.length)," leads"))),!h&&_e>1&&i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("button",{onClick:()=>Us(Re-1),disabled:Re===1,className:"relative inline-flex items-center px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Previous"),i.createElement("div",{className:"flex items-center space-x-1"},UIe()),i.createElement("button",{onClick:()=>Us(Re+1),disabled:Re===_e,className:"relative inline-flex items-center px-3 py-2 text-sm font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Next"))))),de.length>0&&i.createElement("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-4"},i.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-3 flex items-center"},i.createElement($a,{className:"mr-2 h-5 w-5 text-blue-600 animate-spin"}),"Leads en temps rel"),i.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-3 mb-3"},i.createElement("p",{className:"text-sm font-medium text-blue-700"},"Nombre de leads reus: ",i.createElement("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-bold"},de.length))),i.createElement("div",{className:"max-h-48 overflow-y-auto border border-gray-200 rounded-lg"},i.createElement("div",{className:"min-w-full divide-y divide-gray-200"},i.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 sticky top-0"},i.createElement("div",{className:"grid grid-cols-3 px-6 py-3"},i.createElement("div",{className:"text-left text-xs font-semibold text-blue-700 uppercase tracking-wider"},"Email"),i.createElement("div",{className:"text-left text-xs font-semibold text-blue-700 uppercase tracking-wider"},"Tlphone"),i.createElement("div",{className:"text-left text-xs font-semibold text-blue-700 uppercase tracking-wider"},"Lead"))),i.createElement("div",{className:"bg-white divide-y divide-gray-100"},de.map((te,ye)=>i.createElement("div",{key:ye,className:"grid grid-cols-3 px-6 py-4 hover:bg-gray-50 transition-colors duration-150"},i.createElement("div",{className:"text-sm font-medium text-gray-900"},te.Email_1||"N/A"),i.createElement("div",{className:"text-sm text-gray-700"},te.Phone||"N/A"),i.createElement("div",{className:"text-sm text-gray-700"},te.Deal_Name||"N/A"))))))),We&&i.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},i.createElement("div",{className:"relative w-full max-w-md transform rounded-lg bg-white p-6 text-left shadow-xl transition-all"},i.createElement("div",{className:"absolute right-4 top-4"},i.createElement("button",{onClick:OB,className:"text-gray-400 hover:text-gray-600"},i.createElement(Yo,{className:"h-6 w-6"}))),i.createElement("div",{className:"text-center"},i.createElement("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-blue-100"},i.createElement(nA,{className:"h-6 w-6 text-blue-700"})),i.createElement("h3",{className:"mb-2 text-lg font-semibold text-gray-900"},"Choose your import method"),i.createElement("p",{className:"mb-6 text-sm text-gray-600"},"You can import your leads using ",i.createElement("b",null,"Zoho CRM")," or by uploading an ",i.createElement("b",null,"Excel/CSV file"),".",i.createElement("br",null),"Click Next to continue.")),i.createElement("div",{className:"mt-6 flex justify-between space-x-3"},i.createElement("button",{onClick:OB,className:"flex-1 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500"},"Cancel"),i.createElement("button",{onClick:()=>{localStorage.setItem("hasSeenImportChoiceModal","true"),qe(!1)},className:"flex-1 rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-600"},"Next")))))}),QX=()=>i.createElement("div",{className:"h-[calc(100vh-100px)] w-full"},i.createElement(UG,null,i.createElement(SA,null))),eY=()=>{const[t,e]=N.useState(1);N.useState(1),N.useState([]);const[n,s]=N.useState([]),[r,a]=N.useState(!1),[o,l]=N.useState(null),c=[{id:1,title:"Profile Setup",description:"Complete REP profile and documentation",status:"completed"},{id:2,title:"Training & Certification",description:"Complete required training modules",status:"current"},{id:3,title:"Channel Setup",description:"Configure communication channels",status:"pending"},{id:4,title:"Skills Assessment",description:"Validate skills and expertise",status:"pending"}],u=g=>{let b="N/A";if(g.modules&&Array.isArray(g.modules)){const v=g.modules.reduce((E,k)=>E+(k.duration||0),0);if(v>0){const E=Math.floor(v/60),k=v%60;b=E>0?`${E}h ${k}min`:`${k} min`}}let w="not_started";return g.status==="completed"||g.journeyStatus==="completed"?w="completed":(g.status==="in_progress"||g.journeyStatus==="in_progress"||g.status==="active")&&(w="in_progress"),{id:g._id||g.id,title:g.title||g.name||"Untitled Training",description:g.description||"",duration:b,type:g.type||"course",required:g.required!==!1,status:w,progress:g.progress||(w==="completed"?100:w==="in_progress"?50:0),modules:g.modules||[]}},m=(()=>{const g=[];return n.forEach(w=>{w.modules&&Array.isArray(w.modules)&&w.modules.forEach(v=>{v.sections&&Array.isArray(v.sections)&&v.sections.forEach(E=>{if(E.content&&E.content.file){const k=E.content.file,C=k.name||E.title||"Untitled Document",I=k.type||k.mimeType?.split("/")[1]?.toUpperCase()||"FILE",A=k.size?k.size>1024*1024?`${(k.size/(1024*1024)).toFixed(1)} MB`:`${(k.size/1024).toFixed(1)} KB`:"Unknown size";g.push({id:k.id||k.publicId||`${w.id}-${v._id}-${E._id}`,title:C,type:I,size:A,url:k.url})}})})}),g.filter((w,v,E)=>v===E.findIndex(k=>k.id===w.id||k.url===w.url))})(),h=g=>{const b={pdf:"PDF",doc:"DOC",docx:"DOCX",xls:"XLS",xlsx:"XLSX",ppt:"PPT",pptx:"PPTX",mp4:"VIDEO",mov:"VIDEO",avi:"VIDEO",zip:"ZIP",rar:"RAR",jpg:"IMAGE",jpeg:"IMAGE",png:"IMAGE",gif:"IMAGE"},w=g.toLowerCase();return b[w]||g.toUpperCase()},p=[{id:1,title:"Communication Skills",type:"practical",status:"pending",score:null},{id:2,title:"Technical Knowledge",type:"written",status:"completed",score:92},{id:3,title:"Platform Proficiency",type:"practical",status:"in_progress",score:null}],f=()=>typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:5010":"https://v25platformtrainingbackend-production.up.railway.app",y=N.useCallback(async()=>{if(!o){console.log("[RepOnboarding] No companyId available, skipping training fetch");return}a(!0);try{const g=f(),b=`${g}/training_journeys/trainer/companyId/${o}`;console.log("[RepOnboarding] Fetching trainings from:",b),console.log("[RepOnboarding] Company ID:",o),console.log("[RepOnboarding] Training Backend URL:",g);const w=await Ie.get(b);if(console.log("[RepOnboarding] Training API Response:",w.data),w.data&&w.data.success&&w.data.data){const v=Array.isArray(w.data.data)?w.data.data:[];console.log("[RepOnboarding] Found",v.length,"trainings"),s(v)}else Array.isArray(w.data)?(console.log("[RepOnboarding] Response is array, found",w.data.length,"trainings"),s(w.data)):(console.log("[RepOnboarding] No trainings found in response"),s([]))}catch(g){console.error("[RepOnboarding] Error fetching company trainings:",g),g.response&&(console.error("[RepOnboarding] Error response status:",g.response.status),console.error("[RepOnboarding] Error response data:",g.response.data),console.error("[RepOnboarding] Requested URL:",g.config?.url)),s([])}finally{a(!1)}},[o]),x=g=>{window.location.href=g};return N.useEffect(()=>{const g=$e.get("companyId");if(g)l(g);else{const b=$e.get("userId");b&&Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/companies/user/${b}`).then(w=>{if(w.data.success&&w.data.data){const v=w.data.data._id;l(v),$e.set("companyId",v)}}).catch(w=>{console.error("Error fetching company ID:",w)})}},[]),N.useEffect(()=>{o&&y()},[o,y]),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"REP Onboarding"),i.createElement("p",{className:"text-sm text-gray-500"},"Guide new REPS through the onboarding process")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:"flex items-center rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},i.createElement(Gr,{className:"mr-2 h-4 w-4"}),"Settings"),i.createElement("button",{className:"flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(xs,{className:"mr-2 h-4 w-4"}),"New REP"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Onboarding Progress"),i.createElement("span",{className:"text-sm text-gray-500"},"Step ",t," of 4")),i.createElement("div",{className:"mt-4"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"absolute left-0 top-2 h-0.5 w-full bg-gray-200"},i.createElement("div",{className:"absolute h-0.5 bg-indigo-600 transition-all duration-500",style:{width:`${(t-1)/3*100}%`}})),i.createElement("div",{className:"relative flex justify-between"},c.map((g,b)=>i.createElement("div",{key:b,className:"flex flex-col items-center"},i.createElement("div",{className:`flex h-8 w-8 items-center justify-center rounded-full border-2 ${g.status==="completed"?"border-indigo-600 bg-indigo-600":g.status==="current"?"border-indigo-600 bg-white":"border-gray-300 bg-white"}`},g.status==="completed"?i.createElement(mt,{className:"h-5 w-5 text-white"}):i.createElement("span",{className:`text-sm font-medium ${g.status==="current"?"text-indigo-600":"text-gray-500"}`},b+1)),i.createElement("div",{className:"mt-2 text-center"},i.createElement("p",{className:`text-sm font-medium ${g.status==="completed"?"text-indigo-600":g.status==="current"?"text-gray-900":"text-gray-500"}`},g.title),i.createElement("p",{className:"mt-1 text-xs text-gray-500"},g.description)))))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Training & Certification"),i.createElement("div",{className:"mt-4 space-y-4"},r?i.createElement("div",{className:"text-center py-8"},i.createElement("p",{className:"text-sm text-gray-500"},"Loading trainings...")):n.length>0?n.map(g=>{const b=u(g);return i.createElement("div",{key:b.id,className:"rounded-lg border border-gray-200 bg-white"},i.createElement("div",{className:"flex items-center justify-between p-4"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:`rounded-lg p-2 ${b.status==="completed"?"bg-green-100 text-green-600":b.status==="in_progress"?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600"}`},b.type==="video"?i.createElement(xA,{className:"h-5 w-5"}):b.type==="interactive"?i.createElement(Ko,{className:"h-5 w-5"}):i.createElement(Go,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},b.title),i.createElement("div",{className:"mt-1 flex items-center space-x-2 text-sm text-gray-500"},i.createElement(Ct,{className:"h-4 w-4"}),i.createElement("span",null,b.duration),b.required&&i.createElement("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs font-medium text-red-800"},"Required")),b.description&&i.createElement("p",{className:"mt-1 text-xs text-gray-400 line-clamp-1"},b.description))),i.createElement("div",{className:"flex items-center space-x-4"},b.status==="completed"?i.createElement("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-sm font-medium text-green-800"},i.createElement(mt,{className:"mr-1 h-4 w-4"}),"Completed"):b.status==="in_progress"?i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("div",{className:"h-2 w-24 rounded-full bg-gray-200"},i.createElement("div",{className:"h-2 rounded-full bg-indigo-600",style:{width:`${b.progress}%`}})),i.createElement("span",{className:"text-sm text-gray-500"},b.progress,"%")):i.createElement("button",{onClick:()=>x(`/training/${b.id}`),className:"flex items-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(R1,{className:"mr-1 h-4 w-4"}),"Start"))))}):i.createElement("div",{className:"text-center py-8"},i.createElement(Go,{className:"mx-auto h-12 w-12 text-gray-400"}),i.createElement("p",{className:"mt-4 text-sm text-gray-500"},"No trainings available yet.")))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"mb-4 flex items-center justify-between"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Company Trainings"),i.createElement("button",{onClick:()=>x("/training"),className:"rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700 flex items-center space-x-2"},i.createElement(Go,{className:"h-4 w-4"}),i.createElement("span",null,"Go to Training"))),r?i.createElement("div",{className:"text-center py-8"},i.createElement("p",{className:"text-sm text-gray-500"},"Loading trainings...")):n.length>0?i.createElement("div",{className:"space-y-4"},i.createElement("p",{className:"text-sm text-gray-600 mb-4"},"Your company has ",n.length," training",n.length>1?"s":""," available:"),i.createElement("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},n.map(g=>i.createElement("div",{key:g._id||g.id,className:"rounded-lg border border-gray-200 p-4 hover:border-indigo-300 hover:shadow-md transition-all"},i.createElement("div",{className:"flex items-start space-x-3"},i.createElement("div",{className:"rounded-full bg-indigo-100 p-2"},i.createElement(Go,{className:"h-5 w-5 text-indigo-600"})),i.createElement("div",{className:"flex-1 min-w-0"},i.createElement("h4",{className:"text-sm font-medium text-gray-900 truncate"},g.title||g.name||"Untitled Training"),g.description&&i.createElement("p",{className:"mt-1 text-xs text-gray-500 line-clamp-2"},g.description),g.duration&&i.createElement("p",{className:"mt-2 text-xs text-gray-400"},"Duration: ",g.duration))))))):i.createElement("div",{className:"text-center py-8"},i.createElement(Go,{className:"mx-auto h-12 w-12 text-gray-400"}),i.createElement("p",{className:"mt-4 text-sm text-gray-500"},"No trainings available for your company yet."),i.createElement("button",{onClick:()=>x("/training"),className:"mt-4 rounded-lg bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700"},"Create Training"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Skills Assessment"),i.createElement("div",{className:"mt-4 space-y-4"},p.map(g=>i.createElement("div",{key:g.id,className:"rounded-lg border border-gray-200 bg-white p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:`rounded-lg p-2 ${g.status==="completed"?"bg-green-100 text-green-600":g.status==="in_progress"?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600"}`},i.createElement(Sa,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},g.title),i.createElement("p",{className:"text-sm text-gray-500"},g.type==="practical"?"Practical Assessment":"Written Test"))),i.createElement("div",null,g.status==="completed"?i.createElement("div",{className:"text-right"},i.createElement("span",{className:"text-2xl font-bold text-green-600"},g.score,"%"),i.createElement("p",{className:"text-sm text-gray-500"},"Score")):g.status==="in_progress"?i.createElement("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-sm font-medium text-yellow-800"},i.createElement(Ct,{className:"mr-1 h-4 w-4"}),"In Progress"):i.createElement("button",{className:"rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},"Start Assessment"))))))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Channel Configuration"),i.createElement("div",{className:"mt-4 space-y-4"},[{id:"voice",name:"Voice Channel",icon:Ql,status:"configured"},{id:"email",name:"Email Integration",icon:Ku,status:"pending"},{id:"chat",name:"Live Chat",icon:Ko,status:"configured"},{id:"social",name:"Social Media",icon:gs,status:"not_started"}].map(g=>{const b=g.icon;return i.createElement("div",{key:g.id,className:"rounded-lg border border-gray-200 bg-white p-4"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:`rounded-lg p-2 ${g.status==="configured"?"bg-green-100 text-green-600":g.status==="pending"?"bg-yellow-100 text-yellow-600":"bg-gray-100 text-gray-600"}`},i.createElement(b,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},g.name),i.createElement("p",{className:"text-sm text-gray-500"},g.status==="configured"?"Ready to use":g.status==="pending"?"Configuration pending":"Not configured"))),i.createElement("button",{className:`rounded-md px-3 py-1.5 text-sm font-medium shadow-sm ${g.status==="configured"?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-indigo-600 text-white hover:bg-indigo-700"}`},g.status==="configured"?"Reconfigure":"Configure")))}))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Documentation & Resources"),m.length>0&&i.createElement("button",{onClick:()=>{m.forEach(g=>{g.url&&window.open(g.url,"_blank")})},className:"flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-500"},i.createElement(qu,{className:"mr-1 h-4 w-4"}),"Download All")),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2"},m.length>0?m.map(g=>i.createElement("div",{key:g.id,className:"flex items-center justify-between rounded-lg border border-gray-200 p-4 hover:border-indigo-300 hover:shadow-md transition-all"},i.createElement("div",{className:"flex items-center flex-1 min-w-0"},i.createElement(hn,{className:"h-5 w-5 text-gray-400 flex-shrink-0"}),i.createElement("div",{className:"ml-3 min-w-0 flex-1"},i.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},g.title),i.createElement("p",{className:"text-xs text-gray-500"},h(g.type),"  ",g.size))),g.url&&i.createElement("button",{onClick:()=>window.open(g.url,"_blank"),className:"rounded-full p-1 text-gray-400 hover:bg-gray-100 hover:text-indigo-600 flex-shrink-0 ml-2",title:"Download"},i.createElement(qu,{className:"h-4 w-4"})))):i.createElement("div",{className:"col-span-2 text-center py-8"},i.createElement(hn,{className:"mx-auto h-12 w-12 text-gray-400"}),i.createElement("p",{className:"mt-4 text-sm text-gray-500"},"No documents available in training modules yet.")))))};function Mn(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function co(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function xc(t,e){const n=Mn(t);return isNaN(e)?co(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function TD(t,e){const n=Mn(t);if(isNaN(e))return co(t,NaN);if(!e)return n;const s=n.getDate(),r=co(t,n.getTime());r.setMonth(n.getMonth()+e+1,0);const a=r.getDate();return s>=a?r:(n.setFullYear(r.getFullYear(),r.getMonth(),s),n)}const AD=6048e5,tY=864e5,RD=6e4,_D=36e5;let nY={};function Ih(){return nY}function Da(t,e){const n=Ih(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=Mn(t),a=r.getDay(),o=(a<s?7:0)+a-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function fx(t){return Da(t,{weekStartsOn:1})}function DD(t){const e=Mn(t),n=e.getFullYear(),s=co(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const r=fx(s),a=co(t,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=fx(a);return e.getTime()>=r.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function gx(t){const e=Mn(t);return e.setHours(0,0,0,0),e}function PD(t){const e=Mn(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function sY(t,e){const n=gx(t),s=gx(e),r=+n-PD(n),a=+s-PD(s);return Math.round((r-a)/tY)}function rY(t){const e=DD(t),n=co(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),fx(n)}function FD(t,e){const n=gx(t),s=gx(e);return+n==+s}function aY(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function oY(t){if(!aY(t)&&typeof t!="number")return!1;const e=Mn(t);return!isNaN(Number(e))}function jE(t){const e=Mn(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function $h(t){const e=Mn(t);return e.setDate(1),e.setHours(0,0,0,0),e}function iY(t){const e=Mn(t),n=co(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function lY(t,e){const n=Ih(),s=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=Mn(t),a=r.getDay(),o=(a<s?-7:0)+6-(a-s);return r.setDate(r.getDate()+o),r.setHours(23,59,59,999),r}const cY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},uY=(t,e,n)=>{let s;const r=cY[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function GE(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const dY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},mY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pY={date:GE({formats:dY,defaultWidth:"full"}),time:GE({formats:mY,defaultWidth:"full"}),dateTime:GE({formats:hY,defaultWidth:"full"})},fY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},gY=(t,e,n,s)=>fY[t];function Th(t){return(e,n)=>{const s=n?.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=n?.width?String(n.width):o;r=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=n?.width?String(n.width):t.defaultWidth;r=t.values[l]||t.values[o]}const a=t.argumentCallback?t.argumentCallback(e):e;return r[a]}}const xY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},yY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},wY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},vY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},EY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},NY={ordinalNumber:(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Th({values:xY,defaultWidth:"wide"}),quarter:Th({values:yY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Th({values:bY,defaultWidth:"wide"}),day:Th({values:wY,defaultWidth:"wide"}),dayPeriod:Th({values:vY,defaultWidth:"wide",formattingValues:EY,defaultFormattingWidth:"wide"})};function Ah(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],a=e.match(r);if(!a)return null;const o=a[0],l=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?SY(l,m=>m.test(o)):kY(l,m=>m.test(o));let u;u=t.valueCallback?t.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;const d=e.slice(o.length);return{value:u,rest:d}}}function kY(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function SY(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function CY(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],a=e.match(t.parsePattern);if(!a)return null;let o=t.valueCallback?t.valueCallback(a[0]):a[0];o=n.valueCallback?n.valueCallback(o):o;const l=e.slice(r.length);return{value:o,rest:l}}}const IY=/^(\d+)(th|st|nd|rd)?/i,$Y=/\d+/i,TY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AY={any:[/^b/i,/^(a|c)/i]},RY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_Y={any:[/1/i,/2/i,/3/i,/4/i]},DY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},PY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},FY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},MY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},OY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},LY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},zY={ordinalNumber:CY({matchPattern:IY,parsePattern:$Y,valueCallback:t=>parseInt(t,10)}),era:Ah({matchPatterns:TY,defaultMatchWidth:"wide",parsePatterns:AY,defaultParseWidth:"any"}),quarter:Ah({matchPatterns:RY,defaultMatchWidth:"wide",parsePatterns:_Y,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ah({matchPatterns:DY,defaultMatchWidth:"wide",parsePatterns:PY,defaultParseWidth:"any"}),day:Ah({matchPatterns:FY,defaultMatchWidth:"wide",parsePatterns:MY,defaultParseWidth:"any"}),dayPeriod:Ah({matchPatterns:OY,defaultMatchWidth:"any",parsePatterns:LY,defaultParseWidth:"any"})},BY={code:"en-US",formatDistance:uY,formatLong:pY,formatRelative:gY,localize:NY,match:zY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function UY(t){const e=Mn(t);return sY(e,iY(e))+1}function VY(t){const e=Mn(t),n=+fx(e)-+rY(e);return Math.round(n/AD)+1}function MD(t,e){const n=Mn(t),s=n.getFullYear(),r=Ih(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=co(t,0);o.setFullYear(s+1,0,a),o.setHours(0,0,0,0);const l=Da(o,e),c=co(t,0);c.setFullYear(s,0,a),c.setHours(0,0,0,0);const u=Da(c,e);return n.getTime()>=l.getTime()?s+1:n.getTime()>=u.getTime()?s:s-1}function WY(t,e){const n=Ih(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=MD(t,e),a=co(t,0);return a.setFullYear(r,0,s),a.setHours(0,0,0,0),Da(a,e)}function jY(t,e){const n=Mn(t),s=+Da(n,e)-+WY(n,e);return Math.round(s/AD)+1}function Xt(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const nl={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return Xt(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):Xt(n+1,2)},d(t,e){return Xt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return Xt(t.getHours()%12||12,e.length)},H(t,e){return Xt(t.getHours(),e.length)},m(t,e){return Xt(t.getMinutes(),e.length)},s(t,e){return Xt(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return Xt(r,e.length)}},ud={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},OD={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return nl.y(t,e)},Y:function(t,e,n,s){const r=MD(t,s),a=r>0?r:1-r;if(e==="YY"){const o=a%100;return Xt(o,2)}return e==="Yo"?n.ordinalNumber(a,{unit:"year"}):Xt(a,e.length)},R:function(t,e){const n=DD(t);return Xt(n,e.length)},u:function(t,e){const n=t.getFullYear();return Xt(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return Xt(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return Xt(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return nl.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return Xt(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=jY(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):Xt(r,e.length)},I:function(t,e,n){const s=VY(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):Xt(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):nl.d(t,e)},D:function(t,e,n){const s=UY(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):Xt(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),a=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return Xt(a,2);case"eo":return n.ordinalNumber(a,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),a=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return Xt(a,e.length);case"co":return n.ordinalNumber(a,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return Xt(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=ud.noon:s===0?r=ud.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=ud.evening:s>=12?r=ud.afternoon:s>=4?r=ud.morning:r=ud.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return nl.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):nl.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):Xt(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):Xt(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):nl.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):nl.s(t,e)},S:function(t,e){return nl.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return zD(s);case"XXXX":case"XX":return yc(s);case"XXXXX":case"XXX":default:return yc(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return zD(s);case"xxxx":case"xx":return yc(s);case"xxxxx":case"xxx":default:return yc(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+LD(s,":");case"OOOO":default:return"GMT"+yc(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+LD(s,":");case"zzzz":default:return"GMT"+yc(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return Xt(s,e.length)},T:function(t,e,n){const s=t.getTime();return Xt(s,e.length)}};function LD(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),a=s%60;return a===0?n+String(r):n+String(r)+e+Xt(a,2)}function zD(t,e){return t%60===0?(t>0?"-":"+")+Xt(Math.abs(t)/60,2):yc(t,e)}function yc(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Xt(Math.trunc(s/60),2),a=Xt(s%60,2);return n+r+e+a}const BD=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},UD=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},GY={p:UD,P:(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return BD(t,e);let a;switch(s){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",BD(s,e)).replace("{{time}}",UD(r,e))}},HY=/^D+$/,qY=/^Y+$/,KY=["D","DD","YY","YYYY"];function XY(t){return HY.test(t)}function YY(t){return qY.test(t)}function ZY(t,e,n){const s=JY(t,e,n);if(console.warn(s),KY.includes(t))throw new RangeError(s)}function JY(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const QY=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eZ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tZ=/^'([^]*?)'?$/,nZ=/''/g,sZ=/[a-zA-Z]/;function jt(t,e,n){const s=Ih(),r=s.locale??BY,a=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,l=Mn(t);if(!oY(l))throw new RangeError("Invalid time value");let c=e.match(eZ).map(d=>{const m=d[0];if(m==="p"||m==="P"){const h=GY[m];return h(d,r.formatLong)}return d}).join("").match(QY).map(d=>{if(d==="''")return{isToken:!1,value:"'"};const m=d[0];if(m==="'")return{isToken:!1,value:rZ(d)};if(OD[m])return{isToken:!0,value:d};if(m.match(sZ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:d}});r.localize.preprocessor&&(c=r.localize.preprocessor(l,c));const u={firstWeekContainsDate:a,weekStartsOn:o,locale:r};return c.map(d=>{if(!d.isToken)return d.value;const m=d.value;(YY(m)||XY(m))&&ZY(m,e,String(t));const h=OD[m[0]];return h(l,m,r.localize,u)}).join("")}function rZ(t){const e=t.match(tZ);return e?e[1].replace(nZ,"'"):t}function VD(t,e){const n=Mn(t),s=Mn(e);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function HE(t,e){const n=+Mn(t),[s,r]=[+Mn(e.start),+Mn(e.end)].sort((a,o)=>a-o);return n>=s&&n<=r}function aZ(t,e){const s=cZ(t);let r;if(s.date){const c=uZ(s.date,2);r=dZ(c.restDateString,c.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const a=r.getTime();let o=0,l;if(s.time&&(o=mZ(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(l=hZ(s.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(a+o),u=new Date(0);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return new Date(a+o+l)}const xx={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},oZ=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,iZ=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,lZ=/^([+-])(\d{2})(?::?(\d{2}))?$/;function cZ(t){const e={},n=t.split(xx.dateTimeDelimiter);let s;if(n.length>2)return e;if(/:/.test(n[0])?s=n[0]:(e.date=n[0],s=n[1],xx.timeZoneDelimiter.test(e.date)&&(e.date=t.split(xx.timeZoneDelimiter)[0],s=t.substr(e.date.length,t.length))),s){const r=xx.timezone.exec(s);r?(e.time=s.replace(r[1],""),e.timezone=r[1]):e.time=s}return e}function uZ(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=t.match(n);if(!s)return{year:NaN,restDateString:""};const r=s[1]?parseInt(s[1]):null,a=s[2]?parseInt(s[2]):null;return{year:a===null?r:a*100,restDateString:t.slice((s[1]||s[2]).length)}}function dZ(t,e){if(e===null)return new Date(NaN);const n=t.match(oZ);if(!n)return new Date(NaN);const s=!!n[4],r=Rh(n[1]),a=Rh(n[2])-1,o=Rh(n[3]),l=Rh(n[4]),c=Rh(n[5])-1;if(s)return yZ(e,l,c)?pZ(e,l,c):new Date(NaN);{const u=new Date(0);return!gZ(e,a,o)||!xZ(e,r)?new Date(NaN):(u.setUTCFullYear(e,a,Math.max(r,o)),u)}}function Rh(t){return t?parseInt(t):1}function mZ(t){const e=t.match(iZ);if(!e)return NaN;const n=qE(e[1]),s=qE(e[2]),r=qE(e[3]);return bZ(n,s,r)?n*_D+s*RD+r*1e3:NaN}function qE(t){return t&&parseFloat(t.replace(",","."))||0}function hZ(t){if(t==="Z")return 0;const e=t.match(lZ);if(!e)return 0;const n=e[1]==="+"?-1:1,s=parseInt(e[2]),r=e[3]&&parseInt(e[3])||0;return wZ(s,r)?n*(s*_D+r*RD):NaN}function pZ(t,e,n){const s=new Date(0);s.setUTCFullYear(t,0,4);const r=s.getUTCDay()||7,a=(e-1)*7+n+1-r;return s.setUTCDate(s.getUTCDate()+a),s}const fZ=[31,null,31,30,31,30,31,31,30,31,30,31];function WD(t){return t%400===0||t%4===0&&t%100!==0}function gZ(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(fZ[e]||(WD(t)?29:28))}function xZ(t,e){return e>=1&&e<=(WD(t)?366:365)}function yZ(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function bZ(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function wZ(t,e){return e>=0&&e<=59}function vZ(t,e){return TD(t,-e)}function jD({selectedDate:t,onDateSelect:e,slots:n,view:s="month"}){const[r,a]=N.useState(s==="2-weeks"?t:$h(t));N.useEffect(()=>{if(s==="2-weeks"){const m=Da(r),h=xc(m,13);(t<m||t>h)&&a(t)}else VD(r,t)||a($h(t))},[t,s]);const o=()=>{a(s==="2-weeks"?xc(r,14):TD(r,1))},l=()=>{a(s==="2-weeks"?xc(r,-14):vZ(r,1))},c=()=>i.createElement("div",{className:"flex items-center justify-between mb-6 px-2"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600"},i.createElement(Ia,{className:"w-6 h-6"})),i.createElement("div",null,i.createElement("h2",{className:"text-2xl font-black text-gray-900 tracking-tight"},s==="2-weeks"?`${jt(Da(r),"MMMM d")} - ${jt(xc(Da(r),13),"MMMM d, yyyy")}`:jt(r,"MMMM yyyy")),i.createElement("div",{className:"flex items-center mt-1"},i.createElement("div",{className:"w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse"}),i.createElement("p",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide"},"Live Schedule Overview")))),i.createElement("div",{className:"flex bg-gray-100 rounded-lg p-1 space-x-1"},i.createElement("button",{onClick:l,className:"p-2 hover:bg-white hover:shadow-sm rounded-md transition-all text-gray-600 hover:text-gray-900","aria-label":"Previous"},i.createElement(hW,{className:"w-5 h-5"})),i.createElement("button",{onClick:o,className:"p-2 hover:bg-white hover:shadow-sm rounded-md transition-all text-gray-600 hover:text-gray-900","aria-label":"Next"},i.createElement(i0,{className:"w-5 h-5"})))),u=()=>{const m=[],h="EEEE",p=Da(r);for(let f=0;f<7;f++)m.push(i.createElement("div",{className:"text-center font-bold text-gray-400 text-[10px] uppercase tracking-[0.2em] py-4",key:f},jt(xc(p,f),h)));return i.createElement("div",{className:"grid grid-cols-7 mb-4 bg-gray-50/50 rounded-t-xl"},m)},d=()=>{let m,h;const p=$h(r);if(s==="2-weeks")m=Da(r),h=xc(m,13);else{const w=jE(p);m=Da(p),h=lY(w)}const f="d",y=[];let x=[],g=m,b="";for(;g<=h;){for(let w=0;w<7;w++){b=jt(g,f);const v=g,E=FD(g,t),k=VD(g,p),C=FD(g,new Date),I=n.filter(T=>T.date===jt(v,"yyyy-MM-dd")),A=I.filter(T=>T.status==="reserved").length,$=I.filter(T=>T.status==="available").length;x.push(i.createElement("button",{key:g.toString(),onClick:()=>e(v),className:`
                            min-h-[140px] p-4 border border-gray-100 flex flex-col justify-start transition-all duration-300 relative group
                            ${k?"bg-white text-gray-700":"bg-gray-50/30 text-gray-300"}
                            ${E?"ring-2 ring-blue-600 shadow-xl z-10 bg-blue-50/30":"hover:bg-gray-50/80 hover:scale-[1.02] hover:z-10 hover:shadow-lg"}
                        `},i.createElement("div",{className:"flex justify-between items-start w-full mb-3"},i.createElement("span",{className:`
                                text-sm font-black rounded-xl w-10 h-10 flex items-center justify-center transition-all duration-300
                                ${C?"bg-blue-600 text-white shadow-lg shadow-blue-200":E?"bg-blue-100 text-blue-700":"bg-transparent text-gray-900 group-hover:bg-white group-hover:shadow-sm"}
                            `},b),C&&i.createElement("span",{className:"flex h-2 w-2 relative"},i.createElement("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),i.createElement("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-blue-500"}))),i.createElement("div",{className:"w-full space-y-2 mt-auto"},I.length>0&&i.createElement(i.Fragment,null,A>0&&i.createElement("div",{className:"flex items-center justify-between text-[10px] px-2.5 py-1.5 bg-purple-50 text-purple-700 rounded-lg border border-purple-100 shadow-sm transition-all"},i.createElement("div",{className:"flex items-center"},i.createElement(Ct,{className:"w-3 h-3 mr-1.5 font-bold"}),i.createElement("span",{className:"font-extrabold"},A),i.createElement("span",{className:"ml-1 font-bold uppercase tracking-tight opacity-70"},"Booked")),i.createElement("div",{className:"w-1.5 h-1.5 rounded-full bg-purple-400"})),$>0&&i.createElement("div",{className:"flex items-center justify-between text-[10px] px-2.5 py-1.5 bg-green-50 text-green-700 rounded-lg border border-green-100 shadow-sm transition-all"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-2 h-2 rounded-full bg-green-500 mr-2 shadow-sm shadow-green-200"}),i.createElement("span",{className:"font-extrabold"},$),i.createElement("span",{className:"ml-1 font-bold uppercase tracking-tight opacity-70"},"Open"))))))),g=xc(g,1)}y.push(i.createElement("div",{className:"grid grid-cols-7 border-l border-t border-gray-100 overflow-hidden",key:g.toString()},x)),x=[]}return i.createElement("div",{className:"border border-gray-200 rounded-2xl overflow-hidden bg-white shadow-2xl transition-all duration-500 hover:shadow-blue-900/10"},y)};return i.createElement("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 p-8 transition-all hover:shadow-2xl"},c(),i.createElement("div",{className:"relative"},u(),d()),i.createElement("div",{className:"mt-6 flex items-center justify-end space-x-6 text-xs font-semibold text-gray-500 bg-gray-50 p-3 rounded-xl border border-gray-100"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-500 mr-2 shadow-sm shadow-blue-200"}),i.createElement("span",null,"Today")),i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-2.5 h-2.5 rounded-full bg-purple-500 mr-2 shadow-sm shadow-purple-200"}),i.createElement("span",null,"Booked Sessions")),i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500 mr-2 shadow-sm shadow-green-200"}),i.createElement("span",null,"Open Slots"))))}function EZ({slots:t,onSlotClick:e,selectedSlotId:n,projects:s=[]}){const r=Array.from({length:13},(l,c)=>c+8),a=l=>{let c="bg-white border-gray-200 text-gray-500 hover:border-gray-300",u="Available",d="transparent";if(l.status==="reserved"){const m=s.find(h=>h.id===l.gigId);m?(d=m.color,c="bg-blue-50 text-blue-700 font-medium",u=m.name):(c="bg-blue-50 border-blue-200 text-blue-700 font-medium",u="Reserved")}else l.status==="cancelled"&&(c="bg-red-50 border-red-200 text-red-700 opacity-50 cursor-not-allowed",u="Cancelled");return n===l.id&&(c+=" ring-2 ring-blue-500 ring-offset-1"),{style:c,label:u,borderColor:d}},o=l=>{const c=`${l.toString().padStart(2,"0")}:00`;return t.find(u=>u.startTime===c)};return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Ct,{className:"w-5 h-5 text-gray-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Daily Schedule")),i.createElement("div",{className:"space-y-2"},r.map(l=>{const c=o(l);if(!c)return null;const{style:u,label:d,borderColor:m}=a(c);return i.createElement("button",{key:c.id,onClick:()=>e(c.id),disabled:c.status==="cancelled",className:`w-full flex items-center p-3 rounded-lg border transition-all ${u}`,style:{borderLeftColor:m,borderLeftWidth:m!=="transparent"?"4px":"1px"}},i.createElement("div",{className:"w-16 text-sm font-medium"},c.startTime),i.createElement("div",{className:"flex-1 text-left truncate"},d),c.duration>1&&i.createElement("div",{className:"text-xs px-2 py-1 bg-gray-200 rounded-full text-gray-600"},c.duration,"h"))})))}function NZ({slot:t,availableProjects:e,onUpdate:n,onClear:s}){const[r,a]=N.useState(!1),[o,l]=N.useState(t.gigId||""),[c,u]=N.useState(t.notes||""),d=()=>{n({gigId:o||void 0,notes:c||void 0,status:o?"reserved":"available"}),a(!1)},m=()=>{l(t.gigId||""),u(t.notes||""),a(!1)};if(!r&&!t.gigId)return i.createElement("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border border-dashed border-gray-300 text-center"},i.createElement("p",{className:"text-gray-500 mb-2"},"No project assigned to this slot"),i.createElement("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},"Assign Gig"));if(r)return i.createElement("div",{className:"mt-4 p-4 bg-white rounded-lg shadow-md border border-gray-200"},i.createElement("h3",{className:"font-semibold mb-3"},"Edit Slot Details"),i.createElement("div",{className:"mb-3"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Gig"),i.createElement("select",{value:o,onChange:p=>l(p.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},i.createElement("option",{value:""},"Select a project..."),e.map(p=>i.createElement("option",{key:p.id,value:p.id},p.name," (",p.company,")")))),i.createElement("div",{className:"mb-4"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Notes"),i.createElement("textarea",{value:c,onChange:p=>u(p.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:3,placeholder:"Add notes about this session..."})),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{onClick:d,className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium"},"Save"),i.createElement("button",{onClick:m,className:"flex-1 px-3 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 font-medium"},"Cancel")));const h=e.find(p=>p.id===t.gigId);return i.createElement("div",{className:"mt-4 p-4 bg-white rounded-lg shadow-md border border-l-4",style:{borderLeftColor:h?.color||"#ccc"}},i.createElement("div",{className:"flex justify-between items-start mb-2"},i.createElement("div",null,i.createElement("h3",{className:"font-bold text-lg"},h?.name),i.createElement("p",{className:"text-sm text-gray-600"},h?.company)),i.createElement("div",{className:"flex space-x-1"},i.createElement("button",{onClick:()=>a(!0),className:"p-1 text-gray-500 hover:text-blue-600 rounded-full hover:bg-blue-50",title:"Edit details"},i.createElement(A1,{className:"w-4 h-4"})),i.createElement("button",{onClick:s,className:"p-1 text-gray-500 hover:text-red-600 rounded-full hover:bg-red-50",title:"Clear slot"},i.createElement(Hr,{className:"w-4 h-4"})))),t.notes&&i.createElement("div",{className:"mt-2 text-sm bg-gray-50 p-2 rounded"},i.createElement("p",{className:"text-gray-500 italic"},'"',t.notes,'"')),i.createElement("div",{className:"mt-3 flex flex-wrap gap-1"},h?.skills.map(p=>i.createElement("span",{key:p,className:"text-xs px-2 py-1 bg-gray-100 rounded-full text-gray-600"},p))))}function kZ({reps:t,selectedRepId:e,onSelectRep:n}){return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(qr,{className:"w-5 h-5 text-blue-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Select Team Member")),i.createElement("div",{className:"space-y-2"},t.map(s=>i.createElement("button",{key:s.id,onClick:()=>n(s.id),className:`w-full flex items-center p-3 rounded-lg transition-colors ${e===s.id?"bg-blue-50 border-blue-500 border":"hover:bg-gray-50 border border-transparent"}`},s.avatar?i.createElement("img",{src:s.avatar,alt:s.name,className:"w-10 h-10 rounded-full object-cover"}):i.createElement("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold"},s.name.charAt(0)),i.createElement("div",{className:"ml-3 text-left"},i.createElement("div",{className:"font-medium text-gray-900"},s.name),i.createElement("div",{className:"text-sm text-gray-500 line-clamp-1"},s.specialties.join(", "))),e===s.id&&i.createElement("div",{className:"ml-auto"},i.createElement("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}))))))}function SZ({company:t,slots:e,projects:n,reps:s,selectedDate:r}){const a=N.useMemo(()=>e.filter(c=>n.find(d=>d.id===c.gigId)?.company===t&&c.date===jt(r,"yyyy-MM-dd")&&c.status==="reserved"),[e,n,t,r]),o=N.useMemo(()=>{const c={};return a.forEach(u=>{c[u.repId]||(c[u.repId]=0),c[u.repId]+=u.duration||1}),c},[a]),l=Object.values(o).reduce((c,u)=>c+u,0);return i.createElement("div",{className:"bg-white rounded-lg p-8 shadow-sm border border-gray-100"},i.createElement("div",{className:"flex items-center mb-8 border-b border-gray-100 pb-6"},i.createElement("div",{className:"w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mr-4 shadow-lg shadow-blue-200"},i.createElement(Ho,{className:"w-7 h-7 text-white"})),i.createElement("h2",{className:"text-3xl font-extrabold text-gray-900 tracking-tight"},t," Dashboard")),i.createElement("div",{className:"mb-10"},i.createElement("h3",{className:"text-xl font-bold text-gray-800 mb-6"},"Schedule for ",jt(r,"MMMM d, yyyy")),i.createElement("div",{className:"flex items-center justify-between bg-blue-50/50 border border-blue-100 px-6 py-4 rounded-xl mb-12"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"bg-white p-2.5 rounded-xl shadow-sm mr-4"},i.createElement(Ct,{className:"w-6 h-6 text-blue-600"})),i.createElement("span",{className:"text-blue-900 font-bold text-lg"},"Total Hours Scheduled")),i.createElement("span",{className:"text-2xl font-black text-blue-900"},l,"h")),i.createElement("div",{className:"space-y-16"},Object.entries(o).map(([c,u])=>{const d=s.find(h=>h.id===c),m=a.filter(h=>h.repId===c);return i.createElement("div",{key:c,className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between pb-4 border-b border-gray-100"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-14 h-14 rounded-full overflow-hidden mr-4 border-2 border-white shadow-md bg-gray-50 flex-shrink-0"},d?.avatar?i.createElement("img",{src:d.avatar,alt:d.name,className:"w-full h-full object-cover"}):i.createElement("div",{className:"w-full h-full flex items-center justify-center bg-blue-100 text-blue-600 font-black text-xl"},d?.name?.charAt(0)||"R")),i.createElement("div",null,i.createElement("h4",{className:"text-xl font-black text-gray-900 leading-tight"},d?.name||`Agent ${c.substring(0,4)}`),i.createElement("p",{className:"text-gray-500 text-sm font-semibold"},d?.specialties?.join(", ")||"Expert"))),i.createElement("div",{className:"text-right"},i.createElement("div",{className:"text-2xl font-black text-gray-900 leading-none mb-1"},u,"h"),i.createElement("div",{className:"text-gray-400 text-sm font-bold"},m.length," slots"))),i.createElement("div",{className:"space-y-4"},m.map(h=>{const p=n.find(f=>f.id===h.gigId);return i.createElement("div",{key:h.id,className:"group relative py-4 px-6 rounded-xl bg-gray-50/50 hover:bg-gray-100 transition-all duration-200 border-l-[6px]",style:{borderLeftColor:p?.color||"#3b82f6"}},i.createElement("h5",{className:"font-extrabold text-gray-800 text-base mb-1"},p?.name," - ",t),i.createElement("div",{className:"flex items-center text-gray-500 text-sm font-bold"},i.createElement(Ct,{className:"w-4 h-4 mr-2 opacity-60"}),h.startTime," - ",h.endTime," (",h.duration||1,"h)"),h.notes&&i.createElement("div",{className:"mt-3 text-sm text-gray-600 bg-white/60 p-3 rounded-lg border border-gray-100 italic"},'"',h.notes,'"'))})))}),Object.keys(o).length===0&&i.createElement("div",{className:"flex flex-col items-center justify-center py-20 bg-gray-50/50 rounded-3xl border-2 border-dashed border-gray-200"},i.createElement(Ct,{className:"w-12 h-12 text-gray-300 mb-4"}),i.createElement("p",{className:"text-gray-500 font-black text-xl"},"No REPs scheduled for this date"),i.createElement("p",{className:"text-gray-400 text-sm mt-1"},"Assignments will appear here once reserved.")))))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ=1e-7,IZ=1e-4;class GD{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class KE{refCount(e){return dr("refCount")}incRef(e){return dr("incRef")}timerAvailable(){return!0}time(e){return dr("time")}read(e){return dr("read")}readSync(e){return dr("readSync")}readToGPU(e,n){return dr("readToGPU")}numDataIds(){return dr("numDataIds")}disposeData(e,n){return dr("disposeData")}write(e,n,s){return dr("write")}move(e,n,s,r,a){return dr("move")}createTensorFromGPUData(e,n,s){return dr("createTensorFromGPUData")}memory(){return dr("memory")}floatPrecision(){return dr("floatPrecision")}epsilon(){return this.floatPrecision()===32?CZ:IZ}dispose(){return dr("dispose")}}function dr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Z(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,dd(t,e,n)}function bc(t,e,n){return Math.max(t,Math.min(e,n))}function XE(t){return t%2===0?t:t+1}function dd(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function TZ(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function R(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function YE(t,e,n=""){R(zt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function HD(t){R(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ue(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function zt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function md(t){return t%1===0}function ZE(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function hd(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function qD(t,e=r=>0,n,s){return new Promise((r,a)=>{let o=0;const l=()=>{if(t()){r();return}o++;const c=e(o);if(n!=null&&o>=n){a();return}s!=null?s(l,c):setTimeout(l,c)};l()})}function KD(t,e){let n=1,s=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(t[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(t[a]<0)throw Error(`Shapes can not be < 0. Found ${t[a]} at dim ${a}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function Et(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),R(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),R(t.every(s=>md(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function sl(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||r?null:Et(e,t).sort();let o=0;for(let l=0;l<t.length;++l){if(a!=null){if(a[o]===l&&t[l]!==1)throw new Error(`Can't squeeze axis ${l} since its dim '${t[l]}' is not 1`);(a[o]==null||a[o]>l)&&t[l]===1&&(n.push(t[l]),s.push(l)),a[o]<=l&&o++}t[l]!==1&&(n.push(t[l]),s.push(l))}return{newShape:n,keptDims:s}}function bs(t,e){return Cn(t,e)}function Cn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function AZ(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function RZ(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function XD(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function yx(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function _Z(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function _h(t){return typeof t=="string"||t instanceof String}function DZ(t){return typeof t=="boolean"}function JE(t){return typeof t=="number"}function pd(t){return Array.isArray(t)?pd(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":JE(t)?"float32":_h(t)?"string":DZ(t)?"bool":"float32"}function QE(t){return!!(t&&t.constructor&&t.call&&t.apply)}function e2(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function nt(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function YD(t,e,n,s=!1){const r=new Array;if(e.length===1){const a=e[0]*(s?2:1);for(let o=0;o<a;o++)r[o]=n[t+o]}else{const a=e[0],o=e.slice(1),l=o.reduce((c,u)=>c*u)*(s?2:1);for(let c=0;c<a;c++)r[c]=YD(t+c*l,o,n,s)}return r}function Pa(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,a)=>r*a)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return YD(0,t,e,n)}function PZ(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function t2(t,e){const n=ws(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function ws(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function ZD(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return Pa(t,new Float32Array(n));if(e==="int32")return Pa(t,new Int32Array(n));if(e==="bool")return Pa(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function ui(t){t.forEach(e=>{R(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function uo(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function fd(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function n2(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JD="tfjsflags";class FZ{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=MZ,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(n2(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);JD in e&&e[JD].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=LZ(r,a)})}}function MZ(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(OZ(e,s[0],s[1]),s.join("="))),e}function OZ(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function LZ(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function ie(){return QD}let QD=null;function zZ(t){QD=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let s2;function e4(){if(s2==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");s2=t}return s2}function BZ(){const t=e4();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function r2(t,e){const n=BZ();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const bx="Abs",Dh="Acos",Ph="Acosh",gd="Add",a2="AddN",o2="All",i2="Any",wx="ArgMax",vx="ArgMin",Fh="Asin",Mh="Asinh",Oh="Atan",Lh="Atanh",zh="Atan2",Ex="AvgPool",l2="AvgPoolGrad",Nx="AvgPool3D",c2="AvgPool3DGrad",kx="BatchMatMul",Sx="BatchToSpaceND",u2="Bincount",d2="BitwiseAnd",UZ="BroadcastTo",t4="BroadcastArgs",Bh="Cast",Uh="Ceil",Vh="ClipByValue",m2="Complex",Cx="ComplexAbs",Ix="Concat",$x="Conv2D",h2="Conv2DBackpropFilter",Tx="Conv2DBackpropInput",Ax="Conv3D",p2="Conv3DBackpropFilterV2",f2="Conv3DBackpropInputV2",Wh="Cos",jh="Cosh",g2="Cumprod",Rx="Cumsum",x2="CropAndResize",y2="DenseBincount",b2="DepthToSpace",_x="DepthwiseConv2dNative",w2="DepthwiseConv2dNativeBackpropFilter",v2="DepthwiseConv2dNativeBackpropInput",n4="Diag",Dx="Dilation2D",E2="Dilation2DBackpropInput",N2="Dilation2DBackpropFilter",VZ="Draw",Gh="RealDiv",k2="Einsum",Hh="Elu",S2="EluGrad",qh="Erf",Px="Equal",Kh="Exp",Fx="ExpandDims",Xh="Expm1",C2="FFT",I2="Fill",$2="FlipLeftRight",Yh="Floor",Zh="FloorDiv",Mx="FusedBatchNorm",Ox="GatherV2",s4="GatherNd",Lx="Greater",Jh="GreaterEqual",Qh="Identity",T2="IFFT",A2="Imag",ep="IsFinite",tp="IsInf",np="IsNan",zx="LeakyRelu",Bx="Less",Ux="LessEqual",r4="LinSpace",sp="Log",rp="Log1p",Vx="LogicalAnd",Wx="LogicalNot",jx="LogicalOr",WZ="LogSoftmax",Gx="LRN",R2="LRNGrad",Hx="Max",ap="Maximum",qx="MaxPool",_2="MaxPoolGrad",Kx="MaxPool3D",D2="MaxPool3DGrad",a4="MaxPoolWithArgmax",Xx="Mean",Yx="Min",op="Minimum",Zx="MirrorPad",ip="Mod",o4="Multinomial",lp="Multiply",Jx="Neg",Qx="NotEqual",P2="NonMaxSuppressionV3",F2="NonMaxSuppressionV4",M2="NonMaxSuppressionV5",ey="OnesLike",ty="OneHot",ny="Pack",sy="PadV2",cp="Pow",ry="Prelu",ay="Prod",i4="RaggedGather",l4="RaggedRange",c4="RaggedTensorToTensor",O2="Range",L2="Real",up="Reciprocal",dp="Relu",oy="Reshape",iy="ResizeNearestNeighbor",z2="ResizeNearestNeighborGrad",ly="ResizeBilinear",B2="ResizeBilinearGrad",mp="Relu6",cy="Reverse",hp="Round",pp="Rsqrt",u4="ScatterNd",d4="TensorScatterUpdate",m4="SearchSorted",uy="Select",fp="Selu",dy="Slice",gp="Sin",xp="Sinh",yp="Sign",bp="Sigmoid",wp="Softplus",vp="Sqrt",my="Sum",hy="SpaceToBatchND",py="SplitV",fy="Softmax",h4="SparseFillEmptyRows",p4="SparseReshape",f4="SparseSegmentMean",g4="SparseSegmentSum",x4="SparseToDense",Ep="SquaredDifference",U2="Square",V2="StaticRegexReplace",W2="StridedSlice",y4="StringNGrams",b4="StringSplit",w4="StringToHashBucketFast",Np="Sub",kp="Tan",Sp="Tanh",Cp="Tile",j2="TopK",G2="Transform",xd="Transpose",H2="Unique",gy="Unpack",xy="UnsortedSegmentSum",yy="ZerosLike",Ip="Step",jZ="FromPixels",q2="RotateWithOffset",by="_FusedMatMul",wy="FusedConv2D",v4="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(...t){ie().getBool("IS_TEST")||ie().getBool("PROD")||console.warn(...t)}function GZ(...t){ie().getBool("IS_TEST")||ie().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vy=r2("kernelRegistry",()=>new Map),K2=r2("gradRegistry",()=>new Map);function E4(t,e){const n=C4(t,e);return vy.get(n)}function N4(t){return K2.get(t)}function k4(t){const e=vy.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[a,o]=r,[l]=a.split("_");l===t&&n.push(o)}return n}function S4(t){const{kernelName:e,backendName:n}=t,s=C4(e,n);vy.has(s)&&Rr(`The kernel '${e}' for backend '${n}' is already registered`),vy.set(s,t)}function HZ(t){const{kernelName:e}=t;K2.has(e)&&ie().getBool("DEBUG")&&Rr(`Overriding the gradient for '${e}'`),K2.set(e,t)}function C4(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I4(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var $4=ln,ea=null;try{ea=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function ln(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}ln.prototype.__isLong__,Object.defineProperty(ln.prototype,"__isLong__",{value:!0});function mr(t){return(t&&t.__isLong__)===!0}ln.isLong=mr;var T4={},A4={};function wc(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=A4[t],s)?s:(n=cn(t,(t|0)<0?-1:0,!0),r&&(A4[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=T4[t],s)?s:(n=cn(t,t<0?-1:0,!1),r&&(T4[t]=n),n))}ln.fromInt=wc;function ta(t,e){if(isNaN(t))return e?vc:na;if(e){if(t<0)return vc;if(t>=_4)return O4}else{if(t<=-D4)return hr;if(t+1>=D4)return M4}return t<0?ta(-t,e).neg():cn(t%yd|0,t/yd|0,e)}ln.fromNumber=ta;function cn(t,e,n){return new ln(t,e,n)}ln.fromBits=cn;var Ey=Math.pow;function X2(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return na;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return X2(t.substring(1),e,n).neg();for(var r=ta(Ey(n,8)),a=na,o=0;o<t.length;o+=8){var l=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+l),n);if(l<8){var u=ta(Ey(n,l));a=a.mul(u).add(ta(c))}else a=a.mul(r),a=a.add(ta(c))}return a.unsigned=e,a}ln.fromString=X2;function Fa(t,e){return typeof t=="number"?ta(t,e):typeof t=="string"?X2(t,e):cn(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}ln.fromValue=Fa;var R4=65536,qZ=1<<24,yd=R4*R4,_4=yd*yd,D4=_4/2,P4=wc(qZ),na=wc(0);ln.ZERO=na;var vc=wc(0,!0);ln.UZERO=vc;var bd=wc(1);ln.ONE=bd;var F4=wc(1,!0);ln.UONE=F4;var Y2=wc(-1);ln.NEG_ONE=Y2;var M4=cn(-1,2147483647,!1);ln.MAX_VALUE=M4;var O4=cn(-1,-1,!0);ln.MAX_UNSIGNED_VALUE=O4;var hr=cn(0,-2147483648,!1);ln.MIN_VALUE=hr;var Le=ln.prototype;Le.toInt=function(){return this.unsigned?this.low>>>0:this.low},Le.toNumber=function(){return this.unsigned?(this.high>>>0)*yd+(this.low>>>0):this.high*yd+(this.low>>>0)},Le.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(hr)){var n=ta(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var a=ta(Ey(e,6),this.unsigned),o=this,l="";;){var c=o.div(a),u=o.sub(c.mul(a)).toInt()>>>0,d=u.toString(e);if(o=c,o.isZero())return d+l;for(;d.length<6;)d="0"+d;l=""+d+l}},Le.getHighBits=function(){return this.high},Le.getHighBitsUnsigned=function(){return this.high>>>0},Le.getLowBits=function(){return this.low},Le.getLowBitsUnsigned=function(){return this.low>>>0},Le.getNumBitsAbs=function(){if(this.isNegative())return this.eq(hr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1},Le.isZero=function(){return this.high===0&&this.low===0},Le.eqz=Le.isZero,Le.isNegative=function(){return!this.unsigned&&this.high<0},Le.isPositive=function(){return this.unsigned||this.high>=0},Le.isOdd=function(){return(this.low&1)===1},Le.isEven=function(){return(this.low&1)===0},Le.equals=function(e){return mr(e)||(e=Fa(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},Le.eq=Le.equals,Le.notEquals=function(e){return!this.eq(e)},Le.neq=Le.notEquals,Le.ne=Le.notEquals,Le.lessThan=function(e){return this.comp(e)<0},Le.lt=Le.lessThan,Le.lessThanOrEqual=function(e){return this.comp(e)<=0},Le.lte=Le.lessThanOrEqual,Le.le=Le.lessThanOrEqual,Le.greaterThan=function(e){return this.comp(e)>0},Le.gt=Le.greaterThan,Le.greaterThanOrEqual=function(e){return this.comp(e)>=0},Le.gte=Le.greaterThanOrEqual,Le.ge=Le.greaterThanOrEqual,Le.compare=function(e){if(mr(e)||(e=Fa(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},Le.comp=Le.compare,Le.negate=function(){return!this.unsigned&&this.eq(hr)?hr:this.not().add(bd)},Le.neg=Le.negate,Le.add=function(e){mr(e)||(e=Fa(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,a=this.low&65535,o=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,m=0,h=0,p=0;return p+=a+u,h+=p>>>16,p&=65535,h+=r+c,m+=h>>>16,h&=65535,m+=s+l,d+=m>>>16,m&=65535,d+=n+o,d&=65535,cn(h<<16|p,d<<16|m,this.unsigned)},Le.subtract=function(e){return mr(e)||(e=Fa(e)),this.add(e.neg())},Le.sub=Le.subtract,Le.multiply=function(e){if(this.isZero())return na;if(mr(e)||(e=Fa(e)),ea){var n=ea.mul(this.low,this.high,e.low,e.high);return cn(n,ea.get_high(),this.unsigned)}if(e.isZero())return na;if(this.eq(hr))return e.isOdd()?hr:na;if(e.eq(hr))return this.isOdd()?hr:na;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(P4)&&e.lt(P4))return ta(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,a=this.low>>>16,o=this.low&65535,l=e.high>>>16,c=e.high&65535,u=e.low>>>16,d=e.low&65535,m=0,h=0,p=0,f=0;return f+=o*d,p+=f>>>16,f&=65535,p+=a*d,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=r*d,m+=h>>>16,h&=65535,h+=a*u,m+=h>>>16,h&=65535,h+=o*c,m+=h>>>16,h&=65535,m+=s*d+r*u+a*c+o*l,m&=65535,cn(p<<16|f,m<<16|h,this.unsigned)},Le.mul=Le.multiply,Le.divide=function(e){if(mr(e)||(e=Fa(e)),e.isZero())throw Error("division by zero");if(ea){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?ea.div_u:ea.div_s)(this.low,this.high,e.low,e.high);return cn(n,ea.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?vc:na;var s,r,a;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return vc;if(e.gt(this.shru(1)))return F4;a=vc}else{if(this.eq(hr)){if(e.eq(bd)||e.eq(Y2))return hr;if(e.eq(hr))return bd;var o=this.shr(1);return s=o.div(e).shl(1),s.eq(na)?e.isNegative()?bd:Y2:(r=this.sub(e.mul(s)),a=s.add(r.div(e)),a)}else if(e.eq(hr))return this.unsigned?vc:na;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();a=na}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var l=Math.ceil(Math.log(s)/Math.LN2),c=l<=48?1:Ey(2,l-48),u=ta(s),d=u.mul(e);d.isNegative()||d.gt(r);)s-=c,u=ta(s,this.unsigned),d=u.mul(e);u.isZero()&&(u=bd),a=a.add(u),r=r.sub(d)}return a},Le.div=Le.divide,Le.modulo=function(e){if(mr(e)||(e=Fa(e)),ea){var n=(this.unsigned?ea.rem_u:ea.rem_s)(this.low,this.high,e.low,e.high);return cn(n,ea.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},Le.mod=Le.modulo,Le.rem=Le.modulo,Le.not=function(){return cn(~this.low,~this.high,this.unsigned)},Le.and=function(e){return mr(e)||(e=Fa(e)),cn(this.low&e.low,this.high&e.high,this.unsigned)},Le.or=function(e){return mr(e)||(e=Fa(e)),cn(this.low|e.low,this.high|e.high,this.unsigned)},Le.xor=function(e){return mr(e)||(e=Fa(e)),cn(this.low^e.low,this.high^e.high,this.unsigned)},Le.shiftLeft=function(e){return mr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?cn(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):cn(0,this.low<<e-32,this.unsigned)},Le.shl=Le.shiftLeft,Le.shiftRight=function(e){return mr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?cn(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):cn(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},Le.shr=Le.shiftRight,Le.shiftRightUnsigned=function(e){if(mr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return cn(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?cn(n,0,this.unsigned):cn(n>>>e-32,0,this.unsigned)},Le.shru=Le.shiftRightUnsigned,Le.shr_u=Le.shiftRightUnsigned,Le.toSigned=function(){return this.unsigned?cn(this.low,this.high,!1):this},Le.toUnsigned=function(){return this.unsigned?this:cn(this.low,this.high,!0)},Le.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},Le.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},Le.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]},ln.fromBytes=function(e,n,s){return s?ln.fromBytesLE(e,n):ln.fromBytesBE(e,n)},ln.fromBytesLE=function(e,n){return new ln(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)},ln.fromBytesBE=function(e,n){return new ln(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const L4=TC($4),KZ=am({__proto__:null,default:L4},[$4]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ec=L4||KZ;function Ny(t){return Ec.fromString(t,!0,16)}const z4=Ny("c3a5c85c97cb3127"),Nc=Ny("b492b66fbe98f273"),_s=Ny("9ae16a3b2f90404f");function Z2(t){return t.xor(t.shru(47))}function B4(t,e,n){const s=t.slice(e,e+n);return Ec.fromBytes(Array.from(s),!0,!0)}function nn(t,e){return B4(t,e,8)}function U4(t,e){return B4(t,e,4)}function Zn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function rl(t,e,n=Ny("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function XZ(t,e,n,s,r,a){r=r.add(t),a=Zn(a.add(r).add(s),21);const o=r;return r=r.add(e),r=r.add(n),a=a.add(Zn(r,44)),[r.add(s),a.add(o)]}function ky(t,e,n,s){return XZ(nn(t,e),nn(t,e+8),nn(t,e+16),nn(t,e+24),n,s)}function YZ(t,e=t.length){if(e>=8){const n=_s.add(e*2),s=nn(t,0).add(_s),r=nn(t,e-8),a=Zn(r,37).mul(n).add(s),o=Zn(s,25).add(r).mul(n);return rl(a,o,n)}if(e>=4){const n=_s.add(e*2),s=U4(t,0);return rl(s.shl(3).add(e),U4(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],a=n+(s<<8),o=e+(r<<2);return Z2(_s.mul(a).xor(z4.mul(o))).mul(_s)}return _s}function ZZ(t,e=t.length){const n=_s.add(e*2),s=nn(t,0).mul(Nc),r=nn(t,8),a=nn(t,e-8).mul(n),o=nn(t,e-16).mul(_s);return rl(Zn(s.add(r),43).add(Zn(a,30)).add(o),s.add(Zn(r.add(_s),18)).add(a),n)}function JZ(t,e=t.length){const n=_s.add(e*2),s=nn(t,0).mul(_s),r=nn(t,8),a=nn(t,e-8).mul(n),o=nn(t,e-16).mul(_s),l=Zn(s.add(r),43).add(Zn(a,30)).add(o),c=rl(l,s.add(Zn(r.add(_s),18)).add(a),n),u=nn(t,16).mul(n),d=nn(t,24),m=l.add(nn(t,e-32)).mul(n),h=c.add(nn(t,e-24)).mul(n);return rl(Zn(u.add(d),43).add(Zn(m,30)).add(h),u.add(Zn(d.add(s),18)).add(m),n)}function QZ(t,e=t.length){const n=Ec.fromNumber(81,!0);if(e<=32)return e<=16?YZ(t,e):ZZ(t,e);if(e<=64)return JZ(t,e);let s=n,r=n.mul(Nc).add(113),a=Z2(r.mul(_s).add(113)).mul(_s),o=[Ec.UZERO,Ec.UZERO],l=[Ec.UZERO,Ec.UZERO];s=s.mul(_s).add(nn(t,0));let c=0;const u=(e-1>>6)*64,d=u+(e-1&63)-63;do s=Zn(s.add(r).add(o[0]).add(nn(t,c+8)),37).mul(Nc),r=Zn(r.add(o[1]).add(nn(t,c+48)),42).mul(Nc),s=s.xor(l[1]),r=r.add(o[0]).add(nn(t,c+40)),a=Zn(a.add(l[0]),33).mul(Nc),o=ky(t,c,o[1].mul(Nc),s.add(l[0])),l=ky(t,c+32,a.add(l[1]),r.add(nn(t,c+16))),[a,s]=[s,a],c+=64;while(c!==u);const m=Nc.add(a.and(255).shl(1));return c=d,l[0]=l[0].add(e-1&63),o[0]=o[0].add(l[0]),l[0]=l[0].add(o[0]),s=Zn(s.add(r).add(o[0]).add(nn(t,c+8)),37).mul(m),r=Zn(r.add(o[1]).add(nn(t,c+48)),42).mul(m),s=s.xor(l[1].mul(9)),r=r.add(o[0].mul(9).add(nn(t,c+40))),a=Zn(a.add(l[0]),33).mul(m),o=ky(t,c,o[1].mul(m),s.add(l[0])),l=ky(t,c+32,a.add(l[1]),r.add(nn(t,c+16))),[a,s]=[s,a],rl(rl(o[0],l[0],m).add(Z2(r).mul(z4)).add(a),rl(o[1],l[1],m).add(s),m)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function al(t,e){return e==="string"?ol(t):kc([t],e)}function eJ(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function kc(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Sc(t)),ie().getBool("DEBUG")&&AZ(t,e),eJ(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Ks(){return ie().platform.now()}function ol(t,e="utf-8"){return e=e||"utf-8",ie().platform.encode(t,e)}function il(t,e="utf-8"){return e=e||"utf-8",ie().platform.decode(t,e)}function sa(t){return ie().platform.isTypedArray!=null?ie().platform.isTypedArray(t):I4(t)}function Sc(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||n2(t)||t==null||sa(t)&&n)e.push(t);else if(Array.isArray(t)||sa(t))for(let s=0;s<t.length;++s)Sc(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)Sc(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tJ{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new sJ)}profileKernel(e,n,s){let r;const a=()=>{r=s()};let o;const l=Ks();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(a);else{a();for(const u of r)u.dataSync();o=Promise.resolve({kernelMs:Ks()-l})}if(ie().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const d=r[u];d.data().then(m=>{nJ(m,d.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:o.then(u=>u.kernelMs),extraInfo:o.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:a,extraInfo:o}=e;s.forEach(l=>{Promise.all([l.data(),r,o]).then(c=>{this.logger.logKernelProfile(n,l,c[0],c[1],a,c[2])})})}}function nJ(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class sJ{logKernelProfile(e,n,s,r,a,o){const l=typeof r=="number"?hd(`${r}ms`,9):r.error,c=hd(e,25),u=n.rank,d=n.size,m=hd(n.shape.toString(),14);let h="";for(const p in a){const f=a[p];if(f!=null){const y=f.shape||n.shape,x=y.length;h+=`${p}: ${x}D ${x>0?y:""} `}}console.log(`%c${c}	%c${l}	%c${u}D ${m}	%c${d}	%c${h}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rJ(t,e,n){const s={},r={};for(let c=0;c<e.length;c++)s[e[c].id]=!0;for(let c=0;c<t.length;c++){const u=t[c],d=u.inputs;for(const m in d){const h=d[m];let p=!1;for(let f=0;f<e.length;f++)if(s[h.id]){u.outputs.forEach(y=>s[y.id]=!0),p=!0,r[u.id]=!0;break}if(p)break}}const a={};a[n.id]=!0;const o={};for(let c=t.length-1;c>=0;c--){const u=t[c],d=u.inputs;for(let m=0;m<u.outputs.length;m++)if(a[u.outputs[m].id]){for(const h in d)a[d[h].id]=!0,o[u.id]=!0;break}}const l=[];for(let c=0;c<t.length;c++){const u=t[c];if(r[u.id]&&o[u.id]){const d={};for(const h in u.inputs){const p=u.inputs[h];s[p.id]&&(d[h]=p)}const m=Object.assign({},u);m.inputs=d,m.outputs=u.outputs,l.push(m)}}return l}function aJ(t,e,n,s){for(let r=e.length-1;r>=0;r--){const a=e[r],o=[];if(a.outputs.forEach(c=>{const u=t[c.id];u!=null?o.push(u):o.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const l=a.gradient(o);for(const c in a.inputs){if(!(c in l))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(l)}.`);const u=n(()=>l[c]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${u.dtype}'`);const d=a.inputs[c];if(!zt(u.shape,d.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${c}' has shape '${u.shape}', which does not match the shape of the input '${d.shape}'`);if(t[d.id]==null)t[d.id]=u;else{const m=t[d.id];t[d.id]=s(m,u),m.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V4=20,$p=3,J2=7;function oJ(t,e,n,s){const r=nt(e),a=iJ(t,e,n,r),o=e.length,l=Sy(t,e,n,r,a),c=["Tensor"];return s&&(c.push(`  dtype: ${n}`),c.push(`  rank: ${o}`),c.push(`  shape: [${e}]`),c.push("  values:")),c.push(l.map(u=>"    "+u).join(`
`)),c.join(`
`)}function iJ(t,e,n,s){const r=ue(e),a=s[s.length-1],o=new Array(a).fill(0),l=e.length,c=n==="complex64"?Ap(t):t;if(l>1)for(let u=0;u<r/a;u++){const d=u*a;for(let m=0;m<a;m++)o[m]=Math.max(o[m],Tp(c[d+m],0,n).length)}return o}function Tp(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(J2))} + ${parseFloat(t[1].toFixed(J2))}j`:_h(t)?s=`'${t}'`:n==="bool"?s=W4(t):s=parseFloat(t.toFixed(J2)).toString(),hd(s,e)}function W4(t){return t===0?"false":"true"}function Sy(t,e,n,s,r,a=!0){const o=n==="complex64"?2:1,l=e[0],c=e.length;if(c===0){if(n==="complex64"){const y=Ap(t);return[Tp(y[0],0,n)]}return n==="bool"?[W4(t[0])]:[t[0].toString()]}if(c===1){if(l>V4){const x=$p*o;let g=Array.from(t.slice(0,x)),b=Array.from(t.slice((l-$p)*o,l*o));return n==="complex64"&&(g=Ap(g),b=Ap(b)),["["+g.map((w,v)=>Tp(w,r[v],n)).join(", ")+", ..., "+b.map((w,v)=>Tp(w,r[l-$p+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?Ap(t):Array.from(t)).map((x,g)=>Tp(x,r[g],n)).join(", ")+"]"]}const u=e.slice(1),d=s.slice(1),m=s[0]*o,h=[];if(l>V4){for(let y=0;y<$p;y++){const x=y*m,g=x+m;h.push(...Sy(t.slice(x,g),u,n,d,r,!1))}h.push("...");for(let y=l-$p;y<l;y++){const x=y*m,g=x+m;h.push(...Sy(t.slice(x,g),u,n,d,r,y===l-1))}}else for(let y=0;y<l;y++){const x=y*m,g=x+m;h.push(...Sy(t.slice(x,g),u,n,d,r,y===l-1))}const p=c===2?",":"";h[0]="["+(l>0?h[0]+p:"");for(let y=1;y<h.length-1;y++)h[y]=" "+h[y]+p;let f=`,
`;for(let y=2;y<c;y++)f+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(a?"":f),h}function Ap(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class is{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=ue(e),s!=null){const r=s.length;R(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Cn(n,this.size),this.strides=nt(e)}set(e,...n){n.length===0&&(n=[0]),R(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Ma().makeTensor(this.values,this.shape,this.dtype)}}let Ma=null,wd=null;function lJ(t){Ma=t}function cJ(t){wd=t}class Vn{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ue(e),this.strides=nt(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return wd.buffer(this.shape,this.dtype,e)}bufferSync(){return wd.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return Pa(this.shape,e,this.dtype==="complex64")}arraySync(){return Pa(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ma().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>il(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ma().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ma().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>il(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ma().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ma().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return wd.print(this,e)}clone(){return this.throwIfDisposed(),wd.clone(this)}toString(e=!1){const n=this.dataSync();return oJ(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),wd.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Ma().makeVariable(this,e,n,s)}}Object.defineProperty(Vn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function ce(){return r2("Tensor",()=>Vn)}ce();class Cy extends Vn{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!zt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ma().disposeTensor(this),this.dataId=e.dataId,Ma().incRef(this,null)}dispose(){Ma().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Cy,Symbol.hasInstance,{value:t=>t instanceof Vn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var j4;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(j4||(j4={}));var Q2;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Q2||(Q2={}));var eN;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(eN||(eN={}));var tN;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(tN||(tN={}));var nN;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(nN||(nN={}));const uJ={float32:tN,int32:Q2,bool:eN,complex64:nN};function pr(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return uJ[t][e]}function sN(t){return pr(t,"int32")}function G4(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function H4(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function In(t,e){if(t.dtype===e.dtype)return[t,e];const n=pr(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function q4(t){const e=[];return K4(t,e,new Set),e}function K4(t,e,n){if(t==null)return;if(t instanceof Vn){e.push(t);return}if(!dJ(t))return;const s=t;for(const r in s){const a=s[r];n.has(a)||(n.add(a),K4(a,e,n))}}function dJ(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rN(t){return t.kernelName!=null}class X4{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class vd{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new X4}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Rr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new tJ(this.backendInstance),!0}setupRegisteredKernels(){k4(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){k4(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof KE)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(o=>r<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Rr(`Initialization of backend ${e} failed`),Rr(o.stack||o.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Rr(`Initialization of backend ${e} failed`),Rr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,a=this.readSync(n),o=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,a,s.shape,s.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return vd.nextTensorId++}nextVariableId(){return vd.nextVariableId++}clone(e){const n=H.runKernel(Qh,{x:e}),s={x:e},r=o=>({x:()=>{const l="float32",c={x:o},u={dtype:l};return H.runKernel(Bh,c,u)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,a,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(E4(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let a=0;s.forEach(c=>{a+=c.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=r-n-a-o;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),a=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let c;const u=rN(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(rN(e)){const{kernelName:f,inputs:y,attrs:x}=e;this.backendName==null&&this.backend;const g=E4(f,this.backendName);R(g!=null,()=>`Cannot find registered kernel '${f}' for backend '${this.backendName}'`),l=()=>{const b=this.backend.numDataIds();c=g.kernelFunc({inputs:y,attrs:x,backend:this.backend});const w=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(f,b,w);const v=w.map(E=>E.rank!=null?E:this.makeTensorFromTensorInfo(E));if(r){const E=this.getTensorsForGradient(f,y,v);s=this.saveTensorsForBackwardMode(E)}return v}}else{const{forwardFunc:f}=e,y=x=>{r&&(s=x.map(g=>this.keep(this.clone(g))))};l=()=>{const x=this.backend.numDataIds();c=this.tidy(()=>f(this.backend,y));const g=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,g),g}}const{inputs:d,attrs:m}=e,h=rN(e)?null:e.backwardsFunc;let p;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=l():(p=this.profiler.profileKernel(u,d,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),n=p.outputs)}),r&&this.addTapeNode(u,d,n,h,s,m),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(f=>d[f]!=null?d[f].shape:null),outputShapes:n.map(f=>f.shape),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(c)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=N4(e);if(r!=null){const a=r.inputsToSave||[],o=r.outputsToSave||[];let l;r.saveAllInputs?(R(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(n).map(u=>n[u])):l=a.map(u=>n[u]);const c=s.filter((u,d)=>o[d]);return l.concat(c)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=e;s==="string"&&_h(e[0])&&(a=e.map(c=>ol(c)));const o=r.write(a,n,s),l=new Vn(n,s,o,this.nextTensorId());if(this.trackTensor(l,r),s==="string"){const c=this.state.tensorInfo.get(o),u=_Z(a);this.state.numBytes+=u-c.bytes,c.bytes=u}return l}makeTensorFromDataId(e,n,s,r){s=s||"float32";const a={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:a}=e,o=new Vn(r,a,s,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const a=new Cy(e,n,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*yx(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Cy||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*yx(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,a,o){const l={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:a},c=N4(e);c!=null&&(r=c.gradFunc),r!=null&&(l.gradient=u=>(u=u.map((d,m)=>{if(d==null){const h=s[m],p=ws(h.size,h.dtype);return this.makeTensor(p,h.shape,h.dtype)}return d}),r(u.length>1?u:u[0],a,o))),this.state.activeTape.push(l)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=q4(e),s=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const o=this.state.activeScope.track[a];!o.kept&&!s.has(o.id)&&o.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,n,s,r=!1){if(R(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));R(a instanceof Vn,()=>"The result y returned by f() must be a tensor.");const o=rJ(this.state.activeTape,n,a);if(!r&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const l={};l[a.id]=s??mJ(a.shape),aJ(l,o,u=>this.tidy(u),hJ);const c=n.map(u=>l[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const d of u.saved)d.dispose()}),this.state.activeTape=null),{value:a,grads:c}})}customGrad(e){return R(QE(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{R(n.every(l=>l instanceof Vn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((l,c)=>{r[c]=l});const a=(l,c)=>(s=e(...n,c),R(s.value instanceof Vn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),R(QE(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),o=(l,c)=>{const u=s.gradFunc(l,c),d=Array.isArray(u)?u:[u];R(d.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),R(d.every(h=>h instanceof Vn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const m={};return d.forEach((h,p)=>{m[p]=()=>h}),m};return this.runKernelFunc({forwardFunc:a,backwardsFunc:o,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Ks(),s=await this.backend.time(e);return s.wallMs=Ks()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new X4;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}vd.nextTensorId=0,vd.nextVariableId=0;function mJ(t){const e=t2(ue(t),"float32");return H.makeTensor(e,t,"float32")}function Y4(){const t=e4();if(t._tfengine==null){const e=new FZ(t);t._tfengine=new vd(e)}return zZ(t._tfengine.ENV),lJ(()=>t._tfengine),t._tfengine}const H=Y4();function hJ(t,e){const n={a:t,b:e};return H.runKernel(gd,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pJ(){return typeof navigator<"u"&&navigator!=null}function Z4(t){if(t||pJ()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function J4(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xs=ie();Xs.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Xs.registerFlag("IS_BROWSER",()=>J4()),Xs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"),Xs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Xs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),Xs.registerFlag("PROD",()=>!1),Xs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Xs.getBool("DEBUG")),Xs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Xs.registerFlag("IS_TEST",()=>!1),Xs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Xs.getBool("DEBUG")),Xs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),Xs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),Xs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iy(t,e){let n=t;if(sa(t))return e==="string"?[]:[t.length];if(G4(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(H4(t))return[t.buffer.size/(e==null?4:yx(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||sa(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&ie().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&Q4(t,s,[]),s}function Q4(t,e,n){if(n=n||[],!Array.isArray(t)&&!sa(t)){R(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}R(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),R(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)Q4(t[r],s,n.concat(r))}function e3(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function U(t,e,n,s="numeric"){if(t instanceof ce())return e3(s,t.dtype,e,n),t;let r=pd(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),e3(s,r,e,n),t==null||!sa(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const c=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${c}'`)}const a=Iy(t,r);!sa(t)&&!Array.isArray(t)&&(t=[t]);const l=r!=="string"?kc(t,r):Sc(t,[],!0);return H.makeTensor(l,a,r)}function t3(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((a,o)=>U(a,`${e}[${o}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fJ="__op";function ee(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+fJ;const r=(...a)=>{H.startScope(n);try{const o=s(...a);return n2(o)&&console.error("Cannot return a Promise inside of tidy."),H.endScope(o),o}catch(o){throw H.endScope(null),o}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gJ(t,e){const n=U(t,"real","complex"),s=U(e,"imag","complex");YE(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return H.runKernel(m2,r)}const Cc=ee({complex_:gJ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $y(t,e,n,s){if(s==null)s=pd(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(H4(t)||G4(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return H.backend.createTensorFromGPUData(t,e||n,s)}if(!sa(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){ui(e);const r=ue(e),a=ue(n);R(r===a,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${a}`);for(let o=0;o<n.length;++o){const l=n[o],c=o===n.length-1?l!==ue(e.slice(o)):!0;R(n[o]===e[o]||!c,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!sa(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?kc(t,s):Sc(t,[],!0),H.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rp(t,e,n){const s=Iy(t,n);return $y(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ty={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ll{static join(e){return new ll(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>sa(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=n+r.byteLength;this.shards.push({buffer:r,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,a=new ArrayBuffer(r),o=new Uint8Array(a);let l=0;for(let c=s;c<this.shards.length;c++){const u=this.shards[c],m=e+l-u.start,h=l,f=Math.min(n,u.end)-u.start,y=new Uint8Array(u.buffer,m,f-m);if(o.set(y,h),l+=y.length,n<u.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=xJ(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function xJ(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,a=e(t[r]);if(a===0)return r;a<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(){return H}function n3(){return H.memory()}function re(t,e){return H.tidy(t,e)}function vt(t){q4(t).forEach(n=>n.dispose())}function ho(t){return H.keep(t)}function s3(t,e,n=1){return H.registerBackend(t,e,n)}function yJ(){return H.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ed=4;async function r3(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<r.length;++o){const l=r[o],c=Array.isArray(t)?t[o].tensor:t[l];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${l}': ${c.dtype}`);const u={name:l,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){const d=new Promise(async m=>{const h=await c.bytes(),p=h.reduce((x,g)=>x+g.length,0)+Ed*h.length,f=new Uint8Array(p);let y=0;for(let x=0;x<h.length;x++){const g=h[x],b=new Uint8Array(new Uint32Array([g.length]).buffer);f.set(b,y),y+=Ed,f.set(g,y),y+=g.length}m(f)});s.push(d)}else s.push(c.data());e!=null&&(u.group=e),n.push(u)}const a=await Promise.all(s);return{data:EJ(a),specs:n}}function bJ(t,e){const n=new ll(t),s={};let r=0;for(const a of e){const o=wJ(a,(l,c)=>n.slice(r+l,r+c));s[a.name]=vJ(a,n.slice(r,r+o)),r+=o}return s}function wJ(t,e){const n=ue(t.shape);let s;if("quantization"in t){const r=t.quantization;s=Ty[r.dtype]}else if(t.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=Ed+new Uint32Array(e(r,r+Ed))[0];return r}else s=Ty[t.dtype];return n*s}function vJ(t,e){const n=t.name,s=t.dtype,r=t.shape,a=ue(r);let o,l=0;if("quantization"in t){const c=t.quantization;if(c.dtype==="uint8"||c.dtype==="uint16"){if(!("min"in c&&"scale"in c))throw new Error(`Weight ${t.name} with quantization ${c.dtype} doesn't have corresponding metadata min and scale.`)}else if(c.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${c.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${c.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Ty[c.dtype],d=c.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(c.dtype==="uint8"||c.dtype==="uint16"){o=new Float32Array(d.length);for(let m=0;m<d.length;m++){const h=d[m];o[m]=h*c.scale+c.min}}else if(c.dtype==="float16")o=_J()(d);else throw new Error(`Unsupported quantization type ${c.dtype} for weight type float32.`);else if(s==="int32"){if(c.dtype!=="uint8"&&c.dtype!=="uint16")throw new Error(`Unsupported quantization type ${c.dtype} for weight type int32.`);o=new Int32Array(d.length);for(let m=0;m<d.length;m++){const h=d[m];o[m]=Math.round(h*c.scale+c.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);l+=a*u}else if(s==="string"){const c=ue(t.shape);o=[];for(let u=0;u<c;u++){const d=new Uint32Array(e.slice(l,l+Ed))[0];l+=Ed;const m=new Uint8Array(e.slice(l,l+d));o.push(m),l+=d}}else{const c=Ty[s];if(s==="float32")o=new Float32Array(e);else if(s==="int32")o=new Int32Array(e);else if(s==="bool")o=new Uint8Array(e);else if(s==="complex64"){o=new Float32Array(e);const u=new Float32Array(o.length/2),d=new Float32Array(o.length/2);for(let f=0;f<u.length;f++)u[f]=o[f*2],d[f]=o[f*2+1];const m=Rp(u,r,"float32"),h=Rp(d,r,"float32"),p=Cc(m,h);return m.dispose(),h.dispose(),p}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);l+=a*c}return Rp(o,r,s)}function EJ(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(a=>{if(e+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const aN=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function a3(t){return aN?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function NJ(t){if(aN)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function kJ(t){if(aN){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function SJ(t){return ll.join(t)}function CJ(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function IJ(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function $J(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),IJ(t,n,s)}function oN(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:a3(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:a3(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ll(t.weightData).byteLength}}function o3(t){const e=[];for(const n of t)e.push(...n.weights);return e}function TJ(){const t=n=>{let s=n<<13,r=0;for(;!(s&8388608);)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function AJ(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function RJ(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function _J(){const t=TJ(),e=AJ(),n=RJ();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let o=0;o<s.length;o++){const l=s[o],c=t[n[l>>10]+(l&1023)]+e[l>>10];a[o]=c}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jn{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Jn.instance==null&&(Jn.instance=new Jn),Jn.instance}static registerSaveRouter(e){Jn.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Jn.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Jn.getHandlers(e,"save")}static getLoadHandlers(e,n){return Jn.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?Jn.getInstance().loadRouters:Jn.getInstance().saveRouters).forEach(o=>{const l=o(e,s);l!==null&&r.push(l)}),r}}const DJ=t=>Jn.getSaveHandlers(t),PJ=(t,e)=>Jn.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iN="tensorflowjs",lN=1,Ic="models_store",cl="model_info_store";function i3(){if(!ie().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function cN(t){const e=t.result;e.createObjectStore(Ic,{keyPath:"modelPath"}),e.createObjectStore(cl,{keyPath:"modelPath"})}class $c{constructor(e){if(this.indexedDB=i3(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const a=this.indexedDB.open(iN,lN);a.onupgradeneeded=()=>cN(a),a.onsuccess=()=>{const o=a.result;if(n==null){const l=o.transaction(Ic,"readonly"),u=l.objectStore(Ic).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=d=>(o.close(),r(u.error)),l.oncomplete=()=>o.close()}else{n.weightData=ll.join(n.weightData);const l=oN(n),c=o.transaction(cl,"readwrite");let u=c.objectStore(cl),d;try{d=u.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(h){return r(h)}let m;d.onsuccess=()=>{m=o.transaction(Ic,"readwrite");const h=m.objectStore(Ic);let p;try{p=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:l})}catch(f){return r(f)}p.onsuccess=()=>s({modelArtifactsInfo:l}),p.onerror=f=>{u=c.objectStore(cl);const y=u.delete(this.modelPath);y.onsuccess=()=>(o.close(),r(p.error)),y.onerror=x=>(o.close(),r(p.error))}},d.onerror=h=>(o.close(),r(d.error)),c.oncomplete=()=>{m==null?o.close():m.oncomplete=()=>o.close()}}},a.onerror=o=>r(a.error)})}}$c.URL_SCHEME="indexeddb://";const l3=t=>ie().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith($c.URL_SCHEME)?FJ(t.slice($c.URL_SCHEME.length)):null;Jn.registerSaveRouter(l3),Jn.registerLoadRouter(l3);function FJ(t){return new $c(t)}function MJ(t){return t.startsWith($c.URL_SCHEME)?t.slice($c.URL_SCHEME.length):t}class OJ{constructor(){this.indexedDB=i3()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(iN,lN);s.onupgradeneeded=()=>cN(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(cl,"readonly"),l=a.objectStore(cl).getAll();l.onsuccess=()=>{const c={};for(const u of l.result)c[u.modelPath]=u.modelArtifactsInfo;e(c)},l.onerror=c=>(r.close(),n(l.error)),a.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=MJ(e),new Promise((n,s)=>{const r=this.indexedDB.open(iN,lN);r.onupgradeneeded=()=>cN(r),r.onsuccess=()=>{const a=r.result,o=a.transaction(cl,"readwrite"),l=o.objectStore(cl),c=l.get(e);let u;c.onsuccess=()=>{if(c.result==null)return a.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const d=l.delete(e),m=()=>{u=a.transaction(Ic,"readwrite");const p=u.objectStore(Ic).delete(e);p.onsuccess=()=>n(c.result.modelArtifactsInfo),p.onerror=f=>s(c.error)};d.onsuccess=m,d.onerror=h=>(m(),a.close(),s(c.error))}},c.onerror=d=>(a.close(),s(c.error)),o.oncomplete=()=>{u==null?a.close():u.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const di="/",Nd="tensorflowjs_models",c3="info",LJ="model_topology",zJ="weight_specs",BJ="weight_data",UJ="model_metadata";function u3(t){return{info:[Nd,t,c3].join(di),topology:[Nd,t,LJ].join(di),weightSpecs:[Nd,t,zJ].join(di),weightData:[Nd,t,BJ].join(di),modelMetadata:[Nd,t,UJ].join(di)}}function d3(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function VJ(t){const e=t.split(di);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(di)}function WJ(t){return t.startsWith(Tc.URL_SCHEME)?t.slice(Tc.URL_SCHEME.length):t}class Tc{constructor(e){if(!ie().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=u3(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=oN(e),a=ll.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,NJ(a));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw d3(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const l=JSON.parse(a);n.format=l.format,n.generatedBy=l.generatedBy,n.convertedBy=l.convertedBy,l.signature!=null&&(n.signature=l.signature),l.userDefinedMetadata!=null&&(n.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(n.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(n.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(n.trainingConfig=l.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=kJ(o),n}}Tc.URL_SCHEME="localstorage://";const m3=t=>ie().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Tc.URL_SCHEME)?jJ(t.slice(Tc.URL_SCHEME.length)):null;Jn.registerSaveRouter(m3),Jn.registerLoadRouter(m3);function jJ(t){return new Tc(t)}class GJ{constructor(){R(ie().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),R(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Nd+di,s=di+c3;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(n)&&a.endsWith(s)){const o=VJ(a);e[o]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=WJ(e);const n=u3(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return d3(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h3="://";class po{constructor(){this.managers={}}static getInstance(){return po.instance==null&&(po.instance=new po),po.instance}static registerManager(e,n){R(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(h3)&&(e=e.slice(0,e.indexOf(h3))),R(e.length>0,()=>"scheme must not be an empty string.");const s=po.getInstance();R(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=po.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(po.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HJ{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!ie().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return I4(e)}}if(ie().get("IS_BROWSER")){ie().setPlatform("browser",new HJ);try{po.registerManager(Tc.URL_SCHEME,new GJ)}catch{}try{po.registerManager($c.URL_SCHEME,new OJ)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qJ={importFetch:()=>require("node-fetch")};let uN;class KJ{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ie().global.fetch!=null?ie().global.fetch(e,n):(uN==null&&(uN=qJ.importFetch()),uN(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ie().get("IS_NODE")&&!ie().get("IS_BROWSER")&&ie().setPlatform("node",new KJ);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(t,e="float32",n){return e=e||"float32",ui(t),new is(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XJ(t,e){const n=U(t,"x","cast");if(!RZ(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return H.runKernel(Bh,s,r)}const Ue=ee({cast_:XJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(t){const n={x:U(t,"x","clone","string_or_numeric")};return H.runKernel(Qh,n)}const Ac=ee({clone_:YJ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Y4(),cJ({buffer:Nt,cast:Ue,clone:Ac,print:ZJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JJ(t,e){let n=U(t,"a","add"),s=U(e,"b","add");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(gd,r)}const Ce=ee({add_:JJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QJ(t,e){let n=U(t,"a","floorDiv"),s=U(e,"b","floorDiv");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(Zh,r)}const p3=ee({floorDiv_:QJ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(t,e){let n=U(t,"a","div"),s=U(e,"b","div");if([n,s]=In(n,s),n.dtype==="int32"&&s.dtype==="int32")return p3(n,s);const r={a:n,b:s},a={};return H.runKernel(Gh,r,a)}const rt=ee({div_:eQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(t,e){let n=U(t,"a","mul"),s=U(e,"b","mul");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(lp,r)}const G=ee({mul_:tQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(t){const e=U(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return H.runKernel(Cx,n)}else{const n={x:e};return H.runKernel(bx,n)}}const Ds=ee({abs_:nQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sQ(t){const n={x:U(t,"x","acos")};return H.runKernel(Dh,n)}const rQ=ee({acos_:sQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(t){const n={x:U(t,"x","acosh")};return H.runKernel(Ph,n)}const oQ=ee({acosh_:aQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iQ(t,e=null,n=!1){const r={x:U(t,"x","all","bool")},a={axis:e,keepDims:n};return H.runKernel(o2,r,a)}const f3=ee({all_:iQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(t,e=null,n=!1){const r={x:U(t,"x","any","bool")},a={axis:e,keepDims:n};return H.runKernel(i2,r,a)}const dN=ee({any_:lQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(t,e=0){const s={x:U(t,"x","argMax")},r={axis:e};return H.runKernel(wx,s,r)}const _p=ee({argMax_:cQ});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(t,e=0){const s={x:U(t,"x","argMin")},r={axis:e};return H.runKernel(vx,s,r)}const dQ=ee({argMin_:uQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(t){const n={x:U(t,"x","asin")};return H.runKernel(Fh,n)}const hQ=ee({asin_:mQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pQ(t){const n={x:U(t,"x","asinh")};return H.runKernel(Mh,n)}const fQ=ee({asinh_:pQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(t){const n={x:U(t,"x","atan")};return H.runKernel(Oh,n)}const xQ=ee({atan_:gQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(t,e){let n=U(t,"a","atan2"),s=U(e,"b","atan2");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(zh,r)}const bQ=ee({atan2_:yQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wQ(t){const n={x:U(t,"x","atanh")};return H.runKernel(Lh,n)}const vQ=ee({atanh_:wQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dp(t,e,n,s,r="NHWC",a){const o=t[3],l=[...e,o],c=hi(r);return ls(t,l,n,a,s,null,null,c)}function ra(t,e,n,s,r,a,o="channelsLast"){const[l,c]=Pp(e);let u;if(o==="channelsLast")u=[l,c,t[3],t[3]];else if(o==="channelsFirst")u=[l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return ls(t,u,n,s,r,a,!1,o)}function mi(t,e,n,s,r,a,o="NDHWC"){const[l,c,u]=hN(e);let d,m;if(o==="NDHWC")m="channelsLast",d=[l,c,u,t[4],t[4]];else if(o==="NCDHW")m="channelsFirst",d=[l,c,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return ul(t,d,n,s,r,!1,m,a)}function ls(t,e,n,s,r,a,o=!1,l="channelsLast"){let[c,u,d,m]=[-1,-1,-1,-1];if(l==="channelsLast")[c,u,d,m]=t;else if(l==="channelsFirst")[c,m,u,d]=t;else throw new Error(`Unknown dataFormat ${l}`);const[h,p,,f]=e,[y,x]=Pp(n),[g,b]=Pp(s),w=kd(h,g),v=kd(p,b),{padInfo:E,outHeight:k,outWidth:C}=kQ(r,u,d,y,x,w,v,a,l),I=o?f*m:f;let A;return l==="channelsFirst"?A=[c,I,k,C]:l==="channelsLast"&&(A=[c,k,C,I]),{batchSize:c,dataFormat:l,inHeight:u,inWidth:d,inChannels:m,outHeight:k,outWidth:C,outChannels:I,padInfo:E,strideHeight:y,strideWidth:x,filterHeight:h,filterWidth:p,effectiveFilterHeight:w,effectiveFilterWidth:v,dilationHeight:g,dilationWidth:b,inShape:t,outShape:A,filterShape:e}}function ul(t,e,n,s,r,a=!1,o="channelsLast",l){let[c,u,d,m,h]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[c,u,d,m,h]=t;else if(o==="channelsFirst")[c,h,u,d,m]=t;else throw new Error(`Unknown dataFormat ${o}`);const[p,f,y,,x]=e,[g,b,w]=hN(n),[v,E,k]=hN(s),C=kd(p,v),I=kd(f,E),A=kd(y,k),{padInfo:$,outDepth:T,outHeight:F,outWidth:O}=SQ(r,u,d,m,g,b,w,C,I,A,l),M=a?x*h:x;let B;return o==="channelsFirst"?B=[c,M,T,F,O]:o==="channelsLast"&&(B=[c,T,F,O,M]),{batchSize:c,dataFormat:o,inDepth:u,inHeight:d,inWidth:m,inChannels:h,outDepth:T,outHeight:F,outWidth:O,outChannels:M,padInfo:$,strideDepth:g,strideHeight:b,strideWidth:w,filterDepth:p,filterHeight:f,filterWidth:y,effectiveFilterDepth:C,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationDepth:v,dilationHeight:E,dilationWidth:k,inShape:t,outShape:B,filterShape:e}}function EQ(t,e,n,s,r){s==null&&(s=mN(t,e,n));const a=t[0],o=t[1],l=Fp((a-e+2*s)/n+1,r),c=Fp((o-e+2*s)/n+1,r);return[l,c]}function NQ(t,e,n,s,r,a){r==null&&(r=mN(t,e[0],s[0]));const o=[0,0,0,n];for(let l=0;l<3;l++)t[l]+2*r>=e[l]&&(o[l]=Fp((t[l]-e[l]+2*r)/s[l]+1,a));return o}function mN(t,e,n,s=1){const r=kd(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function Pp(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function hN(t){return typeof t=="number"?[t,t,t]:t}function kd(t,e){return e<=1?t:t+(t-1)*(e-1)}function kQ(t,e,n,s,r,a,o,l,c){let u,d,m;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=EQ([e,n],a,s,t,l);d=p[0],m=p[1]}else if(t==="same"){d=Math.ceil(e/s),m=Math.ceil(n/r);const h=Math.max(0,(d-1)*s+a-e),p=Math.max(0,(m-1)*r+o-n),f=Math.floor(h/2),y=h-f,x=Math.floor(p/2),g=p-x;u={top:f,bottom:y,left:x,right:g,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-a+1)/s),m=Math.ceil((n-o+1)/r);else if(typeof t=="object"){const h=c==="channelsLast"?t[1][0]:t[2][0],p=c==="channelsLast"?t[1][1]:t[2][1],f=c==="channelsLast"?t[2][0]:t[3][0],y=c==="channelsLast"?t[2][1]:t[3][1];u={top:h,bottom:p,left:f,right:y,type:h===0&&p===0&&f===0&&y===0?"VALID":"EXPLICIT"},d=Fp((e-a+h+p)/s+1,l),m=Fp((n-o+f+y)/r+1,l)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:d,outWidth:m}}function SQ(t,e,n,s,r,a,o,l,c,u,d){let m,h,p,f;if(t==="valid"&&(t=0),typeof t=="number"){m={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const x=NQ([e,n,s,1],[l,c,u],1,[r,a,o],t,d);h=x[0],p=x[1],f=x[2]}else if(t==="same"){h=Math.ceil(e/r),p=Math.ceil(n/a),f=Math.ceil(s/o);const y=(h-1)*r+l-e,x=(p-1)*a+c-n,g=(f-1)*o+u-s,b=Math.floor(y/2),w=y-b,v=Math.floor(x/2),E=x-v,k=Math.floor(g/2),C=g-k;m={top:v,bottom:E,left:k,right:C,front:b,back:w,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:m,outDepth:h,outHeight:p,outWidth:f}}function Fp(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Rc(t){const[e,n,s]=Pp(t);return e===1&&n===1&&s===1}function vs(t,e){return Rc(t)||Rc(e)}function _c(t){return Pp(t).every(e=>e>0)}function hi(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Ys(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")R(md(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{R(md(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CQ(t,e){const s={x:U(t,"x","reshape","string_or_numeric")},r={shape:e};return H.runKernel(oy,s,r)}const Q=ee({reshape_:CQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(t,e,n,s,r){const a=U(t,"x","avgPool","float32"),o=1;R(vs(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let l=a,c=!1;a.rank===3&&(c=!0,l=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(l.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${l.rank}.`),Ys("avgPool",s,r);const u={x:l},d={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let m=H.runKernel(Ex,u,d);return m=Ue(m,a.dtype),c?Q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const pN=ee({avgPool_:IQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(t,e,n,s,r,a="NDHWC"){const o=U(t,"x","avgPool3d","float32");let l=o,c=!1;o.rank===4&&(c=!0,l=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(l.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),R(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),R(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Ys("avgPool3d",s,r);const u={x:l},d={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:a};let m=H.runKernel(Nx,u,d);return m=Ue(m,l.dtype),c?Q(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const TQ=ee({avgPool3d_:$Q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(t,e=0){R(t.length>=1,()=>"Pass at least one tensor to concat");const n=t3(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Ac(n[0]);const s=n,r={axis:e};return H.runKernel(Ix,s,r)}const Zs=ee({concat_:AQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RQ(t,e,n=!1,s=!1){let r=U(t,"a","matMul"),a=U(e,"b","matMul");[r,a]=In(r,a);const o={a:r,b:a},l={transposeA:n,transposeB:s};return H.runKernel(kx,o,l)}const Bt=ee({matMul_:RQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Q(t){const n={x:U(t,"x","sigmoid","float32")};return H.runKernel(bp,n)}const Sd=ee({sigmoid_:_Q});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DQ(t,e,n){const s=U(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:e,size:n};return H.runKernel(dy,r,a)}const sn=ee({slice_:DQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PQ(t){const n={x:U(t,"x","tanh","float32")};return H.runKernel(Sp,n)}const Ay=ee({tanh_:PQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(t,e,n){const s=U(t,"x","batchToSpaceND"),r=e.reduce((l,c)=>l*c);R(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),R(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),R(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const a={x:s},o={blockShape:e,crops:n};return H.runKernel(Sx,a,o)}const fN=ee({batchToSpaceND_:FQ});function MQ(t){let e;return t.rank===0||t.rank===1?e=Q(t,[1,1,1,t.size]):t.rank===2?e=Q(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=Q(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(t,e,n,s,r,a){a==null&&(a=.001);const o=U(t,"x","batchNorm"),l=U(e,"mean","batchNorm"),c=U(n,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;s!=null&&(d=U(s,"offset","batchNorm")),R(l.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(d==null||l.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(u==null||l.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:MQ(o),scale:u,offset:d,mean:l,variance:c},p={varianceEpsilon:a},f=H.runKernel(Mx,h,p);return Q(f,o.shape)}const Ry=ee({batchNorm_:OQ});function LQ(t,e,n,s,r,a){const o=U(t,"x","batchNorm"),l=U(e,"mean","batchNorm"),c=U(n,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;return s!=null&&(d=U(s,"offset","batchNorm")),R(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),R(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`),R(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&R(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),d!=null&&R(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),Ry(o,l,c,d,u,a)}const zQ=ee({batchNorm2d_:LQ});function BQ(t,e,n,s,r,a){const o=U(t,"x","batchNorm"),l=U(e,"mean","batchNorm"),c=U(n,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;return s!=null&&(d=U(s,"offset","batchNorm")),R(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),R(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`),R(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&R(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),d!=null&&R(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),Ry(o,l,c,d,u,a)}const UQ=ee({batchNorm3d_:BQ});function VQ(t,e,n,s,r,a){const o=U(t,"x","batchNorm"),l=U(e,"mean","batchNorm"),c=U(n,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;return s!=null&&(d=U(s,"offset","batchNorm")),R(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),R(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`),R(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&R(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),d!=null&&R(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),Ry(o,l,c,d,u,a)}const WQ=ee({batchNorm4d_:VQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jQ(t,e,n){const s=U(t,"x","bincount"),r=U(e,"weights","bincount");R(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},o={size:n};return H.runKernel(u2,a,o)}const GQ=ee({bincount_:jQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HQ(t,e){let n=U(t,"broadcastTo","x");const s=n.shape;if(ui(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=Q(n,u)}const r=n.shape,a=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])a[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(a.map((u,d)=>u>1?d:-1).filter(u=>u>=0).length===0)return Ac(n);const l={x:n},c={reps:a};return H.runKernel(Cp,l,c)}const Mp=ee({broadcastTo_:HQ});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qQ(t){const n={x:U(t,"x","ceil","float32")};return H.runKernel(Uh,n)}const KQ=ee({ceil_:qQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(t,e,n){ui(t),n=n||pd(e);const s={shape:t,value:e,dtype:n};return H.runKernel(I2,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(t,e,n){const s=U(t,"x","clipByValue");if(R(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return _y(s.shape,e,s.dtype);const r={x:s},a={clipValueMin:e,clipValueMax:n};return H.runKernel(Vh,r,a)}const _r=ee({clipByValue_:XQ});function YQ(t){return Zs(t,0)}const ZQ=ee({concat1d_:YQ});function JQ(t,e){return Zs(t,e)}const QQ=ee({concat2d_:JQ});function eee(t,e){return Zs(t,e)}const tee=ee({concat3d_:eee});function nee(t,e){return Zs(t,e)}const see=ee({concat4d_:nee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ree(t,e,n,s,r="NHWC",a=[1,1],o){const l=U(t,"x","conv2d","float32"),c=U(e,"filter","conv2d","float32");let u=l,d=!1;l.rank===3&&(d=!0,u=Q(l,[1,l.shape[0],l.shape[1],l.shape[2]])),R(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),R(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),Ys("conv2d",s,o);const m=r==="NHWC"?u.shape[3]:u.shape[1];R(m===c.shape[2],()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${c.shape[2]}.`),R(vs(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),R(_c(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),R(_c(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:u,filter:c},p={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o},f=H.runKernel($x,h,p);return d?Q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Dc=ee({conv2d_:ree});function aee(t,e,n,s,r="NWC",a=1,o){const l=U(t,"x","conv1d"),c=U(e,"filter","conv1d");let u=l,d=!1;l.rank===2&&(d=!0,u=Q(l,[1,l.shape[0],l.shape[1]])),R(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),R(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),Ys("conv1d",s,o),R(u.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${c.shape[1]}.`),R(vs(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),R(_c(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),R(_c(n),()=>"Error in conv1D: Stride should be larger than 0."),R(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const m=Q(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=Q(u,[u.shape[0],1,u.shape[1],u.shape[2]]),x=Dc(h,m,[1,n],s,"NHWC",[1,a],o);return d?Q(x,[x.shape[2],x.shape[3]]):Q(x,[x.shape[0],x.shape[2],x.shape[3]])}const g3=ee({conv1d_:aee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(t,e,n,s,r,a="NHWC",o){R(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let l=t,c=e,u=!1;e.rank===3&&(u=!0,c=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]]),l=[1,t[0],t[1],t[2]]),R(l.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${l.length}.`),R(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),R(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const d=a==="NHWC"?l[3]:l[1],m=a==="NHWC"?c.shape[3]:c.shape[1];R(d===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${n.shape[2]}.`),R(m===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${m}) must match output depth for filter ${n.shape[3]}.`),Ys("conv2dDerInput",r,o);const h={dy:c,filter:n},p={strides:s,pad:r,dataFormat:a,dimRoundingMode:o,inputShape:l},f=H.runKernel(Tx,h,p);return u?Q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const gN=ee({conv2DBackpropInput_:oee});function iee(t,e,n,s,r,a){const o=U(t,"x","conv2dTranspose"),l=U(e,"filter","conv2dTranspose");return gN(n,o,l,s,r,"NHWC",a)}const x3=ee({conv2dTranspose_:iee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lee(t,e,n,s,r="NDHWC",a=[1,1,1]){const o=U(t,"x","conv3d"),l=U(e,"filter","conv3d");let c=o,u=!1;o.rank===4&&(u=!0,c=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),R(l.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${l.rank}.`),R(c.shape[4]===l.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${l.shape[3]}.`),R(vs(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),R(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),R(_c(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),R(_c(n),()=>"Error in conv3D: Strides should be larger than 0.");const d={x:c,filter:l},m={strides:n,pad:s,dataFormat:r,dilations:a},h=H.runKernel(Ax,d,m);return u?Q(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const cee=ee({conv3d_:lee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(t,e,n,s,r){R(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,o=e,l=!1;e.rank===4&&(l=!0,o=Q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);const c=a[4],u=o.shape[4];R(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),R(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),R(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),R(c===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[3]}.`),R(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const d={dy:o,filter:n},m={pad:r,strides:s,inputShape:a},h=H.runKernel(f2,d,m);return l?Q(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const y3=ee({conv3DBackpropInput_:uee});function dee(t,e,n,s,r){const a=U(t,"x","conv3dTranspose"),o=U(e,"filter","conv3dTranspose");return y3(n,a,o,s,r)}const mee=ee({conv3dTranspose_:dee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hee(t){const n={x:U(t,"x","cos","float32")};return H.runKernel(Wh,n)}const xN=ee({cos_:hee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(t){const n={x:U(t,"x","cosh","float32")};return H.runKernel(jh,n)}const b3=ee({cosh_:pee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fee(t,e=0,n=!1,s=!1){const a={x:U(t,"x","cumprod")},o={axis:e,exclusive:n,reverse:s};return H.runKernel(g2,a,o)}const yN=ee({cumprod_:fee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gee(t,e=0,n=!1,s=!1){const a={x:U(t,"x","cumsum")},o={axis:e,exclusive:n,reverse:s};return H.runKernel(Rx,a,o)}const w3=ee({cumsum_:gee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t,e,n,s=!1){const r=U(t,"x","denseBincount"),a=U(e,"weights","denseBincount");R(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),R(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const o={x:r,weights:a},l={size:n,binaryOutput:s};return H.runKernel(y2,o,l)}const v3=ee({denseBincount_:xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(t,e,n="NHWC"){const s=U(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],a=n==="NHWC"?s.shape[2]:s.shape[3],o=n==="NHWC"?s.shape[3]:s.shape[1];R(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),R(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),R(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${s.shape}`),R(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${s.shape}`);const l={x:s},c={blockSize:e,dataFormat:n};return H.runKernel(b2,l,c)}const bee=ee({depthToSpace_:yee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t,e,n,s,r="NHWC",a=[1,1],o){const l=U(t,"x","depthwiseConv2d","float32"),c=U(e,"filter","depthwiseConv2d","float32");let u=l,d=!1;l.rank===3&&(d=!0,u=Q(l,[1,l.shape[0],l.shape[1],l.shape[2]])),R(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),R(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const m=r==="NHWC"?u.shape[3]:u.shape[1];R(m===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${m}) must match the inChannels dimension in filter ${c.shape[2]}.`),Ys("depthwiseConv2d",s,o);const h={x:u,filter:c},p={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o},f=H.runKernel(_x,h,p);return d?Q(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const bN=ee({depthwiseConv2d_:wee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vee(t,e,n,s,r=[1,1],a="NHWC"){const o=U(t,"x","dilation2d"),l=U(e,"filter","dilation2d");R(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),R(l.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${l.rank}.`),R(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let c=o,u=!1;o.rank===3&&(c=Q(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0),R(c.shape[3]===l.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${l.shape[2]}`);const d={x:c,filter:l},m={strides:n,pad:s,dilations:r},h=H.runKernel(Dx,d,m);return u?Q(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Eee=ee({dilation2d_:vee});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cd(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const a=n-1-r,o=t[a]||1;(e[e.length-1-r]||1)>1&&o===1&&s.unshift(a)}return s}function Wn(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],a=e.length-s-1,o=e[a];(r==null||r===1&&o>1)&&n.unshift(a)}return n}function ft(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let a=t[t.length-r-1];a==null&&(a=1);let o=e[e.length-r-1];if(o==null&&(o=1),a===1)s[n-r-1]=o;else if(o===1)s[n-r-1]=a;else if(a!==o){const l=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(l)}else s[n-r-1]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nee(t,e){let n=U(t,"a","equal","string_or_numeric"),s=U(e,"b","equal","string_or_numeric");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Px,r)}const fo=ee({equal_:Nee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(t,e,n){const s=U(e,"a","where"),r=U(n,"b","where"),a=U(t,"condition","where","bool"),o=ft(ft(a.shape,s.shape),r.shape),l=Mp(a,o),c=Mp(s,o),u=Mp(r,o),d={condition:l,t:c,e:u};return H.runKernel(uy,d)}const Ps=ee({where_:kee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(t){const n={x:U(t,"x","zerosLike")};return H.runKernel(yy,n)}const Rt=ee({zerosLike_:See});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t,e){let n=U(t,"a","div"),s=U(e,"b","div");[n,s]=In(n,s);const r=rt(n,s),a=Rt(r),o=fo(s,a);return Ps(o,a,r)}const Iee=ee({divNoNan_:Cee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t,e){const n=U(t,"t1","dot"),s=U(e,"t2","dot");R((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],a=s.rank===1?s.size:s.shape[0];if(R(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),n.rank===1&&s.rank===1){const o=Q(n,[1,-1]),l=Q(s,[-1,1]),c=Bt(o,l);return Q(c,[])}else if(n.rank===1&&s.rank===2){const o=Q(n,[1,-1]),l=Q(s,[s.shape[0],s.shape[1]]),c=Bt(o,l);return Q(c,[c.size])}else if(n.rank===2&&s.rank===1){const o=Q(s,[-1,1]),l=Bt(n,o);return Q(l,[l.size])}else{const o=Q(s,[s.shape[0],s.shape[1]]);return Bt(n,o)}}const Tee=ee({dot_:$ee});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t,...e){const n=e.map((r,a)=>U(r,`tensors${a}`,"einsum")),s={equation:t};return H.runKernel(k2,n,s)}const Op=ee({einsum_:Aee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ree(t){const n={x:U(t,"x","elu","float32")};return H.runKernel(Hh,n)}const Dy=ee({elu_:Ree});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t){let e=U(t,"x","erf");R(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ue(e,"float32"));const n={x:e};return H.runKernel(qh,n)}const E3=ee({erf_:_ee});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wN(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function N3(t,e,n){const s=t.length+e.length,r=[];let a=0,o=0;for(let l=0;l<s;l++)n.indexOf(l)===-1?r.push(t[a++]):r.push(e[o++]);return r}function Qn(t,e){const n=[],s=t.length;for(let a=0;a<s;a++)e.indexOf(a)===-1&&n.push(t[a]);const r=e.map(a=>t[a]);return[n,r]}function On(t,e){const n=e.map(s=>1);return N3(t,n,e)}function cs(t,e,n){R(wN(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function yn(t,e){if(wN(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function dl(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function $n(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dee(t,e=null,n=!1){const r={x:U(t,"x","max")},a={reductionIndices:e,keepDims:n};return H.runKernel(Hx,r,a)}const Oa=ee({max_:Dee});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t,e=null,n=!1){const r={x:U(t,"x","min")},a={axis:e,keepDims:n};return H.runKernel(Yx,r,a)}const Py=ee({min_:Pee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t,e){let n=U(t,"base","pow"),s=U(e,"exp","pow");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(cp,r)}const Pc=ee({pow_:Fee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ut(t,e){if((sa(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&sa(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return $y(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(t){const n={x:U(t,"x","sqrt","float32")};return H.runKernel(vp,n)}const Es=ee({sqrt_:Mee});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oee(t){const e=U(t,"x","square"),n={};return H.runKernel("Square",{x:e},n)}const un=ee({square_:Oee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lee(t,e=null,n=!1){let s=U(t,"x","sum");s.dtype==="bool"&&(s=Ue(s,"int32"));const r={x:s},a={axis:e,keepDims:n};return H.runKernel(my,r,a)}const st=ee({sum_:Lee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zee(t,e="euclidean",n=null,s=!1){t=U(t,"x","norm");const r=k3(t,e,n);let a=r.shape;if(s){const o=Et(n,t.shape);a=On(r.shape,o)}return Q(r,a)}function k3(t,e,n=null){if(t.rank===0)return Ds(t);if(t.rank!==1&&n===null)return k3(Q(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return st(Ds(t),n);if(e===1/0)return Oa(Ds(t),n);if(e===-1/0)return Py(Ds(t),n);if(e==="euclidean"||e===2)return Es(st(Pc(Ds(t),Ut(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Oa(st(Ds(t),n[0]),n[1]-1);if(e===1/0)return Oa(st(Ds(t),n[1]),n[0]);if(e===-1/0)return Py(st(Ds(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Es(st(un(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Fy=ee({norm_:zee});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bee(t,e=null,n=!1){return Fy(t,"euclidean",e,n)}const Uee=ee({euclideanNorm_:Bee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(t){const n={x:U(t,"x","exp")};return H.runKernel(Kh,n)}const go=ee({exp_:Vee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t,e=0){const n=U(t,"x","expandDims","string_or_numeric");R(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return H.runKernel(Fx,s,r)}const Js=ee({expandDims_:Wee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t){const n={x:U(t,"x","expm1")};return H.runKernel(Xh,n)}const Gee=ee({expm1_:jee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t,e){const n=U(t,"x","tile","string_or_numeric");R(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return H.runKernel(Cp,s,r)}const La=ee({tile_:Hee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(t,e,n,s="float32"){e==null&&(e=t);const r=Nt([t,e],s),a=t<=e?t:e;for(let l=0;l<a;++l)r.set(1,l,l);const o=Q(r.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return La(Js(o,0),[n[0],1,1]);if(n.length===2)return La(Js(Js(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return La(Js(Js(Js(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const S3=ee({eye_:qee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kee(t){const n={x:U(t,"x","floor","float32")};return H.runKernel(Yh,n)}const My=ee({floor_:Kee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t,e,n=0,s=0){const r=U(t,"x","gather"),a=U(e,"indices","gather","int32"),o={x:r,indices:a},l={axis:n,batchDims:s};return H.runKernel(Ox,o,l)}const vN=ee({gather_:Xee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(t,e){let n=U(t,"a","greater","string_or_numeric"),s=U(e,"b","greater","string_or_numeric");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Lx,r)}const Dr=ee({greater_:Yee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(t,e){let n=U(t,"a","greaterEqual","string_or_numeric"),s=U(e,"b","greaterEqual","string_or_numeric");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Jh,r)}const Fc=ee({greaterEqual_:Zee});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jee(t){const n={input:U(t,"input","imag")};return H.runKernel(A2,n)}const EN=ee({imag_:Jee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qee(t){const n={x:U(t,"x","isFinite")};return H.runKernel(ep,n)}const ete=ee({isFinite_:Qee});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tte(t){const n={x:U(t,"x","isInf")};return H.runKernel(tp,n)}const nte=ee({isInf_:tte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ste(t){const n={x:U(t,"x","isNaN")};return H.runKernel(np,n)}const rte=ee({isNaN_:ste});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ate(t,e=.2){const s={x:U(t,"x","leakyRelu")},r={alpha:e};return H.runKernel(zx,s,r)}const NN=ee({leakyRelu_:ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ote(t,e){let n=U(t,"a","less","string_or_numeric"),s=U(e,"b","less","string_or_numeric");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Bx,r)}const Oy=ee({less_:ote});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(t,e){let n=U(t,"a","lessEqual","string_or_numeric"),s=U(e,"b","lessEqual","string_or_numeric");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Ux,r)}const Id=ee({lessEqual_:ite});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lte(t,e=5,n=1,s=1,r=.5){const a=U(t,"x","localResponseNormalization");R(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),R(md(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=a,l=!1;a.rank===3&&(l=!0,o=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={x:o},u={depthRadius:e,bias:n,alpha:s,beta:r},d=H.runKernel(Gx,c,u);return l?Q(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const cte=ee({localResponseNormalization_:lte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ute(t){const n={x:U(t,"x","log","float32")};return H.runKernel(sp,n)}const xo=ee({log_:ute});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dte(t){const n={x:U(t,"x","log1p")};return H.runKernel(rp,n)}const C3=ee({log1p_:dte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mte(t,e){R(QE(t),()=>"The f passed in variableGrads(f) must be a function"),R(e==null||Array.isArray(e)&&e.every(u=>u instanceof Cy),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in H.registeredVariables)e.push(H.registeredVariables[u])}const s=n?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),R(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:o,grads:l}=H.gradients(t,e,null,a);R(l.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),R(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const c={};return e.forEach((u,d)=>{l[d]!=null&&(c[u.name]=l[d])}),s?.forEach(u=>c[u.name]=null),{value:o,grads:c}}function $d(t){return H.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(t){const n={x:U(t,"x","neg")};return H.runKernel(Jx,n)}const Tn=ee({neg_:hte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pte(t){const n={x:U(t,"x","softplus")};return H.runKernel(wp,n)}const Lp=ee({softplus_:pte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fte(t){const e=U(t,"x","logSigmoid");return $d(s=>({value:Tn(Lp(Tn(s))),gradFunc:o=>G(o,Sd(Tn(s)))}))(e)}const gte=ee({logSigmoid_:fte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xte(t,e){let n=U(t,"a","sub"),s=U(e,"b","sub");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(Np,r)}const lt=ee({sub_:xte});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yte(t,e=-1){const n=U(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return $d((r,a)=>{const l=Oa(r,e,!0),c=lt(r,l),u=lt(Ue(c,"float32"),xo(st(go(c),e,!0)));return a([u]),{value:u,gradFunc:(m,h)=>{const[p]=h,f=!0,y=go(p);return lt(m,G(st(m,e,f),y))}}})(n)}const I3=ee({logSoftmax_:yte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bte(t,e=null,n=!1){const s=U(t,"x","logSumExp"),r=Et(e,s.shape),a=Oa(s,r,!0),o=lt(s,a),l=go(o),c=st(l,r),u=xo(c),d=Ce(Q(a,u.shape),u);if(n){const m=On(d.shape,r);return Q(d,m)}return d}const $3=ee({logSumExp_:bte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wte(t,e){const n=U(t,"a","logicalAnd","bool"),s=U(e,"b","logicalAnd","bool");ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Vx,r)}const pi=ee({logicalAnd_:wte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vte(t){const n={x:U(t,"x","logicalNot","bool")};return H.runKernel(Wx,n)}const kN=ee({logicalNot_:vte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ete(t,e){const n=U(t,"a","logicalOr","bool"),s=U(e,"b","logicalOr","bool");ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(jx,r)}const T3=ee({logicalOr_:Ete});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nte(t,e){const n=U(t,"a","logicalXor","bool"),s=U(e,"b","logicalXor","bool");return ft(n.shape,s.shape),pi(T3(t,e),kN(pi(t,e)))}const kte=ee({logicalXor_:Nte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ste(t,e,n,s,r){const a=U(t,"x","maxPool"),o=1;let l=a,c=!1;a.rank===3&&(c=!0,l=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(l.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.rank}.`),R(vs(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Ys("maxPool",s,r);const u={x:l},d={filterSize:e,strides:n,pad:s,dimRoundingMode:r},m=H.runKernel(qx,u,d);return c?Q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const SN=ee({maxPool_:Ste});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cte(t,e=[1,1,1],n,s,r,a="NDHWC"){const o=U(t,"x","maxPool3d");let l=o,c=!1;o.rank===4&&(c=!0,l=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(l.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),R(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Ys("maxPool3d",s,r);const u={x:l},d={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:a},m=H.runKernel(Kx,u,d);return c?Q(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const Ite=ee({maxPool3d_:Cte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $te(t,e){let n=U(t,"a","maximum"),s=U(e,"b","maximum");[n,s]=In(n,s),n.dtype==="bool"&&(n=Ue(n,"int32"),s=Ue(s,"int32")),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(ap,r)}const ml=ee({maximum_:$te});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tte(t,e=null,n=!1){const r={x:U(t,"x","mean")},a={axis:e,keepDims:n};return H.runKernel(Xx,r,a)}const Ln=ee({mean_:Tte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function es(t,e="float32"){if(ui(t),e==="complex64"){const s=es(t,"float32"),r=es(t,"float32");return Cc(s,r)}const n=ws(ue(t),e);return H.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hl(t,e="float32"){if(ui(t),e==="complex64"){const s=hl(t,"float32"),r=es(t,"float32");return Cc(s,r)}const n=t2(ue(t),e);return H.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(t,e){let n=U(t,"a","minimum"),s=U(e,"b","minimum");[n,s]=In(n,s),n.dtype==="bool"&&(n=Ue(n,"int32"),s=Ue(s,"int32")),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(op,r)}const zp=ee({minimum_:Ate});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rte(t,e,n){R(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=U(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");R(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let l=0;l<s.rank;l++)R(e[l].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),R(e[l][0]>=0&&e[l][0]<=s.shape[l]-r&&e[l][1]>=0&&e[l][1]<=s.shape[l]-r,()=>`Padding in dimension ${l} cannot be greater than or equal to ${s.shape[l]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:e,mode:n},o={x:s};return H.runKernel(Zx,o,a)}const _te=ee({mirrorPad_:Rte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dte(t,e){let n=U(t,"a","mod"),s=U(e,"b","mod");[n,s]=In(n,s);const r={a:n,b:s};return H.runKernel(ip,r)}const Pte=ee({mod_:Dte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fte(t,e=null,n=!1){t=U(t,"x","moments");const s=Et(e,t.shape),r=Ln(t,s,n);let a=r.shape;n||(a=On(r.shape,s));const o=un(lt(Ue(t,"float32"),Q(r,a))),l=Ln(o,s,n);return{mean:r,variance:l}}const CN=ee({moments_:Fte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mte(t,e){let n=U(t,"a","notEqual","string_or_numeric"),s=U(e,"b","notEqual","string_or_numeric");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s};return H.runKernel(Qx,r)}const Ly=ee({notEqual_:Mte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ote(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const o={indices:U(t,"indices","oneHot","int32")},l={dtype:r,depth:e,onValue:n,offValue:s};return H.runKernel(ty,o,l)}const A3=ee({oneHot_:Ote});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lte(t){const n={x:U(t,"x","onesLike")};return H.runKernel(ey,n)}const aa=ee({onesLike_:Lte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zte(t,e,n=0){const s=U(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},a={x:s};return H.runKernel(sy,a,r)}const IN=ee({pad_:zte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bte(t,e,n){const s=U(t,"x","spaceToBatchND");R(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),R(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),R(s.shape.reduce((o,l,c)=>c>0&&c<=e.length?o&&(l+n[c-1][0]+n[c-1][1])%e[c-1]===0:o,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},a={blockShape:e,paddings:n};return H.runKernel(hy,r,a)}const $N=ee({spaceToBatchND_:Bte});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(t,e,n,s,r,a,o){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const l=U(t,"x","maxPool");let c=l,u=!1;l.rank===3&&(u=!0,c=Q(l,[1,l.shape[0],l.shape[1],l.shape[2]])),R(vs(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const d=ra(c.shape,e,a,r,s),m=[d.dilationHeight,d.dilationWidth];let h;s==="same"?h=Wte([d.filterHeight,d.filterWidth],m):h=[[0,0],[0,0]];const p=m[0]===1&&m[1]===1,[f,y]=Vte([d.inHeight,d.inWidth],m,h),x=p?s:"valid",g=p?c:$N(c,m,f),w=(n==="avg"?()=>pN(g,e,a,x,o):()=>SN(g,e,a,x,o))(),v=p?w:fN(w,m,y);return u?Q(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function Vte(t,e,n){const s=n.map(d=>d[0]),r=n.map(d=>d[1]),a=t.concat(s,r),o=e.map((d,m)=>(d-a[m]%d)%d),l=r.map((d,m)=>d+o[m]),c=e.map((d,m)=>[s[m],l[m]]),u=e.map((d,m)=>[0,o[m]]);return[c,u]}function Wte(t,e){const s=t.map((o,l)=>o+(o-1)*(e[l]-1)).map(o=>o-1),r=s.map(o=>Math.floor(o/2)),a=s.map((o,l)=>o-r[l]);return s.map((o,l)=>[r[l],a[l]])}const jte=ee({pool_:Ute});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gte(t,e){const n=U(t,"x","prelu"),s=U(e,"alpha","prelu"),r={x:n,alpha:s};return H.runKernel(ry,r)}const TN=ee({prelu_:Gte});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hte(t,e=null,n=!1){let s=U(t,"x","prod");s.dtype==="bool"&&(s=Ue(s,"int32"));const r={x:s},a={axis:e,keepDims:n};return H.runKernel(ay,r,a)}const qte=ee({prod_:Hte});var AN={exports:{}};AN.exports,function(t){(function(e,n,s){function r(c){var u=this,d=l();u.next=function(){var m=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=m-(u.c=m|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(c),u.s0<0&&(u.s0+=1),u.s1-=d(c),u.s1<0&&(u.s1+=1),u.s2-=d(c),u.s2<0&&(u.s2+=1),d=null}function a(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function o(c,u){var d=new r(c),m=u&&u.state,h=d.next;return h.int32=function(){return d.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,m&&(typeof m=="object"&&a(m,d),h.state=function(){return a(d,{})}),h}function l(){var c=4022871197,u=function(d){d=String(d);for(var m=0;m<d.length;m++){c+=d.charCodeAt(m);var h=.02519603282416938*c;c=h>>>0,h-=c,h*=c,c=h>>>0,h-=c,c+=h*4294967296}return(c>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:this.alea=o})(Ml,t)}(AN);var Kte=AN.exports,RN={exports:{}};RN.exports,function(t){(function(e,n,s){function r(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var m=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^m^m>>>8},l===(l|0)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=u.charCodeAt(d)|0,c.next()}function a(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function o(l,c){var u=new r(l),d=c&&c.state,m=function(){return(u.next()>>>0)/4294967296};return m.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},m.int32=u.next,m.quick=m,d&&(typeof d=="object"&&a(d,u),m.state=function(){return a(u,{})}),m}n&&n.exports?n.exports=o:this.xor128=o})(Ml,t)}(RN);var Xte=RN.exports,_N={exports:{}};_N.exports,function(t){(function(e,n,s){function r(l){var c=this,u="";c.next=function(){var m=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(m^m<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:u+=l;for(var d=0;d<u.length+64;d++)c.x^=u.charCodeAt(d)|0,d==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function a(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function o(l,c){var u=new r(l),d=c&&c.state,m=function(){return(u.next()>>>0)/4294967296};return m.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},m.int32=u.next,m.quick=m,d&&(typeof d=="object"&&a(d,u),m.state=function(){return a(u,{})}),m}n&&n.exports?n.exports=o:this.xorwow=o})(Ml,t)}(_N);var Yte=_N.exports,DN={exports:{}};DN.exports,function(t){(function(e,n,s){function r(l){var c=this;c.next=function(){var d=c.x,m=c.i,h,p;return h=d[m],h^=h>>>7,p=h^h<<24,h=d[m+1&7],p^=h^h>>>10,h=d[m+3&7],p^=h^h>>>3,h=d[m+4&7],p^=h^h<<7,h=d[m+7&7],h=h^h<<13,p^=h^h<<9,d[m]=p,c.i=m+1&7,p};function u(d,m){var h,p=[];if(m===(m|0))p[0]=m;else for(m=""+m,h=0;h<m.length;++h)p[h&7]=p[h&7]<<15^m.charCodeAt(h)+p[h+1&7]<<13;for(;p.length<8;)p.push(0);for(h=0;h<8&&p[h]===0;++h);for(h==8?p[7]=-1:p[h],d.x=p,d.i=0,h=256;h>0;--h)d.next()}u(c,l)}function a(l,c){return c.x=l.x.slice(),c.i=l.i,c}function o(l,c){l==null&&(l=+new Date);var u=new r(l),d=c&&c.state,m=function(){return(u.next()>>>0)/4294967296};return m.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},m.int32=u.next,m.quick=m,d&&(d.x&&a(d,u),m.state=function(){return a(u,{})}),m}n&&n.exports?n.exports=o:this.xorshift7=o})(Ml,t)}(DN);var Zte=DN.exports,PN={exports:{}};PN.exports,function(t){(function(e,n,s){function r(l){var c=this;c.next=function(){var d=c.w,m=c.X,h=c.i,p,f;return c.w=d=d+1640531527|0,f=m[h+34&127],p=m[h=h+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,f=m[h]=f^p,c.i=h,f+(d^d>>>16)|0};function u(d,m){var h,p,f,y,x,g=[],b=128;for(m===(m|0)?(p=m,m=null):(m=m+"\0",p=0,b=Math.max(b,m.length)),f=0,y=-32;y<b;++y)m&&(p^=m.charCodeAt((y+32)%m.length)),y===0&&(x=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,y>=0&&(x=x+1640531527|0,h=g[y&127]^=p+x,f=h==0?f+1:0);for(f>=128&&(g[(m&&m.length||0)&127]=-1),f=127,y=4*128;y>0;--y)p=g[f+34&127],h=g[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,g[f]=p^h;d.w=x,d.X=g,d.i=f}u(c,l)}function a(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function o(l,c){l==null&&(l=+new Date);var u=new r(l),d=c&&c.state,m=function(){return(u.next()>>>0)/4294967296};return m.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},m.int32=u.next,m.quick=m,d&&(d.X&&a(d,u),m.state=function(){return a(u,{})}),m}n&&n.exports?n.exports=o:this.xor4096=o})(Ml,t)}(PN);var Jte=PN.exports,FN={exports:{}};FN.exports,function(t){(function(e,n,s){function r(l){var c=this,u="";c.next=function(){var m=c.b,h=c.c,p=c.d,f=c.a;return m=m<<25^m>>>7^h,h=h-p|0,p=p<<24^p>>>8^f,f=f-m|0,c.b=m=m<<20^m>>>12^h,c.c=h=h-p|0,c.d=p<<16^h>>>16^f,c.a=f-m|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):u+=l;for(var d=0;d<u.length+20;d++)c.b^=u.charCodeAt(d)|0,c.next()}function a(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function o(l,c){var u=new r(l),d=c&&c.state,m=function(){return(u.next()>>>0)/4294967296};return m.double=function(){do var h=u.next()>>>11,p=(u.next()>>>0)/4294967296,f=(h+p)/(1<<21);while(f===0);return f},m.int32=u.next,m.quick=m,d&&(typeof d=="object"&&a(d,u),m.state=function(){return a(u,{})}),m}n&&n.exports?n.exports=o:this.tychei=o})(Ml,t)}(FN);var Qte=FN.exports,R3={exports:{}};const ene=zB(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));(function(t){(function(e,n,s){var r=256,a=6,o=52,l="random",c=s.pow(r,a),u=s.pow(2,o),d=u*2,m=r-1,h;function p(v,E,k){var C=[];E=E==!0?{entropy:!0}:E||{};var I=g(x(E.entropy?[v,w(n)]:v??b(),3),C),A=new f(C),$=function(){for(var T=A.g(a),F=c,O=0;T<u;)T=(T+O)*r,F*=r,O=A.g(1);for(;T>=d;)T/=2,F/=2,O>>>=1;return(T+O)/F};return $.int32=function(){return A.g(4)|0},$.quick=function(){return A.g(4)/4294967296},$.double=$,g(w(A.S),n),(E.pass||k||function(T,F,O,M){return M&&(M.S&&y(M,A),T.state=function(){return y(A,{})}),O?(s[l]=T,F):T})($,I,"global"in E?E.global:this==s,E.state)}function f(v){var E,k=v.length,C=this,I=0,A=C.i=C.j=0,$=C.S=[];for(k||(v=[k++]);I<r;)$[I]=I++;for(I=0;I<r;I++)$[I]=$[A=m&A+v[I%k]+(E=$[I])],$[A]=E;(C.g=function(T){for(var F,O=0,M=C.i,B=C.j,L=C.S;T--;)F=L[M=m&M+1],O=O*r+L[m&(L[M]=L[B=m&B+F])+(L[B]=F)];return C.i=M,C.j=B,O})(r)}function y(v,E){return E.i=v.i,E.j=v.j,E.S=v.S.slice(),E}function x(v,E){var k=[],C=typeof v,I;if(E&&C=="object")for(I in v)try{k.push(x(v[I],E-1))}catch{}return k.length?k:C=="string"?v:v+"\0"}function g(v,E){for(var k=v+"",C,I=0;I<k.length;)E[m&I]=m&(C^=E[m&I]*19)+k.charCodeAt(I++);return w(E)}function b(){try{var v;return h&&(v=h.randomBytes)?v=v(r):(v=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(v)),w(v)}catch{var E=e.navigator,k=E&&E.plugins;return[+new Date,e,k,e.screen,w(n)]}}function w(v){return String.fromCharCode.apply(0,v)}if(g(s.random(),n),t.exports){t.exports=p;try{h=ene}catch{}}else s["seed"+l]=p})(typeof self<"u"?self:Ml,[],Math)})(R3);var tne=R3.exports,nne=Kte,sne=Xte,rne=Yte,ane=Zte,one=Jte,ine=Qte,Mc=tne;Mc.alea=nne,Mc.xor128=sne,Mc.xorwow=rne,Mc.xorshift7=ane,Mc.xor4096=one,Mc.tychei=ine;var MN=Mc;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _3{constructor(e,n,s,r,a){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=a||Math.random();this.random=MN.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,a,o;do r=2*this.random()-1,a=2*this.random()-1,o=r*r+a*a;while(o>=1||o===0);const l=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*l,n=this.mean+this.stdDev*a*l,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class lne{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=MN.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cne(t,e=0,n=1,s,r){if(ui(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new _3(e,n,s,!1,r),o=Nt(t,s);for(let l=0;l<o.values.length;l++)o.values[l]=a.nextValue();return o.toTensor()}const une=ee({randomNormal_:cne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dne(t,e=0,n=1,s="float32",r){ui(t);const a=Nt(t,s),o=new lne(e,n,null,r);for(let l=0;l<a.values.length;l++)a.values[l]=o.nextValue();return a.toTensor()}const Bp=ee({randomUniform_:dne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Up(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return H.runKernel(O2,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mne(t){const n={input:U(t,"input","real")};return H.runKernel(L2,n)}const zy=ee({real_:mne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hne(t){const n={x:U(t,"x","reciprocal")};return H.runKernel(up,n)}const pne=ee({reciprocal_:hne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fne(t){const n={x:U(t,"x","relu")};return H.runKernel(dp,n)}const Oc=ee({relu_:fne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(t){const n={x:U(t,"x","relu6")};return H.runKernel(mp,n)}const D3=ee({relu6_:gne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(t,e){const s={x:U(t,"x","reverse")},r={dims:e};return H.runKernel(cy,s,r)}const Lc=ee({reverse_:xne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yne(t){const n={x:U(t,"x","round")};return H.runKernel(hp,n)}const P3=ee({round_:yne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(t){const n={x:U(t,"x","rsqrt","float32")};return H.runKernel(pp,n)}const F3=ee({rsqrt_:bne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(t){const n={x:U(t,"x","selu")};return H.runKernel(fp,n)}const M3=ee({selu_:wne});function vne(t,e,n,s,r,a=[1,1],o="NHWC"){const l=U(t,"x","separableConv2d"),c=U(e,"depthwiseFilter","separableConv2d"),u=U(n,"pointwiseFilter","separableConv2d");let d=l,m=!1;if(l.rank===3&&(m=!0,d=Q(l,[1,l.shape[0],l.shape[1],l.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");R(d.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),R(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),R(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),R(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),R(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const h=c.shape[2],p=c.shape[3];R(u.shape[2]===h*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${u.shape[2]}.`);const f=bN(d,c,s,r,o,a),x=Dc(f,u,1,"valid",o);return m?Q(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const O3=ee({separableConv2d_:vne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(t){const n={x:U(t,"x","sign")};return H.runKernel(yp,n)}const Nne=ee({sign_:Ene});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(t){const n={x:U(t,"x","sin","float32")};return H.runKernel(gp,n)}const L3=ee({sin_:kne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sne(t){const n={x:U(t,"x","sinh")};return H.runKernel(xp,n)}const z3=ee({sinh_:Sne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cne(t,e,n){const s=U(t,"x","slice1d");return R(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),sn(s,[e],[n])}const ON=ee({slice1d_:Cne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ine(t,e,n){const s=U(t,"x","slice2d");return R(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),sn(s,e,n)}const B3=ee({slice2d_:Ine});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(t,e,n){const s=U(t,"x","slice3d");return R(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),sn(s,e,n)}const LN=ee({slice3d_:$ne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,e,n){const s=U(t,"x","slice4d");return R(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),sn(s,e,n)}const By=ee({slice4d_:Tne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(t,e=-1){const n=U(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return H.runKernel(fy,s,r)}const zN=ee({softmax_:Ane});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rne(t){R(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return H.runKernel(C2,e)}const U3=ee({fft_:Rne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ne(t){R(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return H.runKernel(T2,e)}const BN=ee({ifft_:_ne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dne(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=Q(t,[n,e]);s=BN(r)}else{const r=[n,2*(e-1)],a=Q(zy(t),[n,e]),o=Q(EN(t),[n,e]),l=Lc(sn(a,[0,1],[n,e-2]),1),c=G(Lc(sn(o,[0,1],[n,e-2]),1),Ut(-1)),u=Zs([a,l],1),d=Zs([o,c],1),m=Q(Cc(u,d),[r[0],r[1]]);s=BN(m)}if(s=zy(s),t.rank===3&&t.shape[0]!==0){const r=s,a=t.shape[0];s=Q(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const Pne=ee({irfft_:Dne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fne(t,e,n=0){const r={x:U(t,"x","split")},a={numOrSizeSplits:e,axis:n};return H.runKernel(py,r,a)}const Pr=ee({split_:Fne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mne(t,e){R(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const f=t.shape.map(x=>0),y=t.shape.map(x=>x);y[t.shape.length-1]=e,r=sn(t,f,y),n=e}else if(e!=null&&e>n){const f=t.shape.map(y=>y);f[t.shape.length-1]=e-n,r=Zs([t,es(f)],t.shape.length-1),n=e}else r=t;const a=Rt(r),o=Q(Cc(r,a),[s,n]),l=U3(o),c=Math.floor(n/2)+1,u=zy(l),d=EN(l),m=Pr(u,[c,n-c],u.shape.length-1),h=Pr(d,[c,n-c],d.shape.length-1),p=r.shape.slice();return p[r.shape.length-1]=c,Q(Cc(m[0],h[0]),p)}const One=ee({rfft_:Mne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lne(t,e){let n=U(t,"a","squaredDifference"),s=U(e,"b","squaredDifference");[n,s]=In(n,s),ft(n.shape,s.shape);const r={a:n,b:s},a={};return H.runKernel(Ep,r,a)}const zne=ee({squaredDifference_:Lne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bne(t,e){const n=U(t,"x","squeeze","string_or_numeric");return Q(n,sl(n.shape,e).newShape)}const Vp=ee({squeeze_:Bne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Une(t,e=0){const n=t3(t,"tensors","stack","string_or_numeric");R(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&R(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return H.runKernel(ny,s,r)}const fi=ee({stack_:Une});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(t,e=0){const s={x:U(t,"x","step")},r={alpha:e};return H.runKernel(Ip,s,r)}const Wp=ee({step_:Vne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(t,e,n,s,r=0,a=0,o=0,l=0,c=0){const d={x:U(t,"x","stridedSlice","string_or_numeric")},m={begin:e,end:n,strides:s,beginMask:r,endMask:a,ellipsisMask:o,newAxisMask:l,shrinkAxisMask:c};return H.runKernel(W2,d,m)}const jne=ee({stridedSlice_:Wne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gne(t){const n={x:U(t,"x","tan","float32")};return H.runKernel(kp,n)}const Hne=ee({tan_:Gne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fr(t,e){HD(t);const n=Iy(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return $y(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UN(t,e,n){if(HD(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Iy(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return $y(t,e,s,n)}function V3(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(a+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(a+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(a+` update.rank != ${r+t.length-s}`);for(let o=0;o<r;++o)if(n.shape[o]!==e.shape[o])throw new Error(a+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-r;++o)if(n.shape[o+r]!==t[o+s])throw new Error(a+` updates.shape[${o+r}] (${n.shape[o+r]}) != shape[${o+r}] (${t[o+r]})`)}function qne(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}V3(n,e,t)}function zc(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,a=n.length;let o=1;for(let m=r;m<a;++m)o*=n[m];const l=r<1?1:r,c=ue(e.shape)/l,u=[...nt(n.slice(0,r)),1],d=ue(n);return{sliceRank:r,numUpdates:c,sliceSize:o,strides:u,outputSize:d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(t,e=1,n=!0){const s=U(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const a={x:s},o={k:e,sorted:n},[l,c]=H.runKernel(j2,a,o);return{values:l,indices:c}}const Xne=ee({topk_:Kne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yne(t,e=0,n=1,s,r){if(ui(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new _3(e,n,s,!0,r),o=Nt(t,s);for(let l=0;l<o.values.length;l++)o.values[l]=a.nextValue();return o.toTensor()}const W3=ee({truncatedNormal_:Yne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zne(t,e=0){const n=U(t,"x","unique","string_or_numeric");R(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[a,o]=H.runKernel(H2,s,r);return{values:a,indices:o}}const Jne=ee({unique_:Zne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qne(t,e,n){const s=U(t,"x","unsortedSegmentSum"),r=U(e,"segmentIds","unsortedSegmentSum","int32");R(md(n),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},o={numSegments:n};return H.runKernel(xy,a,o)}const j3=ee({unsortedSegmentSum_:Qne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ese(t,e=0){const n=U(t,"x","unstack","string_or_numeric");R(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return H.runKernel(gy,s,r)}const Bc=ee({unstack_:ese});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tse(t,e=!0,n,s){return H.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G3(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const s=Nt(t,"int32"),r=Nt([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const o=s.indexToLoc(n[a]),l=a*t.length;r.values.set(o,l)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nse(t,e,n){const s=U(t,"x","transpose");if(e==null&&(e=s.shape.map((o,l)=>l).reverse()),R(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(o=>{R(o>=0&&o<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:e};return s.dtype==="complex64"?re(()=>{let o=zy(s),l=EN(s);return o=H.runKernel(xd,{x:o},a),l=H.runKernel(xd,{x:l},a),n&&(l=Tn(l)),Cc(o,l)}):H.runKernel(xd,r,a)}const _t=ee({transpose_:nse});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(t,e){if(e==null)return t.shape.slice();if(zt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rse(t,e,n,s){const r=U(t,"x","dropout");if(R(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),R(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Vn?r.clone():r;const a=sse(r,n),o=1-e,l=rt(My(Ce(Bp(a,0,1,"float32",s),o)),o);return G(r,l)}const ase=ee({dropout_:rse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(t,e,n,s,r,a="NHWC",o){let l=t;t.rank===3&&(l=Q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;c.rank===3&&(c=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]])),R(l.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${l.shape}.`),R(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),R(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=a==="NHWC"?l.shape[3]:l.shape[1],d=a==="NHWC"?c.shape[3]:c.shape[1];R(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),R(d===n[3],()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${n[3]}).`),Ys("conv2dDerFilter",r,o);const m={x:l,dy:c},h={strides:s,pad:r,dataFormat:a,dimRoundingMode:o,filterShape:n};return H.runKernel(h2,m,h)}const VN=ee({conv2DBackpropFilter_:ose});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return G(t,Wp(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function jN(t,e){let n=e;const s=Wn(t.shape,e.shape);return s.length>0&&(n=st(n,s)),Q(n,t.shape)}function GN(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Oc(t);if(e==="elu")return Dy(t);if(e==="relu6")return D3(t);if(e==="prelu")return TN(t,n);if(e==="leakyrelu")return NN(t,s);if(e==="sigmoid")return Sd(t);throw new Error(`Unknown fused activation ${e}.`)}const HN=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ise({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:o,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(c=c||"linear",HN(H.state.gradientDepth,c)===!1){R(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=Dc(t,e,n,s,r,a,o);return l!=null&&(k=Ce(k,l)),GN(k,c,u,d)}const m=U(t,"x","conv2d","float32"),h=U(e,"filter","conv2d","float32");let p=m,f=!1;m.rank===3&&(f=!0,p=Q(m,[1,m.shape[0],m.shape[1],m.shape[2]])),R(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),R(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Ys("fused conv2d",s,o);const y=r==="NHWC"?p.shape[3]:p.shape[1];R(h.shape[2]===y,()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${h.shape[2]}.`),R(vs(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const x=ls(p.shape,h.shape,n,a,s,o);let g;l!=null&&(g=U(l,"bias","fused conv2d"),[g]=In(g,m),r==="NHWC"?ft(x.outShape,g.shape):(R(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),R(g.shape.length===0||g.shape[0]===x.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let b;if(u!=null){const k=u.shape;if(R(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)R(k[0]===1||k[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${x.outChannels}).`);else if(k.length===3)try{ft(k,x.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(I)}b=U(u,"prelu weights","fused conv2d")}const w=(k,C)=>{R(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[I,A,$,T]=C,F=WN(k,$,c);R(Rc(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const O=gN(A.shape,F,I,n,s),M=VN(A,F,I.shape,n,s),B=[O,M];if(T!=null){const L=jN(T,F);B.push(L)}return B},v={x:p,filter:h,bias:g,preluActivationWeights:b},E={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:o,activation:c,leakyreluAlpha:d};return l==null?$d((C,I,A)=>{let $=H.runKernel(wy,v,E);return A([I,C,$]),f&&($=Q($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:w}})(p,h):$d((C,I,A,$)=>{let T=H.runKernel(wy,v,E);return $([I,C,T,A]),f&&(T=Q(T,[T.shape[1],T.shape[2],T.shape[3]])),{value:T,gradFunc:w}})(p,h,g)}const lse=ee({fusedConv2d_:ise});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(t,e,n,s,r,a=[1,1],o){let l=t;t.rank===3&&(l=Q(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;c.rank===3&&(c=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:l,dy:c},d={strides:s,pad:r,dimRoundingMode:o,dilations:a,filterShape:n};return H.runKernel(w2,u,d)}const use=ee({depthwiseConv2dNativeBackpropFilter_:cse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dse(t,e,n,s,r,a=[1,1],o){let l=e,c=!1;e.rank===3&&(c=!0,l=Q(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:l,filter:n},d={strides:s,pad:r,dimRoundingMode:o,dilations:a,inputShape:t},m=H.runKernel(v2,u,d);return c?Q(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const mse=ee({depthwiseConv2dNativeBackpropInput_:dse});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hse({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:o,leakyreluAlpha:l=.2}){if(HN(H.state.gradientDepth,a)===!1){let T=Bt(t,e,n,s);return r!=null&&(T=Ce(T,r)),GN(T,a,o,l)}let c=U(t,"a","fused matMul"),u=U(e,"b","fused matMul");[c,u]=In(c,u);const d=n?c.shape[c.rank-2]:c.shape[c.rank-1],m=s?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?c.shape[c.rank-1]:c.shape[c.rank-2],p=s?u.shape[u.rank-2]:u.shape[u.rank-1],f=c.shape.slice(0,-2),y=u.shape.slice(0,-2),x=ue(f),g=ue(y);R(d===m,()=>`Error in fused matMul: inner shapes (${d}) and (${m}) of Tensors with shapes ${c.shape} and ${u.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=ft(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,p]),v=n?Q(c,[x,d,h]):Q(c,[x,h,d]),E=s?Q(u,[g,p,m]):Q(u,[g,m,p]);let k;r!=null&&(k=U(r,"bias","fused matMul"),[k]=In(k,c),ft(w,k.shape));let C;o!=null&&(C=U(o,"prelu weights","fused matMul"));const I=(T,F)=>{const[O,M,B,L]=F,Y=WN(Q(T,B.shape),B,a);let D,_;if(!n&&!s?(D=Bt(Y,M,!1,!0),_=Bt(O,Y,!0,!1)):!n&&s?(D=Bt(Y,M,!1,!1),_=Bt(Y,O,!0,!1)):n&&!s?(D=Bt(M,Y,!1,!0),_=Bt(O,Y,!1,!1)):(D=Bt(M,Y,!0,!0),_=Bt(Y,O,!0,!0)),r!=null){const P=jN(L,Y);return[D,_,P]}else return[D,_]},A={a:v,b:E,bias:k,preluActivationWeights:C},$={transposeA:n,transposeB:s,activation:a,leakyreluAlpha:l};return r==null?$d((F,O,M)=>{const B=H.runKernel(by,A,$);return M([F,O,B]),{value:Q(B,w),gradFunc:I}})(v,E):$d((F,O,M,B)=>{const L=H.runKernel(by,A,$);return B([F,O,L,M]),{value:Q(L,w),gradFunc:I}})(v,E,k)}const H3=ee({fusedMatMul_:hse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(t,e,n,s,r="bilinear",a=0){const o=U(t,"image","cropAndResize"),l=U(e,"boxes","cropAndResize","float32"),c=U(n,"boxInd","cropAndResize","int32"),u=l.shape[0];R(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),R(l.rank===2&&l.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${l.shape}.`),R(c.rank===1&&c.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${l.shape}.`),R(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),R(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),R(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const d={image:o,boxes:l,boxInd:c},m={method:r,extrapolationValue:a,cropSize:s};return H.runKernel(x2,d,m)}const fse=ee({cropAndResize_:pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gse(t){const e=U(t,"image","flipLeftRight","float32");R(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return H.runKernel($2,n,{})}const xse=ee({flipLeftRight_:gse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yse(t){const e=U(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];R(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),R(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,La(e,r)}const bse=ee({grayscaleToRGB_:yse});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const e=U(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];R(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),R(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,a=Ue(e,"float32"),o=fr([.2989,.587,.114]);let l;switch(e.rank){case 2:l=Op("ij,j->i",a,o);break;case 3:l=Op("ijk,k->ij",a,o);break;case 4:l=Op("ijkl,l->ijk",a,o);break;case 5:l=Op("ijklm,m->ijkl",a,o);break;case 6:l=Op("ijklmn,n->ijklm",a,o);break;default:throw new Error("Not a valid tensor rank.")}return l=Js(l,-1),Ue(l,r)}const vse=ee({rgbToGrayscale_:wse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ese(t,e,n=0,s=.5){const r=U(t,"image","rotateWithOffset","float32");R(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},o={radians:e,fillValue:n,center:s};return H.runKernel(q2,a,o)}const Nse=ee({rotateWithOffset_:Ese});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Td(t,e,n,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const o=t.shape[0];return n=Math.min(n,o),R(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),R(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),R(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),R(e.rank===1,()=>"scores must be a 1D tensor"),R(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),R(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=U(t,"boxes","nonMaxSuppression","float32"),o=U(e,"scores","nonMaxSuppression","float32"),l=Td(a,o,n,s,r);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const c={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return H.runKernel(P2,{boxes:a,scores:o},c)}const Sse=ee({nonMaxSuppression_:kse});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cse(t,e,n){const s=Ise(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Ise(t,e,n){return Tse(t,e,n||$se)}function $se(t,e){return t>e?1:t<e?-1:0}function Tse(t,e,n){let s=0,r=t.length,a=0,o=!1;for(;s<r;){a=s+(r-s>>>1);const l=n(e,t[a]);l>0?s=a+1:(r=a,o=!l)}return o?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qN(t,e,n,s,r){return YN(t,e,n,s,r,0)}function KN(t,e,n,s,r,a){return YN(t,e,n,s,r,0,!1,a,!0)}function XN(t,e,n,s,r,a){return YN(t,e,n,s,r,a,!0)}function YN(t,e,n,s,r,a,o=!1,l=!1,c=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>r&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(q3);const d=a>0?-.5/a:0,m=[],h=[];for(;m.length<n&&u.length>0;){const x=u.pop(),{score:g,boxIndex:b,suppressBeginIndex:w}=x;if(g<r)break;let v=!1;for(let E=m.length-1;E>=w;--E){const k=Ase(t,b,m[E]);if(k>=s){v=!0;break}if(x.score=x.score*Rse(s,d,k),x.score<=r)break}x.suppressBeginIndex=m.length,v||(x.score===g?(m.push(b),h.push(x.score)):x.score>r&&Cse(u,x,q3))}const p=m.length,f=n-p;l&&f>0&&(m.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const y={selectedIndices:m};return o&&(y.selectedScores=h),c&&(y.validOutputs=p),y}function Ase(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),a=Math.min(s[0],s[2]),o=Math.min(s[1],s[3]),l=Math.max(s[0],s[2]),c=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),m=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),p=(l-a)*(c-o),f=(m-u)*(h-d);if(p<=0||f<=0)return 0;const y=Math.max(a,u),x=Math.max(o,d),g=Math.min(l,m),b=Math.min(c,h),w=Math.max(g-y,0)*Math.max(b-x,0);return w/(p+f-w)}function Rse(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function q3(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function _se(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=U(t,"boxes","nonMaxSuppressionAsync"),o=U(e,"scores","nonMaxSuppressionAsync"),l=Td(a,o,n,s,r);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const c=await Promise.all([a.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:m}=qN(u,d,n,s,r);return a!==t&&a.dispose(),o!==e&&o.dispose(),fr(m,"int32")}const Dse=_se;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const o=U(t,"boxes","nonMaxSuppression"),l=U(e,"scores","nonMaxSuppression"),c=Td(o,l,n,s,r,a);n=c.maxOutputSize,s=c.iouThreshold,r=c.scoreThreshold,a=c.softNmsSigma;const u={boxes:o,scores:l},d={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},m=H.runKernel(M2,u,d);return{selectedIndices:m[0],selectedScores:m[1]}}const Fse=ee({nonMaxSuppressionWithScore_:Pse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Mse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const o=U(t,"boxes","nonMaxSuppressionAsync"),l=U(e,"scores","nonMaxSuppressionAsync"),c=Td(o,l,n,s,r,a);n=c.maxOutputSize,s=c.iouThreshold,r=c.scoreThreshold,a=c.softNmsSigma;const u=await Promise.all([o.data(),l.data()]),d=u[0],m=u[1],{selectedIndices:h,selectedScores:p}=XN(d,m,n,s,r,a);return o!==t&&o.dispose(),l!==e&&l.dispose(),{selectedIndices:fr(h,"int32"),selectedScores:fr(p)}}const Ose=Mse;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const o=U(t,"boxes","nonMaxSuppression"),l=U(e,"scores","nonMaxSuppression"),c=Td(o,l,n,s,r,null),u=c.maxOutputSize,d=c.iouThreshold,m=c.scoreThreshold,h={boxes:o,scores:l},p={maxOutputSize:u,iouThreshold:d,scoreThreshold:m,padToMaxOutputSize:a},f=H.runKernel(F2,h,p);return{selectedIndices:f[0],validOutputs:f[1]}}const zse=ee({nonMaxSuppressionPadded_:Lse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Bse(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const o=U(t,"boxes","nonMaxSuppressionAsync"),l=U(e,"scores","nonMaxSuppressionAsync"),c=Td(o,l,n,s,r,null),u=c.maxOutputSize,d=c.iouThreshold,m=c.scoreThreshold,[h,p]=await Promise.all([o.data(),l.data()]),{selectedIndices:f,validOutputs:y}=KN(h,p,u,d,m,a);return o!==t&&o.dispose(),l!==e&&l.dispose(),{selectedIndices:fr(f,"int32"),validOutputs:Ut(y,"int32")}}const Use=Bse;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vse(t,e,n=!1,s=!1){const r=U(t,"images","resizeBilinear");R(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),R(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),R(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,o=!1;r.rank===3&&(o=!0,a=Q(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},c={alignCorners:n,halfPixelCenters:s,size:e},u=H.runKernel(ly,l,c);return o?Q(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const K3=ee({resizeBilinear_:Vse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wse(t,e,n=!1,s=!1){const r=U(t,"images","resizeNearestNeighbor");R(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),R(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),R(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),R(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,o=!1;r.rank===3&&(o=!0,a=Q(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},c={alignCorners:n,halfPixelCenters:s,size:e},u=H.runKernel(iy,l,c);return o?Q(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const X3=ee({resizeNearestNeighbor_:Wse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t,e="binary",n=!1,s=.5){const r=U(t,"image","threshold"),a=.2989,o=.587,l=.114,c=r.shape[0]*r.shape[1];let u=G(fr([s]),255),d,m,h,p;if(R(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),R(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),R(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),R(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[d,m,h]=Pr(r,[1,1,1],-1);const x=G(d,a),g=G(m,o),b=G(h,l);p=Ce(Ce(x,g),b)}else p=t;if(e==="otsu"){const x=GQ(Ue(P3(p),"int32"),Rp([]),256);u=Gse(x,c)}const f=n?Id(p,u):Dr(p,u);return Ue(G(f,255),"int32")}function Gse(t,e){let n=fr([-1]),s=fr([0]),r=fr([0]),a,o,l,c,u,d;for(let m=0;m<t.size-1;m++){a=sn(t,0,m+1),o=sn(t,m+1),u=rt(st(a),e),d=rt(st(o),e);const h=st(G(a,Up(0,a.size)));l=rt(h,st(a));const p=_y(o.shape,a.size),f=Ce(Up(0,o.size),p),y=G(o,f);c=rt(st(y),st(o));const x=lt(l,c),g=lt(l,c),b=G(u,d);r=G(G(b,x),g);const w=Dr(r,s);s=Ps(w,r,s),n=Ps(w,fr([m]),n)}return n}const Hse=ee({threshold_:jse});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qse(t,e,n="nearest",s="constant",r=0,a){const o=U(t,"image","transform","float32"),l=U(e,"transforms","transform","float32");R(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),R(l.rank===2&&(l.shape[0]===o.shape[0]||l.shape[0]===1)&&l.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),R(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const c={image:o,transforms:l},u={interpolation:n,fillMode:s,fillValue:r,outputShape:a};return H.runKernel(G2,c,u)}const Kse=ee({transform_:qse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xse(t,e,n){const s=U(t,"a","bandPart");R(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,o]=s.shape.slice(-2);let l,c;typeof e=="number"?(R(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),R(e<=a,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`),l=U(e<0?a:e,"numLower","bandPart")):(R(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),l=Ps(Oy(e,0),a,zp(e,a))),typeof n=="number"?(R(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),R(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),c=U(n<0?o:n,"numUpper","bandPart")):(R(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),c=Ps(Oy(n,0),o,zp(n,o)));const u=Q(Up(0,a,1,"int32"),[-1,1]),d=Up(0,o,1,"int32"),m=lt(u,d),h=pi(Id(m,l),Fc(m,Tn(c))),p=es([a,o],s.dtype);return Q(fi(Bc(Q(s,[-1,a,o])).map(f=>Ps(h,f,p))),r)}const Yse=ee({bandPart_:Xse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zse(t){let e;if(Array.isArray(t)){e=!1,R(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let a=1;a<t.length;++a)R(t[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[a].shape[0]} vs. ${r})`)}else e=!0,t=Pr(t,t.shape[0],0).map(r=>Vp(r,[0]));R(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(H.tidy(()=>{let a=s[r];if(r>0)for(let o=0;o<r;++o){const l=G(st(G(n[o],a)),n[o]);a=lt(a,l)}return rt(a,Fy(a,"euclidean"))}));return e?fi(n,0):n}const Jse=ee({gramSchmidt_:Zse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t,e=!1){if(R(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return Y3(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((c,u)=>c*u),s=Bc(Q(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],a=[];s.forEach(c=>{const[u,d]=Y3(c,e);r.push(u),a.push(d)});const o=Q(fi(r,0),t.shape),l=Q(fi(a,0),t.shape);return[o,l]}}function Y3(t,e=!1){return H.tidy(()=>{R(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=S3(n),a=Ac(t);const o=UN([[1]],[1,1]);let l=Ac(o);const c=n>=s?s:n;for(let u=0;u<c;++u){const d=a,m=l,h=r;[l,a,r]=H.tidy(()=>{const p=sn(a,[u,u],[n-u,1]),f=Fy(p),y=sn(a,[u,u],[1,1]),x=Ps(Dr(y,0),UN([[-1]]),UN([[1]])),g=lt(y,G(x,f)),b=rt(p,g);b.shape[0]===1?l=Ac(o):l=Zs([o,sn(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const w=Tn(rt(Bt(x,g),f)),v=sn(a,[u,0],[n-u,s]),E=G(w,l),k=_t(l);if(u===0)a=lt(v,Bt(E,Bt(k,v)));else{const A=lt(v,Bt(E,Bt(k,v)));a=Zs([sn(a,[0,0],[u,s]),A],0)}const C=_t(E),I=sn(r,[0,u],[n,r.shape[1]-u]);if(u===0)r=lt(I,Bt(Bt(I,l),C));else{const A=lt(I,Bt(Bt(I,l),C));r=Zs([sn(r,[0,0],[n,u]),A],1)}return[l,a,r]}),vt([d,m,h])}return!e&&n>s&&(r=sn(r,[0,0],[n,s]),a=sn(a,[0,0],[s,s])),[r,a]})}const ere=ee({qr_:Qse});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gi={flipLeftRight:xse,grayscaleToRGB:bse,resizeNearestNeighbor:X3,resizeBilinear:K3,rgbToGrayscale:vse,rotateWithOffset:Nse,cropAndResize:fse,nonMaxSuppression:Sse,nonMaxSuppressionAsync:Dse,nonMaxSuppressionWithScore:Fse,nonMaxSuppressionWithScoreAsync:Ose,nonMaxSuppressionPadded:zse,nonMaxSuppressionPaddedAsync:Use,threshold:Hse,transform:Kse},tre={bandPart:Yse,gramSchmidt:Jse,qr:ere};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nre=new Map,sre=new Map;class Ad{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class oa{constructor(){this.classNameMap={}}static getMap(){return oa.instance==null&&(oa.instance=new oa),oa.instance}static register(e){oa.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ne(t,e,n){R(t.className!=null,()=>"Class being registered does not have the static className property defined."),R(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),R(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return oa.register(t),nre.set(r,t),sre.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pl extends Ad{minimize(e,n=!1,s){const{value:r,grads:a}=this.computeGradients(e,s);if(s!=null){const o=s.map(l=>({name:l.name,tensor:a[l.name]}));this.applyGradients(o)}else this.applyGradients(a);return vt(a),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return mte(e,n)}dispose(){this.iterations_!=null&&vt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ut(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(pl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z3 extends pl{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=H.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s],o=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:re(()=>Rt(a).variable(o))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:re(()=>Rt(a).variable(o))});const l=Array.isArray(e)?e[r].tensor:e[s];if(l==null)return;const c=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;re(()=>{const d=Ce(G(c,this.rho),G(un(l),1-this.rho)),m=G(rt(Es(Ce(u,this.epsilon)),Es(Ce(c,this.epsilon))),l),h=Ce(G(u,this.rho),G(un(m),1-this.rho));c.assign(d),u.assign(h);const p=Ce(G(m,-this.learningRate),a);a.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(vt(this.accumulatedGrads.map(e=>e.variable)),vt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J3 extends pl{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:re(()=>_y(a.shape,this.initialAccumulatorValue).variable(!1))});const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const l=this.accumulatedGrads[r].variable;re(()=>{const c=Ce(l,un(o));l.assign(c);const u=Ce(G(rt(o,Es(Ce(c,H.backend.epsilon()))),-this.learningRate),a);a.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&vt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q3 extends pl{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],re(()=>{this.accBeta1=Ut(n).variable(),this.accBeta2=Ut(s).variable()}),r==null&&(this.epsilon=H.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);re(()=>{const s=lt(1,this.accBeta1),r=lt(1,this.accBeta2);n.forEach((a,o)=>{const l=H.registeredVariables[a],c=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:re(()=>Rt(l).variable(c))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${a}/v`,variable:re(()=>Rt(l).variable(c))});const u=Array.isArray(e)?e[o].tensor:e[a];if(u==null)return;const d=this.accumulatedFirstMoment[o].variable,m=this.accumulatedSecondMoment[o].variable,h=Ce(G(d,this.beta1),G(u,1-this.beta1)),p=Ce(G(m,this.beta2),G(un(u),1-this.beta2)),f=rt(h,s),y=rt(p,r);d.assign(h),m.assign(p);const x=Ce(G(rt(f,Ce(Es(y),this.epsilon)),-this.learningRate),l);l.assign(x)}),this.accBeta1.assign(G(this.accBeta1,this.beta1)),this.accBeta2.assign(G(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&vt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&vt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),re(()=>{this.accBeta1.assign(Pc(this.beta1,this.iterations_+1)),this.accBeta2.assign(Pc(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eP extends pl{static get className(){return"Adamax"}constructor(e,n,s,r=null,a=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],re(()=>{this.iteration=Ut(0).variable(),this.accBeta1=Ut(n).variable()}),r==null&&(this.epsilon=H.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);re(()=>{const s=lt(1,this.accBeta1),r=rt(-this.learningRate,Ce(G(this.iteration,this.decay),1));n.forEach((a,o)=>{const l=H.registeredVariables[a],c=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${a}/m`,variable:Rt(l).variable(c)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${a}/v`,variable:Rt(l).variable(c)});const u=Array.isArray(e)?e[o].tensor:e[a];if(u==null)return;const d=this.accumulatedFirstMoment[o].variable,m=this.accumulatedWeightedInfNorm[o].variable,h=Ce(G(d,this.beta1),G(u,1-this.beta1)),p=G(m,this.beta2),f=Ds(u),y=ml(p,f);d.assign(h),m.assign(y);const x=Ce(G(rt(r,s),rt(h,Ce(y,this.epsilon))),l);l.assign(x)}),this.iteration.assign(Ce(this.iteration,1)),this.accBeta1.assign(G(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&vt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&vt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZN extends pl{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const o=H.registeredVariables[s];re(()=>{const l=Ce(G(this.c,a),o);o.assign(l)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=ho(Ut(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tP extends ZN{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Ut(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:re(()=>Rt(a).variable(!1))});const o=this.accumulations[r].variable,l=Array.isArray(e)?e[r].tensor:e[s];l!=null&&re(()=>{let c;const u=Ce(G(this.m,o),l);this.useNesterov?c=Ce(G(this.c,Ce(l,G(u,this.m))),a):c=Ce(G(this.c,u),a),o.assign(u),a.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&vt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nP extends pl{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=H.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=H.registeredVariables[s],o=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:re(()=>Rt(a).variable(o))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:re(()=>Rt(a).variable(o))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:re(()=>Rt(a).variable(o))});const l=Array.isArray(e)?e[r].tensor:e[s];if(l==null)return;const c=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;re(()=>{const d=Ce(G(c,this.decay),G(un(l),1-this.decay));if(this.centered){const m=this.accumulatedMeanGrads[r].variable,h=Ce(G(m,this.decay),G(l,1-this.decay)),p=rt(G(l,this.learningRate),Es(lt(d,Ce(un(h),this.epsilon)))),f=Ce(G(u,this.momentum),p);c.assign(d),m.assign(h),u.assign(f);const y=lt(a,f);a.assign(y)}else{const m=Ce(G(c,this.decay),G(un(l),1-this.decay)),h=Ce(G(u,this.momentum),rt(G(l,this.learningRate),Es(Ce(m,this.epsilon))));c.assign(m),u.assign(h);const p=lt(a,h);a.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&vt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&vt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&vt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rre=[Z3,J3,Q3,eP,tP,nP,ZN];function are(){for(const t of rre)Ne(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sP(t,e,n,s){o(t),n=n??0,s=s??1,l(n,s);let r=0;const a=c=>(c.then(u=>{const d=n+ ++r/t.length*(s-n);return e(d),u}),c);function o(c){R(c!=null&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")}function l(c,u){R(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),R(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),R(u>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${u}`)}return Promise.all(t.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ore(t,e){e==null&&(e={});const n=e.fetchFunc==null?ie().platform.fetch:e.fetchFunc,s=t.map(m=>n(m,e.requestInit,{isBinary:!0})),l=(e.onProgress==null?await Promise.all(s):await sP(s,e.onProgress,0,.5)).map(m=>m.arrayBuffer());return e.onProgress==null?await Promise.all(l):await sP(l,e.onProgress,.5,1)}function ire(t,e){var n;const s=e.fetchFunc==null?ie().platform.fetch:e.fetchFunc;let r=0,a;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async o=>{for(var l;r<t.length;){a||(a=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:c,value:u}=await a.read();if(c){r++,a=void 0,(l=e.onProgress)===null||l===void 0||l.call(e,r/t.length);continue}o.enqueue(u);return}o.close()}})}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre="application/octet-stream",cre="application/json";class JN{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(R(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ie().platform.fetch,R(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&R(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=CJ(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:cre}),"model.json"),e.weightData!=null){const o=ll.join(e.weightData);n.body.append("model.weights.bin",new Blob([o],{type:lre}),"model.weights.bin")}const a=await this.fetch(this.path,n);if(a.ok)return{modelArtifactsInfo:oN(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let o=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?o+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":o+=" Please make sure the server is serving valid JSON for this request.",new Error(o)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return $J(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=o3(e.weightsManifest),r=()=>ire(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=ure(n),a=this.weightPathPrefix||s,o=[],l=[];for(const c of e)for(const u of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(u)):o.push(a+u+r);return this.weightUrlConverter&&o.push(...await Promise.all(l)),o}async loadWeights(e){const n=await this.getWeightUrls(e),s=o3(e),r=await ore(n,this.loadOptions);return[s,r]}}JN.URL_SCHEME_REGEX=/^https?:\/\//;function ure(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function rP(t){return t.match(JN.URL_SCHEME_REGEX)!=null}const aP=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>rP(s)):n=rP(t),n)return oP(t,e)}return null};Jn.registerSaveRouter(aP),Jn.registerLoadRouter(aP);function oP(t,e){return new JN(t,e)}function dre(t,e){return oP(t,e)}function QN(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(ue(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,a=r[r.length-1];let o=1;for(let m=0;m<r.length-1;++m)o*=r[m];const l=t.shape,c=r.slice();c.pop();let u=1;for(let m=a;m<n;++m)u*=l[m],c.push(l[m]);const d=[...nt(t.shape).map(m=>m/u),1].slice(0,a);return[c,o,u,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ek=-2,mre=-1;function tk(t,e,n){const s=t.shape.length;R(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),R(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)R(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function hre(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function nk(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function iP(t,e,n,s){const r=[...t];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<n;a++)a===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function lP(t,e,n){return n<=t?n:n-(e-1)}function cP(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function pre(t,e,n,s,r,a,o,l,c){const u=t.length;let d=new Array(u),m=new Array(u),h=new Array(u);if(e.length&&n>0){const p=e[0],f=n+1;d=uP(o,p,f,s,t),m=dP(l,p,f,r,t),h=iP(a,p,f,t)}else for(let p=0;p<u;p++)d[p]=hP(o,s,a,t,p,c),m[p]=pP(l,r,a,t,p,c),h[p]=mP(a,p,c);return{begin:d,end:m,strides:h}}function uP(t,e,n,s,r){const a=[...r],o=cP(n,e);for(let l=0;l<a.length;l++)if(o.indexOf(l)>-1)a[l]=0;else{const c=lP(e,n,l);let u=s[c];t&1<<c&&(u=0),a[l]=u}return a}function dP(t,e,n,s,r){const a=[...r],o=cP(n,e);for(let l=0;l<a.length;l++)if(o.indexOf(l)>-1)a[l]=Number.MAX_SAFE_INTEGER;else{const c=lP(e,n,l);let u=s[c];t&1<<c&&(u=Number.MAX_SAFE_INTEGER),a[l]=u}for(let l=0;l<a.length;l++){const c=r[l];a[l]<0&&(a[l]+=c),a[l]=bc(0,a[l],r[l])}return a}function mP(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function hP(t,e,n,s,r,a){let o=e[r];const l=n[r]||1;(t&1<<r||a&1<<r||o==null)&&(l>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const c=s[r];return o<0&&(o+=c),o=bc(0,o,c-1),o}function pP(t,e,n,s,r,a){let o=e[r];const l=n[r]||1;(t&1<<r||a&1<<r||o==null)&&(l>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const c=s[r];return o<0&&(o+=c),l>0?o=bc(0,o,c):o=bc(-1,o,c-1),o}function sk(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function rk(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Uy(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(o=>{R(o!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(r).fill(-1):typeof n=="number"?a=[n,...new Array(r-1).fill(-1)]:n.length<r?a=n.concat(new Array(r-n.length).fill(-1)):a=n,a=a.map((o,l)=>o>=0?o:(R(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${l}.`),t.shape[l]-s[l])),[s,a]}function ak(t,e,n,s,r,a,o,l,c){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const m={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:r,endMask:a,ellipsisMask:o,newAxisMask:l,shrinkAxisMask:c};for(let w=0;w<m.dims;w++)d&&1<<w&l&&m.numAddAxisAfterEllipsis++,1<<w&o&&(d=!0);d||(m.ellipsisMask|=1<<m.dims,m.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};fre(m,h);let p=!0,f=!0,y=!0;const x=[],g=[];for(let w=0;w<t.length;++w){if(h.strides[w]===0)throw Error(`strides[${w}] must be non-zero`);const v=!!(h.shrinkAxisMask&1<<w),E=t[w];if(E===-1){x.push(v?1:-1);continue}const k=[h.beginMask&1<<w,h.endMask&1<<w],C=[h.strides[w]>0?0:-1,h.strides[w]>0?E:E-1];if(v&&h.strides[w]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&h.strides[w]===1;const I=!!(h.beginMask&1<<w&&h.endMask&1<<w);if(h.beginValid&&h.endValid){if(v){const F=h.begin[w]<0?E+h.begin[w]:h.begin[w];if(h.begin[w]=F,h.end[w]=h.begin[w]+1,F<0||F>=E)throw Error(`slice index ${h.begin[w]} of dimension ${w} out of bounds.`)}else h.begin[w]=fP(h.begin[w],0,h.strides[w],E,k,C),h.end[w]=fP(h.end[w],1,h.strides[w],E,k,C);const T=h.strides[w]===1&&h.begin[w]===0&&h.end[w]===E;p=p&&T,f=f&&(w===0&&h.strides[w]===1||T)}else p=p&&h.strides[w]===1&&I,f=f&&(w===0&&h.strides[w]===1||I);let A,$=!1;if(h.beginValid&&h.endValid?(A=h.end[w]-h.begin[w],$=!0):v?(A=1,$=!0):I&&E>=0&&(h.strides[w]<0?A=-E:A=E,$=!0),$){let T;A===0||A<0!=h.strides[w]<0?T=0:T=Math.trunc(A/h.strides[w])+(A%h.strides[w]!==0?1:0),x.push(T)}else x.push(-1)}for(let w=0;w<h.finalShapeGatherIndices.length;++w){const v=h.finalShapeGatherIndices[w];v>=0?g.push(x[v]):v===ek&&g.push(1)}return{finalShapeSparse:g.filter((w,v)=>h.finalShapeGatherIndices[v]!==ek),finalShape:g,isIdentity:p,sliceDim0:f,isSimpleSlice:y,begin:h.begin,end:h.end,strides:h.strides}}function fre(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(ek),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(mre),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function fP(t,e,n,s,r,a){if(r[e])return n>0?a[e]:a[e+1&1];{const o=t<0?s+t:t;return o<a[0]?a[0]:o>a[1]?a[1]:o}}const gre=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:tk,computeFlatOffset:rk,computeOutShape:nk,getNormalizedAxes:pre,isSliceContinous:sk,maskToAxes:hre,parseSliceParams:Uy,sliceInfo:ak,startForAxis:hP,startIndicesWithElidedDims:uP,stopForAxis:pP,stopIndicesWithElidedDims:dP,stridesForAxis:mP,stridesWithElidedDims:iP},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xre{static sgd(e){return new ZN(e)}static momentum(e,n,s=!1){return new tP(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,a=!1){return new nP(e,n,s,r,a)}static adam(e=.001,n=.9,s=.999,r=null){return new Q3(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new Z3(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,a=0){return new eP(e,n,s,r,a)}static adagrad(e,n=.1){return new J3(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rd=xre;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yre=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function gP(){return new Promise(t=>yre(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ok(t,e){const n=t[0].length;t.forEach((r,a)=>{R(r.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),R(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,a)=>{for(let o=0;o<n;o++)R(o===e||r[o]===s[o],()=>`Error in concat${n}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function yo(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var za;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(za||(za={}));function xP(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const a=n[r],o=s[s.length-n.length+r],l=s[o];if(a>=0)if(l>=0){if(l!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${a} but shape[${r+t}] = ${l}`)}else s[o]=a}return s}function yP(t){const e={FIRST_DIM_SIZE:za.FIRST_DIM_SIZE,VALUE_ROWIDS:za.VALUE_ROWIDS,ROW_LENGTHS:za.ROW_LENGTHS,ROW_SPLITS:za.ROW_SPLITS,ROW_LIMITS:za.ROW_LIMITS,ROW_STARTS:za.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function bP(t){return t.length===0?0:t[0]===za.FIRST_DIM_SIZE?t.length-1:t.length}function wP(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const a=t[r],o=e[r+1];if(a>=0&&o>=0&&a!==1&&a!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${a} but ragged tensor input.flatValues.shape[${r-t.length}] = ${o}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ik=30;function Vy(t){return t<=ik?t:e2(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lk(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jp(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const a=e.length;for(let o=0;o<a;++o)r=r.concat([t[o+1]/e[o],e[o]]);r=r.concat(t.slice(a+1))}return r}function Gp(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],a=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?a.push(o):r.push(o);s.push(...r),s.push(0),s.push(...a)}return s}function Hp(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let a=1;a<t.length;++a)a<=e.length?s?r.push(e[a-1]*t[a]):r.push(t[a]/e[a-1]):r.push(t[a]);return r}function ck(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function uk(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wy=1.7580993408473768,jy=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dk=.3275911,mk=.254829592,hk=-.284496736,pk=1.421413741,fk=-1.453152027,gk=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xi(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function vP(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function EP(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function NP(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function xk(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function kP(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function SP(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const a=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:n,imag:s}}function CP(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yk="->",bre=/->/g,IP=",",$P="...";function bk(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(bre,"").length)/yk.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${yk}").`);const[s,r]=t.split(yk);R(s.indexOf($P)===-1,()=>`The ellipsis notation ("${$P}") is not supported yet.`);const a=s.split(IP),o=a.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const l=[];for(let h=0;h<r.length;++h){const p=r[h];if(!a.some(f=>f.indexOf(p)!==-1))throw new Error(`Output subscripts contain the label ${p} not present in the input subscripts.`);l.indexOf(p)===-1&&l.push(p)}for(let h=0;h<s.length;++h){const p=s[h];l.indexOf(p)===-1&&p!==IP&&l.push(p)}const c=new Array(a.length);for(let h=0;h<o;++h){if(new Set(a[h].split("")).size!==a[h].length)throw new Error(`Found duplicate axes in input component ${a[h]}. Support for duplicate axes in input is not implemented yet.`);c[h]=[];for(let p=0;p<a[h].length;++p)c[h].push(l.indexOf(a[h][p]))}const u=l.length,d=r.length,m=[];for(let h=d;h<u;++h)m.push(h);return{allDims:l,summedDims:m,idDims:c}}function wk(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function vk(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const a=n[r].shape;for(let o=0;o<e[r].length;++o)s[e[r][o]]===void 0?s[e[r][o]]=a[o]:R(s[e[r][o]]===a[o],()=>`Expected dimension ${s[e[r][o]]} at axis ${o} of input shaped ${JSON.stringify(a)}, but got dimension ${a[o]}`)}}function Ek(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let o=0;o<r;++o)s.push([]);const a=[];for(let o=0;o<n.length;++o){const l=n[o],c=wre(e,l);for(const u of c)a.indexOf(u)===-1&&(s[o].push(u),a.push(u))}return{path:n,steps:s}}function Nk(t){return t.every((e,n)=>e===n)}function wre(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function kk(t,e,n=0){let s=[];if(typeof e=="number")R(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((o,l)=>(l===-1&&(o+=1),o),0);R(r<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const o=e.reduce((l,c)=>c>0?l+c:l);e[a]=t.shape[n]-o}R(t.shape[n]===e.reduce((o,l)=>o+l),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TP(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function AP(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function RP(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _P(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function DP(t,e){return`size ${t} must be non-negative, not ${e}`}function PP(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function FP(t,e){const n=ue(t),s=ue(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function MP(t,e){const n=ue(t),s=ue(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sk(){return"segment ids must be >= 0"}function OP(){return"segment ids are not increasing"}function LP(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function zP(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BP(t,e){let n=!1,s;for(t<=ik?(s=t,n=!0):s=e2(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=e2(t,s+1);return s}function UP(t,e,n){const s=[],r=t.length;for(let a=0;a<r;a++)a!==e?s.push(t[a]):s.push(n);return s}function Ck(t,e,n,s){const r=e.shape.length,a=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let m=0;m<s;++m)if(t.shape[m]!==e.shape[m])throw new Error(`x.shape[${m}]: ${t.shape[m]} should be equal to indices.shape[${m}]: ${e.shape[m]}.`);const o=t.shape[n],l=[];let c=1,u=1,d=1;for(let m=0;m<s;++m)l.push(t.shape[m]),c*=t.shape[m];for(let m=s;m<n;m++)l.push(t.shape[m]),u*=t.shape[m];for(let m=s;m<r;m++)l.push(e.shape[m]);for(let m=n+1;m<a;m++)l.push(t.shape[m]),d*=t.shape[m];return{batchSize:c,sliceSize:d,outerSize:u,dimSize:o,outputShape:l}}const vre=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:Ck,computeOutShape:UP,segOpComputeOptimalWindowSize:BP},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yi(t){try{return t.map(e=>il(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function VP(t){return t.map(e=>ol(e))}const Ere=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:mk,ERF_A2:hk,ERF_A3:pk,ERF_A4:fk,ERF_A5:gk,ERF_P:dk,PARALLELIZE_THRESHOLD:ik,get RowPartitionType(){return za},SELU_SCALE:jy,SELU_SCALEALPHA:Wy,applyActivation:GN,assertAndGetBroadcastShape:ft,assertAxesAreInnerMostDims:cs,assertParamsConsistent:ok,assignToTypedArray:kP,axesAreInnerMostDims:wN,calculateShapes:zc,checkEinsumDimSizes:vk,checkPadOnDimRoundingMode:Ys,combineLocations:N3,combineRaggedTensorToTensorShapes:xP,complexWithEvenIndex:EP,complexWithOddIndex:NP,computeConv2DInfo:ls,computeConv3DInfo:ul,computeDefaultPad:mN,computeDilation2DInfo:Dp,computeOptimalWindowSize:Vy,computeOutAndReduceShapes:Qn,computeOutShape:yo,computePool2DInfo:ra,computePool3DInfo:mi,convertConv2DDataFormat:hi,decodeEinsumEquation:bk,eitherStridesOrDilationsAreOne:vs,expandShapeToKeepDim:On,exponent:CP,exponents:SP,fromStringArrayToUint8:VP,fromUint8ToStringArray:yi,getAxesPermutation:yn,getBroadcastDims:Cd,getComplexWithIndex:xk,getEinsumComputePath:Ek,getEinsumPermutation:wk,getFusedBiasGradient:jN,getFusedDyActivation:WN,getImageCenter:lk,getInnerMostAxes:$n,getPermuted:Gp,getRaggedRank:bP,getReductionAxes:Wn,getReshaped:jp,getReshapedPermuted:Hp,getRowPartitionTypesHelper:yP,getSliceBeginCoords:ck,getSliceSize:uk,getSparseFillEmptyRowsIndicesDenseShapeMismatch:TP,getSparseFillEmptyRowsNegativeIndexErrorMessage:AP,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:RP,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:PP,getSparseReshapeInputOutputMismatchErrorMessage:MP,getSparseReshapeInputOutputMultipleErrorMessage:FP,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:_P,getSparseReshapeNegativeOutputDimErrorMessage:DP,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:zP,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Sk,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:OP,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:LP,getUndoAxesPermutation:dl,isIdentityPermutation:Nk,log:GZ,mergeRealAndImagArrays:xi,prepareAndValidate:QN,prepareSplitSize:kk,segment_util:vre,shouldFuse:HN,slice_util:gre,splitRealAndImagArrays:vP,stridesOrDilationsArePositive:_c,tupleValuesAreOne:Rc,upcastType:pr,validateDefaultValueShape:wP,validateInput:qne,validateUpdateShape:V3,warn:Rr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */are();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WP={kernelName:bx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,Wp(Ue(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nre={kernelName:Dh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=un(Ue(n,"float32")),r=Es(lt(Ut(1),s));return Tn(rt(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kre={kernelName:Ph,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Es(lt(un(Ue(n,"float32")),1));return rt(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sre={kernelName:gd,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{let l=t;const c=Wn(n.shape,r);return c.length>0&&(l=st(l,c)),Q(l,n.shape)},b:()=>{let l=t;const c=Wn(s.shape,r);return c.length>0&&(l=st(l,c)),Q(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cre={kernelName:a2,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ire={kernelName:wx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Rt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $re={kernelName:vx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Rt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tre={kernelName:Fh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,Es(lt(Ut(1),un(Ue(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Are={kernelName:Mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Es(Ce(Ut(1),un(Ue(n,"float32"))));return rt(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rre={kernelName:zh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{const l=Ce(un(n),un(s));let c=G(t,rt(s,l));const u=Wn(n.shape,r);return u.length>0&&(c=st(c,u)),Q(c,n.shape)},b:()=>{const l=Ce(un(n),un(s));let c=Tn(G(t,rt(n,l)));const u=Wn(s.shape,r);return u.length>0&&(c=st(c,u)),Q(c,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _re={kernelName:Oh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,Ce(un(Ue(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dre={kernelName:Lh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,lt(Ut(1),un(Ue(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(t,e,n,s,r,a){const o=U(t,"dy","avgPool3dGrad"),l=U(e,"input","avgPool3dGrad");let c=o,u=l,d=!1;l.rank===4&&(d=!0,c=Q(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),u=Q(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),R(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),R(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Ys("avgPool3dGrad",r,a);const m={dy:c,input:u},h={filterSize:n,strides:s,pad:r,dimRoundingMode:a},p=H.runKernel(c2,m,h);return d?Q(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Fre=ee({avgPool3dGrad_:Pre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mre={kernelName:Nx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:a,pad:o,dimRoundingMode:l}=n;return{x:()=>Fre(t,s,r,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(t,e,n,s,r){const a=U(t,"dy","avgPoolGrad"),o=U(e,"input","avgPoolGrad");R(o.rank===a.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`);let l=o,c=a,u=!1;o.rank===3&&(u=!0,l=Q(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=Q(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),R(l.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${l.rank}.`);const d={dy:c,input:l},m={filterSize:n,strides:s,pad:r},h=H.runKernel(l2,d,m);return u?Q(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Lre=ee({avgPoolGrad_:Ore});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zre={kernelName:Ex,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:a,pad:o}=n;return{x:()=>Lre(t,s,r,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bre={kernelName:kx,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:a,transposeB:o}=n;return!a&&!o?{a:()=>Bt(t,r,!1,!0),b:()=>Bt(s,t,!0,!1)}:!a&&o?{a:()=>Bt(t,r,!1,!1),b:()=>Bt(t,s,!0,!1)}:a&&!o?{a:()=>Bt(r,t,!1,!0),b:()=>Bt(s,t,!1,!1)}:{a:()=>Bt(r,t,!0,!0),b:()=>Bt(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ure={kernelName:Sx,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>$N(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vre={kernelName:UZ,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,a=s.shape,o=Array.from(a);for(let c=r.length-1;c>=0;c--)if(r[c]===a[c])o[c]=1;else if(r[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const l=[];for(let c=0;c<o.length;c++)o[c]>1&&l.push(c);return{x:()=>st(t,l,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wre={kernelName:Bh,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jre={kernelName:Uh,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gre={kernelName:Vh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:a}=n;return{x:()=>Ps(pi(Fc(s,r),Id(s,a)),t,Rt(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hre={kernelName:Cx,inputsToSave:["x"],gradFunc:WP.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qre={kernelName:Ix,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(c=>c.shape),{axis:r}=n,a=Et(r,e[0].shape)[0],o=s.map(c=>c[a]);return Pr(t,o,a).map(c=>()=>c)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kre={kernelName:$x,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:a,strides:o,pad:l,dataFormat:c}=n;return R(Rc(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>gN(s.shape,t,r,o,l,c),filter:()=>VN(s,t,r.shape,o,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xre={kernelName:Tx,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c}=n;return{dy:()=>Dc(t,r,a,o,l,1,c),filter:()=>VN(t,s,r.shape,a,o,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t,e,n,s,r){let a=t;t.rank===4&&(a=Q(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;o.rank===4&&(o=Q(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),R(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),R(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),R(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),R(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),R(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const l={x:a,dy:o},c={strides:s,pad:r,filterShape:n};return H.runKernel(p2,l,c)}const Zre=ee({conv3DBackpropFilter_:Yre});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre={kernelName:Ax,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:a}=n;R(Rc(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[o,l]=e;return{x:()=>y3(o.shape,t,l,r,a),filter:()=>Zre(o,t,l.shape,r,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qre={kernelName:Wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(Tn(L3(Ue(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eae={kernelName:jh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(z3(Ue(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tae={kernelName:Rx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:a,reverse:o}=n;return{x:()=>{const l=yn([r],s.rank);let c=w3(t,r,a,!o);return l!=null&&(c=_t(c,l)),c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nae={kernelName:_x,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:o}=n,l=s??[1,1];R(Rc(l),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${l}'`);const[c,u]=e;return R(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),R(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),R(c.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),R(vs(r,l),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${l}'.`),Ys("depthwiseConv2d",a,o),{x:()=>mse(c.shape,t,u,r,a,l,o),filter:()=>use(c,t,u.shape,r,a,l,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sae={kernelName:Dx,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,a={x:s,filter:r,dy:t},o={x:s,filter:r,dy:t};return{x:()=>H.runKernel(E2,a,n),filter:()=>H.runKernel(N2,o,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rae={kernelName:Hh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>H.runKernel(S2,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aae={kernelName:qh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=G(go(Tn(un(n))),2/Math.sqrt(Math.PI));return{x:()=>G(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oae={kernelName:Kh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iae={kernelName:Fx,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Q(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lae={kernelName:Xh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,go(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cae={kernelName:Yh,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae={kernelName:Zh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{const l=rt(t,Ue(s,"float32")),c=Wn(n.shape,r);return c.length>0?Q(st(l,c),n.shape):l},b:()=>{let l=G(t,Ue(n,"float32"));const c=Wn(s.shape,r);c.length>0&&(l=Q(st(l,c),s.shape));const u=un(s);return Tn(rt(l,Ue(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dae={kernelName:Mx,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,a,o,l]=e,c=l??Ut(1),u=Wn(a.shape,r.shape),d=[];if(a.rank===1){for(let v=0;v<r.shape.length-1;++v)d.push(r.shape[v]);d.push(1)}const m=lt(r,a),h=G(t,c),p=F3(Ce(o,Ut(s))),f=G(G(G(p,p),p),Ut(-.5));return{x:()=>a.rank===1?Q(G(G(t,La(Q(p,[1,1,1,a.shape[0]]),d)),c),r.shape):Q(G(G(t,p),c),r.shape),mean:()=>{let v=G(G(p,Ut(-1)),h);return a.rank===1&&(v=st(v,u)),Q(v,a.shape)},variance:()=>{let v=G(G(f,m),h);return a.rank===1&&(v=st(v,u)),Q(v,a.shape)},scale:()=>{const v=G(m,p);let E=G(t,v);return a.rank===1&&(E=st(E,u)),Q(E,a.shape)},offset:()=>{let v=t;return a.rank===1&&(v=st(v,u)),Q(v,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mae={kernelName:Ox,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:a,batchDims:o}=n,l=Et(a,s.shape)[0],c=(u,d,m)=>()=>{const h=u.shape,p=d.size,f=h.slice(0,l),y=f.length,x=h.slice(a,h.length).slice(1),g=x.length,b=jP(0,y),w=jP(y+1,y+1+g),v=GP([f,[p],x]),E=Q(m,v),k=Q(d,[p]),C=GP([[y],b,w]),I=_t(E,C);let A=j3(I,k,u.shape[l]);const $=dl(C);return A=_t(A,$),A};if(o===1){const u=s.shape[0],d=s.split(u,0);return{x:()=>fi(d.map((p,f)=>c(p,r.slice(f,1),t.slice(f,1))())).reshape(s.shape),indices:()=>r}}else return{x:c(s,r,t),indices:()=>r}}};function jP(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function GP(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hae={kernelName:Jh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Rt(n),b:()=>Rt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae={kernelName:Qh,gradFunc:t=>({x:()=>Ue(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fae={kernelName:ep,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gae={kernelName:tp,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae={kernelName:np,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yae={kernelName:zx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,a=Dr(s,0);return{x:()=>Ps(a,t,G(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bae={kernelName:rp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,Ce(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wae={kernelName:sp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,Ue(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vae={kernelName:WZ,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const o=go(s);return lt(t,G(st(t,r,!0),o))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eae(t,e,n,s=5,r=1,a=1,o=.5){const l={x:t,y:e,dy:n},c={depthRadius:s,bias:r,alpha:a,beta:o};return H.runKernel(R2,l,c)}const Nae=ee({localResponseNormalizationBackprop_:Eae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kae={kernelName:Gx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:a,bias:o,alpha:l,beta:c}=n;return{x:()=>Nae(s,r,t,a,o,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HP(t,e,n,s){return e.rank<n.rank&&(e=Q(e,On(e.shape,s))),t.rank<n.rank&&(t=Q(t,On(t.shape,s))),{x:()=>G(t,Ue(fo(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qP={kernelName:Hx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,a=e[0],o=e[1],l=Et(r,a.shape),c=HP(t,o,a,l);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sae={kernelName:ap,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>G(t,Ue(Fc(n,s),"float32")),b:()=>G(t,Ue(Oy(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t,e,n,s,r,a,o){const l=U(t,"dy","maxPool3dGrad"),c=U(e,"input","maxPool3dGrad"),u=U(n,"output","maxPool3dGrad");let d=l,m=c,h=u,p=!1;c.rank===4&&(p=!0,d=Q(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),m=Q(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),h=Q(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),R(d.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${d.rank}.`),R(m.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${m.rank}.`),R(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Ys("maxPool3dGrad",a,o);const f={dy:d,input:m,output:h},y={filterSize:s,strides:r,pad:a,dimRoundingMode:o},x=H.runKernel(D2,f,y);return p?Q(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const Iae=ee({maxPool3dGrad_:Cae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae={kernelName:Kx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=n;return{x:()=>Iae(t,s,r,a,o,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tae(t,e,n,s,r,a,o){const l=U(t,"dy","maxPoolGrad"),c=U(e,"input","maxPoolGrad"),u=U(n,"output","maxPoolGrad");R(c.rank===l.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${l.rank})`),R(l.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),R(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),Ys("maxPoolGrad",a,o);const d={dy:l,input:c,output:u},m={filterSize:s,strides:r,pad:a,dimRoundingMode:o};return H.runKernel(_2,d,m)}const Aae=ee({maxPoolGrad_:Tae});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rae={kernelName:qx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:a,strides:o,pad:l}=n;return{x:()=>Aae(t,s,r,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _ae={kernelName:Xx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,a=Et(r,s.shape),l=Qn(s.shape,a)[1],c=ue(l);return{x:()=>{const d=s.shape.slice();a.forEach(p=>{d[p]=1});const m=Q(t,d);return rt(G(m,hl(s.shape,"float32")),c)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dae={kernelName:Yx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[a,o]=e,l=Et(r,a.shape),c=HP(t,o,a,l);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pae={kernelName:op,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>G(t,Ue(Id(n,s),"float32")),b:()=>G(t,Ue(Dr(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae={kernelName:Zx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,a=r.map(o=>o[0]);return{x:()=>sn(t,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae={kernelName:ip,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{const l=Wn(n.shape,r);return l.length>0?Q(st(t,l),n.shape):t},b:()=>{const l=G(t,Tn(My(rt(n,s)))),c=Wn(s.shape,r);return c.length>0?Q(st(l,c),s.shape):l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oae={kernelName:lp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{const l=G(t,Ue(s,"float32")),c=Wn(n.shape,r);return c.length>0?Q(st(l,c),n.shape):l},b:()=>{const l=G(t,Ue(n,"float32")),c=Wn(s.shape,r);return c.length>0?Q(st(l,c),s.shape):l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lae={kernelName:Jx,gradFunc:t=>({x:()=>Tn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zae={kernelName:ty,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>es(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bae={kernelName:ey,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uae={kernelName:ny,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return Bc(t,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KP={kernelName:sy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,a=r.map(o=>o[0]);return{x:()=>sn(t,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vae={kernelName:cp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,a=n,o=s,l=ft(a.shape,o.shape);return{a:()=>{const d=Ue(o,"float32");let m=G(t,G(d,Pc(a,lt(d,Ut(1)))));const h=Wn(a.shape,l);return h.length>0&&(m=st(m,h)),Q(m,a.shape)},b:()=>{const d=Dr(a,0),m=Ps(d,xo(a),Rt(a));let h=G(t,G(r,m));const p=Wn(o.shape,l);return p.length>0&&(h=st(h,p)),Q(h,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wae={kernelName:ry,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=Dr(n,0);return{x:()=>Ps(r,t,G(t,s)),alpha:()=>{let a=Ps(r,Rt(t),G(t,n));const o=Wn(s.shape,t.shape);return o.length>0&&(a=st(a,o)),Q(a,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jae(t,e,n){const s=t.shape.slice();s[n]=1;const r=Q(e,s),a=yN(t,n,!0,!1),o=yN(t,n,!0,!0),l=G(a,o);return G(r,l)}function Gae(t,e,n){const s=t.shape.length,r=s-n.length,a=yn(n,s);let o=t;a!=null&&(o=_t(t,a));const l=o.shape.slice(),u=l.splice(s-n.length,n.length).reduce((h,p)=>h*p,1);l.push(u);const d=o.reshape(l);let m=jae(d,e,r);if(m=m.reshape(o.shape),a!=null){const h=dl(a);m=_t(m,h)}return m}const Hae={kernelName:ay,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let a=[];return r==null?a=s.shape.map((o,l)=>l):typeof r=="number"?a=[r]:a=r,{x:()=>Gae(s,t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qae={kernelName:Gh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{const l=rt(t,Ue(s,"float32")),c=Wn(n.shape,r);return c.length>0?Q(st(l,c),n.shape):l},b:()=>{let l=G(t,Ue(n,"float32"));const c=Wn(s.shape,r);c.length>0&&(l=Q(st(l,c),s.shape));const u=un(s);return Tn(rt(l,Ue(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae={kernelName:up,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,Tn(un(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xae={kernelName:mp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=G(Id(n,6),Wp(n));return{x:()=>G(t,Ue(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yae={kernelName:dp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,Ue(Wp(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zae={kernelName:oy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Q(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jae={kernelName:ly,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>H.runKernel(B2,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qae={kernelName:iy,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>H.runKernel(z2,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eoe={kernelName:cy,gradFunc:(t,e,n)=>{const{dims:s}=n,r=Et(s,t.shape);return{x:()=>Lc(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const toe={kernelName:hp,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const noe={kernelName:pp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Tn(rt(t,G(Pc(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const soe={kernelName:uy,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Ue(Rt(n),"float32"),t:()=>G(t,Ue(n,t.dtype)),e:()=>G(t,Ue(kN(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe={kernelName:fp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Dr(n,Ut(0)),r=Ut(Wy),a=Ut(jy),o=G(t,a),l=G(G(t,r),go(Ue(n,"float32")));return Ps(s,o,l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aoe={kernelName:bp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,G(n,lt(Ut(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ooe={kernelName:yp,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe={kernelName:gp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(xN(Ue(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const loe={kernelName:xp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(b3(Ue(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const coe={kernelName:dy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:a}=n,o=s.shape,[l,c]=Uy(s,r,a),u=[];for(let d=0;d<t.rank;d++)u.push([l[d],o[d]-l[d]-c[d]]);return{x:()=>IN(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe={kernelName:fy,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,a=!0,o=G(t,s);return{logits:()=>lt(o,G(st(o,[r],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const doe={kernelName:wp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,Sd(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XP={kernelName:hy,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>fN(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YP={kernelName:py,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Zs(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const moe={kernelName:vp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,G(Es(Ue(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hoe={kernelName:U2,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(t,G(Ue(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const poe={kernelName:Ep,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Ut(2);return{a:()=>G(t,G(r,lt(n,s))),b:()=>G(t,G(r,lt(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const foe={kernelName:Ip,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe={kernelName:Np,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=ft(n.shape,s.shape);return{a:()=>{let l=t;const c=Wn(n.shape,r);return c.length>0&&(l=st(l,c)),Q(l,n.shape)},b:()=>{let l=t;const c=Wn(s.shape,r);return c.length>0&&(l=st(l,c)),Q(Tn(l),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xoe={kernelName:my,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:a}=n;Et(a,s.shape).forEach(u=>{r[u]=1});const l=Q(t,r),c=G(l,hl(s.shape,"float32"));return{x:()=>c}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yoe={kernelName:kp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>rt(t,un(xN(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const boe={kernelName:Sp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>G(lt(Ut(1),un(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const woe={kernelName:Cp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let o=Rt(s);if(s.rank===1)for(let l=0;l<r[0];++l)o=Ce(o,sn(t,[l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)o=Ce(o,sn(t,[l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)for(let u=0;u<r[2];++u)o=Ce(o,sn(t,[l*s.shape[0],c*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)for(let u=0;u<r[2];++u)for(let d=0;d<r[3];++d)o=Ce(o,sn(t,[l*s.shape[0],c*s.shape[1],u*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const voe={kernelName:xd,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,a=dl(r);return{x:()=>_t(t,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe={kernelName:gy,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>fi(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe={kernelName:xy,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>koe(t,n)}}};function koe(t,e){const n=ml(e,Rt(e)),s=vN(t,n);let r=Fc(e,Ut(0,"int32"));const a=s.rank-r.rank;for(let l=0;l<a;++l)r=Js(r,l+1);r=pi(r,hl(s.shape,"bool"));const o=Rt(s);return Ps(r,s,o)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Soe={kernelName:yy,gradFunc:t=>({x:()=>Rt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Coe=[WP,Nre,kre,Sre,Cre,Ire,$re,Tre,Are,Rre,_re,Dre,Mre,zre,Bre,Ure,Vre,Wre,jre,Gre,Hre,qre,Xre,Kre,Jre,Qre,eae,tae,nae,sae,qae,rae,aae,oae,iae,lae,uae,cae,dae,mae,hae,pae,fae,gae,xae,yae,bae,wae,vae,kae,qP,qP,Sae,$ae,Rae,_ae,Dae,Pae,Fae,Mae,Oae,Lae,zae,Bae,Uae,KP,KP,Vae,Wae,Hae,Kae,Xae,Yae,Zae,Jae,Qae,eoe,toe,noe,soe,roe,aoe,ooe,ioe,loe,coe,uoe,doe,XP,XP,YP,YP,moe,poe,hoe,foe,goe,xoe,yoe,boe,woe,voe,Eoe,Noe,Soe];for(const t of Coe)HZ(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.abs=function(){return this.throwIfDisposed(),Ds(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acos=function(){return this.throwIfDisposed(),rQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.acosh=function(){return this.throwIfDisposed(),oQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.add=function(t){return this.throwIfDisposed(),Ce(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.all=function(t,e){return this.throwIfDisposed(),f3(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.any=function(t,e){return this.throwIfDisposed(),dN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMax=function(t){return this.throwIfDisposed(),_p(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.argMin=function(t){return this.throwIfDisposed(),dQ(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asScalar=function(){return this.throwIfDisposed(),R(this.size===1,()=>"The array must have only 1 element."),Q(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asType=function(t){return this.throwIfDisposed(),Ue(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as1D=function(){return this.throwIfDisposed(),Q(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as2D=function(t,e){return this.throwIfDisposed(),Q(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Q(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),Q(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),Q(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asin=function(){return this.throwIfDisposed(),hQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.asinh=function(){return this.throwIfDisposed(),fQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan=function(){return this.throwIfDisposed(),xQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atan2=function(t){return this.throwIfDisposed(),bQ(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.atanh=function(){return this.throwIfDisposed(),vQ(this)},ce().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),pN(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),fN(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Ry(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Mp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cast=function(t){return this.throwIfDisposed(),Ue(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ceil=function(){return this.throwIfDisposed(),KQ(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),_r(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Vn&&(t=[t]),Zs([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv1d=function(t,e,n,s,r,a){return this.throwIfDisposed(),g3(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),x3(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.conv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),Dc(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cos=function(){return this.throwIfDisposed(),xN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cosh=function(){return this.throwIfDisposed(),b3(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),yN(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),w3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),bee(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.depthwiseConv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),bN(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),Eee(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.divNoNan=function(t){return this.throwIfDisposed(),Iee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.div=function(t){return this.throwIfDisposed(),rt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.dot=function(t){return this.throwIfDisposed(),Tee(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.elu=function(){return this.throwIfDisposed(),Dy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.equal=function(t){return this.throwIfDisposed(),fo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.erf=function(){return this.throwIfDisposed(),E3(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),Uee(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.exp=function(){return this.throwIfDisposed(),go(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expandDims=function(t){return this.throwIfDisposed(),Js(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.expm1=function(){return this.throwIfDisposed(),Gee(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.fft=function(){return this.throwIfDisposed(),U3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.flatten=function(){return this.throwIfDisposed(),Q(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floor=function(){return this.throwIfDisposed(),My(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.floorDiv=function(t){return this.throwIfDisposed(),p3(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.gather=function(t,e,n){return this.throwIfDisposed(),vN(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Fc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.greater=function(t){return this.throwIfDisposed(),Dr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.ifft=function(){return this.throwIfDisposed(),BN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.irfft=function(){return this.throwIfDisposed(),Pne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isFinite=function(){return this.throwIfDisposed(),ete(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isInf=function(){return this.throwIfDisposed(),nte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.isNaN=function(){return this.throwIfDisposed(),rte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.leakyRelu=function(t){return this.throwIfDisposed(),NN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.lessEqual=function(t){return this.throwIfDisposed(),Id(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.less=function(t){return this.throwIfDisposed(),Oy(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),cte(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSigmoid=function(){return this.throwIfDisposed(),gte(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSoftmax=function(t){return this.throwIfDisposed(),I3(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),$3(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log=function(){return this.throwIfDisposed(),xo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.log1p=function(){return this.throwIfDisposed(),C3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalAnd=function(t){return this.throwIfDisposed(),pi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalNot=function(){return this.throwIfDisposed(),kN(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalOr=function(t){return this.throwIfDisposed(),T3(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.logicalXor=function(t){return this.throwIfDisposed(),kte(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Bt(this,t,e,n)},ce().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),SN(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.max=function(t,e){return this.throwIfDisposed(),Oa(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.maximum=function(t){return this.throwIfDisposed(),ml(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mean=function(t,e){return this.throwIfDisposed(),Ln(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.min=function(t,e){return this.throwIfDisposed(),Py(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.minimum=function(t){return this.throwIfDisposed(),zp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),_te(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mod=function(t){return this.throwIfDisposed(),Pte(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.mul=function(t){return this.throwIfDisposed(),G(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.neg=function(){return this.throwIfDisposed(),Tn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Fy(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.notEqual=function(t){return this.throwIfDisposed(),Ly(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),A3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.onesLike=function(){return this.throwIfDisposed(),aa(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pad=function(t,e){return this.throwIfDisposed(),IN(this,t,e)},ce().prototype.pool=function(t,e,n,s,r,a){return this.throwIfDisposed(),jte(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.pow=function(t){return this.throwIfDisposed(),Pc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prelu=function(t){return this.throwIfDisposed(),TN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.prod=function(t,e){return this.throwIfDisposed(),qte(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reciprocal=function(){return this.throwIfDisposed(),pne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu=function(){return this.throwIfDisposed(),Oc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.relu6=function(){return this.throwIfDisposed(),D3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshapeAs=function(t){return this.throwIfDisposed(),Q(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reshape=function(t){return this.throwIfDisposed(),Q(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),K3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),X3(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.reverse=function(t){return this.throwIfDisposed(),Lc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rfft=function(){return this.throwIfDisposed(),One(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.round=function(){return this.throwIfDisposed(),P3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.rsqrt=function(){return this.throwIfDisposed(),F3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.selu=function(){return this.throwIfDisposed(),M3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.separableConv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),O3(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sigmoid=function(){return this.throwIfDisposed(),Sd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sign=function(){return this.throwIfDisposed(),Nne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sin=function(){return this.throwIfDisposed(),L3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sinh=function(){return this.throwIfDisposed(),z3(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.slice=function(t,e){return this.throwIfDisposed(),sn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softmax=function(t){return this.throwIfDisposed(),zN(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.softplus=function(){return this.throwIfDisposed(),Lp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),$N(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.split=function(t,e){return this.throwIfDisposed(),Pr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sqrt=function(){return this.throwIfDisposed(),Es(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.square=function(){return this.throwIfDisposed(),un(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squaredDifference=function(t){return this.throwIfDisposed(),zne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.squeeze=function(t){return this.throwIfDisposed(),Vp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Vn?[this,t]:[this,...t];return fi(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.step=function(t){return this.throwIfDisposed(),Wp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.stridedSlice=function(t,e,n,s,r,a,o,l){return this.throwIfDisposed(),jne(this,t,e,n,s,r,a,o,l)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sub=function(t){return this.throwIfDisposed(),lt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.sum=function(t,e){return this.throwIfDisposed(),st(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tan=function(){return this.throwIfDisposed(),Hne(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tanh=function(){return this.throwIfDisposed(),Ay(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.tile=function(t){return this.throwIfDisposed(),La(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toBool=function(){return this.throwIfDisposed(),Ue(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toFloat=function(){return this.throwIfDisposed(),Ue(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.toInt=function(){return this.throwIfDisposed(),Ue(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.topk=function(t,e){return this.throwIfDisposed(),Xne(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.transpose=function(t){return this.throwIfDisposed(),_t(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unique=function(t){return this.throwIfDisposed(),Jne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),j3(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.unstack=function(t){return this.throwIfDisposed(),Bc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.where=function(t,e){return this.throwIfDisposed(),Ps(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ce().prototype.zerosLike=function(){return this.throwIfDisposed(),Rt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class bo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,bo.prototype)}}class ia extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ia.prototype)}}class j extends Error{constructor(e){super(e),Object.setPrototypeOf(this,j.prototype)}}class bt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,bt.prototype)}}class Ik extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Ik.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ZP{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uc(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function wo(t,e){if(!t)throw new Ik(e)}function JP(t,e){let n=0;for(const s of t)s===e&&n++;return n}function Qs(t){return t.length===1?t[0]:t}function Gt(t){return Array.isArray(t)?t:[t]}function bi(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Vc(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let la={};function $k(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Tk(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>Tk(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:Tk(s))}}}function qp(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const a=t;let o;if(a in n)o=n[a];else if(a in la)o=la[a];else if(o=e[a],o==null)throw new j(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return o}else{const a=t;if(a.className==null||a.config==null)throw new j(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const o=a.className;let l,c;if(o in n?[l,c]=n[o]:o in la?[l,c]=la.className:o in e&&([l,c]=e[o]),l==null)throw new j(`Unknown ${s}: ${o}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){const u={};for(const p of Object.keys(la))u[p]=la[p];for(const p of Object.keys(n))u[p]=n[p];const d=a.config;d.customObjects=u;const m=Object.assign({},la);for(const p of Object.keys(n))la[p]=n[p];Tk(a.config);const h=c(l,a.config,n,r);return la=Object.assign({},m),h}else{const u=Object.assign({},la);for(const m of Object.keys(n))la[m]=n[m];const d=new l(a.config);return la=Object.assign({},u),d}}}function Ioe(t,e){return t<e?-1:t>e?1:0}function Gy(t,e){return-1*Ioe(t,e)}function fl(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function $oe(t){if(t==null)throw new j(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Wc(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new j(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Ak(t,e,n=0,s=1/0){return wo(n>=0),wo(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function ts(t,e){Array.isArray(t)?(R(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>ts(n,`element ${s+1} of ${e}`))):R(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${QP(t)}.`)}function QP(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>QP(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function Toe(t,e,n){let s=n!=null?n():Ks(),r;return(...o)=>{const l=n!=null?n():Ks();return l-s<e||(s=l,r=t(...o)),r}}function eF(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Aoe=0;function tF(){return Aoe++}const Hy={};function qy(t=""){return t in Hy||(Hy[t]=0),Hy[t]+=1,t+Hy[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Roe=["channelsFirst","channelsLast"],_oe=["nearest","bilinear"],Doe=["valid","same","causal"],Poe=["max","avg"],Foe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const _d=new Map;function An(t){Wc(Roe,"DataFormat",t)}function Moe(t){Wc(_oe,"InterpolationFormat",t)}function Fr(t){Wc(Doe,"PaddingMode",t)}function nF(t){Wc(Poe,"PoolMode",t)}const Kp=[],sF="/";function jc(t,e){Kp.push(t);try{const n=e();return Kp.pop(),n}catch(n){throw Kp.pop(),n}}function Ooe(){return Kp.length===0?"":Kp.join(sF)+sF}function rF(t){if(!oF(t))throw new Error("Not a valid tensor name: '"+t+"'");return Ooe()+t}function aF(t){if(!oF(t))throw new Error("Not a valid tensor name: '"+t+"'");_d.has(t)||_d.set(t,0);const e=_d.get(t);if(_d.set(t,_d.get(t)+1),e>0){const n=`${t}_${e}`;return _d.set(n,1),n}else return t}const Loe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function oF(t){return!!t.match(Loe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zoe(t){return t===parseInt(t.toString(),10)}function gl(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Dd(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function xl(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function Ba(t,e){if(e<t)throw new j(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Rk;function jn(){return Rk==null&&(Rk=yJ().epsilon()),Rk}function Ua(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vo(t,e){return Ue(t,e)}function Xp(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),Q(t,n)}function Boe(t,e){return re(()=>{if(t.shape.length!==2)throw new j(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Xp(t,1);return Pk(n,[1,e,1])})}function Uoe(t){const e=[gl(t.shape)];return Q(t,e)}function Voe(t){if(t.rank<=1)throw new j(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],gl(t.shape,1)];return Q(t,e)}function Gc(t,e,n){return re(()=>{switch(t.rank){case 1:return ON(t,e,n);case 2:return B3(t,[e,0],[n,t.shape[1]]);case 3:return LN(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return By(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return sn(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return sn(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new j(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function _k(t,e,n){return re(()=>{switch(t.rank){case 1:return ON(t,e,n);case 2:return B3(t,[0,e],[t.shape[0],n]);case 3:return LN(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return By(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new j(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Ky(t,e,n,s){return re(()=>{switch(t.rank){case 1:return ON(t,e,n);case 2:switch(s){case 1:return Gc(t,e,n);case 2:return _k(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return Gc(t,e,n);case 2:return LN(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return _k(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return Gc(t,e,n);case 2:return By(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return By(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return _k(t,e,n);default:throw new j(`The axis is not within the rank of the tensor ${s}`)}default:throw new j(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Dk(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Zs(t,e)}function iF(t,e){switch(t.rank){case 1:return ZQ([t,e]);case 2:return QQ([t,e],0);case 3:return tee([t,e],0);case 4:return see([t,e],0);default:throw new j(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Pk(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new j(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return La(t,e)}function Xy(t,e=0,n=1,s,r){return une(t,e,n,s,r)}function Eo(t,e,n,s){if(t.rank<2||e.rank<2)throw new bt(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],a=e.shape.slice(-2)[0];if(r!==a)throw new bt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return H3({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Fk(t.rank,s,Ua()):null,activation:n});{const r=t.shape.slice(),a=r.pop();t=Q(t,[-1,a]);const o=e.shape.slice(),l=o.pop(),c=o.pop(),u=[...o,l],d=Array.from({length:e.rank},(f,y)=>y===0?e.rank-2:y<=e.rank-2?y-1:y);e=Q(_t(e,d),[c,-1]);const m=[...r,...u];return Q(H3({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Fk(t.rank,s,Ua()):null,activation:n}),m)}}function lF(t,e,n){return re(()=>(Array.isArray(e)?e=fr(e,"int32"):e=Ue(e,"int32"),vN(t,e,n)))}function Yp(t){return G(t,t)}function Fk(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new j(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?Q(e,[1,s[0],1,1,1]):Q(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?Q(e,[1,1,1,1,s[0]]):Q(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?Q(e,[1,s[0],1,1]):Q(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?Q(e,[1,1,1,s[0]]):Q(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?Q(e,[1,s[0],1]):Q(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?Q(e,[1,1,s[0]]):Q(e,[1].concat(s))}else if(t<3)return e;throw new j(`Unsupported input rank by biasAdd: ${e.rank}`)}function Va(t,e,n){return re(()=>(n==null&&(n=Ua()),An(n),Ce(t,Fk(t.rank,e,n))))}function Woe(t,e=1){if(e!==1)throw new bt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Dy(t)}function joe(t){return re(()=>rt(t,Ce(Ds(t),1)))}function cF(t,e,n,s){return re(()=>ase(t,e,n,s))}function Goe(t){return re(()=>{const e=Ce(.5,G(.2,t));return _r(e,0,1)})}function Zp(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Hoe=["fanIn","fanOut","fanAvg"],qoe=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Koe(t){Wc(Hoe,"FanMode",t)}function Xoe(t){Wc(qoe,"Distribution",t)}class ca extends Ad{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class uF extends ca{apply(e,n){return es(e,n)}}uF.className="Zeros",Ne(uF);class Mk extends ca{apply(e,n){return hl(e,n)}}Mk.className="Ones",Ne(Mk);class dF extends ca{constructor(e){if(super(),typeof e!="object")throw new j(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new j(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return re(()=>G(Ut(this.value),hl(e,n)))}getConfig(){return{value:this.value}}}dF.className="Constant",Ne(dF);class mF extends ca{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Bp(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}mF.className="RandomUniform",Ne(mF);class hF extends ca{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new bt(`randomNormal does not support dType ${n}.`);return Xy(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}hF.className="RandomNormal",Ne(hF);class pF extends ca{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new bt(`truncatedNormal does not support dType ${n}.`);return W3(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}pF.className="TruncatedNormal",Ne(pF);class fF extends ca{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return re(()=>{if(e.length!==2||e[0]!==e[1])throw new j("Identity matrix initializer can only be used for 2D square matrices.");return G(this.gain,S3(e[0]))})}getConfig(){return{gain:this.gain}}}fF.className="Identity",Ne(fF);function Yoe(t,e="channelsLast"){let n,s;if(An(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=gl(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=gl(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=gl(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class gr extends ca{constructor(e){if(super(),e.scale<0)throw new j(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Koe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Xoe(this.distribution),this.seed=e.seed}apply(e,n){const s=Yoe(e),r=s[0],a=s[1];let o=this.scale;if(this.mode==="fanIn"?o/=Math.max(1,r):this.mode==="fanOut"?o/=Math.max(1,a):o/=Math.max(1,(r+a)/2),this.distribution==="normal"){const l=Math.sqrt(o);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new bt(`${this.getClassName()} does not support dType ${n}.`);return W3(e,0,l,n,this.seed)}else{const l=Math.sqrt(3*o);return Bp(e,-l,l,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}gr.className="VarianceScaling",Ne(gr);class Ok extends gr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return gr.className}}Ok.className="GlorotUniform",Ne(Ok);class Lk extends gr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return gr.className}}Lk.className="GlorotNormal",Ne(Lk);class zk extends gr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return gr.className}}zk.className="HeNormal",Ne(zk);class Bk extends gr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return gr.className}}Bk.className="HeUniform",Ne(Bk);class Uk extends gr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return gr.className}}Uk.className="LeCunNormal",Ne(Uk);class Vk extends gr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return gr.className}}Vk.className="LeCunUniform",Ne(Vk);class gF extends ca{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return re(()=>{if(e.length<2)throw new bt("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=ue(e.slice(0,-1)),r=e[e.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const o=[Math.max(r,s),Math.min(r,s)],l=Xy(o,0,1,n,this.seed),c=tre.qr(l,!1);let u=c[0];const m=c[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=G(u,m.sign()),s<r&&(u=u.transpose()),G(Ut(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}gF.className="Orthogonal",Ne(gF);const xF={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function yF(t,e={}){return qp(t,oa.getMap().classNameMap,e,"initializer")}function bn(t){return $k(t)}function pn(t){if(typeof t=="string"){const e=t in xF?xF[t]:t;if(e==="GlorotNormal")return new Lk;if(e==="GlorotUniform")return new Ok;if(e==="HeNormal")return new zk;if(e==="HeUniform")return new Bk;if(e==="LeCunNormal")return new Uk;if(e==="LeCunUniform")return new Vk;{const n={};return n.className=e,n.config={},yF(n)}}else return t instanceof ca?t:yF(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Wk(t){return Array.isArray(t)&&Array.isArray(t[0])}function Yy(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function ut(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new j(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Ft(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new j(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zy(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const bF="Variable";class Zoe{constructor(e,n="float32",s=bF,r=!0,a=null){this.dtype=n??"float32",this.shape=e.shape,this.id=tF(),s=s??bF,this.originalName=rF(s),this.name=aF(this.originalName),this.trainable_=r,this.constraint=a,this.val=tse(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Joe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Joe(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function jk(t){return t.map(e=>e.read())}function Gk(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Gn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class No{constructor(e,n,s,r,a,o,l){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=l,this.id=tF(),o!=null&&(this.originalName=rF(o),this.name=aF(this.originalName)),this.rank=n.length}}let Qoe=0,Jy=class{constructor(e,n){this.callArgs=n,this.id=Qoe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},eie=0;class kt extends Ad{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=eie++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=bi(s)+"_"+qy(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),s=[a].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new ia(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new j(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Qs(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Qs(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new bo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new bo(`Layer ${this.name} is not connected, no input to return.`);return Qs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new bo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new bo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Qs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Gt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Gt(this.inputSpec);if(n.length!==s.length)throw new j(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const a=n[r],o=s[r];if(o==null)continue;const l=a.rank;if(o.ndim!=null&&l!==o.ndim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${l}`);if(o.maxNDim!=null&&l>o.maxNDim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${l}`);if(o.minNDim!=null&&l<o.minNDim)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${l}.`);if(o.dtype!=null&&a.dtype!==o.dtype)throw new j(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${a.dtype}.`);if(o.axes){const c=a.shape;for(const u in o.axes){const d=Number(u),m=o.axes[u],h=d>=0?c[d]:c[c.length+d];if(m!=null&&[m,null].indexOf(h)===-1)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected axis ${d} of input shape to have value ${m} but got shape ${c}.`)}}if(o.shape!=null)for(let c=0;c<o.shape.length;++c){const u=o.shape[c],d=a.shape[c];if(u!=null&&d!=null&&u!==d)throw new j(`Input ${r} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${a.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Gt(e),r=sie(e),a=rie(e);if(r===a)throw new j("Arguments to apply() must be all SymbolicTensors or all Tensors");return jc(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const o=[];for(const l of Gt(e))o.push(l.shape);this.build(Qs(o)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let o=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,o);const l=Gt(o),c=[];for(let u of l)s.indexOf(u)!==-1&&(u=u.clone()),c.push(u);if(o=Qs(c),this.activityRegularizer!=null)throw new bt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return o}else{const o=tie(e),l=this.computeOutputShape(o);let c;const u=nie(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?o[0]:o),l!=null&&l.length>0&&Array.isArray(l[0])?c=l.map((d,m)=>new No(u,d,this,Gt(e),n,this.name,m)):c=new No(u,l,this,Gt(e),n,this.name),this.addInboundNode(e,c,null,null,o,l,n),this._refCount++,this.activityRegularizer!=null)throw new bt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new bo(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new bo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ia(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Zy(this.weights)}build(e){this.built=!0}getWeights(e=!1){return jk(e?this.trainableWeights:this.weights)}setWeights(e){re(()=>{const n=this.weights;if(n.length!==e.length)throw new j(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=jk(n);for(let a=0;a<r.length;++a){const o=r[a],l=n[a],c=e[a];if(!zt(o.shape,c.shape))throw new j(`Layer weight shape ${o.shape} not compatible with provided weight shape ${c.shape}`);s.push([l,c])}Gk(s)})}addWeight(e,n,s,r,a,o,l,c){if(this._addedWeightNames.indexOf(e)!==-1)throw new j(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=c!=null?c():pn("zeros"));const u=r.apply(n,s),d=new Zoe(u,s,e,o,l);return u.dispose(),a!=null&&this.addLoss(()=>a.apply(d.read())),o==null&&(o=!0),o?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Gt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),a=Gt(n),o=Gt(r);if(a.length!==o.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let l=0;l<a.length;l++)a[l].kerasMask=o[l]}addInboundNode(e,n,s,r,a,o,l=null){const c=Gt(e);n=Gt(n),s=Gt(s),r=Gt(r),a=Yy(a),o=Yy(o);const u=[],d=[],m=[];for(const h of c)u.push(h.sourceLayer),d.push(h.nodeIndex),m.push(h.tensorIndex);new Jy({outboundLayer:this,inboundLayers:u,nodeIndices:d,tensorIndices:m,inputTensors:c,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:o},l);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function tie(t){t=Gt(t);const e=[];for(const n of t)e.push(n.shape);return Qs(e)}function nie(t){return"float32"}function wF(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const o=s.inputTensors[a],l=s.inboundLayers[a],c=s.nodeIndices[a],u=wF(o,l,c);for(const d of u)r.indexOf(d)===-1&&r.push(d)}return r}}}function sie(t){let e=!0;for(const n of Gt(t))if(!(n instanceof No)){e=!1;break}return e}function rie(t){let e=!0;for(const n of Gt(t))if(n instanceof No){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Jp extends kt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:qy("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new j("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new j("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new j("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new No(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Jy({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new j(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Jp.className="InputLayer",Ne(Jp);function aie(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new j("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Jp({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oie(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return Ue(e,t.dtype)}catch{throw new j(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class yl{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof yl)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=oie(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new j(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof No){if(this.id2Value[e.id]==null)throw new j(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new j(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof No){if(this.id2Value[e.id]==null)throw new j(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new j(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&vt(this.id2Mask)}}const Qy=new ZP,eb=new ZP;function iie(t){Qy?.setMaxEntries(t),eb?.setMaxEntries(t)}function Qp(t,e,n,s){const r=n==null?!1:n.training,a=Array.isArray(t),o=a?t:[t],l=o.map(f=>f.name),c=[],u=e.names();for(const f of l)u.indexOf(f)!==-1?c.push(e.getValue(f)):c.push(null);const d=l.join(",")+"|"+e.names().sort().join(",");let m=Qy.get(d),h;if(m==null){const f=lie(o,e);m=f.sorted,h=f.recipientCounts,Qy.put(d,m),eb.put(d,h)}h={},r||Object.assign(h,eb.get(d));const p=new yl(e);for(let f=0;f<m.length;++f){const y=m[f],x=y.sourceLayer;if(x instanceof Jp)continue;const g=[],b=[],w=[];let v=!1;for(const A of y.inputs){const $=p.getValue(A),T=p.getMask(A);g.push($),b.push(T),T!=null&&(v=!0),r||(h[A.name]--,h[A.name]===0&&!e.hasKey(A)&&l.indexOf(A.name)===-1&&!$.isDisposed&&A.sourceLayer.stateful!==!0&&w.push($))}v&&(n=n||{},n.mask=b[0]);const E=Gt(x.apply(g,n));let k=null;x.supportsMasking&&(k=x.computeMask(g,b));const C=uie(y),I=Array.isArray(C)?C:[C];for(let A=0;A<I.length;++A){p.hasKey(I[A])||p.add(I[A],E[A],Array.isArray(k)?k[0]:k);const $=l.indexOf(I[A].name);$!==-1&&(c[$]=E[A])}r||vt(w)}return p.disposeMasks(),a?c:c[0]}function lie(t,e){R(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=vF(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of t){const{sorted:o,recipientMap:l}=vF(a,e);for(const c of o)r.has(c.name)||(n.push(c),r.add(c.name));for(const c in l)s[c]==null&&(s[c]=new Set),l[c].forEach(u=>s[c].add(u))}}return{sorted:n,recipientCounts:cie(s)}}function cie(t){const e={};for(const n in t)e[n]=t[n].size;return e}function vF(t,e){const n=new Set,s=[],r={};for(const l of e.names())n.add(l);const a=[],o=[];for(a.push(t);a.length>0;){const l=a[a.length-1];if(n.has(l.name)){a.pop();continue}const c=o[o.length-1]===a.length-1;if(l.inputs.length===0||c)a.pop(),s.push(l),n.add(l.name),c&&o.pop();else{o.push(a.length-1);for(const u of l.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(l.name),!n.has(u.name)&&a.push(u)}}return{sorted:s,recipientMap:r}}function uie(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ie().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,iie);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Hk(t,e){return re(()=>Es(st(G(t,t),e,!0)))}class ef extends Ad{getConfig(){return{}}}class EF extends ef{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>{const n=Hk(e,this.axis),s=_r(n,0,this.maxValue);return G(e,rt(s,Ce(jn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}EF.className="MaxNorm",Ne(EF);class NF extends ef{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>rt(e,Ce(jn(),Hk(e,this.axis))))}getConfig(){return{axis:this.axis}}}NF.className="UnitNorm",Ne(NF);class kF extends ef{apply(e){return Oc(e)}}kF.className="NonNeg",Ne(kF);class SF extends ef{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return re(()=>{const n=Hk(e,this.axis),s=Ce(G(this.rate,_r(n,this.minValue,this.maxValue)),G(1-this.rate,n));return G(e,rt(s,Ce(jn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}SF.className="MinMaxNorm",Ne(SF);const CF={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Hn(t){return $k(t)}function IF(t,e={}){return qp(t,oa.getMap().classNameMap,e,"constraint")}function qn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in CF?CF[t]:t,config:{}};return IF(n)}else return t instanceof ef?t:IF(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Hc(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const a=t[r];if(typeof a!="number"){const o=a;e.push(o.data()),n.push(r),s.push(o)}}if(e.length>0){const r=await Promise.all(e);for(let a=0;a<r.length;++a)t[n[a]]=r[a][0];vt(s)}}function $F(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var TF;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(TF||(TF={}));const die=125;class tf{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class mie{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class hie extends tf{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const a=n[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let o;r in this.totals?o=this.totals[r]:this.totals[r]=0;const l=re(()=>Ce(this.totals[r],G(a,s)));this.totals[r]=l,o?.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:re(()=>{const r=G(rt(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),ho(n[s])}))}}class pie extends tf{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const a in this.history){const o=this.history[a];for(let l=0;l<o.length;++l)if(typeof o[l]!="number"){const c=o[l];e.push(c.data()),n.push(a),s.push(l)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[n[a]][s[a]].dispose(),this.history[n[a]][s[a]]=r[a][0]}}class fie extends tf{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||gP,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=die),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");JE(this.yieldEvery)&&(this.maybeWait=Toe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await Hc(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await Hc(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await Hc(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await Hc(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await Hc(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):JE(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Hc(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Hc(e),await this.trainEnd(e))}}function AF(t,e){return t==null&&(t={}),t instanceof tf?[t]:Array.isArray(t)&&t[0]instanceof tf?t:Gt(t).map(s=>new fie(s,e))}class ua{constructor(){}static registerCallbackConstructor(e,n){R(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),ua.checkForDuplicate(n),ua.constructors[e]==null&&(ua.constructors[e]=[]),ua.constructors[e].push(n)}static checkForDuplicate(e){for(const n in ua.constructors)ua.constructors[+n].forEach(r=>{if(r===e)throw new j("Duplicate callback constructor.")})}static clear(){ua.constructors={}}static createCallbacks(e){const n=[];for(const s in ua.constructors){const r=+s;e>=r&&n.push(...ua.constructors[r])}return n.map(s=>new s)}}ua.constructors={};function RF(t,e,n,s,r,a,o,l,c){const u=new pie,d=[new hie,...ua.createCallbacks(e)];t!=null&&d.push(...t),d.push(u);const m=new mie(d);return m.setParams({epochs:n,initialEpoch:s,samples:r,steps:a,batchSize:o,verbose:e,doValidation:l,metrics:c}),{callbackList:m,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ko(t,e={},n=!1){return qp(t,oa.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tb(t,e){return re(()=>{t.dtype!=="float32"&&(t=Ue(t,"float32"));const n=st(Yp(t),e,!0),s=_y(n.shape,jn()),r=Es(ml(n,s));return rt(t,r)})}function nb(t,e){return re(()=>Ln(Yp(lt(e,t)),-1))}function qk(t,e){return re(()=>Ln(Ds(lt(e,t)),-1))}function Kk(t,e){return re(()=>{const n=lt(t,e),s=_r(Ds(t),jn(),Number.MAX_VALUE),r=Ds(rt(n,s));return G(100,Ln(r,-1))})}function gie(t,e){return re(()=>{const n=_r(e,jn(),Number.MAX_VALUE),s=xo(Ce(1,n)),r=_r(t,jn(),Number.MAX_VALUE),a=xo(Ce(1,r));return Ln(Yp(lt(s,a)),-1)})}function xie(t,e){return re(()=>{const n=ml(0,lt(1,G(t,e)));return Ln(Yp(n),-1)})}function yie(t,e){return re(()=>{const n=ml(0,lt(1,G(t,e)));return Ln(n,-1)})}function bie(t,e){return re(()=>{const n=st(G(t,e),-1),s=Oa(G(lt(1,t),e),-1);return ml(0,Ce(1,lt(s,n)))})}function wie(t,e){return re(()=>{const n=Math.log(2),s=lt(e,t),r=lt(Ce(s,Lp(G(-2,s))),n);return Ln(r,-1)})}function nf(t,e,n=!1){return re(()=>{if(n)e=zN(e);else{const s=st(e,e.shape.length-1,!0);e=rt(e,s)}return e=_r(e,jn(),1-jn()),Tn(st(G(Ue(t,"float32"),xo(e)),e.shape.length-1))})}function sb(t,e,n=!1){return re(()=>{const s=Ue(My(Uoe(t)),"int32");e=_r(e,jn(),1-jn());const r=e.shape,a=Q(A3(s,r[r.length-1]),r);return nf(a,e,n)})}function vie(t,e){if(!zt(t.shape,e.shape))throw new j(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return re(()=>{const n=Oc(e),s=Tn(Ds(e));return Ce(lt(n,G(e,t)),C3(go(s)))})}function rb(t,e){return re(()=>{let n;return n=_r(e,jn(),1-jn()),n=xo(rt(n,lt(1,n))),Ln(vie(t,n),-1)})}function Eie(t,e){return re(()=>{const n=_r(t,jn(),1),s=_r(e,jn(),1);return st(G(t,xo(rt(n,s))),-1)})}function Nie(t,e){return re(()=>{const n=xo(Ce(jn(),e));return Ln(lt(e,G(t,n)),-1)})}function _F(t,e){return re(()=>{const n=tb(t,-1),s=tb(e,-1),r=G(n,s);return Tn(st(r,-1))})}const ab={meanSquaredError:nb,meanAbsoluteError:qk,meanAbsolutePercentageError:Kk,meanSquaredLogarithmicError:gie,squaredHinge:xie,hinge:yie,categoricalHinge:bie,logcosh:wie,categoricalCrossentropy:nf,sparseCategoricalCrossentropy:sb,binaryCrossentropy:rb,kullbackLeiblerDivergence:Eie,poisson:Nie,cosineProximity:_F};function Xk(t){if(typeof t=="string"){if(t in ab)return ab[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new j(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function DF(t,e){return re(()=>{const n=G(.5,aa(e)),s=vo(Dr(e,n),t.dtype);return Ln(fo(t,s),-1)})}function PF(t,e){return re(()=>vo(fo(_p(t,-1),_p(e,-1)),"float32"))}function kie(t,e){return re(()=>Ue(st(pi(fo(t,1),fo(e,1))),"float32"))}function Sie(t,e){return re(()=>Ue(st(pi(fo(t,0),fo(e,1))),"float32"))}function Cie(t,e){return re(()=>{const n=kie(t,e),s=Sie(t,e),r=Ce(n,s);return Ue(Ps(Dr(r,0),rt(n,r),0),"float32")})}function Iie(t,e){return rb(t,e)}function $ie(t,e){return t.rank===e.rank&&(t=Vp(t,[t.rank-1])),e=_p(e,-1),e.dtype!==t.dtype&&(e=Ue(e,t.dtype)),Ue(fo(t,e),"float32")}const Tie=nb,Aie=nb,Rie=qk,_ie=qk,Die=Kk,Pie=Kk,FF=nf,Fie=_F,MF=sb,ob={binaryAccuracy:DF,categoricalAccuracy:PF,precision:Cie,categoricalCrossentropy:FF,sparseCategoricalCrossentropy:MF,mse:Tie,MSE:Aie,mae:Rie,MAE:_ie,mape:Die,MAPE:Pie,cosine:Fie};function Mie(t){if(typeof t=="string"&&t in ob)return ob[t];if(typeof t!="string"&&t!=null)return t;throw new j(`Unknown metric ${t}`)}function ib(t){if(wo(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(ab))if(ab[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(ob))if(ob[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Oie(t){const e={Adagrad:()=>Rd.adagrad(.01),Adadelta:()=>Rd.adadelta(1,.95,jn()),Adam:()=>Rd.adam(.001,.9,.999,jn()),Adamax:()=>Rd.adamax(.002,.9,.999,jn(),0),RMSProp:()=>Rd.rmsprop(.001,.9,0,jn()),SGD:()=>Rd.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new j(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const OF=1*1024*1024;function LF(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Yk(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>OF&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${OF}.`)}}function Yk(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Yk(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Yk(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lie(t,e,n,s=console.log){const r=Bie(t),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(d=>Math.floor(e*d)));let o;if(!r){a.push("Receives inputs"),o=[];for(const d in t.nodesByDepth)o.push(...t.nodesByDepth[d])}s("_".repeat(e)),lb(a,n,s),s("=".repeat(e));const l=t.layers;for(let d=0;d<l.length;++d)r?Uie(l[d],n,s):Vie(l[d],n,o,s),s((d===l.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const c=zie(t),u=Zy(t.nonTrainableWeights);s(`Total params: ${c+u}`),s(`Trainable params: ${c}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function zie(t){let e;return t.collectedTrainableWeights!=null?e=Zy(t.collectedTrainableWeights):e=Zy(t.trainableWeights),e}function Bie(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let a=!1;for(const o of r.inboundNodes)if(s.indexOf(o)!==-1)if(a){e=!1;break}else a=!0;if(!e)break}return e}function lb(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function Uie(t,e,n){let s,r;try{r=t.inboundNodes.map(c=>JSON.stringify(c.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const a=t.name,o=t.getClassName(),l=[`${a} (${o})`,r,s,t.countParams().toString()];lb(l,e,n)}function Vie(t,e,n,s){let r,a;try{a=t.inboundNodes.map(m=>JSON.stringify(m.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const o=[];for(const m of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(m)===-1))for(let h=0;h<m.inboundLayers.length;++h){const p=m.inboundLayers[h].name,f=m.nodeIndices[h],y=m.tensorIndices[h];o.push(`${p}[${f}][${y}]`)}const l=t.name,c=t.getClassName(),u=o.length===0?"":o[0],d=[`${l} (${c})`,a,r,t.countParams().toString(),u];lb(d,e,s);for(let m=1;m<o.length;++m)lb(["","","","",o[m]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zF(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function cb(t,e){if(t===null)return null;if(typeof t=="string")return Vc(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const a=t[r];zF(e,r,a)?n.push(a):n.push(cb(a,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const a=Vc(s);n[a]=cb(r,a)}}return n}}function Zk(t,e){if(t==null)return null;if(typeof t=="string")return bi(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const a=t[r];zF(e,r,a)?n.push(a):n.push(Zk(a,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],a=bi(s);(s==="name"||s==="className")&&typeof r=="string"?n[a]=r:n[a]=Zk(r,s)}return n}}/** @license See the LICENSE file. */const BF="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Wie=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Wa extends kt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=qy(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],fl(this.inputs).length!==this.inputs.length)throw new j(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);fl(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const w=b.sourceLayer,v=b.nodeIndex,E=b.tensorIndex;this.outputLayers.push(w),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(E)}for(const b of this.inputs){const w=b.sourceLayer,v=b.nodeIndex,E=b.tensorIndex;wo(v===0,"input layer has >1 nodes"),wo(E===0,"input layer has >1 tensors"),this.inputLayers.push(w),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(E)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const w=this.inputLayers[b];if(!(w instanceof Jp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${w.getClassName()}.`);this.inputNames.push(w.name),this.feedInputShapes.push(w.batchInputShape),this.feedInputNames.push(w.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const n={},s={},r={},a={},o={},l=[],c=(b,w,v,E,k,C)=>{(E==null||k==null||C==null)&&(E=b.sourceLayer,k=b.nodeIndex,C=b.tensorIndex);const I=E.inboundNodes[k];if(v.indexOf(I)!==-1)throw new ia(`The tensor ${b.name} at layer "${E.name}" is part of a cycle.`);if(w.indexOf(I)!==-1)return;this.containerNodes.add(Wa.nodeKey(E,k)),E.id in o||(o[E.id]=Object.keys(o).length),v.indexOf(I)===-1&&v.push(I);const A=I.inboundLayers.length;for(let $=0;$<A;$++){const T=I.inputTensors[$],F=I.inboundLayers[$],O=I.nodeIndices[$],M=I.tensorIndices[$];c(T,w,v,F,O,M)}for(w.push(I);v.indexOf(I)>=0;)v.splice(v.indexOf(I),1);l.push(I)},u=[],d=[];for(const b of this.outputs)c(b,u,d);const m=l.slice().reverse();for(const b of m){s[b.id]=b,b.id in n||(n[b.id]=0);let w=n[b.id];const v=r[b.outboundLayer.id]==null?0:r[b.outboundLayer.id];w=Math.max(w,v),r[b.outboundLayer.id]=w,a[b.outboundLayer.id]=b.outboundLayer,n[b.id]=w;for(let E=0;E<b.inboundLayers.length;E++){const k=b.inboundLayers[E],C=b.nodeIndices[E],I=k.inboundNodes[C],A=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(w+1,A),s[I.id]=I}}const h={};for(const b in n){const w=n[b];w in h||(h[w]=[]),h[w].push(s[b])}const p={};for(const b in r){const w=r[b];w in p||(p[w]=[]),p[w].push(a[b])}let f=Object.keys(p).map(b=>parseInt(b,10)).sort(Gy);this.layers=[];for(const b of f){const w=p[b];w.sort((v,E)=>{const k=o[v.id],C=o[E.id];return k<C?-1:k>C?1:0});for(const v of w)v instanceof Wa&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=p,f=Object.keys(h).map(b=>parseInt(b,10)).sort(Gy);const y=this.inputs.slice(),x=[];for(const b of f)for(const w of h[b]){const v=w.outboundLayer;if(v!=null){for(const E of w.inputTensors)if(y.indexOf(E)===-1)throw new ia(`Graph disconnected: cannot obtain value for tensor ${E} at layer "${v.name}". The following previous layers were accessed without issue: ${x}`);for(const E of w.outputTensors)y.push(E);x.push(v.name)}}this.nodesByDepth=h;const g=this.layers.map(b=>b.name);for(const b of g){const w=g.filter(v=>v===b).length;if(w!==1)throw new ia(`The name "${b}" is used ${w} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new Jy({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new j("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const a=Wie(e);a&&this.parseWeights(e);for(const l of this.layers)for(const[c,u]of l.weights.entries()){const d=a?`${u.name.split("/").slice(0,-1).join("/")+"/"}${c}`:u.originalName;if(s[d]!=null)throw new j(`Duplicate weight name: ${d}`);s[d]=u,r++}const o=[];for(const l in e){let c=l;if(s[l]==null){const u=l.split("/");c=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[c]!=null)o.push([s[c],e[l]]);else if(n)throw new j(`Provided weight data has no target variable: ${l}`);delete s[c]}if(n){const l=[];for(const c in s)l.push(c);if(l.length>0)throw new j(`${l.length} of ${r} weights are not set: ${l}`)}Gk(o)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(o=>o.startsWith("_")?o.slice(1):o).filter(o=>!r.includes(o)).join("/");a!==n&&(e[a]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${BF}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=Zk(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return re(()=>{e=Gt(e);const s=new yl;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Qp(this.outputs,s,n)})}computeMask(e,n){return re(()=>{e=Gt(e);let s;return n==null?s=Uc(null,e.length):s=Gt(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=Yy(e);if(n.length!==this.inputLayers.length)throw new j(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let l=0;l<n.length;l++){const c=this.inputLayers[l],u=n[l],d=c.name+"_0_0";s[d]=u}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Gy);if(r.length>1)for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer;if(this.inputLayers.map(y=>y.id).indexOf(d.id)!==-1)continue;const m=[];for(let y=0;y<u.inboundLayers.length;y++){const x=u.inboundLayers[y],g=u.nodeIndices[y],b=u.tensorIndices[y],w=`${x.name}_${g}_${b}`,v=s[w];m.push(v)}const h=d.computeOutputShape(Qs(m)),p=Yy(h),f=d.inboundNodes.indexOf(u);for(let y=0;y<p.length;y++){const x=`${d.name}_${f}_${y}`;s[x]=p[y]}}}const a=[],o=[];for(let l=0;l<this.outputLayers.length;l++){const c=this.outputLayers[l],u=this.outputLayersNodeIndices[l],d=this.outputLayersTensorIndices[l],m=`${c.name}_${u}_${d}`;o.push(m)}for(let l=0;l<o.length;l++){const c=o[l];wo(c in s),a.push(s[c])}return Qs(a)}runInternalGraph(e,n){n==null&&(n=Uc(null,e.length));const s={};for(let c=0;c<this.inputs.length;++c){const u=this.inputs[c],d=e[c],m=n[c];s[u.id]=[d,m]}const r=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(Gy);for(const c of r){const u=this.nodesByDepth[c];for(const d of u){const m=d.outboundLayer,h=d.inputTensors,p=d.outputTensors,f=new Array;for(const y of h)y.id in s&&f.push(s[y.id]);if(f.length===h.length){let y={},x,g,b,w;if(d.callArgs!=null&&(y=d.callArgs),f.length===1){const[v,E]=f[0];y.mask==null&&(y.mask=E),b=Gt(m.call(v,y)),w=Gt(m.computeMask(v,E)),x=[v],g=[E]}else x=f.map(v=>v[0]),g=f.map(v=>v[1]),y.mask==null&&(y.mask=g),b=Gt(m.call(x,y)),w=Gt(m.computeMask(x,g));if(m.activityRegularizer)throw new bt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<p.length;++v){const E=p[v],k=b[v],C=w[v];s[E.id]=[k,C]}}}}const a=[],o=[],l=[];for(const c of this.outputs){wo(c.id in s,`Could not compute output ${c.name} : ${c.id}`);const[u,d]=s[c.id];l.push(u.shape),a.push(u),o.push(d)}return[a,o,l]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Wa?1:0;for(let a=0;a<r.inboundNodes.length;a++){const o=Wa.nodeKey(r,a);this.containerNodes.has(o)&&(n[o]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new j("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new j(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new j(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return re(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Wa.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const o of this.layers){const l=o.getClassName(),c=o.getConfig(),u=[];for(let m=0;m<o.inboundNodes.length;m++){const h=o.inboundNodes[m],p=Wa.nodeKey(o,m);let f={};if(this.containerNodes.has(p)){if(h.callArgs)try{JSON.stringify(h.callArgs),f=h.callArgs}catch{console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),f={}}if(h.inboundLayers.length>0){const y=[];for(let x=0;x<h.inboundLayers.length;x++){const g=h.inboundLayers[x],b=h.nodeIndices[x],w=h.tensorIndices[x],v=Wa.nodeKey(g,b);let E=n[v];E==null&&(E=0),y.push([g.name,E,w,f])}u.push(y)}}}const d={};d.name=o.name,d.className=l,d.config=c,d.inboundNodes=u,s.push(d)}e.layers=s;const r=[];for(let o=0;o<this.inputLayers.length;o++){const l=this.inputLayers[o],c=this.inputLayersNodeIndices[o],u=Wa.nodeKey(l,c);if(!this.containerNodes.has(u))continue;let d=n[u];d==null&&(d=0);const m=this.inputLayersTensorIndices[o];r.push([l.name,d,m])}e.inputLayers=r;const a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],u=Wa.nodeKey(l,c);if(!this.containerNodes.has(u))continue;let d=n[u];d==null&&(d=0);const m=this.outputLayersTensorIndices[o];a.push([l.name,d,m])}return e.outputLayers=a,e}static fromConfig(e,n,s={},r=!1){const a={},o={};function l(x,g){x.name in o?o[x.name].push(g):o[x.name]=[g]}function c(x,g){const b=[];let w;for(const v of g){const E=v[0],k=v[1],C=v[2];if(w=v[3]==null?{}:v[3],!(E in a)){l(x,g);return}const I=a[E];if(I.inboundNodes.length<=k){l(x,g);return}const A=I.inboundNodes[k];b.push(A.outputTensors[C])}b.length>0&&x.apply(Qs(b),w)}function u(x){const g=x.name,b=ko(x,n.customObjects!=null?n.customObjects:{});b.setFastWeightInitDuringBuild(r),a[g]=b,x.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new j(`Corrupted configuration, expected array for nodeData: ${v}`);l(b,v)})}const d=n.name,m=n.layers;for(const x of m)u(x);for(;!$oe(o);)for(const x of m){const g=a[x.name];if(g.name in o){const b=o[g.name];delete o[g.name];for(const w of b)c(g,w)}}const h=[],p=[],f=n.inputLayers;for(const x of f){const g=x[0],b=x[1],w=x[2];wo(g in a);const E=a[g].inboundNodes[b].outputTensors;h.push(E[w])}const y=n.outputLayers;for(const x of y){const g=x[0],b=x[1],w=x[2];wo(g in a);const E=a[g].inboundNodes[b].outputTensors;p.push(E[w])}return new e({inputs:h,outputs:p,name:d})}get stateful(){if(this._stateful)throw new j("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){re(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jie(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(a=>{a in t?r.push(t[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function UF(t,e){return jie(t,e,"classWeight")}async function VF(t,e,n,s){if(n!=null){const r=re(()=>{if(t.shape.length===1)return Ac(t);if(t.shape.length===2){if(t.shape[1]>1)return _p(t,1);if(t.shape[1]===1)return Q(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());vt(r);const o=[];return a.forEach(l=>{if(n[l]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${l} exists in the data but not in classWeight`);o.push(n[l])}),fr(o,"float32")}else return null}function Gie(t,e){return G(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Hie=32;function WF(t,e){let n,s;const r=e;n=r.xs,s=r.ys,R(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const a=jF("input",t.inputNames,n),o=jF("output",t.outputNames,s),l=a[0].shape[0];R(a.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),R(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let c=0;c<a.length;c++)R(a[c].shape[0]===l,()=>`Batch size mismatch: input ${t.inputNames[c]} has ${a[c].shape[0]}; expected  ${l} based on input ${t.inputNames[0]}.`);for(let c=0;c<o.length;c++)R(o[c].shape[0]===l,()=>`Batch size mismatch: output ${t.outputNames[c]} has ${o[c].shape[0]}; expected  ${l} based on input ${t.inputNames[0]}.`);return{xs:a,ys:o}}function jF(t,e,n){if(n instanceof Vn)return[n];if(Array.isArray(n))return R(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new j(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function qie(t){if(t.length===3)throw new bt("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function Kie(t,e,n){const s=n.batchesPerEpoch!=null;if(R(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),R(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),R(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),R(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),R(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let a,o;if(r)if(GF(n.validationData))R(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const x=qie(n.validationData);a=x.xs,o=x.ys}const l=t.makeTrainFunction(),c=t.getDedupedMetricsNames();let u;r?u=c.slice().concat(c.map(x=>"val_"+x)):u=c.slice();const d=AF(n.callbacks,n.yieldEvery),m=n.verbose==null?1:n.verbose,{callbackList:h,history:p}=RF(d,m,n.epochs,null,null,Xie(e,n),null,r,u);h.setModel(t),t.history=p,await h.onTrainBegin(),t.stopTraining_=!1;let f=n.initialEpoch==null?0:n.initialEpoch,y=await e.iterator();for(;f<n.epochs;){const x={};await h.onEpochBegin(f);let g=0,b=0;for(s||(y=await e.iterator());!s||g<n.batchesPerEpoch;){const w=await y.next();if(s&&w.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(w.value!=null){const{xs:v,ys:E}=WF(t,w.value),k={};k.batch=b,k.size=v[0].shape[0],await h.onBatchBegin(b,k);const C=[];if(n.classWeight!=null){const $=UF(n.classWeight,t.outputNames);for(let T=0;T<$.length;++T)C.push(await VF(E[T],null,$[T]))}const I=v.concat(E).concat(C),A=l(I);vt(I);for(let $=0;$<c.length;++$){const T=c[$],F=A[$];k[T]=F,ho(F)}await h.onBatchEnd(b,k),$F(k),b++,g++}if(s?g>=n.batchesPerEpoch:w.done){if(r){let v;GF(n.validationData)?v=Gt(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):v=Gt(t.evaluate(a,o,{batchSize:n.validationBatchSize==null?Hie:n.validationBatchSize,verbose:0}));for(let E=0;E<t.metricsNames.length;++E)x[`val_${t.metricsNames[E]}`]=v[E]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(f,x),f++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function Xie(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function GF(t){return typeof t.iterator=="function"}function Yie(t){return typeof t.next=="function"}async function Zie(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let a=[];if(n.verbose>0)throw new bt("Verbose mode is not implemented yet.");R(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const o=Yie(e)?e:await e.iterator();let l=0,c=0;for(;!s||c<n.batches;){const u=await o.next();if(a=re(()=>{if(u.value){const{xs:d,ys:m}=WF(t,u.value),h=d.concat(m),p=re(()=>r(h));if(vt(h),c===0)for(let y=0;y<p.length;++y)a.push(Ut(0));const f=h[0].shape[0];for(let y=0;y<p.length;++y){const x=p[y],g=a[y];a[y]=re(()=>Ce(a[y],G(f,x))),c>0&&vt(g)}vt(p),l+=f,++c}return a}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<a.length;++u){const d=a[u];a[u]=rt(a[u],l),vt(d)}return Qs(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jk(t){R(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function sf(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>Gc(s,e,n-e)):Gc(t,e,n-e)}function Qk(t,e){return re(()=>t==null?null:Array.isArray(t)?t.map(n=>Qk(n,e)):lF(t,e.dtype==="int32"?e:Ue(e,"int32")))}function eS(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function HF(t){const e=[];t instanceof Vn&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Xp(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function ja(t,e){if(t==null)return;const n=[];if(e instanceof Vn)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const a=e[r];n.push(a.id)}const s=[];if(t instanceof Vn)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const a=t[r];n.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jie(t){return t instanceof Vn}function tS(t){return Array.isArray(t)}function qF(t){return!Jie(t)&&!tS(t)}function KF(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let o=!1;if(tS(t)&&t.length>0)o=!0;else if(qF(t)){for(const l in t)if(t.hasOwnProperty(l)){o=!0;break}}else o=!0;if(o)throw new j(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(o=>null);let a;if(qF(t)){t=t,a=[];for(const o of e){if(t[o]==null)throw new j(`No data provided for "${o}". Need data for each key in: ${e}`);a.push(t[o])}}else if(tS(t)){if(t=t,t.length!==e.length)throw new j(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);a=t}else{if(t=t,e.length>1)throw new j(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);a=[t]}if(a=HF(a),n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const l=a[o];if(l.shape.length!==n[o].length)throw new j(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape ${l.shape}`);for(let c=0;c<n[o].length;++c){if(c===0&&!s)continue;const u=l.shape[c],d=n[o][c];if(d!=null&&d>=0&&u!==d)throw new j(`${r} expected a batch of elements where each example has shape [${n[o].slice(1,n[o].length)}] (i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}]) but the ${r} received an input with ${l.shape[0]} examples, each with shape [${l.shape.slice(1,l.shape.length)}] (tensor shape [${l.shape}])`)}}return a}function Qie(t,e,n){const s=fl(t.map(a=>a.shape[0]));s.sort();const r=fl(e.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new j(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(r.length>1)throw new j(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!zt(s,r))throw new j(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function ele(t,e,n){const s=[nb,rb,nf];for(let r=0;r<t.length;++r){const a=t[r],o=e[r],l=n[r];if(o!=null){if(o===nf&&a.shape[a.shape.length-1]===1)throw new j(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(o)!==-1){const c=a.shape.slice(1),u=l.slice(1);for(let d=0;d<c.length;++d){const m=c[d],h=u[d];if(h!=null&&m!==h)throw new j(`A target Tensor with shape ${a.shape} was passed for an output of shape ${l}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function XF(t,e,n,s=!0,r=""){let a;if(Array.isArray(t)){if(t.length!==e.length)throw new j(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);a=t}else{if(e.length>1)throw new j(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);a=[t]}if(n!=null)for(let o=0;o<e.length;++o){if(n[o]==null)continue;const l=a[o];if(l.shape.length!==n[o].length)throw new j(`Error when checking ${r}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape ${JSON.stringify(l.shape)}`);for(let c=0;c<n[o].length;++c){if(c===0&&!s)continue;const u=l.shape[c],d=n[o][c];if(d!=null&&d!==u)throw new j(`Error when checking ${r}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(l.shape)}.`)}}}function tle(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let a=n.hasOwnProperty(r)?n[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const nle="layers-model";class Pd extends Wa{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new j("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Lie(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Oie(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof pl))throw new j("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const o in e.loss)if(this.outputNames.indexOf(o)===-1)throw new j(`Unknown entry in loss dictionary: "${o}". Only expected the following keys: ${this.outputNames}`);for(const o of this.outputNames)e.loss[o]==null&&console.warn(`Output "${o}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${o} during training`),n.push(Xk(e.loss[o]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new j(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(l=>Xk(l))}else{const o=Xk(e.loss);this.outputs.forEach(l=>{n.push(o)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let o=0;o<this.outputs.length;++o){const l=this.internalOutputShapes[o],c=this.outputNames[o];this.feedOutputNames.push(c),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[o])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],jc("loss",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const l=this.lossFunctions[o];this.outputs.length>1&&(this.metricsTensors.push([l,o]),this.metricsNames.push(this.outputNames[o]+"_loss"))}});const r=tle(e.metrics,this.outputNames),a=(o,l,c)=>{this.outputNames.length>1&&(l=this.outputNames[o]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([c,o])};jc("metric",()=>{for(let o=0;o<this.outputs.length;++o){if(s.indexOf(o)!==-1)continue;const l=r[o];(u=>{const d="";let m,h,p;for(const f of u){if(typeof f=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(f)!==-1){const x=this.internalOutputShapes[o];x[x.length-1]===1||this.lossFunctions[o]===rb?["accuracy","acc"].indexOf(f)!==-1?h=DF:["crossentropy","ce"].indexOf(f)!==-1&&(h=Iie):this.lossFunctions[o]===sb?["accuracy","acc"].indexOf(f)!==-1?h=$ie:["crossentropy","ce"].indexOf(f)!==-1&&(h=MF):["accuracy","acc"].indexOf(f)!==-1?h=PF:["crossentropy","ce"].indexOf(f)!==-1&&(h=FF);let g;["accuracy","acc"].indexOf(f)!==-1?g="acc":["crossentropy","ce"].indexOf(f)!==-1&&(g="ce"),p=h,m=d+g}else p=Mie(f),m=d+ib(f);let y;jc(m,()=>{y=p}),a(o,m,y)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;Jk(r);const o=this.standardizeUserDataXY(e,n,!0,r);try{const l=o[0].concat(o[1]);this.makeTestFunction();const c=this.testFunction,u=this.testLoop(c,l,r,s.verbose,s.steps);return Qs(u)}finally{ja(o[0],e),ja(o[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),Zie(this,e,n)}checkNumSamples(e,n,s,r="steps"){let a;if(s!=null){if(a=null,n!=null)throw new j(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new j(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new j("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],a=this.retrieveSymbolicTensors(r),o=new yl;if(e instanceof Vn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new j(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)o.add(this.inputs[c],e[c])}else for(const c of this.inputs){const u=e[c.name];if(u==null)throw new j(`No value is provided for the model's input ${c.name}`);o.add(c,u)}const l=Qp(a,o);return s?l:l[0]}retrieveSymbolicTensors(e){const n=Uc(null,e.length);let s=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],o=a.map(l=>l.name);for(let l=0;l<e.length;++l){const c=o.indexOf(e[l]);if(c!==-1&&(n[l]=a[c],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((a,o)=>{a==null&&r.push(e[o])}),new j(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return re(()=>{const r=this.checkNumSamples(e);if(s)throw new bt("Verbose predictLoop() is not implemented yet.");const a=eS(r,n),o=this.outputs.map(l=>[]);for(let l=0;l<a.length;++l)re(()=>{const u=a[l][0],d=a[l][1],m=sf(e,u,d),h=[];if(Array.isArray(m))for(let f=0;f<m.length;++f)h.push({key:this.inputs[f],value:m[f]});else h.push({key:this.inputs[0],value:m});const p=new yl(h);return Qp(this.outputs,p)}).forEach((u,d)=>o[d].push(u));return Qs(o.map(l=>Zs(l,0)))})}predict(e,n={}){const s=HF(e);XF(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return Jk(r),this.predictLoop(s,r)}finally{ja(s,e)}}predictOnBatch(e){XF(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new ia("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let o=0;o<this.feedOutputShapes.length;++o){const l=this.feedOutputShapes[o];this.feedLossFns[o]===sb?a.push(l.slice(0,l.length-1).concat([1])):a.push(l)}if(e=KF(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=KF(n,this.feedOutputNames,a,!1,"target"),Qie(e,n),ele(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new j(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,a=!0,o){const[l,c]=this.standardizeUserDataXY(e,n,a,o);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const d=UF(r,this.outputNames);u=[];for(let m=0;m<d.length;++m)u.push(await VF(c[m],null,d[m]))}return[l,c,u]}testLoop(e,n,s,r=0,a){return re(()=>{const o=this.checkNumSamples(n,s,a,"steps"),l=[];if(r>0)throw new bt("Verbose mode is not implemented yet.");if(a!=null)throw new bt("steps mode in testLoop() is not implemented yet");{const c=eS(o,s),u=fr(Ba(0,o));for(let d=0;d<c.length;++d){const m=c[d][0],h=c[d][1],p=Gc(u,m,h-m),f=Qk(n,p),y=e(f);if(d===0)for(let x=0;x<y.length;++x)l.push(Ut(0));for(let x=0;x<y.length;++x){const g=y[x];l[x]=Ce(l[x],G(h-m,g))}}for(let d=0;d<l.length;++d)l[d]=rt(l[d],o)}return l})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let a=r;if(JP(e,r)>1){const o=JP(e.slice(0,s),r);a+=`_${o}`}n.push(a)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),o=[],l=()=>{const m=[];for(let y=0;y<this.inputs.length;++y)m.push({key:this.inputs[y],value:s[y]});const h=new yl(m),p=Qp(this.outputs,h,{training:!0});let f;for(let y=0;y<this.lossFunctions.length;++y){const x=this.lossFunctions[y];let g=x(r[y],p[y]);a[y]!=null&&(g=Gie(g,a[y]));const b=Ln(g);n.push(b),y===0?f=g:f=Ce(f,g)}for(let y=0;y<this.metricsTensors.length;++y){let x;if(this.outputs.length>1&&y<this.outputs.length)x=n[y];else{const g=this.metricsTensors[y][0],b=this.metricsTensors[y][1];x=Ln(g(r[b],p[b]))}ho(x),o.push(x)}return f=Ln(f),this.calculateLosses().forEach(y=>{f=Ce(f,y)}),f},c=this.collectedTrainableWeights.map(m=>m.read());return[this.optimizer_.minimize(l,!0,c)].concat(o)}}makeTestFunction(){this.testFunction=e=>re(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=[];for(let u=0;u<this.inputs.length;++u)o.push({key:this.inputs[u],value:r[u]});const l=new yl(o),c=Qp(this.outputs,l);for(let u=0;u<this.lossFunctions.length;++u){const d=this.lossFunctions[u],m=Ln(d(a[u],c[u]));u===0?s=m:s=Ce(s,m),n.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const d=this.metricsTensors[u][0],m=this.metricsTensors[u][1],h=Ln(d(a[m],c[m]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,o,l,c,u,d,m,h;try{const p=s.batchSize==null?32:s.batchSize;Jk(p);const y=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,p);r=y[0],a=y[1],h=y[2];let x=!1,g;if(s.validationData!=null&&s.validationData.length>0){if(x=!0,s.validationData.length===2)c=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new bt("validationData including sample weights is not supported yet."):new j(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=await this.standardizeUserData(c,u,null,null,!0,p);d=$[0],m=$[1],g=d.concat(m)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){x=!0;const A=Math.floor(r[0].shape[0]*(1-s.validationSplit)),$=r[0].shape[0];d=sf(r,A,$),o=r,r=sf(r,0,A),m=sf(a,A,$),l=a,a=sf(a,0,A),g=d.concat(m)}else s.validationSteps!=null&&(x=!0);const b=r.concat(a).concat(h);this.checkTrainableWeightsConsistency();const w=this.makeTrainFunction(),v=this.getDedupedMetricsNames();let E,k;x?(this.makeTestFunction(),E=this.testFunction,k=v.slice().concat(v.map(A=>"val_"+A))):(E=null,g=[],k=v.slice());const C=AF(s.callbacks,s.yieldEvery);return await this.fitLoop(w,b,v,p,s.epochs,s.verbose,C,E,g,s.shuffle,k,s.initialEpoch,null,null)}finally{this.isTraining=!1,ja(r,e),ja(a,n),ja(o,e),ja(l,n),ja(d,c),ja(m,u),h!=null&&vt(h)}}async fitLoop(e,n,s,r,a,o,l,c,u,d,m,h,p,f){r==null&&(r=32),a==null&&(a=1),d==null&&(d=!0),h==null&&(h=0);let y=!1;if(c!=null&&u!=null&&(y=!0),f!=null&&(y=!0,p==null))throw new j("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(n,r,p,"steps_per_epoch");let g;x!=null&&(g=Ba(0,x)),o==null&&(o=1);const{callbackList:b,history:w}=RF(l,o,a,h,x,p,r,y,m);b.setModel(this),this.history=w,await b.onTrainBegin(),this.stopTraining_=!1;for(let v=h;v<a;++v){await b.onEpochBegin(v);const E={};if(p!=null)throw new bt("stepsPerEpoch mode is not implemented yet.");{if(d==="batch")throw new bt("batch shuffling is not implemneted yet");d&&$Z(g);const k=fr(g),C=eS(x,r);for(let I=0;I<C.length;++I){const A={};if(await b.onBatchBegin(I,A),re(()=>{const $=C[I][0],T=C[I][1],F=Gc(k,$,T-$);A.batch=I,A.size=T-$;const O=Qk(n,F),M=e(O);for(let B=0;B<s.length;++B){const L=s[B],Y=M[B];A[L]=Y,ho(Y)}if(I===C.length-1&&y){const B=this.testLoop(c,u,r);for(let L=0;L<s.length;++L){const Y=s[L],D=B[L];ho(D),E["val_"+Y]=D}}}),await b.onBatchEnd(I,A),$F(A),this.stopTraining_)break}k.dispose()}if(await b.onEpochEnd(v,E),this.stopTraining_)break}return await b.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return Kie(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],a=s[1],l=this.makeTrainFunction()(r.concat(a)),c=[];for(const u of l){const d=await u.data();c.push(d[0])}return vt(l),ja(s[0],e),ja(s[1],n),Qs(c)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let o=0;o<r.length;++o)s&&!r[o].trainable||n.push({name:r[o].originalName,tensor:a[o]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=n3().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-n3().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=bi(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>bi(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=bi(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[bi(ib(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>bi(ib(e)));{const e={};for(const n in this.metrics)e[n]=bi(ib(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=cb(e.optimizer_config),s=ko(n);let r;if(typeof e.loss=="string")r=Vc(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(o=>Vc(o));else if(e.loss!=null){r={};for(const o in e.loss)r[o]=Vc(e.loss[o])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(o=>Vc(o));else if(e.metrics!=null){a={};for(const o in e.metrics)a[o]=Vc(e.metrics[o])}this.compile({loss:r,metrics:a,optimizer:s})}async save(e,n){if(typeof e=="string"){const u=DJ(e);if(u.length===0)throw new j(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new j(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new j("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await r3(this.getNamedWeights(n)),l={modelTopology:this.toJSON(null,!1),format:nle,generatedBy:`TensorFlow.js tfjs-layers v${BF}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:d,specs:m}=await r3(await this.optimizer.getWeights(),u);s.specs.push(...m),s.data=SJ([s.data,d])}return this.userDefinedMetadata!=null&&(LF(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=s.data,l.weightSpecs=s.specs,e.save(l)}setUserDefinedMetadata(e){LF(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Pd.className="Model",Ne(Pd);class YF extends Pd{}YF.className="Functional",Ne(YF);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function sle(t,e){if(e==null&&(e={}),typeof t=="string"){const n=PJ(t,e);if(n.length===0)n.push(dre(t,e));else if(n.length>1)throw new j(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return rle(t,void 0,e)}async function rle(t,e,n){if(n==null&&(n={}),t.load==null)throw new j("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const a=n.strict==null?!0:n.strict,o=s.weightData!=null&&s.weightSpecs!=null&&a,l=ko(cb(r),e,o),c=s.trainingConfig;if(c!=null&&l.loadTrainingConfig(c),s.userDefinedMetadata!=null&&l.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new j("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:u,optimizerWeights:d}=ale(s.weightData,s.weightSpecs);l.loadWeights(u,a),l.optimizer!=null&&d.length>0&&await l.optimizer.setWeights(d),vt(u),vt(d.map(m=>m.tensor))}return l}function ale(t,e){const n=bJ(t,e),s={},r=[];return e.forEach(a=>{a.group==="optimizer"?r.push({name:a.name,tensor:n[a.name]}):s[a.name]=n[a.name]}),{modelWeights:s,optimizerWeights:r}}class Fd extends Pd{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:qy("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new j(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Fd||e instanceof Pd;let s;if(n){if(s=e,s.outputs.length!==1)throw new j("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new j("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new j("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=aie({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new j(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new j("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=wF(this.outputs[0])}this.inboundNodes=[],new Jy({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Uc(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Ft(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Pd({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new ia("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new ia("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new ia("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new ia("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let a,o={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new j("Legacy serialization format not supported yet.");a=n}else R(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,o=n;const l=new e(o);if(!(l instanceof Fd))throw new bt(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(const c of a){const d=ko(c,void 0,r);r&&d.setFastWeightInitDuringBuild(!0),l.add(d)}return l}set stopTraining(e){if(this.model==null)throw new j("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new j("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Fd.className="Sequential",Ne(Fd);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ole(t){return new Fd(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ns=class extends Ad{getConfig(){return{}}};class ZF extends Ns{apply(e,n=1){return Woe(e,n)}}ZF.className="elu",Ne(ZF);class JF extends Ns{apply(e){return M3(e)}}JF.className="selu",Ne(JF);class QF extends Ns{apply(e){return Oc(e)}}QF.className="relu",Ne(QF);class eM extends Ns{apply(e){return re(()=>zp(6,Oc(e)))}}eM.className="relu6",Ne(eM);class tM extends Ns{apply(e){return e}}tM.className="linear",Ne(tM);class nM extends Ns{apply(e){return Sd(e)}}nM.className="sigmoid",Ne(nM);class sM extends Ns{apply(e){return Goe(e)}}sM.className="hardSigmoid",Ne(sM);class rM extends Ns{apply(e){return Lp(e)}}rM.className="softplus",Ne(rM);class aM extends Ns{apply(e){return joe(e)}}aM.className="softsign",Ne(aM);class oM extends Ns{apply(e){return Ay(e)}}oM.className="tanh",Ne(oM);let nS=class extends Ns{apply(e,n=-1){return zN(e,n)}};nS.className="softmax",Ne(nS);class iM extends Ns{apply(e,n=-1){return I3(e,n)}}iM.className="logSoftmax",Ne(iM);class lM extends Ns{apply(e){return re(()=>re(()=>{const n=Math.sqrt(2),s=G(.5,Ce(1,E3(rt(e,n))));return G(e,s)}))}}lM.className="gelu",Ne(lM);class cM extends Ns{apply(e){return re(()=>G(.5,G(e,Ce(1,Ay(G(Es(rt(2,Math.PI)),Ce(e,G(.044715,Pc(e,3)))))))))}}cM.className="gelu_new",Ne(cM);class uM extends Ns{apply(e){return re(()=>G(e,Ay(Lp(e))))}}uM.className="mish",Ne(uM);class dM extends Ns{apply(e,n=1){return re(()=>G(Sd(G(e,n)),e))}}dM.className="swish",Ne(dM);function bl(t){return t.getClassName()}function sS(t,e={}){return qp(t,oa.getMap().classNameMap,e,"activation")}function wl(t){if(t==null){const e={};return e.className="linear",e.config={},sS(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},sS(e)}else return t instanceof Ns?t:sS(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ile(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class mM extends Ad{}class hM extends mM{constructor(e){super(),ile(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return re(()=>{let n=es([1]);return this.hasL1&&(n=Ce(n,st(G(this.l1,Ds(e))))),this.hasL2&&(n=Ce(n,st(G(this.l2,Yp(e))))),Q(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}hM.className="L1L2",Ne(hM);const pM={l1l2:"L1L2"};function Jt(t){return $k(t)}function fM(t,e={}){return qp(t,oa.getMap().classNameMap,e,"regularizer")}function fn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in pM?pM[t]:t,config:{}};return fM(n)}else return t instanceof mM?t:fM(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gM extends kt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=ut(e);let s=Oc(e);return this.maxValue!=null&&(s=_r(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}gM.className="ReLU",Ne(gM);class xM extends kt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ut(e);return NN(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}xM.className="LeakyReLU",Ne(xM);class yM extends kt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=pn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=fn(e.alphaRegularizer),this.alphaConstraint=qn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new j(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Ft(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Gn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=ut(e),TN(e,this.alpha.read())}getConfig(){const e={alphaInitializer:bn(this.alphaInitializer),alphaRegularizer:Jt(this.alphaRegularizer),alphaConstraint:Hn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}yM.className="PReLU",Ne(yM);let bM=class extends kt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new bt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=ut(e);return Dy(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};bM.className="ELU",Ne(bM);class wM extends kt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=ut(e);return G(s,Ue(Dr(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}wM.className="ThresholdedReLU",Ne(wM);class vM extends kt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new nS().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return re(()=>{let s=ut(e);const r=n.mask;if(r!=null){const a=G(lt(hl(s.shape),Ue(r,s.dtype)),Ut(-1e9));s=Ce(s,a)}return this.axis instanceof Array?this.axis.length>1?go(lt(s,$3(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}vM.className="Softmax",Ne(vM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Md(t,e,n){if(typeof t=="number")return Uc(t,e);if(t.length!==e)throw new j(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!zoe(r))throw new j(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function Ga(t,e,n,s,r=1){if(t==null)return t;const a=e+(e-1)*(r-1);let o;return n==="same"?o=t:o=t-a+1,Math.floor((o+s-1)/s)}function So(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+xl([n-e,0]);else if(s==="same")t=t*e;else throw new j(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rS(t,e){return re(()=>(An(e),e==="channelsFirst"?_t(t,[0,2,3,1]):t))}function EM(t,e){return re(()=>(An(e),e==="channelsFirst"?_t(t,[0,2,3,4,1]):t))}function lle(t,e,n,s=1,r="valid",a,o=1){return re(()=>{if(a==null&&(a=Ua()),An(a),t.shape.length!==3)throw new j(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new j(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new j(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(a==="channelsFirst"&&(t=_t(t,[0,2,1])),r==="causal")throw new bt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let l=g3(t,e,s,r==="same"?"same":"valid","NWC",o);return n!=null&&(l=Va(l,n)),l})}function NM(t,e,n,s=[1,1],r="valid",a,o,l=null){return re(()=>{if(a==null&&(a=Ua()),An(a),t.rank!==3&&t.rank!==4)throw new j(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new j(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let c=rS(t,a);if(r==="causal")throw new bt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=lse({x:c,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:l}),a==="channelsFirst"&&(c=_t(c,[0,3,1,2])),c})}function cle(t,e,n,s=[1,1,1],r="valid",a,o){return re(()=>{if(a==null&&(a=Ua()),An(a),t.rank!==4&&t.rank!==5)throw new j(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new j(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let l=EM(t,a);if(r==="causal")throw new bt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return l=cee(l,e,s,r==="same"?"same":"valid","NDHWC",o),n!=null&&(l=Va(l,n)),a==="channelsFirst"&&(l=_t(l,[0,4,1,2,3])),l})}class ub extends kt{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",ub.verifyArgs(n),this.rank=e,ts(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new bt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Md(n.kernelSize,e,"kernelSize"),this.strides=Md(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,Fr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,An(this.dataFormat),this.activation=wl(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=pn(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=qn(n.biasConstraint),this.biasRegularizer=fn(n.biasRegularizer),this.activityRegularizer=fn(n.activityRegularizer),this.dilationRate=Md(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new j(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new j(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new j(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(wo("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Ak(e.kernelSize,"number",1,3))throw new j(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:bl(this.activation),useBias:this.useBias,biasInitializer:bn(this.biasInitializer),biasRegularizer:Jt(this.biasRegularizer),activityRegularizer:Jt(this.activityRegularizer),biasConstraint:Hn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Od extends ub{constructor(e,n){super(e,n),this.kernel=null,Od.verifyArgs(n),this.filters=n.filters,ts(this.filters,"filters"),this.kernelInitializer=pn(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=qn(n.kernelConstraint),this.kernelRegularizer=fn(n.kernelRegularizer)}build(e){e=Ft(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return re(()=>{e=ut(e);let s;const r=this.bias==null?null:this.bias.read(),a=eF(this.activation.getClassName());if(a!=null&&this.rank===2)s=NM(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=lle(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=NM(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=cle(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new bt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Ft(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<s.length;++a){const o=Ga(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);n.push(o)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:bn(this.kernelInitializer),kernelRegularizer:Jt(this.kernelRegularizer),kernelConstraint:Hn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new j(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class rf extends Od{constructor(e){super(2,e),rf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Ak(e.kernelSize,"number",1,2))throw new j(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}rf.className="Conv2D",Ne(rf);class af extends Od{constructor(e){super(3,e),af.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new j(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}af.className="Conv3D",Ne(af);class kM extends rf{constructor(e){if(super(e),this.inputSpec=[new Gn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new j(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ft(e),e.length!==4)throw new j("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Gn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{let s=ut(e);if(s.shape.length!==4)throw new j(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let o,l;this.dataFormat==="channelsFirst"?(o=2,l=3):(o=1,l=2);const c=r[o],u=r[l],d=this.kernelSize[0],m=this.kernelSize[1],h=this.strides[0],p=this.strides[1],f=So(c,h,d,this.padding),y=So(u,p,m,this.padding),x=[a,f,y,this.filters];this.dataFormat!=="channelsLast"&&(s=_t(s,[0,2,3,1]));let g=x3(s,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=_t(g,[0,3,1,2])),this.bias!=null&&(g=Va(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=Ft(e);const n=e.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],u=this.strides[1];return n[s]=this.filters,n[r]=So(n[r],c,o,this.padding),n[a]=So(n[a],u,l,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}kM.className="Conv2DTranspose",Ne(kM);class SM extends af{constructor(e){if(super(e),this.inputSpec=[new Gn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new j(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Ft(e),e.length!==5)throw new j("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new j("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Gn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{let s=ut(e);if(s.shape.length!==5)throw new j(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let o,l,c;this.dataFormat==="channelsFirst"?(c=2,o=3,l=4):(c=1,o=2,l=3);const u=r[c],d=r[o],m=r[l],h=this.kernelSize[0],p=this.kernelSize[1],f=this.kernelSize[2],y=this.strides[0],x=this.strides[1],g=this.strides[2],b=So(u,y,h,this.padding),w=So(d,x,p,this.padding),v=So(m,g,f,this.padding),E=[a,b,w,v,this.filters];this.dataFormat!=="channelsLast"&&(s=_t(s,[0,2,3,4,1]));let k=mee(s,this.kernel.read(),E,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=_t(k,[0,4,1,2,3])),this.bias!==null&&(k=Va(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(e){e=Ft(e);const n=e.slice();let s,r,a,o;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,o=4):(s=4,r=1,a=2,o=3);const l=this.kernelSize[0],c=this.kernelSize[1],u=this.kernelSize[2],d=this.strides[0],m=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=So(n[r],d,l,this.padding),n[a]=So(n[a],m,c,this.padding),n[o]=So(n[o],h,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}SM.className="Conv3DTranspose",Ne(SM);class CM extends Od{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new j("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new j("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new j(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=pn(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=fn(n.depthwiseRegularizer),this.depthwiseConstraint=qn(n.depthwiseConstraint),this.pointwiseInitializer=pn(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=fn(n.pointwiseRegularizer),this.pointwiseConstraint=qn(n.pointwiseConstraint)}build(e){if(e=Ft(e),e.length<this.rank+2)throw new j(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new j(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let l=0;l<this.rank;++l)a.push(1);a.push(s*this.depthMultiplier,this.filters);const o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Gn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return re(()=>{e=ut(e);let s;if(this.rank===1)throw new bt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=_t(e,[0,2,3,1])),s=O3(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Va(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=_t(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=bn(this.depthwiseInitializer),e.pointwiseInitializer=bn(this.pointwiseInitializer),e.depthwiseRegularizer=Jt(this.depthwiseRegularizer),e.pointwiseRegularizer=Jt(this.pointwiseRegularizer),e.depthwiseConstraint=Hn(this.depthwiseConstraint),e.pointwiseConstraint=Hn(this.pointwiseConstraint),e}}CM.className="SeparableConv";class IM extends CM{constructor(e){super(2,e)}}IM.className="SeparableConv2D",Ne(IM);class db extends Od{constructor(e){super(1,e),db.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Ak(e.kernelSize,"number",1,1))throw new j(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}db.className="Conv1D",Ne(db);class $M extends kt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return re(()=>{if(e=ut(e),this.dataFormat==="channelsLast"){const s=Ky(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Ky(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Ky(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Ky(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}$M.className="Cropping2D",Ne($M);class TM extends kt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,An(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,Moe(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return re(()=>{let s=ut(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=_t(s,[0,2,3,1]);const a=this.size[0]*r[2],o=this.size[1]*r[3],l=this.interpolation==="nearest"?gi.resizeNearestNeighbor(s,[a,o]):gi.resizeBilinear(s,[a,o]);return _t(l,[0,3,1,2])}else{const a=this.size[0]*r[1],o=this.size[1]*r[2];return this.interpolation==="nearest"?gi.resizeNearestNeighbor(s,[a,o]):gi.resizeBilinear(s,[a,o])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}TM.className="UpSampling2D",Ne(TM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ule(t,e,n=[1,1],s="valid",r,a){return re(()=>{r==null&&(r=Ua()),An(r);let o=rS(t,r);if(t.rank!==4)throw new j(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new j(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return o=bN(o,e,n,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(o=_t(o,[0,3,1,2])),o})}class AM extends ub{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=pn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=qn(e.depthwiseConstraint),this.depthwiseRegularizer=fn(e.depthwiseRegularizer)}build(e){if(e=Ft(e),e.length<4)throw new j(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new j(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{e=ut(e);let s=ule(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Va(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Ft(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Ga(n,this.kernelSize[0],this.padding,this.strides[0]),o=Ga(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,o]:[e[0],a,o,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=bn(this.depthwiseInitializer),e.depthwiseRegularizer=Jt(this.depthwiseRegularizer),e.depthwiseConstraint=Hn(this.depthwiseRegularizer),e}}AM.className="DepthwiseConv2D",Ne(AM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function RM(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new j("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function _M(t,e,n,s=!1,r,a,o=!1,l=!1){return re(()=>{const c=e.shape.length;if(c<3)throw new j(`Input should be at least 3D, but is ${c}D.`);const u=[1,0].concat(Ba(2,c));e=_t(e,u),o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Ue(Ue(r,"bool"),"float32"),r.rank===c-1&&(r=Js(r,-1)),r=_t(r,u)),s&&(e=Lc(e,0),r!=null&&(r=Lc(r,0)));const d=[];let m,h=n;const p=e.shape[0],f=Bc(e);let y;r!=null&&(y=Bc(r));for(let g=0;g<p;++g){const b=f[g],w=re(()=>t(b,h));if(r==null)m=w[0],h=w[1];else{const v=re(()=>{const E=y[g],k=lt(aa(E),E),C=Ce(G(w[0],E),G(h[0],k)),I=h.map((A,$)=>Ce(G(w[1][$],E),G(A,k)));return{output:C,newStates:I}});m=v.output,h=v.newStates}l&&d.push(m)}let x;return l&&(x=fi(d,1)),[m,x,h]})}class vl extends kt{constructor(e){super(e);let n;if(e.cell==null)throw new j("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new iS({cells:e.cell}):n=e.cell,n.stateSize==null)throw new j("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Gn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Ba(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Wk(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const a=[];for(const o of n)a.push([e[0],o]);return[r].concat(a)}else return r}computeMask(e,n){return re(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new bt("Constants support is not implemented in RNN yet.");Wk(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Gn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!zt(this.stateSpec.map(o=>o.shape[o.shape.length-1]),a))throw new j(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(o=>new Gn({shape:[null,o]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){re(()=>{if(!this.stateful)throw new bo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new j("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>es([s,r])):this.states_=[es([s,this.cell.stateSize])];else if(e==null)vt(this.states_),this.keptStates!=null&&(vt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>es([s,r])):this.states_[0]=es([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new j(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):vt(this.states_);for(let r=0;r<this.states_.length;++r){const a=e[r],o=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,l=[s,o];if(!zt(a.shape,l))throw new j(`State ${r} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>ho(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const a=RM(e,s,r,this.numConstants);e=a.inputs,s=a.initialState,r=a.constants;let o=[],l=[];if(s!=null){n.initialState=s,o=o.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Gn({shape:u.shape}));l=l.concat(this.stateSpec)}if(r!=null&&(n.constants=r,o=o.concat(r),this.numConstants=r.length),o[0]instanceof No){const u=[e].concat(o),d=this.inputSpec.concat(l),m=this.inputSpec;this.inputSpec=d;const h=super.apply(u,n);return this.inputSpec=m,h}else return super.apply(e,n)}call(e,n){return re(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let a=n==null?null:n.initialState;e=ut(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));const o=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==o)throw new j(`RNN Layer has ${o} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const l={training:r},u=_M((f,y)=>{const x=this.cell.call([f].concat(y),l);return[x[0],x.slice(1)]},e,a,this.goBackwards,s,null,this.unroll,this.returnSequences),d=u[0],m=u[1],h=u[2];this.stateful&&this.resetStates(h,r);const p=this.returnSequences?m:d;return this.returnState?[p].concat(h):p})}getInitialState(e){return re(()=>{let n=es(e.shape);return n=st(n,[1,2]),n=Xp(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?Pk(n,[1,s]):n):this.cell.stateSize>1?[Pk(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===vl.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,a=ko(r,s);return new e(Object.assign(n,{cell:a}))}}vl.className="RNN",Ne(vl);class mb extends kt{}class aS extends mb{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,ts(this.units,"units"),this.activation=wl(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=pn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=fn(e.kernelRegularizer),this.recurrentRegularizer=fn(e.recurrentRegularizer),this.biasRegularizer=fn(e.biasRegularizer),this.kernelConstraint=qn(e.kernelConstraint),this.recurrentConstraint=qn(e.recurrentConstraint),this.biasConstraint=qn(e.biasConstraint),this.dropout=Dd([1,xl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Dd([1,xl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ft(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{if(e=e,e.length!==2)throw new j(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=El({ones:()=>aa(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=El({ones:()=>aa(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const o=this.dropoutMask,l=this.recurrentDropoutMask;o!=null?a=Eo(G(e,o),this.kernel.read()):a=Eo(e,this.kernel.read()),this.bias!=null&&(a=Va(a,this.bias.read())),l!=null&&(s=G(s,l));let c=Ce(a,Eo(s,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:bl(this.activation),useBias:this.useBias,kernelInitializer:bn(this.kernelInitializer),recurrentInitializer:bn(this.recurrentInitializer),biasInitializer:bn(this.biasInitializer),kernelRegularizer:Jt(this.kernelRegularizer),recurrentRegularizer:Jt(this.recurrentRegularizer),biasRegularizer:Jt(this.biasRegularizer),activityRegularizer:Jt(this.activityRegularizer),kernelConstraint:Hn(this.kernelConstraint),recurrentConstraint:Hn(this.recurrentConstraint),biasConstraint:Hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}aS.className="SimpleRNNCell",Ne(aS);class DM extends vl{constructor(e){e.cell=new aS(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return new e(n)}}DM.className="SimpleRNN",Ne(DM);class oS extends mb{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new j("GRUCell does not support reset_after parameter set to true.");this.units=e.units,ts(this.units,"units"),this.activation=wl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=wl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=pn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=fn(e.kernelRegularizer),this.recurrentRegularizer=fn(e.recurrentRegularizer),this.biasRegularizer=fn(e.biasRegularizer),this.kernelConstraint=qn(e.kernelConstraint),this.recurrentConstraint=qn(e.recurrentConstraint),this.biasConstraint=qn(e.biasConstraint),this.dropout=Dd([1,xl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Dd([1,xl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Ft(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return re(()=>{if(e=e,e.length!==2)throw new j(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=El({ones:()=>aa(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=El({ones:()=>aa(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,u;0<this.dropout&&this.dropout<1&&(e=G(e,a[0]));let d=Eo(e,this.kernel.read());this.useBias&&(d=Va(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=G(r,o[0]));const m=this.recurrentKernel.read(),[h,p]=Pr(m,[2*this.units,this.units],m.rank-1),f=Eo(r,h),[y,x,g]=Pr(d,3,d.rank-1),[b,w]=Pr(f,2,f.rank-1);l=this.recurrentActivation.apply(Ce(y,b)),c=this.recurrentActivation.apply(Ce(x,w));const v=Eo(G(c,r),p);u=this.activation.apply(Ce(g,v));const E=Ce(G(l,r),G(Ce(1,Tn(l)),u));return[E,E]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:bl(this.activation),recurrentActivation:bl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bn(this.kernelInitializer),recurrentInitializer:bn(this.recurrentInitializer),biasInitializer:bn(this.biasInitializer),kernelRegularizer:Jt(this.kernelRegularizer),recurrentRegularizer:Jt(this.recurrentRegularizer),biasRegularizer:Jt(this.biasRegularizer),activityRegularizer:Jt(this.activityRegularizer),kernelConstraint:Hn(this.kernelConstraint),recurrentConstraint:Hn(this.recurrentConstraint),biasConstraint:Hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}oS.className="GRUCell",Ne(oS);class PM extends vl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new oS(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}PM.className="GRU",Ne(PM);class hb extends mb{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,ts(this.units,"units"),this.activation=wl(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=wl(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=pn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=fn(e.kernelRegularizer),this.recurrentRegularizer=fn(e.recurrentRegularizer),this.biasRegularizer=fn(e.biasRegularizer),this.kernelConstraint=qn(e.kernelConstraint),this.recurrentConstraint=qn(e.recurrentConstraint),this.biasConstraint=qn(e.biasConstraint),this.dropout=Dd([1,xl([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Dd([1,xl([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Ft(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,o=this.units;r=new(n=class extends ca{apply(c,u){const d=a.apply([o]),m=new Mk().apply([o]),h=a.apply([o*2]);return iF(iF(d,m),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return re(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new j(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=El({ones:()=>aa(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=El({ones:()=>aa(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,l=this.recurrentDropoutMask;let c,u,d,m;0<this.dropout&&this.dropout<1&&(e=G(e,o[0]));let h=Eo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=G(r,l[0])),h=Ce(h,Eo(r,this.recurrentKernel.read())),this.useBias&&(h=Va(h,this.bias.read()));const[p,f,y,x]=Pr(h,4,h.rank-1);c=this.recurrentActivation.apply(p),u=this.recurrentActivation.apply(f),d=Ce(G(u,a),G(c,this.activation.apply(y))),m=this.recurrentActivation.apply(x);const g=G(m,this.activation.apply(d));return[g,g,d]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:bl(this.activation),recurrentActivation:bl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:bn(this.kernelInitializer),recurrentInitializer:bn(this.recurrentInitializer),biasInitializer:bn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Jt(this.kernelRegularizer),recurrentRegularizer:Jt(this.recurrentRegularizer),biasRegularizer:Jt(this.biasRegularizer),activityRegularizer:Jt(this.activityRegularizer),kernelConstraint:Hn(this.kernelConstraint),recurrentConstraint:Hn(this.recurrentConstraint),biasConstraint:Hn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}hb.className="LSTMCell",Ne(hb);class FM extends vl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new hb(e),super(e)}call(e,n){return re(()=>{this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}FM.className="LSTM",Ne(FM);class iS extends mb{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return re(()=>{e=e;let s=e.slice(1);const r=[];for(const l of this.cells.slice().reverse())Array.isArray(l.stateSize)?r.push(s.splice(0,l.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let o;for(let l=0;l<this.cells.length;++l){const c=this.cells[l];s=r[l],l===0?o=[e[0]].concat(s):o=[o[0]].concat(s),o=c.call(o,n),a.push(o.slice(1))}s=[];for(const l of a.slice().reverse())s.push(...l);return[o[0]].concat(s)})}build(e){Wk(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{jc(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const a of n.cells)r.push(ko(a,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return jk(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,a=e.splice(r);for(let o=0;o<s.weights.length;++o)n.push([s.weights[o],a[o]])}Gk(n)}}iS.className="StackedRNNCells",Ne(iS);function El(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:a}=t,o=()=>a!=null?a(e(),n):cF(e(),n),l=()=>Zp(o,e,s);return!r||r<=1?ho(l().clone()):Array(r).fill(void 0).map(l).map(u=>ho(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var dle=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class MM extends vl{constructor(e){if(e.unroll)throw new bt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new bt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Gn({ndim:5})]}call(e,n){return re(()=>{if(this.cell.dropoutMask!=null&&(vt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(vt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new j("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return re(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],o=es(a);return Array.isArray(n)?Array(n.length).fill(o):[o]})}resetStates(e,n=!1){re(()=>{if(!this.stateful)throw new bo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new j("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>es(a)):this.states_=[es(a)];else if(e==null)vt(this.states_),this.keptStates!=null&&(vt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>es(a)):this.states_[0]=es(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new j(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):vt(this.states_);for(let l=0;l<this.states_.length;++l){const c=e[l],u=a;if(!zt(c.shape,u))throw new j(`State ${l} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${c.shape}`);this.states_[l]=c}}this.states_=this.states_.map(l=>ho(l.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:a,strides:o,dilationRate:l}=this.cell,c=n==="channelsFirst",u=e[c?3:2],d=e[c?4:3],m=Ga(u,r[0],a,o[0],l[0]),h=Ga(d,r[1],a,o[1],l[1]);return[...e.slice(0,2),...c?[s,m,h]:[m,h,s]]}}MM.className="ConvRNN2D";class lS extends hb{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:a,dataFormat:o,dilationRate:l}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,ts(this.filters,"filters"),this.kernelSize=Md(s,2,"kernelSize"),this.kernelSize.forEach(c=>ts(c,"kernelSize")),this.strides=Md(r||1,2,"strides"),this.strides.forEach(c=>ts(c,"strides")),this.padding=a||"valid",Fr(this.padding),this.dataFormat=o||"channelsLast",An(this.dataFormat),this.dilationRate=Md(l||1,2,"dilationRate"),this.dilationRate.forEach(c=>ts(c,"dilationRate"))}build(e){var n;e=Ft(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new j(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],a=4,o=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",o,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const l=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){const u=this.biasInitializer,d=this.filters;c=new(n=class extends ca{apply(h,p){const f=u.apply([d]),y=hl([d]),x=u.apply([d*2]);return Dk([f,y,x])}},n.className="CustomInit",n)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return re(()=>{if(e.length!==3)throw new j(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],a=e[1],o=e[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=El({ones:()=>aa(r),rate:this.dropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,u=(P,z,q)=>!z||!z[q]?P:G(z[q],P);let d=u(r,c,0),m=u(r,c,1),h=u(r,c,2),p=u(r,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=El({ones:()=>aa(a),rate:this.recurrentDropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const f=this.recurrentDropoutMask;let y=u(a,f,0),x=u(a,f,1),g=u(a,f,2),b=u(a,f,3);const w=3,[v,E,k,C]=Pr(this.kernel.read(),l,w),[I,A,$,T]=this.useBias?Pr(this.bias.read(),l):[null,null,null,null];d=this.inputConv(d,v,I,this.padding),m=this.inputConv(m,E,A,this.padding),h=this.inputConv(h,k,$,this.padding),p=this.inputConv(p,C,T,this.padding);const[F,O,M,B]=Pr(this.recurrentKernel.read(),l,w);y=this.recurrentConv(y,F),x=this.recurrentConv(x,O),g=this.recurrentConv(g,M),b=this.recurrentConv(b,B);const L=this.recurrentActivation.apply(Ce(d,y)),Y=this.recurrentActivation.apply(Ce(m,x)),D=Ce(G(Y,o),G(L,this.activation.apply(Ce(h,g)))),_=G(this.recurrentActivation.apply(Ce(p,b)),this.activation.apply(D));return[_,_,D]})}getConfig(){const e=super.getConfig(),n=dle(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const a=Dc(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Va(a,s,this.dataFormat):a}recurrentConv(e,n){return Dc(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}lS.className="ConvLSTM2DCell",Ne(lS);class OM extends MM{constructor(e){const n=new lS(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}OM.className="ConvLSTM2D",Ne(OM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cS extends kt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,a=this.getNoiseShape(s);return Zp(()=>cF(s,this.rate,a,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}cS.className="Dropout",Ne(cS);class LM extends cS{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}LM.className="SpatialDropout1D",Ne(LM);class uS extends kt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,ts(this.units,"units"),this.activation=wl(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=pn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=pn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=qn(e.kernelConstraint),this.biasConstraint=qn(e.biasConstraint),this.kernelRegularizer=fn(e.kernelRegularizer),this.biasRegularizer=fn(e.biasRegularizer),this.activityRegularizer=fn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Ft(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Ft(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e),r=eF(this.activation.getClassName());let a;return r!=null?a=Eo(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=Eo(s,this.kernel.read()),this.bias!=null&&(a=Va(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const e={units:this.units,activation:bl(this.activation),useBias:this.useBias,kernelInitializer:bn(this.kernelInitializer),biasInitializer:bn(this.biasInitializer),kernelRegularizer:Jt(this.kernelRegularizer),biasRegularizer:Jt(this.biasRegularizer),activityRegularizer:Jt(this.activityRegularizer),kernelConstraint:Hn(this.kernelConstraint),biasConstraint:Hn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}uS.className="Dense",Ne(uS);class zM extends kt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Ft(e);for(const n of e.slice(1))if(n==null)throw new j(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],gl(e,1)]}call(e,n){return re(()=>{this.invokeCallHook(e,n);let s=ut(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=_t(s,r)}return Voe(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}zM.className="Flatten",Ne(zM);class BM extends kt{constructor(e){super(e),this.supportsMasking=!0,this.activation=wl(e.activation)}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e);return this.activation.apply(s)})}getConfig(){const e={activation:bl(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}BM.className="Activation",Ne(BM);class UM extends kt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return re(()=>(e=ut(e),Boe(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}UM.className="RepeatVector",Ne(UM);class VM extends kt{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let a=1,o=null;for(let c=0;c<r.length;++c){const u=r[c];if(this.isUnknown(u))if(o===null)o=c;else throw new j("Can only specifiy one unknown dimension.");else a*=u}const l=gl(e);if(o!==null){if(a===0||l%a!==0)throw new j(s);r[o]=l/a}else if(l!==a)throw new j(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Q(s,a)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}VM.className="Reshape",Ne(VM);class WM extends kt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Ba(1,e.dims.length+1);if(!zt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Gn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Ft(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return _t(ut(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}WM.className="Permute",Ne(WM);class jM extends kt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=ut(e);return dN(Ly(s,this.maskValue),-1)}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e),o=dN(Ly(s,this.maskValue),-1,!0);return G(s,Ue(o,s.dtype))})}}jM.className="Masking",Ne(jM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class GM extends kt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Gt(e.inputLength))}this.inputDim=e.inputDim,ts(this.inputDim,"inputDim"),this.outputDim=e.outputDim,ts(this.outputDim,"outputDim"),this.embeddingsInitializer=pn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=fn(e.embeddingsRegularizer),this.activityRegularizer=fn(e.activityRegularizer),this.embeddingsConstraint=qn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return re(()=>this.maskZero?(e=ut(e),Ly(e,Rt(e))):null)}computeOutputShape(e){if(e=Ft(e),this.inputLength==null)return[...e,this.outputDim];const n=Gt(this.inputLength);if(n.length!==e.length-1)throw new j(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const a=n[r],o=e[r+1];if(a!=null&&o!=null&&a!==o)throw new j(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(n[s]=o),s++}}return[e[0],...n,this.outputDim]}call(e,n){return re(()=>{this.invokeCallHook(e,n);let s=ut(e);s.dtype!=="int32"&&(s=vo(s,"int32"));const r=lF(this.embeddings.read(),Q(s,[s.size]));return Q(r,Ft(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:bn(this.embeddingsInitializer),embeddingsRegularizer:Jt(this.embeddingsRegularizer),activityRegularizer:Jt(this.activityRegularizer),embeddingsConstraint:Hn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}GM.className="Embedding",Ne(GM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class qc extends kt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new bt}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const a=e[e.length-n.length+r],o=n[r];if(a==null||o==null||a<0||o<0)s.push(null);else if(a===1)s.push(o);else if(o===1)s.push(a);else{if(a!==o)throw new j("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(a)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Ft(e)]),e=e,e.length<2)throw new j(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const a of e)a!=null&&a[0]!==null&&n.push(a[0]);if(n=fl(n),n.length>1)throw new j(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){const o=e[a]==null?null:e[a].slice(1);s=this.computeElementwiseOpOutputShape(s,o)}const r=e.map(a=>a.length);e.indexOf(null)===-1&&fl(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return re(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){const a=xl(r);for(let o of e){const l=o.rank;for(let c=0;c<a-l;++c)o=Xp(o,1);s.push(o)}return this.mergeFunction(s)}else{let a=!1;for(const c of e){const u=c.rank;if(u==null){const d=c.shape,m=d[0],h=d.slice(1).concat([m]);let p=Q(c,[m].concat(gl(d.slice(1))));p=_t(p,[1,0]),p=Q(p,h),s.push(p),a=!0}else if(u>1){const d=Ba(1,u).concat([0]);s.push(_t(c,d)),a=!0}else s.push(c)}let o=this.mergeFunction(s);const l=o.rank;if(a){if(l==null){const c=o.shape,u=c.length,d=c[u-1],m=[d].concat(c.slice(0,c.length-1));o=Q(_t(Q(o,[-1,d]),[1,0]),m)}else if(l>1){const c=[l-1].concat(Ba(0,l-1));o=_t(o,c)}}return o}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const a=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=fl(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return re(()=>{if(n==null)return null;if(!Array.isArray(n))throw new j("`mask` should be an Array");if(!Array.isArray(e))throw new j("`inputs` should be an Array");if(n.length!==e.length)throw new j(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:Js(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=pi(s,n[r]);return s})}}class HM extends qc{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Ce(n,e[s]);return n})}}HM.className="Add",Ne(HM);class qM extends qc{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=G(n,e[s]);return n})}}qM.className="Multiply",Ne(qM);class KM extends qc{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=Ce(n,e[s]);return G(1/e.length,n)})}}KM.className="Average",Ne(KM);class XM extends qc{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=ml(n,e[s]);return n})}}XM.className="Maximum",Ne(XM);class YM extends qc{constructor(e){super(e)}mergeFunction(e){return re(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=zp(n,e[s]);return n})}}YM.className="Minimum",Ne(YM);class ZM extends qc{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new j("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const a=e[r].slice();a.splice(this.axis,1);let o=!1;for(const l of s)if(zt(l,a)){o=!0;break}o||s.push(a)}if(s.length>1)throw new j("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return re(()=>Dk(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new j("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of n.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new j("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new j("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new j(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return re(()=>{let s=!0;if(n.forEach(o=>{if(o!=null){s=!1;return}}),s)return null;const r=[];for(let o=0;o<e.length;++o)n[o]==null?r.push(Ue(aa(e[o]),"bool")):n[o].rank<e[o].rank?r.push(Js(n[o],-1)):r.push(n[o]);const a=Zs(r,this.axis);return f3(a,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}ZM.className="Concatenate",Ne(ZM);function of(t,e){for(;t<0;)t+=e;return t}function mle(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new bt("batchDot is not implemented for tensors of 4D or higher rank yet");if(R(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),R(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new bt("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const a=n;return re(()=>{let o;if(s>r){o=s-r;const c=[];for(let u=0;u<o;++u)c.push(1);e=Q(e,e.shape.concat(c))}else if(r>s){o=r-s;const c=[];for(let u=0;u<o;++u)c.push(1);t=Q(t,t.shape.concat(c))}else o=0;let l;if(t.shape.length===2&&e.shape.length===2)a[0]===a[1]?l=st(G(t,e),a[0]):l=st(G(_t(t,[1,0]),e),a[1]);else{const c=a[0]!==t.shape.length-1,u=a[1]===e.shape.length-1;l=Bt(t,e,c,u)}if(o>0){let c;s>r?c=s+r-3:c=s-1;const u=[];for(let d=c;d<c+o;++d)u.push(d);l=Vp(l,u)}return l.shape.length===1&&(l=Js(l,1)),l})}class JM extends qc{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){R(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new bt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new j(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new j(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,o)=>of(a,e[o].shape.length)):r=[of(this.axes,n.shape.length),of(this.axes,s.shape.length)],this.normalize&&(n=tb(n,r[0]),s=tb(s,r[1])),mle(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[of(this.axes,e.length),of(this.axes,n.length)],s}computeOutputShape(e){R(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new bt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=n.concat(s);return a.length===1&&a.push(1),a}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}JM.className="Dot",Ne(JM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class QM extends kt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e);return Zp(()=>Ce(Xy(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}QM.className="GaussianNoise",Ne(QM);class eO extends kt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return re(()=>{this.invokeCallHook(e,n);const s=ut(e);return this.rate>0&&this.rate<1?Zp(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return G(s,Xy(s.shape,1,a))},()=>s,n.training||!1):s})}}eO.className="GaussianDropout",Ne(eO);class tO extends kt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ut(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return re(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Zp(()=>{const a=ut(e),c=-1.6732632423543772*1.0507009873554805;let u=Fc(Bp(s),this.rate);u=vo(u,"float32");const d=((1-this.rate)*(1+this.rate*c**2))**-.5,m=-d*c*this.rate,h=Ce(G(a,u),G(Ce(u,-1),c));return Ce(G(h,d),m)},()=>ut(e),n.training||!1)}return e})}}tO.className="AlphaDropout",Ne(tO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lf(t,e,n,s,r,a=.001){let o;if(t.rank===2)o=zQ(t,e,n,s,r,a);else if(t.rank===3)o=UQ(t,e,n,s,r,a);else if(t.rank===4)o=WQ(t,e,n,s,r,a);else throw new bt(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return o}function hle(t,e,n,s,r=.001){return re(()=>{const a=CN(t,s),o=a.mean,l=a.variance;return[lf(t,o,l,n,e,r),o,l]})}function ple(t,e,n,s,r=.001){return re(()=>{const a=CN(t,s),o=a.mean,l=a.variance,c=[];for(const f of Ba(0,t.rank))s.indexOf(f)!==-1?c.push(1):c.push(t.shape[f]);const u=Q(o,c),d=Q(l,c),m=e==null?null:Q(e,c),h=n==null?null:Q(n,c);return[lf(t,u,d,h,m,r),o,l]})}function fle(t,e,n,s,r=.001){return zt(s.slice().sort(),Ba(0,t.rank-1))?hle(t,e,n,s,r):ple(t,e,n,s,r)}class nO extends kt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=pn(e.betaInitializer||"zeros"),this.gammaInitializer=pn(e.gammaInitializer||"ones"),this.movingMeanInitializer=pn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=pn(e.movingVarianceInitializer||"ones"),this.betaConstraint=qn(e.betaConstraint),this.gammaConstraint=qn(e.gammaConstraint),this.betaRegularizer=fn(e.betaRegularizer),this.gammaRegularizer=fn(e.gammaRegularizer)}build(e){e=Ft(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new j(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Gn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return re(()=>{const s=n.training==null?!1:n.training,r=ut(e),a=r.shape,o=a.length,l=Ba(0,o),c=this.axis>=0?this.axis:this.axis+o;l.splice(c,1);const u=Uc(1,o);u[c]=a[c];const d=l.slice();d.sort();const m=!zt(d,Ba(0,o).slice(0,o-1)),h=()=>{if(m){const b=Q(this.movingMean.read(),u),w=Q(this.movingVariance.read(),u),v=this.center?Q(this.beta.read(),u):null,E=this.scale?Q(this.gamma.read(),u):null;return lf(r,b,w,v,E,this.epsilon)}else return lf(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[p,f,y]=fle(r,this.gamma.read(),this.beta.read(),l,this.epsilon),x=(b,w,v)=>{re(()=>{const E=1-v,k=b.read(),C=G(lt(k,w),E);b.write(lt(k,C))})};return(()=>{x(this.movingMean,f,this.momentum),x(this.movingVariance,y,this.momentum)})(),p})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:bn(this.betaInitializer),gammaInitializer:bn(this.gammaInitializer),movingMeanInitializer:bn(this.movingMeanInitializer),movingVarianceInitializer:bn(this.movingVarianceInitializer),betaRegularizer:Jt(this.betaRegularizer),gammaRegularizer:Jt(this.gammaRegularizer),betaConstraint:Hn(this.betaConstraint),gammaConstraint:Hn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}nO.className="BatchNormalization",Ne(nO);class sO extends kt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=pn(e.betaInitializer||"zeros"),this.gammaInitializer=pn(e.gammaInitializer||"ones"),this.betaRegularizer=fn(e.betaRegularizer),this.gammaRegularizer=fn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Ft(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(const a of this.axis)if(a<0||a>=n)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==fl(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=ut(e),r=s.shape,a=r.length;return re(()=>{let{mean:l,variance:c}=CN(s,this.axis,!0);const u=Uc(1,a);for(const y of this.axis)u[y]=r[y];const d=y=>y!=null&&y.shape.length!==a?Q(y,u):y;let m=this.scale?d(this.gamma.read()):null,h=this.center?d(this.beta.read()):null;const p=[],f=[];for(let y=0;y<a;++y)this.axis.indexOf(y)!==-1?(p.push(r[y]),f.push(1)):(p.push(1),f.push(r[y]));return l=La(l,p),c=La(c,p),m!=null&&(m=La(m,f)),h!=null&&(h=La(h,f)),lf(s,l,c,h,m,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:bn(this.betaInitializer),gammaInitializer:bn(this.gammaInitializer),betaRegularizer:Jt(this.betaRegularizer),gammaRegularizer:Jt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}sO.className="LayerNormalization",Ne(sO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gle(t,e,n){return re(()=>{if(t.rank!==4)throw new j(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new j("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Ua()),n!=="channelsLast"&&n!=="channelsFirst")throw new j(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],IN(t,s)})}class rO extends kt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Ua():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new j(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new j(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new j(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new Gn({ndim:4})]}computeOutputShape(e){e=Ft(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return re(()=>gle(ut(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}rO.className="ZeroPadding2D",Ne(rO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pb(t,e,n,s,r,a){return re(()=>{An(r),nF(a),Fr(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=Ua()),a==null&&(a="max"),t=rS(t,r);let o;const l=s==="same"?"same":"valid";return a==="max"?o=SN(t,e,n,l):o=pN(t,e,n,l),r==="channelsFirst"&&(o=_t(o,[0,3,1,2])),o})}function aO(t,e,n,s,r,a){return re(()=>{An(r),nF(a),Fr(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=Ua()),a==null&&(a="max"),t=EM(t,r);let o;const l=s==="same"?"same":"valid";return a==="max"?o=Ite(t,e,n,l):o=TQ(t,e,n,l),r==="channelsFirst"&&(o=_t(o,[0,4,1,2,3])),o})}class oO extends kt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new j(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(ts(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new j(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);ts(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,Fr(this.padding),this.inputSpec=[new Gn({ndim:3})]}computeOutputShape(e){e=Ft(e);const n=Ga(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return re(()=>{this.invokeCallHook(e,n),e=Xp(ut(e),2);const s=this.poolingFunction(ut(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Vp(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class iO extends oO{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return An(a),Fr(r),pb(e,n,s,r,a,"max")}}iO.className="MaxPooling1D",Ne(iO);class lO extends oO{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return An(a),Fr(r),pb(e,n,s,r,a,"avg")}}lO.className="AveragePooling1D",Ne(lO);class cO extends kt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new j(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];ts(this.poolSize,"poolSize"),ts(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,An(this.dataFormat),Fr(this.padding),this.inputSpec=[new Gn({ndim:4})]}computeOutputShape(e){e=Ft(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Ga(n,this.poolSize[0],this.padding,this.strides[0]),s=Ga(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return re(()=>(this.invokeCallHook(e,n),this.poolingFunction(ut(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class uO extends cO{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return An(a),Fr(r),pb(e,n,s,r,a,"max")}}uO.className="MaxPooling2D",Ne(uO);class dO extends cO{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return An(a),Fr(r),pb(e,n,s,r,a,"avg")}}dO.className="AveragePooling2D",Ne(dO);class mO extends kt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new j(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];ts(this.poolSize,"poolSize"),ts(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,An(this.dataFormat),Fr(this.padding),this.inputSpec=[new Gn({ndim:5})]}computeOutputShape(e){e=Ft(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Ga(n,this.poolSize[0],this.padding,this.strides[0]),s=Ga(s,this.poolSize[1],this.padding,this.strides[1]),r=Ga(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return re(()=>(this.invokeCallHook(e,n),this.poolingFunction(ut(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class hO extends mO{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return An(a),Fr(r),aO(e,n,s,r,a,"max")}}hO.className="MaxPooling3D",Ne(hO);class pO extends mO{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return An(a),Fr(r),aO(e,n,s,r,a,"avg")}}pO.className="AveragePooling3D",Ne(pO);class fO extends kt{constructor(e){super(e),this.inputSpec=[new Gn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new bt}}class gO extends fO{constructor(e){super(e||{})}call(e,n){return re(()=>{const s=ut(e);return Ln(s,1)})}}gO.className="GlobalAveragePooling1D",Ne(gO);class xO extends fO{constructor(e){super(e||{})}call(e,n){return re(()=>{const s=ut(e);return Oa(s,1)})}}xO.className="GlobalMaxPooling1D",Ne(xO);class yO extends kt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,An(this.dataFormat),this.inputSpec=[new Gn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new bt}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class bO extends yO{call(e,n){return re(()=>{const s=ut(e);return this.dataFormat==="channelsLast"?Ln(s,[1,2]):Ln(s,[2,3])})}}bO.className="GlobalAveragePooling2D",Ne(bO);class wO extends yO{call(e,n){return re(()=>{const s=ut(e);return this.dataFormat==="channelsLast"?Oa(s,[1,2]):Oa(s,[2,3])})}}wO.className="GlobalMaxPooling2D",Ne(wO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vO extends kt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,a=ko(r,s);delete n.layer;const o={layer:a};return Object.assign(o,n),new e(o)}}class EO extends vO{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Ft(e),e.length<3)throw new j(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Ft(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return re(()=>(e=ut(e),_M((o,l)=>[ut(this.layer.call(o,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}EO.className="TimeDistributed",Ne(EO);function xle(t){Wc(Foe,"BidirectionalMergeMode",t)}const yle="concat";class NO extends vO{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=ko(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=ko(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?yle:e.mergeMode,xle(this.mergeMode),e.weights)throw new bt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,a;return this.returnState&&(a=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):Qs(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const a=RM(e,s,r,this.numConstants);if(e=a.inputs,s=a.initialState,r=a.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const o=[],l=[];if(s!=null){const u=s.length;if(u%2>0)throw new j("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,o.push(...s);const d=s.map(m=>new Gn({shape:m.shape}));this.forwardLayer.stateSpec=d.slice(0,u/2),this.backwardLayer.stateSpec=d.slice(u/2),l.push(...d)}if(r!=null)throw new bt("Support for constants in Bidirectional layers is not implemented yet.");const c=o[0]instanceof No;for(const u of o)if(u instanceof No!==c)throw new j("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){const u=[e].concat(o),d=this.inputSpec.concat(l),m=this.inputSpec;this.inputSpec=d;const h=super.apply(u,n);return this.inputSpec=m,h}else return super.apply(e,n)}call(e,n){return re(()=>{const s=n.initialState;let r,a;if(s==null)r=this.forwardLayer.call(e,n),a=this.backwardLayer.call(e,n);else{const c=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:c})),a=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let o;this.returnState&&(Array.isArray(r)&&(o=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Lc(a,1));let l;return this.mergeMode==="concat"?l=Dk([r,a]):this.mergeMode==="sum"?l=Ce(r,a):this.mergeMode==="ave"?l=G(.5,Ce(r,a)):this.mergeMode==="mul"?l=G(r,a):this.mergeMode==null&&(l=[r,a]),this.returnState?this.mergeMode==null?l.concat(o):[l].concat(o):l})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){jc(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),jc(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(o=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=ko(n.layer);if(delete n.layer,n.numConstants!=null)throw new bt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}NO.className="Bidirectional",Ne(NO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kO extends kt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return re(()=>(e=ut(e),e.dtype!=="float32"&&(e=vo(e,"float32")),Ce(G(e,this.scale),this.offset)))}}kO.className="Rescaling",Ne(kO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:ble,cropAndResize:wle}=gi;class SO extends kt{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,a,o,l,c){return re(()=>{let u,d=!1;const m=n/o,h=s/l,p=(r+n)/o,f=(a+s)/l,y=[m,h,p,f],x=[];e.rank===3?(d=!0,u=fi([e])):u=e;for(let E=0;E<u.shape[0];E++)x.push(y);const g=Rp(x,[x.length,4]),b=Up(0,x.length,1,"int32"),v=wle(u,g,b,[r,a],"nearest");return vo(d?ut(Bc(v)):v,c)})}upsize(e,n,s,r){return re(()=>{const a=ble(e,[n,s]);return vo(a,r)})}call(e,n){return re(()=>{const s=ut(e),r=s.dtype,a=s.shape,o=a[a.length-3],l=a[a.length-2];let c=0;o!==this.height&&(c=Math.floor((o-this.height)/2));let u=0;return l!==this.width&&(u=Math.floor((l-this.width)/2),u===0&&(u=1)),c>=0&&u>=0?this.centerCrop(s,c,u,this.height,this.width,o,l,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ft(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}SO.className="CenterCrop",Ne(SO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vle(t,e,n,s){let r=ut(t);if(r.dtype!=="int32"&&(r=vo(r,"int32")),e==="int")return r;const a=r.shape;if(r.rank===0&&(r=Js(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Js(r,-1)),r.rank>2)throw new j(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${a} which would result in output rank ${r.rank}.`);const o=["multiHot","oneHot"].includes(e),l=r;let c;if(typeof s<"u"&&e==="count"?c=v3(l,s,n,o):c=v3(l,[],n,o),e!=="tfIdf")return c;if(s)return G(c,s);throw new j("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class CO extends kt{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Ft(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return re(()=>{e=ut(e),e.dtype!=="int32"&&(e=vo(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new j(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=ut(n.countWeights)}const r=Oa(e),a=Py(e),o=Dr(this.numTokens,r).bufferSync().get(0),l=Fc(a,0).bufferSync().get(0);if(!(o&&l))throw new j(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return vle(e,this.outputMode,this.numTokens,s)})}}CO.className="CategoryEncoding",Ne(CO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ele=["bilinear","nearest"],IO=new Set(Ele);class $O extends kt{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(IO.has(e.interpolation))this.interpolation=e.interpolation;else throw new j(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Ft(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return re(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return gi.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return gi.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...IO]} are supported`)})}}$O.className="Resizing",Ne($O);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class TO{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}TO.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AO extends kt{constructor(e){super(e),this.randomGenerator=new TO(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}AO.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Nle=["bilinear","nearest"],RO=new Set(Nle);class _O extends AO{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new j(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new j(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new j(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(RO.has(s))this.interpolation=s;else throw new j(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Ft(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return re(()=>{const s=ut(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Bp([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const o=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return gi.resizeBilinear(e,o);case"nearest":return gi.resizeNearestNeighbor(e,o);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...RO]} are supported`)}})}}_O.className="RandomWidth",Ne(_O);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dS(t){return new uS(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */ie().registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var DO;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(DO||(DO={}));var PO;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(PO||(PO={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var FO;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(FO||(FO={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&R(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kle=G3;class fb extends KE{nextDataId(){return fb.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new GD(this,mo())}write(e,n,s){this.firstUse&&(this.firstUse=!1,ie().get("IS_NODE")&&Rr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&_h(s[0])){const a=s.map(o=>ol(o));r=this.write(a,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,a){this.data.set(e,{values:n,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return xi(r,a)}return PZ(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>il(r));return Nt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Nt(e.shape,e.dtype,n)}makeOutput(e,n,s){return mo().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Ks();return e(),{kernelMs:Ks()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ze([e],"where");const n=this.readSync(e.dataId);return kle(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}fb.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MO(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const Sle={kernelName:bx,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;Ze(e,"abs");let s=new Float32Array(ue(e.shape));const r=n.data.get(e.dataId).values;return s=MO(r),n.makeOutput(s,e.shape,e.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rn(t){return(e,n,s,r,a)=>{const o=ft(e,n),l=o.length,c=nt(o),u=ue(o),d=bs(a,u),m=e.length,h=n.length,p=nt(e),f=nt(n),y=Cd(e,o),x=Cd(n,o);if(y.length+x.length===0)for(let g=0;g<d.length;++g)d[g]=t(s[g%s.length],r[g%r.length]);else for(let g=0;g<d.length;++g){const b=fd(g,l,c),w=b.slice(-m);y.forEach(C=>w[C]=0);const v=uo(w,m,p),E=b.slice(-h);x.forEach(C=>E[C]=0);const k=uo(E,h,f);d[g]=t(s[v],r[k])}return[d,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xr(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,a=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,l=n.makeTensorInfo(s.shape,"complex64"),c=n.data.get(l.dataId);return c.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",a),imag:n.makeTensorInfo(r.shape,"float32",o)},l}const Cle={kernelName:m2,backendName:"cpu",kernelFunc:xr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gb(t,e,n="float32"){if(n==="complex64"){const r=gb(t,e,"float32"),a=gb(t,e,"float32");return xr({inputs:{real:r,imag:a},backend:t})}const s=ws(ue(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Co(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Ile={kernelName:Qh,backendName:"cpu",kernelFunc:Co};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kc(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const $le={kernelName:L2,backendName:"cpu",kernelFunc:Kc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OO(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=kc([0],n),[a,o]=Rn((l,c)=>l!==c?1:0)(e,[],t,r,"bool");return[o,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function Nl(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Co({inputs:{x:r},backend:n});const d=gb(n,r.shape,r.dtype),m=Nl({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=xr({inputs:{real:m,imag:d},backend:n});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),h}if(r.dtype==="complex64"){const d=Kc({inputs:{input:r},backend:n}),m=Nl({inputs:{x:d},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(d),m}if(!XD(r.dtype,a)){const d=Co({inputs:{x:r},backend:n});return{dataId:d.dataId,shape:d.shape,dtype:a}}const o=n.data.get(r.dataId).values,[l,c,u]=OO(o,r.shape,r.dtype,a);return n.makeTensorInfo(l,c,u)}const Tle={kernelName:Bh,backendName:"cpu",kernelFunc:Nl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kn(t,e,n,s){return n==null?({inputs:r,backend:a})=>{const{a:o,b:l}=r,c=a;Ze([o,l],t);const u=c.data.get(o.dataId).values,d=c.data.get(l.dataId).values,m=o.dtype==="string"?yi(u):u,h=o.dtype==="string"?yi(d):d,p=s||o.dtype,[f,y]=e(o.shape,l.shape,m,h,p);return c.makeTensorInfo(y,p,f)}:({inputs:r,backend:a})=>{const{a:o,b:l}=r,c=a;if(o.dtype==="complex64"||l.dtype==="complex64"){const u=Nl({inputs:{x:o},backend:c,attrs:{dtype:"complex64"}}),d=c.data.get(u.dataId),m=d.complexTensorInfos.real,h=d.complexTensorInfos.imag,p=c.data.get(m.dataId).values,f=c.data.get(h.dataId).values,y=Nl({inputs:{x:l},backend:c,attrs:{dtype:"complex64"}}),x=c.data.get(y.dataId),g=x.complexTensorInfos.real,b=x.complexTensorInfos.imag,w=c.data.get(g.dataId).values,v=c.data.get(b.dataId).values,[E,k,C]=n(o.shape,l.shape,p,f,w,v),I=c.makeTensorInfo(C,"float32",E),A=c.makeTensorInfo(C,"float32",k),$=xr({inputs:{real:I,imag:A},backend:c});return c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(y),c.disposeIntermediateTensorInfo(I),c.disposeIntermediateTensorInfo(A),$}else{const u=c.data.get(o.dataId).values,d=c.data.get(l.dataId).values,m=s||o.dtype,[h,p]=e(o.shape,l.shape,u,d,m);return c.makeTensorInfo(p,m,h)}}}function mS(t){return(e,n,s,r,a,o)=>{const l=ft(e,n),c=ue(l),u=l.length,d=nt(l),m=bs("float32",c),h=bs("float32",c),p=Cd(e,l),f=Cd(n,l),y=xi(s,r),x=xi(a,o),g=e.length,b=nt(e),w=n.length,v=nt(n);if(p.length+f.length===0)for(let E=0;E<m.length;E++){const k=E%y.length,C=E%x.length,I=t(y[k*2],y[k*2+1],x[C*2],x[C*2+1]);m[E]=I.real,h[E]=I.imag}else for(let E=0;E<m.length;E++){const k=fd(E,u,d),C=k.slice(-g);p.forEach(F=>C[F]=0);const I=uo(C,g,b),A=k.slice(-w);f.forEach(F=>A[F]=0);const $=uo(A,w,v),T=t(y[I*2],y[I*2+1],x[$*2],x[$*2+1]);m[E]=T.real,h[E]=T.imag}return[m,h,l]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LO=Rn((t,e)=>t+e),Ale=mS((t,e,n,s)=>({real:t+n,imag:e+s})),Ld=Kn(gd,LO,Ale),Rle={kernelName:gd,backendName:"cpu",kernelFunc:Ld};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hS(t,e,n,s,r){const a=ue(s),o=ws(r,n);for(let l=0;l<t.length;l++){const c=t[l];if(c<0)throw new Error("Input x must be non-negative!");c>=r||(a>0?o[c]+=e[l]:o[c]+=1)}return o}function zO(t,e,n,s=!1){const r=t.shape[0],a=t.shape[1],o=Nt([r,n],e.dtype);for(let l=0;l<r;l++)for(let c=0;c<a;c++){const u=t.get(l,c);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(s?o.set(1,l,u):e.size>0?o.set(o.get(l,u)+e.get(l,c),l,u):o.set(o.get(l,u)+1,l,u))}return o}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BO=Rn((t,e)=>t&e),_le=Kn(d2,BO),Dle={kernelName:d2,backendName:"cpu",kernelFunc:_le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(t){return(e,n,s)=>{const r=Cn(n,e.length);for(let a=0;a<e.length;++a)r[a]=t(e[a],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e,n){const s=Io(e);return kl(t,s,n)}function kl(t,e,n){return({inputs:s,attrs:r,backend:a})=>{const{x:o}=s;Ze(o,t);const l=a,c=l.data.get(o.dataId).values;let u;if(o.dtype==="string"){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=yi(c)}else u=c;const d=n||o.dtype,m=e(u,d,r);return l.makeTensorInfo(o.shape,d,m)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UO=Io(t=>Math.ceil(t)),Ple=kl(Uh,UO),Fle={kernelName:Uh,backendName:"cpu",kernelFunc:Ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VO(t,e,n,s){const r=Cn(n,ue(e));if(s&&n!=="string"){let a=0;t.forEach(o=>{const l=ue(o.shape);r.set(o.vals,a),a+=l})}else{let a=0;t.forEach(o=>{const l=n==="string"?yi(o.vals):o.vals;let c=0;for(let u=0;u<o.shape[0];++u){const d=u*e[1]+a;for(let m=0;m<o.shape[1];++m)r[d+m]=l[c++]}a+=o.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WO=Rn((t,e)=>t===e?1:0),jO=Kn(Px,WO,null,"bool"),Mle={kernelName:Px,backendName:"cpu",kernelFunc:jO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GO=Io(t=>Math.exp(t)),HO=kl(Kh,GO,"float32"),Ole={kernelName:Kh,backendName:"cpu",kernelFunc:HO};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qO=Io(t=>Math.expm1(t)),Lle=kl(Xh,qO),zle={kernelName:Xh,backendName:"cpu",kernelFunc:Lle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KO=Io(t=>Math.floor(t)),Ble=kl(Yh,KO),Ule={kernelName:Yh,backendName:"cpu",kernelFunc:Ble};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XO=Rn((t,e)=>Math.floor(t/e)),Vle=Kn(Zh,XO,null,"int32"),Wle={kernelName:Zh,backendName:"cpu",kernelFunc:Vle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YO(t,e,n,s,r,a,o,l,c){const u=Nt([s,a],n);for(let d=0;d<s;d++){const m=[];let h=0;for(let p=0;p<r;p++){const f=t[d*r+p];h+=f*o[p],m.push(f)}if(h<0||h>=c/a)throw new Error(`Invalid indices: ${m} does not index into ${l}`);for(let p=0;p<a;p++)u.values[d*a+p]=e.get(...e.indexToLoc(h*a+p))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZO(t,e,n){const s=Nt(n,t.dtype);for(let r=0;r<s.size;++r){const o=s.indexToLoc(r).slice(),l=o[0],c=o[2],u=e.locToIndex([l,c]);o[2]=e.values[u];const d=t.locToIndex(o);0<=d&&d<t.values.length&&(s.values[r]=t.values[d])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JO=Rn((t,e)=>t>e?1:0),jle=Kn(Lx,JO,null,"bool"),Gle={kernelName:Lx,backendName:"cpu",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QO=Rn((t,e)=>t>=e?1:0),Hle=Kn(Jh,QO,null,"bool"),qle={kernelName:Jh,backendName:"cpu",kernelFunc:Hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eL=Rn((t,e)=>t<e?1:0),Kle=Kn(Bx,eL,null,"bool"),Xle={kernelName:Bx,backendName:"cpu",kernelFunc:Kle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tL=Rn((t,e)=>t<=e?1:0),Yle=Kn(Ux,tL,null,"bool"),Zle={kernelName:Ux,backendName:"cpu",kernelFunc:Yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nL(t,e,n){const s=(e-t)/(n-1),r=ws(n,"float32");r[0]=t;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sL=Io(t=>Math.log(t)),Jle=kl(sp,sL),Qle={kernelName:sp,backendName:"cpu",kernelFunc:Jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL(t,e,n,s){const r=bs(s,ue(n));for(let a=0;a<r.length;++a){const o=a*e;let l=t[o];for(let c=0;c<e;++c){const u=t[o+c];(Number.isNaN(u)||u>l)&&(l=u)}r[a]=l}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aL=Rn((t,e)=>Math.max(t,e)),ece=Kn(ap,aL),tce={kernelName:ap,backendName:"cpu",kernelFunc:ece};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oL=Rn((t,e)=>Math.min(t,e)),nce=Kn(op,oL),sce={kernelName:op,backendName:"cpu",kernelFunc:nce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pS=Rn((t,e)=>t*e),rce=mS((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),xb=Kn(lp,pS,rce),ace={kernelName:lp,backendName:"cpu",kernelFunc:xb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iL(t,e,n){const s=al(-1,n);return pS([],e,s,t,n)}function oce(t){const{inputs:e,backend:n}=t,{x:s}=e;Ze(s,"neg");const r=n.data.get(s.dataId).values,[a,o]=iL(r,s.shape,s.dtype);return n.makeTensorInfo(o,s.dtype,a)}const ice={kernelName:Jx,backendName:"cpu",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lL=Rn((t,e)=>t!==e?1:0),lce=Kn(Qx,lL,null,"bool"),cce={kernelName:Qx,backendName:"cpu",kernelFunc:lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fS(t,e,n,s,r){const a=e.length,o=ue(e),l=nt(e),c=nt(r),u=bs(n,ue(r));for(let d=0;d<o;++d){const m=fd(d,a,l),h=new Array(m.length);for(let f=0;f<h.length;f++)h[f]=m[s[f]];const p=uo(h,a,c);u[p]=t[d]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:a}=n;Ze(r,"transpose");const o=r.shape.length,l=new Array(o);for(let m=0;m<l.length;m++)l[m]=r.shape[a[m]];const c=s.data.get(r.dataId).values,u=fS(c,r.shape,r.dtype,a,l);return{dataId:s.write(u,l,r.dtype),shape:l,dtype:r.dtype}}const uce={kernelName:xd,backendName:"cpu",kernelFunc:er};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(t,e,n,s){const[r,a]=Qn(t,s),o=pr(e,"int32"),l=ws(ue(r),o),c=ue(a);for(let u=0;u<l.length;++u){const d=u*c;let m=1;for(let h=0;h<c;++h)m*=n[d+h];l[u]=m}return{outVals:l,outShape:r,outDtype:o}}function dce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s;Ze(r,"prod");const l=r.shape.length,c=Et(a,r.shape),u=yn(c,l);let d=c,m=r;const h=[];u!=null&&(m=er({inputs:{x:r},backend:n,attrs:{perm:u}}),h.push(m),d=$n(d.length,l));const p=n.data.get(m.dataId).values,{outVals:f,outShape:y,outDtype:x}=cL(m.shape,m.dtype,p,d);let g=y;return o&&(g=On(y,c)),h.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(g,x,f)}const mce={kernelName:ay,backendName:"cpu",kernelFunc:dce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hce(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const a=fd(r,e.length,nt(e)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${n})`)}})}function pce(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function fce(t,e,n,s){const r=[];let a=0;const o=e.length-1+n.length,l=new Array(o).fill(null).map(()=>[0]);pce(n,s);let c=1;for(let u=0;u<e.length-1;++u){c*=e[u];const d=e[u+1];for(let m=1;m<c+1;++m)l[u].push(m*d)}for(let u=0;u<t.length;++u){let d=t[u],m=t[u]+1;for(let h=0;h<n.length;++h){const p=n[h],f=h+e.length-1;if(f>=0){const y=l[f],x=y[y.length-1]-p[d];for(let g=d;g<m;++g)l[f].push(p[g+1]+x)}d=p[d],m=p[m]}m!==d&&(r.push([d,m]),a+=m-d)}return{outSplits:l,valueSlices:r,numValues:a}}function gce(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Cn("int32",s);e.push(r),t[n].forEach((a,o)=>r[o]=a)}return e}function uL(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function xce(t,e,n,s,r,a){const o=uL(e,2)[1],l=uL(a,2)[1];let c=0;for(const u of n)for(let d=u[0];d<u[1];++d){for(let m=0;m<s;++m)r[c*l+m]=t[d*o+m];++c}}function yce(t,e,n,s,r){const a=e.slice();a[0]=r;const o=Cn(n,ue(a)),l=t.length,c=l===0?0:l/e[0];return xce(t,e,s,c,o,a),[o,a]}function dL(t,e,n,s,r,a,o,l){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const c=e[0][0]-1;if(hce(a,o,c),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:d,valueSlices:m,numValues:h}=fce(a,o,t,u),p=gce(d),f=yce(n,s,r,m,h);return[p,f[0],f[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mL=2147483647;function hL(t,e,n,s,r,a,o){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");const l=e.length===0,c=r.length===0,u=o.length===0,d=[];l||d.push(e[0]),c||d.push(r[0]),u||d.push(o[0]);for(let x=1;x<d.length;++x)if(d[x]!==d[x-1])throw new Error("starts, limits, and deltas must have the same shape");const m=d.length===0?1:d[0],h=Cn("int32",m+1);h[0]=0;for(let x=0;x<m;++x){const g=l?t[0]:t[x],b=c?s[0]:s[x],w=u?a[0]:a[x];if(w===0)throw new Error("Requires delta != 0");let v;if(w>0&&b<g||w<0&&b>g)v=0;else if(v=Math.ceil(Math.abs((b-g)/w)),v>mL)throw new Error(`Requires ((limit - start) / delta) <= ${mL}`);h[x+1]=h[x]+v}const p=h[m],f=Cn(n,p);let y=0;for(let x=0;x<m;++x){const g=h[x+1]-h[x];let b=l?t[0]:t[x];const w=u?a[0]:a[x];for(let v=0;v<g;++v)f[y++]=b,b+=w}return[h,f]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var da=za;class yb{constructor(e,n,s,r,a,o,l,c,u,d){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=o,this.defaultValueShape=l,this.rowPartitionValues=c,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=yP(d),this.raggedRank=bP(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===da.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===da.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case da.VALUE_ROWIDS:return yb.getMaxWidthValueRowID(n);case da.ROW_SPLITS:return yb.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${da[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const a=e[r+1]-e[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],a=0;for(let o=1;o<n;++o){const l=e[o];l!==r&&(r=l,a=Math.max(o-s,a),s=o)}return Math.max(n-s,a)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return fL(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;wP(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),o=xP(this.raggedRank,r,n);o[0]<0&&(o[0]=e);for(let l=1;l<=this.raggedRank;++l)o[l]<0&&(o[l]=this.getMaxWidth(l));return o}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),a=[];let o=0;for(let l=0;l<r;++l,o+=n)a.push(o);for(let l=r;l<e;++l)a.push(-1);return R(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,n,s,r){const a=e.length,o=[];for(let l=0;l<a-1;++l){const c=e[l+1]-e[l];let u=Math.min(r,c),d=n[l];d===-1&&(u=0);for(let m=0;m<u;++m)o.push(d),d+=s;for(let m=0;m<c-u;++m)o.push(-1)}if(a>0&&o.length!==e[a-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,s,r){const a=e.length,o=[];if(a===0)return[];let l=0,c=e[0];if(c>=n.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${n.length}`);let u=n[c];o.push(u);for(let d=1;d<a;++d){const m=e[d];if(m===c)u>=0&&(++l,l<r?u+=s:u=-1);else{if(l=0,c=m,m>=n.length)throw new Error(`Got nextValueRowId=${m} which is not less than ${n.length}`);u=n[m]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,s,r){const a=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case da.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,s,r);case da.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,s,r);default:throw new Error(`Unsupported partition type: ${da[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case da.FIRST_DIM_SIZE:return e[0];case da.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case da.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${da[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let c=r.length-2;c>=0;--c)r[c]=r[c+1]*s[c+1];const a=fL(s,!1),o=Cn(this.valuesDType,ue(a));if(r[0]*s[0]>0){let c=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)c=this.calculateOutputIndex(u-1,c,r[u],s[u]);this.setOutput(this.raggedRank,c,o,a)}return[a,o]}setOutput(e,n,s,r){if(s.length===0)return;const a=this.values,o=s;let l=r.slice();l=l.slice(e+1);const c=ue(l),u=n.length;let d=this.defaultValue;if(d.length!==c&&d.length!==1){const f=this.defaultValueShape;re(()=>{const y=Q(d,f);d=Mp(y,l).dataSync()})}let m=0,h=0,p=0;for(let f=0;f<=u;++f){let y=f<u?n[f]:-1;if(y===p){++p;continue}if(h<p){const x=a.subarray(m*c),g=o.subarray(h*c),b=(p-h)*c;pL(g,x,b)}if(f>=u){const x=s.length;y=Math.floor(x/c)}if(y>p)if(this.defaultValue.length===1)o.subarray(p*c,y*c).fill(this.defaultValue[0]),p=y;else for(;y>p;){const x=o.slice(p*c);pL(x,d,c),++p}y<0?(m=f+1,h=p):(m=f,h=p,p=h+1)}}}function pL(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function fL(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function gL(t,e,n,s,r,a,o,l,c,u){return new yb(t,e,n,s,r,a,o,l,c,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xL(t,e,n,s){const r=t===e,a=t<e&&n<0,o=e<t&&n>1;if(r||a||o)return ws(0,s);const l=Math.abs(Math.ceil((e-t)/n)),c=ws(l,s);e<t&&n===1&&(n=-1),c[0]=t;for(let u=1;u<c.length;u++)c[u]=c[u-1]+n;return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yL=Io(t=>1/Math.sqrt(t)),bce=kl(pp,yL),wce={kernelName:pp,backendName:"cpu",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xc(t,e,n,s,r,a,o,l,c,u){const d=[s/r,r],m=t.values,h=e.values;if(s===0)return Nt(n,e.dtype);const p=c instanceof is?c:Nt(d,e.dtype);typeof c=="string"||typeof c=="number"?p.values.fill(c):typeof c=="boolean"&&p.values.fill(+c);for(let f=0;f<a;f++){const y=[];let x=0;for(let g=0;g<o;g++){const b=m[f*o+g];y.push(b),x+=b*l[g]}if(x<0||x>=s/r)throw new Error(`Invalid indices: ${y} does not index into ${n}`);for(let g=0;g<r;g++)u?p.values[x*r+g]+=h[f*r+g]:p.values[x*r+g]=e.rank===0?h[0]:h[f*r+g]}return p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vce=Io(t=>1/(1+Math.exp(-t))),bL=Ht(bp,t=>1/(1+Math.exp(-t))),Ece={kernelName:bp,backendName:"cpu",kernelFunc:bL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wL(t,e,n,s,r){const a=sk(s,e,n),o=ue(n),l=nt(s);if(a){const m=rk(e,l);return r==="string"?t.slice(m,m+o):t.subarray(m,m+o)}const c=r==="string"?yi(t):t,u=Nt(s,r,c),d=Nt(n,r);for(let m=0;m<d.size;++m){const h=d.indexToLoc(m),p=h.map((f,y)=>f+e[y]);d.set(u.get(...p),...h)}return r==="string"?VP(d.values):d.values}function Yc(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,size:o}=s;Ze(r,"slice");const[l,c]=Uy(r,a,o);tk(r,l,c);const u=n.data.get(r.dataId).values,d=wL(u,l,c,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,d)}const Nce={kernelName:dy,backendName:"cpu",kernelFunc:Yc};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vL(t,e,n,s,r,a,o){const l=e[0],c=a[0],u=new Array(c),d=new Array(l),m=e[1];if(c===0){if(l!==0)throw new Error(TP(l));const x=Cn(n,0),g=Cn(r,0);return[x,[0,m],g,u,d]}let h=!0,p=0;const f=new Array(c).fill(0);for(let x=0;x<l;++x){const g=t[x*m];if(g<0)throw new Error(AP(x,g));if(g>=c)throw new Error(RP(x,g,c));++f[g],h=h&&g>=p,p=g}let y=!0;for(let x=0;x<c;++x){const g=f[x]===0;u[x]=g,y=y&&!g,f[x]=Math.max(f[x],1),x>0&&(f[x]+=f[x-1])}if(y&&h){const x=t,g=s;for(let b=0;b<l;++b)d[b]=b;return[x,[l,m],g,u,d]}else{const x=f[c-1],g=Cn(n,x*m),b=Cn(r,x),w=new Array(c).fill(0);for(let v=0;v<l;++v){const E=t[v*m],k=w[E],C=(E===0?0:f[E-1])+k;w[E]++;for(let I=0;I<m;++I)g[C*m+I]=t[v*m+I];b[C]=s[v],d[v]=C}for(let v=0;v<c;++v)if(w[v]===0){const k=v===0?0:f[v-1];g[k*m+0]=v;for(let C=1;C<m;++C)g[k*m+C]=0;b[k]=o}return[g,[x,m],b,u,d]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(t,e,n,s,r){const a=ue(s),o=e[0],l=r.length,c=[];let u=1,d=-1;for(let x=0;x<l;++x){const g=r[x];if(g===-1){if(d!==-1)throw new Error(_P(d,x));d=x,c.push(1)}else{if(g<0)throw new Error(DP(x,g));u*=g,c.push(g)}}if(d!==-1){if(u<=0)throw new Error(PP());const x=Math.trunc(a/u);if(u*x!==a)throw new Error(FP(s,c));c[d]=x}if(ue(c)!==a)throw new Error(MP(s,c));const h=s.length,p=[];if(h>0){p[h-1]=1;for(let x=h-2;x>=0;--x)p[x]=p[x+1]*s[x+1]}const f=[];if(l>0){f[l-1]=1;for(let x=l-2;x>=0;--x)f[x]=f[x+1]*c[x+1]}const y=Cn(n,o*l);for(let x=0;x<o;++x){let g=0;for(let b=0;b<h;++b)g+=t[x*h+b]*p[b];for(let b=0;b<l;++b)y[x*l+b]=Math.trunc(g/f[b]),g%=f[b]}return[y,[o,l],c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gS(t,e,n,s,r,a=!1,o=0){const l=s.length,c=[e[0],t.length/e[0]],u=c[1],m=l>0?r[l-1]+1:0;if(m<0)throw new Error(Sk());const h=e.slice();h[0]=m;const p=h.reduce((w,v)=>w*v,1),f=Cn(n,p);if(l===0)return m>0&&f.fill(o),[f,h];if(m<=0)throw new Error(Sk());let y=0,x=1,g=0,b=r[y];for(;;){let w=0;if(x<l){if(w=r[x],b===w){++x;continue}if(b>=w)throw new Error(OP())}if(b<0||b>=m)throw new Error(LP(b,m));b>g&&f.fill(o,g*u,b*u);for(let v=y;v<x;++v){const E=s[v];if(E<0||E>=c[0])throw new Error(zP(v,s[v],c[0]));for(let k=0;k<u;k++)f[b*u+k]+=t[E*u+k]}if(a)for(let v=0;v<u;v++)f[b*u+v]/=x-y;if(y=x,++x,g=b+1,b=w,x>l)break}return g<m&&f.fill(o,g*u,m*u),[f,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kce=Io(t=>Math.sqrt(t)),Sce=Ht(vp,t=>Math.sqrt(t)),Cce={kernelName:vp,backendName:"cpu",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NL=Rn((t,e)=>{const n=t-e;return n*n}),Ice=Kn(Ep,NL),$ce={kernelName:Ep,backendName:"cpu",kernelFunc:Ice};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kL=Io((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),Tce=kl(V2,kL),Ace={kernelName:V2,backendName:"cpu",kernelFunc:Tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(t,e,n,s){const r=Nt(t,e.dtype);for(let a=0;a<r.size;a++){const o=r.indexToLoc(a),l=new Array(o.length);for(let c=0;c<l.length;c++)l[c]=o[c]*n[c]+s[c];r.set(e.get(...l),...o)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rce{constructor(e,n,s,r,a,o){this.separator=ol(e),this.nGramWidths=n,this.leftPad=ol(s),this.rightPad=ol(r),this.padWidth=a,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,a,o){for(let l=0;l<a;++l){const c=this.getPadWidth(o),u=Math.max(0,c-l),d=Math.max(0,c-(a-(l+1))),m=o-(u+d),h=n+(u>0?0:l-c);let p=0;p+=u*this.leftPad.length;for(let b=0;b<m;++b)p+=e[h+b].length;p+=d*this.rightPad.length;const f=u+d+m-1;p+=f*this.separator.length,s[r+l]=new Uint8Array(p);const y=s[r+l];let x=0;const g=b=>b.forEach(w=>y[x++]=w);for(let b=0;b<u;++b)g(this.leftPad),g(this.separator);for(let b=0;b<m-1;++b)g(e[h+b]),g(this.separator);if(m>0){g(e[h+m-1]);for(let b=0;b<d;++b)g(this.separator),g(this.rightPad)}else{for(let b=0;b<d-1;++b)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let c=n[0];if(c!==0)throw new Error(`First split value must be 0, got ${c}`);for(let u=1;u<r;++u){let d=n[u]>=c;if(d=d&&n[u]<=s,!d)throw new Error(`Invalid split value ${n[u]}, must be in [${c}, ${s}]`);c=n[u]}if(c!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${c}`)}const a=r-1,o=Cn("int32",r);if(s===0||r===0){const c=new Array(s);for(let u=0;u<=a;++u)o[u]=0;return[c,o]}o[0]=0;for(let c=1;c<=a;++c){const u=n[c]-n[c-1];let d=0;this.nGramWidths.forEach(m=>{d+=this.getNumNGrams(u,m)}),this.preserveShort&&u>0&&d===0&&(d=1),o[c]=o[c-1]+d}const l=new Array(o[a]);for(let c=0;c<a;++c){const u=n[c];let d=o[c];if(this.nGramWidths.forEach(m=>{const h=n[c+1]-n[c],p=this.getNumNGrams(h,m);this.createNGrams(e,u,l,d,p,m),d+=p}),this.preserveShort&&d===o[c]){const m=n[c+1]-n[c];if(m===0)continue;const h=m+2*this.padWidth;this.createNGrams(e,u,l,d,1,h)}}return[l,o]}}function CL(t,e,n,s,r,a,o,l){return new Rce(n,s,r,a,o,l).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e,n,s){if(!t.length)return;if(e.length===0){for(let a=0;a<t.length;++a)s.push(t.subarray(a,a+1));return}if(e.length===1){const a=e[0];let o=t.indexOf(a);for(;o!==-1;){const l=t.subarray(0,o);(!n||l.length!==0)&&s.push(l),t=t.subarray(o+1),o=t.indexOf(a)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let a=0;a<t.length+1;a++)if(a===t.length||e.indexOf(t[a])!==-1){const o=t.subarray(r,a);(!n||o.length!==0)&&s.push(o),r=a+1}}function IL(t,e,n){const s=t.length,r=[];let a=0,o=0;const l=new Array(s);for(let h=0;h<s;++h){const p=r.length;_ce(t[h],e,n,r);const f=r.length-p;l[h]=f,a+=f,o=Math.max(o,f)}const c=Cn("int32",a*2),u=new Array(a),d=[s,o];let m=0;for(let h=0;h<s;++h)for(let p=0;p<l[h];++p)c[m*2]=h,c[m*2+1]=p,u[m]=r[m],++m;return[c,u,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(t,e){const n=Cn("int32",t.length);for(let s=0;s<t.length;++s)n[s]=QZ(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TL=Rn((t,e)=>t-e),Dce=mS((t,e,n,s)=>({real:t-n,imag:e-s})),xS=Kn(Np,TL,Dce),Pce={kernelName:Np,backendName:"cpu",kernelFunc:xS};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AL(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Nt(n,t.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),o=new Array(t.rank);for(let c=0;c<o.length;c++)o[c]=a[c]%t.shape[c];const l=t.locToIndex(o);s.values[r]=t.values[l]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cf=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function RL(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const l=s-n+1,c=e-n+1,u=Math.log(l),d=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*d*(l-d)/l)*Math.sign(c-l/2),h=Math.max(n,Math.floor(e-c*d/l+m)),p=Math.min(s,Math.floor(e+(l-c)*d/l+m));RL(t,e,h,p)}const r=t[e];let a=n,o=s;for(dd(t,n,e),cf(t[s],r)>0&&dd(t,n,s);a<o;){for(dd(t,a,o),a++,o--;cf(t[a],r)<0;)a=a+1;for(;cf(t[o],r)>0;)o=o-1}cf(t[n],r)===0?dd(t,n,o):(o=o+1,dd(t,o,s)),o<=e&&(n=o+1),e<=o&&(s=o-1)}}function _L(t,e,n,s,r){const a=e[e.length-1],[o,l]=[t.length/a,a],c=bs(n,o*s),u=bs("int32",o*s);for(let m=0;m<o;m++){const h=m*l,p=t.subarray(h,h+l);let f=new Array(p.length);p.forEach((b,w)=>f[w]={value:b,index:w}),s<f.length&&(RL(f,s),f=f.slice(0,s)),r&&f.sort(cf);const y=m*s,x=c.subarray(y,y+s),g=u.subarray(y,y+s);for(let b=0;b<s;b++)x[b]=f[b].value,g[b]=f[b].index}const d=e.slice();return d[d.length-1]=s,[Nt(d,n,c),Nt(d,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DL(t,e,n,s){const r=Et(e,n)[0],a=[1,n[0],1];for(let f=0;f<r;f++)a[0]*=n[f];a[1]=n[r];for(let f=r+1;f<n.length;f++)a[2]*=n[f];const o=new Map,l=new Int32Array(n[r]),c=new is(a,s,t),u=[],d=a[0]===1&&a[2]===1;for(let f=0;f<n[r];f++){let y;if(d)y=t[f].toString();else{const g=[];for(let b=0;b<a[0];b++)for(let w=0;w<a[2];w++)g.push(c.get(b,f,w));y=g.join(",")}const x=o.get(y);if(x!=null)l[f]=x;else{const g=o.size;o.set(y,g),l[f]=g,u.push(f)}}const m=a.slice();m[1]=o.size;const h=new is(m,s);u.forEach((f,y)=>{for(let x=0;x<a[0];x++)for(let g=0;g<a[2];g++)h.set(c.get(x,f,g),x,y,g)});const p=n.slice();return p[r]=m[1],{outputValues:h.values,outputShape:p,indices:l}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fce=Object.freeze(Object.defineProperty({__proto__:null,addImpl:LO,bincountImpl:hS,bincountReduceImpl:zO,bitwiseAndImpl:BO,castImpl:OO,ceilImpl:UO,concatImpl:VO,equalImpl:WO,expImpl:GO,expm1Impl:qO,floorDivImpl:XO,floorImpl:KO,gatherNdImpl:YO,gatherV2Impl:ZO,greaterEqualImpl:QO,greaterImpl:JO,lessEqualImpl:tL,lessImpl:eL,linSpaceImpl:nL,logImpl:sL,maxImpl:rL,maximumImpl:aL,minimumImpl:oL,multiplyImpl:pS,negImpl:iL,notEqualImpl:lL,prodImpl:cL,raggedGatherImpl:dL,raggedRangeImpl:hL,raggedTensorToTensorImpl:gL,rangeImpl:xL,rsqrtImpl:yL,scatterImpl:Xc,sigmoidImpl:vce,simpleAbsImpl:MO,sliceImpl:wL,sparseFillEmptyRowsImpl:vL,sparseReshapeImpl:EL,sparseSegmentReductionImpl:gS,sqrtImpl:kce,squaredDifferenceImpl:NL,staticRegexReplaceImpl:kL,stridedSliceImpl:SL,stringNGramsImpl:CL,stringSplitImpl:IL,stringToHashBucketFastImpl:$L,subImpl:TL,tileImpl:AL,topKImpl:_L,transposeImpl:fS,uniqueImpl:DL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */s3("cpu",()=>new fb,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PL=Ht(Hh,t=>t>=0?t:Math.exp(t)-1),Mce={kernelName:Hh,backendName:"cpu",kernelFunc:PL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:a}=s;Ze([r],"leakyRelu");const o=ue(r.shape),l=n.data.get(r.dataId).values,c=bs("float32",o);for(let u=0;u<l.length;u++)c[u]=l[u]<0?a*l[u]:l[u];return n.makeTensorInfo(r.shape,"float32",c)}const Oce={kernelName:zx,backendName:"cpu",kernelFunc:FL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lce=Rn((t,e)=>t<0?e*t:t);function ML(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Ze([s,r],"prelu");const a=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,[l,c]=Lce(s.shape,r.shape,a,o,"float32");return n.makeTensorInfo(c,"float32",l)}const zce={kernelName:ry,backendName:"cpu",kernelFunc:ML};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OL=Ht(dp,t=>Math.max(0,t)),Bce={kernelName:dp,backendName:"cpu",kernelFunc:OL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LL=Ht(mp,t=>Math.min(Math.max(0,t),6)),Uce={kernelName:mp,backendName:"cpu",kernelFunc:LL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bb(t,e,n,s,r){if(n==="linear")return Co({inputs:{x:e},backend:t});if(n==="relu")return OL({inputs:{x:e},backend:t});if(n==="elu")return PL({inputs:{x:e},backend:t});if(n==="relu6")return LL({inputs:{x:e},backend:t});if(n==="prelu")return ML({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return FL({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return bL({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rn(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:a}=s,o=ue(r.shape),l=KD(a,o),c=ue(l);R(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const u=n.data.get(r.dataId);if(u.complexTensorInfos!=null){const d=u.complexTensorInfos.real,m=u.complexTensorInfos.imag;d.shape=l,m.shape=l}return{dataId:r.dataId,shape:l,dtype:r.dtype}}const Vce={kernelName:oy,backendName:"cpu",kernelFunc:rn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zL(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a}=e,{transposeA:o,transposeB:l}=s;Ze([r,a],"matMul");const c=r.shape.length,u=a.shape.length,d=o?r.shape[c-2]:r.shape[c-1],m=l?a.shape[u-1]:a.shape[u-2],h=o?r.shape[c-1]:r.shape[c-2],p=l?a.shape[u-2]:a.shape[u-1],f=r.shape.slice(0,-2),y=a.shape.slice(0,-2),x=ue(f),g=ue(y),w=ft(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([h,p]);R(d===m,()=>`Error in matMul: inner shapes (${d}) and (${m}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${o} and transposeB=${l} must match.`);const v=o?[x,d,h]:[x,h,d],E=l?[g,p,m]:[g,m,p],k=rn({inputs:{x:r},backend:n,attrs:{shape:v}}),C=rn({inputs:{x:a},backend:n,attrs:{shape:E}}),I=o?k.shape[1]:k.shape[2],A=o?k.shape[2]:k.shape[1],$=l?C.shape[1]:C.shape[2],T=Math.max(x,g),F=n.data.get(k.dataId).values,O=n.data.get(C.dataId).values,M=nt(k.shape),B=nt(C.shape),[L,Y,D]=o?[M[0],1,M[1]]:[M[0],M[1],1],[_,P,z]=l?[1,B[1],B[0]]:[B[1],1,B[0]],q=A*$,K=Nt([T,A,$],k.dtype),ae=K.values,ne=n.blockSize;for(let Z=0;Z<T;Z++){const ke=Z%x,Ae=Z%g;for(let W=0;W<A;W+=ne){const le=Math.min(W+ne,A);for(let we=0;we<$;we+=ne){const de=Math.min(we+ne,$);for(let Ee=0;Ee<I;Ee+=ne){const Re=Math.min(Ee+ne,I);for(let ze=W;ze<le;ze++)for(let _e=we;_e<de;_e++){let ht=0;for(let X=Ee;X<Re;X++){const me=F[ke*L+ze*Y+X*D],Fe=O[X*_+_e*P+Ae*z];ht+=me*Fe}ae[Z*q+(ze*$+_e)]+=ht}}}}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(w,K.dtype,K.values)}const Wce={kernelName:kx,backendName:"cpu",kernelFunc:zL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jce(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a,bias:o,preluActivationWeights:l}=e,{transposeA:c,transposeB:u,activation:d,leakyreluAlpha:m}=s;let h,p,f;const y=[];h=zL({inputs:{a:r,b:a},attrs:{transposeA:c,transposeB:u},backend:n}),o&&(p=Ld({inputs:{a:h,b:o},backend:n}),y.push(h),h=p),d&&(f=bb(n,h,d,l,m),y.push(h),h=f);for(const g of y)n.disposeIntermediateTensorInfo(g);return h}const Gce={kernelName:by,backendName:"cpu",kernelFunc:jce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce=Ht(Dh,t=>Math.acos(t)),qce={kernelName:Dh,backendName:"cpu",kernelFunc:Hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kce=Ht(Ph,t=>Math.acosh(t)),Xce={kernelName:Ph,backendName:"cpu",kernelFunc:Kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t){const{inputs:e,backend:n}=t,s=e;Ze(e,"addN");const r=s.map(l=>n.data.get(l.dataId).values),a=Nt(s[0].shape,s[0].dtype),o=a.values;for(let l=0;l<s.length;l++){const c=r[l];for(let u=0;u<o.length;u++)o[u]+=c[u]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const Zce={kernelName:a2,backendName:"cpu",kernelFunc:Yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s;Ze(r,"all");const l=Et(a,r.shape);let c=l;const u=yn(c,r.shape.length);let d=r;u!=null&&(d=er({inputs:{x:r},backend:n,attrs:{perm:u}}),c=$n(c.length,r.shape.length)),cs("all",c,d.shape.length);const[m,h]=Qn(d.shape,c),p=ue(h),f=ws(ue(m),d.dtype),y=n.data.get(d.dataId).values;for(let g=0;g<f.length;++g){const b=g*p;let w=y[b];for(let v=0;v<p;++v){const E=y[b+v];w=w&&E}f[g]=w}u!=null&&n.disposeIntermediateTensorInfo(d);const x=n.makeTensorInfo(m,d.dtype,f);if(o){const g=On(m,l),b=rn({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),b}return x}const Qce={kernelName:o2,backendName:"cpu",kernelFunc:Jce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s;Ze(r,"any");const l=Et(a,r.shape);let c=l;const u=yn(c,r.shape.length);let d=r;u!=null&&(d=er({inputs:{x:r},backend:n,attrs:{perm:u}}),c=$n(c.length,r.shape.length)),cs("any",c,d.shape.length);const[m,h]=Qn(d.shape,c),p=ue(h),f=ws(ue(m),d.dtype),y=n.data.get(d.dataId).values;for(let g=0;g<f.length;++g){const b=g*p;let w=y[b];for(let v=0;v<p;++v){const E=y[b+v];w=w||E}f[g]=w}u!=null&&n.disposeIntermediateTensorInfo(d);const x=n.makeTensorInfo(m,d.dtype,f);if(o){const g=On(m,l),b=rn({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),b}return x}const tue={kernelName:i2,backendName:"cpu",kernelFunc:eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;Ze(r,"argMax");let o=Et(a,r.shape);const l=yn(o,r.shape.length);let c=r;const u=[];l!=null&&(c=er({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),o=$n(o.length,c.shape.length)),o=[o[0]],cs("argMax",o,c.shape.length);const[d,m]=Qn(c.shape,o),h=ue(d),p=ws(h,"int32"),f=ue(m),y=n.data.get(c.dataId).values;for(let x=0;x<p.length;++x){const g=x*f;let b=y[g],w=0;for(let v=0;v<f;++v){const E=y[g+v];E>b&&(b=E,w=v)}p[x]=w}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(d,"int32",p)}const sue={kernelName:wx,backendName:"cpu",kernelFunc:nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;Ze(r,"argMin");let o=Et(a,r.shape);const l=yn(o,r.shape.length);let c=r;const u=[];l!=null&&(c=er({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),o=$n(o.length,c.shape.length)),o=[o[0]],cs("argMin",o,c.shape.length);const[d,m]=Qn(c.shape,o),h=ue(d),p=ws(h,"int32"),f=ue(m),y=n.data.get(c.dataId).values;for(let x=0;x<p.length;++x){const g=x*f;let b=y[g],w=0;for(let v=0;v<f;++v){const E=y[g+v];E<b&&(b=E,w=v)}p[x]=w}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(d,"int32",p)}const aue={kernelName:vx,backendName:"cpu",kernelFunc:rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oue=Ht(Fh,t=>Math.asin(t)),iue={kernelName:Fh,backendName:"cpu",kernelFunc:oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue=Ht(Mh,t=>Math.asinh(t)),cue={kernelName:Mh,backendName:"cpu",kernelFunc:lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uue=Ht(Oh,t=>Math.atan(t)),due={kernelName:Oh,backendName:"cpu",kernelFunc:uue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mue=Rn((t,e)=>Math.atan2(t,e)),hue=Kn(zh,mue),pue={kernelName:zh,backendName:"cpu",kernelFunc:hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fue=Ht(Lh,t=>Math.atanh(t)),gue={kernelName:Lh,backendName:"cpu",kernelFunc:fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yS(t,e,n,s,r,a){const o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,m=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,f=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=Nt(r.outShape,n),x=y.values,g=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],w=r.outShape[3];for(let v=0;v<r.batchSize;++v){const E=v*g,k=v*s[0];for(let C=0;C<r.inChannels;++C)for(let I=0;I<r.outHeight;++I){const A=I*o-h,$=Math.max(0,A),T=Math.min(r.inHeight,d+A),F=E+I*b;for(let O=0;O<r.outWidth;++O){const M=O*l-p,B=Math.max(0,M),L=Math.min(r.inWidth,m+M);let Y=f,D=0,_=0;for(let z=$;z<T;z+=c){const q=k+z*s[1];for(let K=B;K<L;K+=u){const ae=q+K*s[2],ne=t[ae+C];a==="max"&&ne>Y?Y=ne:a==="avg"&&(D+=ne,_++)}if(isNaN(Y))break}const P=F+O*w+C;x[P]=a==="avg"?D/_:Y}}}return y}function BL(t,e,n,s,r=!1,a=!1){const o=Nt(s.outShape,"int32"),l=s.strideHeight,c=s.strideWidth,u=s.dilationHeight,d=s.dilationWidth,m=s.effectiveFilterHeight,h=s.effectiveFilterWidth,p=s.padInfo.top,f=s.padInfo.left,y=Nt(e,n,t);for(let x=0;x<s.batchSize;++x)for(let g=0;g<s.inChannels;++g)for(let b=0;b<s.outHeight;++b){const w=b*l-p;let v=w;for(;v<0;)v+=u;const E=Math.min(s.inHeight,m+w);for(let k=0;k<s.outWidth;++k){const C=k*c-f;let I=C;for(;I<0;)I+=d;const A=Math.min(s.inWidth,h+C);let $=Number.NEGATIVE_INFINITY,T=-1;for(let F=v;F<E;F+=u){const O=F-w;for(let M=I;M<A;M+=d){const B=M-C,L=y.get(x,F,M,g);L>$&&($=L,r?T=a?((x*s.inHeight+F)*s.inWidth+M)*s.inChannels+g:(F*s.inWidth+M)*s.inChannels+g:T=O*h+B)}}o.set(T,x,b,k,g)}}return o}function UL(t,e,n,s,r,a){const o=r.strideDepth,l=r.strideHeight,c=r.strideWidth,u=r.dilationDepth,d=r.dilationHeight,m=r.dilationWidth,h=r.effectiveFilterDepth,p=r.effectiveFilterHeight,f=r.effectiveFilterWidth,y=r.padInfo.front,x=r.padInfo.top,g=r.padInfo.left,b=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=Nt(r.outShape,n),v=w.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let A=0;A<r.batchSize;++A){const $=A*E,T=A*s[0];for(let F=0;F<r.inChannels;++F)for(let O=0;O<r.outDepth;++O){const M=O*o-y;let B=M;for(;B<0;)B+=u;const L=Math.min(r.inDepth,h+M),Y=$+O*k;for(let D=0;D<r.outHeight;++D){const _=D*l-x;let P=_;for(;P<0;)P+=d;const z=Math.min(r.inHeight,p+_),q=Y+D*C;for(let K=0;K<r.outWidth;++K){const ae=K*c-g;let ne=ae;for(;ne<0;)ne+=m;const Z=Math.min(r.inWidth,f+ae),ke=q+K*I;let Ae=b,W=0,le=0;for(let de=B;de<L;de+=u){const Ee=T+de*s[1];for(let Re=P;Re<z;Re+=d){const ze=Ee+Re*s[2];for(let _e=ne;_e<Z;_e+=m){const ht=ze+_e*s[3],X=t[ht+F];if(a==="max"&&X>Ae?Ae=X:a==="avg"&&(W+=X,le++),isNaN(Ae))break}if(isNaN(Ae))break}if(isNaN(Ae))break}const we=ke+F;v[we]=a==="avg"?W/Math.max(le,1):Ae}}}}return w}function xue(t,e){const n=Nt(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,a=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,m=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left;for(let y=0;y<e.batchSize;++y)for(let x=0;x<e.inChannels;++x)for(let g=0;g<e.outDepth;++g){const b=g*s-h;let w=b;for(;w<0;)w+=o;const v=Math.min(e.inDepth,u+b);for(let E=0;E<e.outHeight;++E){const k=E*r-p;let C=k;for(;C<0;)C+=l;const I=Math.min(e.inHeight,d+k);for(let A=0;A<e.outWidth;++A){const $=A*a-f;let T=$;for(;T<0;)T+=c;const F=Math.min(e.inWidth,m+$);let O=Number.NEGATIVE_INFINITY,M=-1;for(let B=w;B<v;B+=o){const L=B-b;for(let Y=C;Y<I;Y+=l){const D=Y-k;for(let _=T;_<F;_+=c){const P=_-$,z=t.get(y,B,Y,_,x);z>=O&&(O=z,M=L*d*m+D*d+P)}}}n.set(M,y,g,E,A,x)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ze(r,"avgPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;R(vs(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=ra(r.shape,a,o,u,l,c);let m;if(d.filterWidth===1&&d.filterHeight===1&&zt(d.inShape,d.outShape))m=Co({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,p=nt(r.shape),f=yS(h,r.shape,r.dtype,p,d,"avg");m=n.makeTensorInfo(d.outShape,r.dtype,f.values)}return m}const bue={kernelName:Ex,backendName:"cpu",kernelFunc:yue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=s;Ze(r,"avgPool3d");const d=mi(r.shape,a,o,1,l,c,u),m=n.data.get(r.dataId).values,h=UL(m,r.shape,r.dtype,nt(r.shape),d,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const vue={kernelName:Nx,backendName:"cpu",kernelFunc:wue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=s;Ze([r,a],"avgPool3DGrad");const d=mi(a.shape,o,l,1,c,u),m=d.strideDepth,h=d.strideHeight,p=d.strideWidth,f=d.filterDepth,y=d.filterHeight,x=d.filterWidth,g=d.dilationDepth,b=d.dilationHeight,w=d.dilationWidth,v=d.effectiveFilterDepth,E=d.effectiveFilterHeight,k=d.effectiveFilterWidth,C=v-1-d.padInfo.front,I=k-1-d.padInfo.left,A=E-1-d.padInfo.top,$=Nt(a.shape,"float32"),T=1/(f*y*x),F=n.bufferSync(r);for(let O=0;O<d.batchSize;++O)for(let M=0;M<d.inChannels;++M)for(let B=0;B<d.inDepth;++B)for(let L=0;L<d.inHeight;++L)for(let Y=0;Y<d.inWidth;++Y){const D=B-C,_=L-A,P=Y-I;let z=0;for(let q=0;q<v;q+=g){const K=(D+q)/m;if(!(K<0||K>=d.outDepth||Math.floor(K)!==K))for(let ae=0;ae<E;ae+=b){const ne=(_+ae)/h;if(!(ne<0||ne>=d.outHeight||Math.floor(ne)!==ne))for(let Z=0;Z<k;Z+=w){const ke=(P+Z)/p;if(ke<0||ke>=d.outWidth||Math.floor(ke)!==ke)continue;const Ae=F.get(O,K,ne,ke,M);z+=Ae}}}$.set(z*T,O,B,L,Y,M)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const Nue={kernelName:c2,backendName:"cpu",kernelFunc:Eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,o=a;Ze([r,a],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=s,d=ra(o.shape,l,c,1,u),m=d.strideHeight,h=d.strideWidth,p=d.filterHeight,f=d.filterWidth,y=d.dilationHeight,x=d.dilationWidth,g=d.effectiveFilterHeight,b=d.effectiveFilterWidth,w=b-1-d.padInfo.left,v=g-1-d.padInfo.top,E=Nt(o.shape,"float32"),k=1/(p*f),C=n.data.get(r.dataId).values,I=Nt(r.shape,"float32",C);for(let A=0;A<d.batchSize;++A)for(let $=0;$<d.inChannels;++$)for(let T=0;T<d.inHeight;++T)for(let F=0;F<d.inWidth;++F){const O=T-v,M=F-w;let B=0;for(let L=0;L<g;L+=y){const Y=(O+L)/m;if(!(Y<0||Y>=d.outHeight||Math.floor(Y)!==Y))for(let D=0;D<b;D+=x){const _=(M+D)/h;if(_<0||_>=d.outWidth||Math.floor(_)!==_)continue;const P=I.get(A,Y,_,$);B+=P}}E.set(B*k,A,T,F,$)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const Sue={kernelName:l2,backendName:"cpu",kernelFunc:kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:a,offset:o,mean:l,variance:c}=e;R(l.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(o==null||l.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(a==null||l.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ze([r,l,c,a,o],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const d=n.data.get(r.dataId).values,m=n.data.get(l.dataId).values,h=n.data.get(c.dataId).values,p=a?n.data.get(a.dataId).values:new Float32Array([1]),f=o?n.data.get(o.dataId).values:new Float32Array([0]),y=new Float32Array(d.length),x=f.length,g=p.length,b=h.length,w=m.length;let v=0,E=0,k=0,C=0;for(let I=0;I<d.length;++I)y[I]=f[v++]+(d[I]-m[E++])*p[k++]/Math.sqrt(h[C++]+u),v>=x&&(v=0),E>=w&&(E=0),k>=g&&(k=0),C>=b&&(C=0);return n.makeTensorInfo(r.shape,r.dtype,y)}const Iue={kernelName:Mx,backendName:"cpu",kernelFunc:Cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,crops:o}=s;Ze([r],"batchToSpaceND");const l=a.reduce((g,b)=>g*b),c=jp(r.shape,a,l),u=Gp(c.length,a.length),d=Hp(r.shape,a,l),m=ck(o,a.length),h=uk(d,o,a.length),p=rn({inputs:{x:r},backend:n,attrs:{shape:c}}),f=er({inputs:{x:p},backend:n,attrs:{perm:u}}),y=rn({inputs:{x:f},backend:n,attrs:{shape:d}}),x=Yc({inputs:{x:y},backend:n,attrs:{begin:m,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),x}const Tue={kernelName:Sx,backendName:"cpu",kernelFunc:$ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:o}=s,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=hS(l,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,u)}const Rue={kernelName:u2,backendName:"cpu",kernelFunc:Aue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,a=n.data.get(s.dataId).values,o=n.data.get(r.dataId).values,l=ft(Array.from(a),Array.from(o));return n.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const Due={kernelName:t4,backendName:"cpu",kernelFunc:_ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pue=Ht(Vh,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Fue={kernelName:Vh,backendName:"cpu",kernelFunc:Pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue={kernelName:Cx,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(ue(e.shape)),r=n.data.get(e.dataId),a=r.complexTensorInfos.real,o=r.complexTensorInfos.imag,l=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values;for(let u=0;u<l.length;u++){const d=l[u],m=c[u];s[u]=Math.hypot(d,m)}return n.makeOutput(s,e.shape,"float32")}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zd(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const Oue={kernelName:A2,backendName:"cpu",kernelFunc:zd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bd(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,a=Et(r,e[0].shape)[0],o=e.map(y=>y.shape);ok(o,a);let l=yo(e.map(y=>y.shape),a);if(ue(l)===0)return n.makeTensorInfo(l,e[0].dtype,[]);const c=e.filter(y=>ue(y.shape)>0);if(c.length===1)return Co({inputs:{x:c[0]},backend:n});if(c[0].dtype==="complex64"){const y=c.map(v=>Kc({inputs:{input:v},backend:n})),x=c.map(v=>zd({inputs:{input:v},backend:n})),g=Bd({inputs:y,backend:n,attrs:{axis:a}}),b=Bd({inputs:x,backend:n,attrs:{axis:a}}),w=xr({inputs:{real:g,imag:b},backend:n});return y.forEach(v=>n.disposeIntermediateTensorInfo(v)),x.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),w}const u=c.map(y=>{const g=[-1,ue(y.shape.slice(a))];return rn({inputs:{x:y},backend:n,attrs:{shape:g}})}),d=u.map(y=>({vals:n.data.get(y.dataId).values,shape:y.shape}));l=yo(u.map(y=>y.shape),1);const m=u[0].shape[0]===1,h=VO(d,l,e[0].dtype,m),p=yo(c.map(y=>y.shape),a),f=n.makeTensorInfo(p,e[0].dtype,h);return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),f}const Lue={kernelName:Ix,backendName:"cpu",kernelFunc:Bd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:d}=s;Ze([r,a],"conv2d");const m=hi(c),h=ls(r.shape,a.shape,o,u,l,d,!1,m),p=h.filterHeight,f=h.filterWidth,y=h.dilationHeight,x=h.dilationWidth,g=h.padInfo.left,b=h.padInfo.top,w=h.dataFormat==="channelsLast",v=new is(h.outShape,r.dtype),E=nt(r.shape),k=nt(a.shape),C=E[0],I=w?E[1]:E[2],A=w?E[2]:1,$=w?1:E[1],T=v.strides[0],F=w?v.strides[1]:v.strides[2],O=w?v.strides[2]:1,M=w?1:v.strides[1],B=n.data.get(r.dataId).values,L=n.data.get(a.dataId).values,Y=v.values;for(let D=0;D<h.batchSize;++D){const _=D*C,P=D*T;for(let z=0;z<h.outHeight;++z){const q=P+z*F,K=z*h.strideHeight-b;for(let ae=0;ae<p;++ae){const ne=K+ae*y;if(ne<0||ne>=h.inHeight)continue;const Z=ae*k[0],ke=_+ne*I;for(let Ae=0;Ae<h.outWidth;++Ae){const W=q+Ae*O,le=Ae*h.strideWidth-g;for(let we=0;we<f;++we){const de=le+we*x;if(de<0||de>=h.inWidth)continue;const Ee=Z+we*k[1],Re=ke+de*A;let ze=Ee;for(let _e=0;_e<h.inChannels;++_e){const ht=B[Re+_e*$];for(let X=0;X<h.outChannels;++X)Y[W+X*M]+=ht*L[ze+X];ze+=h.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,Y)}const zue={kernelName:$x,backendName:"cpu",kernelFunc:VL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:o,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:d}=s;Ze([r,a],"conv2dBackpropFilter");const m=hi(c),h=ls(r.shape,d,o,1,l,u,!1,m),{strideHeight:p,strideWidth:f,filterHeight:y,filterWidth:x}=h,g=h.dataFormat==="channelsLast",b=new is(h.filterShape,"float32"),w=h.padInfo.left,v=h.padInfo.top,E=n.data.get(r.dataId).values,k=n.data.get(a.dataId).values,C=new is(r.shape,r.dtype,E),I=new is(a.shape,a.dtype,k);for(let A=0;A<y;++A){const $=Math.max(0,Math.ceil((v-A)/p)),T=Math.min(h.outHeight,(h.inHeight+v-A)/p);for(let F=0;F<x;++F){const O=Math.max(0,Math.ceil((w-F)/f)),M=Math.min(h.outWidth,(h.inWidth+w-F)/f);for(let B=0;B<h.inChannels;++B)for(let L=0;L<h.outChannels;++L){let Y=0;for(let D=0;D<h.batchSize;++D)for(let _=$;_<T;++_){const P=A+_*p-v;for(let z=O;z<M;++z){const q=F+z*f-w;g?Y+=C.get(D,P,q,B)*I.get(D,_,z,L):Y+=C.get(D,B,P,q)*I.get(D,L,_,z)}}b.set(Y,A,F,B,L)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Uue={kernelName:h2,backendName:"cpu",kernelFunc:Bue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{inputShape:o,strides:l,pad:c,dataFormat:u,dimRoundingMode:d}=s;Ze([r,a],"conv2dBackpropInput");const m=nt(a.shape),h=nt(r.shape);let p=hi(u);const f=ls(o,a.shape,l,1,c,d,!1,p),y=new is(f.inShape,"float32"),x=y.values,g=n.data.get(r.dataId).values,b=n.data.get(a.dataId).values,[w,v,E]=m,{batchSize:k,filterHeight:C,filterWidth:I,inChannels:A,inHeight:$,inWidth:T,outChannels:F,outHeight:O,outWidth:M,strideHeight:B,strideWidth:L}=f;p=f.dataFormat;const Y=C-1-f.padInfo.top,D=I-1-f.padInfo.left,_=p==="channelsLast",P=y.strides[0],z=_?y.strides[1]:y.strides[2],q=_?y.strides[2]:1,K=_?1:y.strides[1],ae=h[0],ne=_?h[1]:h[2],Z=_?h[2]:1,ke=_?1:h[1];for(let Ae=0;Ae<k;++Ae)for(let W=0;W<A;++W)for(let le=0;le<$;++le){const we=le-Y,de=Math.max(0,Math.ceil(we/B)),Ee=Math.min(O,(C+we)/B);for(let Re=0;Re<T;++Re){const ze=Re-D,_e=Math.max(0,Math.ceil(ze/L)),ht=Math.min(M,(I+ze)/L);let X=0;for(let Fe=de;Fe<Ee;++Fe){const tt=Fe*B-we;for(let Oe=_e;Oe<ht;++Oe){const Ye=Oe*L-ze,at=ae*Ae+ne*Fe+Z*Oe,At=w*(C-1-tt)+v*(I-1-Ye)+E*W;for(let wt=0;wt<F;++wt){const fe=g[at+ke*wt],We=b[At+wt];X+=fe*We}}}const me=P*Ae+z*le+q*Re+K*W;x[me]=X}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const Wue={kernelName:Tx,backendName:"cpu",kernelFunc:Vue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c}=s;Ze([r,a],"conv3d");const u=ul(r.shape,a.shape,o,c,l),{filterDepth:d,filterHeight:m,filterWidth:h,dilationDepth:p,dilationHeight:f,dilationWidth:y,padInfo:x}=u,g=x.front,b=x.left,w=x.top,v=new is(u.outShape,r.dtype),E=n.data.get(r.dataId).values,k=n.data.get(a.dataId).values,C=v.values,I=nt(r.shape),A=nt(a.shape);for(let $=0;$<u.batchSize;++$){const T=$*I[0],F=$*v.strides[0];for(let O=0;O<u.outDepth;++O){const M=F+O*v.strides[1],B=O*u.strideDepth-g;for(let L=0;L<d;++L){const Y=B+L*p;if(Y<0||Y>=u.inDepth)continue;const D=L*A[0],_=T+Y*I[1];for(let P=0;P<u.outHeight;++P){const z=M+P*v.strides[2],q=P*u.strideHeight-w;for(let K=0;K<m;++K){const ae=q+K*f;if(ae<0||ae>=u.inHeight)continue;const ne=D+K*A[1],Z=_+ae*I[2];for(let ke=0;ke<u.outWidth;++ke){const Ae=z+ke*u.outChannels,W=ke*u.strideWidth-b;for(let le=0;le<h;++le){const we=W+le*y;if(we<0||we>=u.inWidth)continue;const de=ne+le*A[2],Ee=Z+we*u.inChannels;let Re=de;for(let ze=0;ze<u.inChannels;++ze){const _e=E[Ee+ze];for(let ht=0;ht<u.outChannels;++ht)C[Ae+ht]+=_e*k[Re+ht];Re+=u.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const Gue={kernelName:Ax,backendName:"cpu",kernelFunc:jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:o,pad:l,filterShape:c}=s;Ze([r,a],"conv3dBackpropFilterV2");const u=nt(r.shape),d=nt(a.shape),m=ul(r.shape,c,o,1,l),h=m.strideDepth,p=m.strideHeight,f=m.strideWidth,y=m.filterDepth,x=m.filterHeight,g=m.filterWidth,b=new is(m.filterShape,"float32"),w=b.values,[v,E,k,C]=b.strides,I=n.data.get(a.dataId).values,[A,$,T,F]=d,O=n.data.get(r.dataId).values,[M,B,L,Y]=u,D=m.padInfo.front,_=m.padInfo.left,P=m.padInfo.top;for(let z=0;z<y;++z){const q=Math.max(0,Math.ceil((D-z)/h)),K=Math.min(m.outDepth,(m.inDepth+D-z)/h),ae=z*v;for(let ne=0;ne<x;++ne){const Z=Math.max(0,Math.ceil((P-ne)/p)),ke=Math.min(m.outHeight,(m.inHeight+P-ne)/p),Ae=ne*E+ae;for(let W=0;W<g;++W){const le=Math.max(0,Math.ceil((_-W)/f)),we=Math.min(m.outWidth,(m.inWidth+_-W)/f),de=W*k+Ae;for(let Ee=0;Ee<m.inChannels;++Ee){const Re=Ee*C+de;for(let ze=0;ze<m.outChannels;++ze){let _e=0;for(let ht=0;ht<m.batchSize;++ht){const X=ht*M,me=ht*A;for(let Fe=q;Fe<K;++Fe){const Oe=(z+Fe*h-D)*B+X,Ye=Fe*$+me;for(let at=Z;at<ke;++at){const wt=(ne+at*p-P)*L+Oe,fe=at*T+Ye;for(let We=le;We<we;++We){const je=(W+We*f-_)*Y+wt,it=We*F+fe;_e+=O[je+Ee]*I[it+ze]}}}}w[Re+ze]=_e}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const que={kernelName:p2,backendName:"cpu",kernelFunc:Hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{pad:o,strides:l,inputShape:c}=s;Ze([r],"conv3dBackpropInputV2");const u=nt(r.shape),d=nt(a.shape),m=ul(c,a.shape,l,1,o),h=new is(m.inShape,"float32"),p=h.values,[f,y,x,g]=h.strides,b=n.data.get(r.dataId).values,[w,v,E,k]=u,C=n.data.get(a.dataId).values,[I,A,$,T]=d,{batchSize:F,filterDepth:O,filterHeight:M,filterWidth:B,inChannels:L,inDepth:Y,inHeight:D,inWidth:_,outChannels:P,outDepth:z,outHeight:q,outWidth:K,strideDepth:ae,strideHeight:ne,strideWidth:Z}=m,ke=O-1-m.padInfo.front,Ae=M-1-m.padInfo.top,W=B-1-m.padInfo.left;for(let le=0;le<F;++le)for(let we=0;we<L;++we)for(let de=0;de<Y;++de){const Ee=de-ke,Re=Math.max(0,Math.ceil(Ee/ae)),ze=Math.min(z,(O+Ee)/ae);for(let _e=0;_e<D;++_e){const ht=_e-Ae,X=Math.max(0,Math.ceil(ht/ne)),me=Math.min(q,(M+ht)/ne);for(let Fe=0;Fe<_;++Fe){const tt=Fe-W,Oe=Math.max(0,Math.ceil(tt/Z)),Ye=Math.min(K,(B+tt)/Z);let at=0;for(let At=Re;At<ze;++At){const wt=At*ae-Ee;for(let fe=X;fe<me;++fe){const We=fe*ne-ht;for(let qe=Oe;qe<Ye;++qe){const je=qe*Z-tt,it=w*le+v*At+E*fe+k*qe,St=I*(O-1-wt)+A*(M-1-We)+$*(B-1-je)+T*we;for(let dt=0;dt<P;++dt){const gt=b[it+dt],Qt=C[St+dt];at+=gt*Qt}}}}p[f*le+y*de+x*_e+g*Fe+we]=at}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const Xue={kernelName:f2,backendName:"cpu",kernelFunc:Kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yue=Ht(Wh,t=>Math.cos(t)),Zue={kernelName:Wh,backendName:"cpu",kernelFunc:Yue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jue=Ht(jh,t=>Math.cosh(t)),Que={kernelName:jh,backendName:"cpu",kernelFunc:Jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ede(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:a,boxInd:o}=e,{cropSize:l,method:c,extrapolationValue:u}=s,[d,m,h,p]=r.shape,f=a.shape[0],[y,x]=l,g=Nt([f,y,x,p],"float32"),b=n.data.get(a.dataId).values,w=n.data.get(o.dataId).values,v=n.data.get(r.dataId).values,E=nt(r.shape),k=nt(g.shape);for(let C=0;C<f;C++){const I=C*4,A=b[I],$=b[I+1],T=b[I+2],F=b[I+3],O=w[C];if(O>=d)continue;const M=y>1?(T-A)*(m-1)/(y-1):0,B=x>1?(F-$)*(h-1)/(x-1):0;for(let L=0;L<y;L++){const Y=y>1?A*(m-1)+L*M:.5*(A+T)*(m-1);if(Y<0||Y>m-1){for(let D=0;D<x;D++)for(let _=0;_<p;_++){const P=_+D*k[2]+L*k[1]+C*k[0];g.values[P]=u}continue}if(c==="bilinear"){const D=Math.floor(Y),_=Math.ceil(Y),P=Y-D;for(let z=0;z<x;z++){const q=x>1?$*(h-1)+z*B:.5*($+F)*(h-1);if(q<0||q>h-1){for(let Z=0;Z<p;Z++){const ke=Z+z*k[2]+L*k[1]+C*k[0];g.values[ke]=u}continue}const K=Math.floor(q),ae=Math.ceil(q),ne=q-K;for(let Z=0;Z<p;Z++){let ke=Z+K*E[2]+D*E[1]+O*E[0];const Ae=v[ke];ke=Z+ae*E[2]+D*E[1]+O*E[0];const W=v[ke];ke=Z+K*E[2]+_*E[1]+O*E[0];const le=v[ke];ke=Z+ae*E[2]+_*E[1]+O*E[0];const we=v[ke],de=Ae+(W-Ae)*ne,Ee=le+(we-le)*ne;ke=Z+z*k[2]+L*k[1]+C*k[0],g.values[ke]=de+(Ee-de)*P}}}else for(let D=0;D<x;++D){const _=x>1?$*(h-1)+D*B:.5*($+F)*(h-1);if(_<0||_>h-1){for(let q=0;q<p;q++){const K=q+D*k[2]+L*k[1]+C*k[0];g.values[K]=u}continue}const P=Math.round(_),z=Math.round(Y);for(let q=0;q<p;q++){const K=q+P*E[2]+z*E[1]+O*E[0],ae=q+D*k[2]+L*k[1]+C*k[0];g.values[ae]=v[K]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const tde={kernelName:x2,backendName:"cpu",kernelFunc:ede};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;Ze(r,"cumprod");const c=yn([a],r.shape.length);let u=r;c!=null&&(u=er({inputs:{x:r},backend:n,attrs:{perm:c}}));const d=$n(1,r.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);const m=pr(u.dtype,"int32"),h=t2(ue(u.shape),m),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],y=l?(g,b)=>g+f-b-1:(g,b)=>g+b;for(let g=0;g<p.length;g+=f)for(let b=0;b<f;b++){const w=y(g,b);if(b===0)h[w]=o?1:p[w];else{const v=y(g,b-1);h[w]=o?p[v]*h[v]:p[w]*h[v]}}const x=n.makeTensorInfo(u.shape,m,h);if(c!=null){const g=dl(c),b=er({inputs:{x},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),b}return x}const sde={kernelName:g2,backendName:"cpu",kernelFunc:nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;Ze(r,"cumsum");const c=yn([a],r.shape.length);let u=r;c!=null&&(u=er({inputs:{x:r},backend:n,attrs:{perm:c}}));const d=$n(1,r.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);const m=pr(u.dtype,"int32"),h=ws(ue(u.shape),m),p=n.data.get(u.dataId).values,f=u.shape[u.shape.length-1],y=l?(g,b)=>g+f-b-1:(g,b)=>g+b;for(let g=0;g<p.length;g+=f)for(let b=0;b<f;b++){const w=y(g,b);if(b===0)h[w]=o?0:p[w];else{const v=y(g,b-1);h[w]=o?p[v]+h[v]:p[w]+h[v]}}const x=n.makeTensorInfo(u.shape,m,h);if(c!=null){const g=dl(c),b=er({inputs:{x},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),b}return x}const ade={kernelName:Rx,backendName:"cpu",kernelFunc:rde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:o,binaryOutput:l}=s;if(r.shape.length===1){const c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,d=hS(c,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,d)}else if(r.shape.length===2){const c=n.bufferSync(r),u=n.bufferSync(a),d=zO(c,u,o,l);return n.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const ide={kernelName:y2,backendName:"cpu",kernelFunc:ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:a,dataFormat:o}=s;R(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const l=r.shape[0],c=r.shape[1],u=r.shape[2],d=r.shape[3],m=c*a,h=u*a,p=d/(a*a),f=n.data.get(r.dataId).values,y=new Float32Array(l*m*h*p);let x=0;for(let g=0;g<l;++g)for(let b=0;b<m;++b){const w=Math.floor(b/a),v=b%a;for(let E=0;E<h;++E){const k=Math.floor(E/a),C=E%a,I=(v*a+C)*p;for(let A=0;A<p;++A){const T=A+I+d*(k+u*(w+c*g));y[x++]=f[T]}}}return n.makeTensorInfo([l,m,h,p],r.dtype,y)}const cde={kernelName:b2,backendName:"cpu",kernelFunc:lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=s;Ze([r,a],"depthwiseConv2DNative");const d=nt(r.shape),m=nt(a.shape);let h=c;h==null&&(h=[1,1]),R(vs(o,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${h}'`);const p=ls(r.shape,a.shape,o,h,l,u,!0),{filterHeight:f,filterWidth:y,dilationHeight:x,dilationWidth:g,padInfo:b}=p,w=b.left,v=b.top,E=p.outChannels/p.inChannels,k=new is(p.outShape,r.dtype),C=n.data.get(r.dataId).values,I=n.data.get(a.dataId).values,A=k.values;for(let $=0;$<p.batchSize;++$){const T=$*d[0],F=$*k.strides[0];for(let O=0;O<p.outHeight;++O){const M=F+O*k.strides[1],B=O*p.strideHeight-v;for(let L=0;L<f;++L){const Y=B+L*x;if(Y<0||Y>=p.inHeight)continue;const D=L*m[0],_=T+Y*d[1];for(let P=0;P<p.outWidth;++P){const z=M+P*k.strides[2],q=P*p.strideWidth-w;for(let K=0;K<y;++K){const ae=q+K*g;if(ae<0||ae>=p.inWidth)continue;const ne=D+K*m[1],Z=_+ae*p.inChannels;let ke=z,Ae=ne;for(let W=0;W<p.inChannels;++W){const le=C[Z+W];for(let we=0;we<E;++we)A[ke+we]+=le*I[Ae+we];ke+=E,Ae+=E}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const ude={kernelName:_x,backendName:"cpu",kernelFunc:WL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,filterShape:d}=s;Ze([r,a],"depthwiseConv2dNativeBackpropFilter");const m=ls(r.shape,d,o,l,c,u,!0),{strideHeight:h,strideWidth:p,filterHeight:f,filterWidth:y}=m,x=new is(m.filterShape,"float32"),g=m.padInfo.left,b=m.padInfo.top,w=m.outChannels/m.inChannels,v=n.data.get(r.dataId).values,E=new is(r.shape,r.dtype,v),k=n.data.get(a.dataId).values,C=new is(a.shape,a.dtype,k);for(let I=0;I<f;++I){const A=Math.max(0,Math.ceil((b-I)/h)),$=Math.min(m.outHeight,(m.inHeight+b-I)/h);for(let T=0;T<y;++T){const F=Math.max(0,Math.ceil((g-T)/p)),O=Math.min(m.outWidth,(m.inWidth+g-T)/p);for(let M=0;M<m.outChannels;++M){const B=Math.trunc(M/w),L=M%w;let Y=0;for(let D=0;D<m.batchSize;++D)for(let _=A;_<$;++_){const P=I+_*h-b;for(let z=F;z<O;++z){const q=T+z*p-g;Y+=E.get(D,P,q,B)*C.get(D,_,z,M)}}x.set(Y,I,T,B,L)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const mde={kernelName:w2,backendName:"cpu",kernelFunc:dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hde(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,inputShape:d}=s;Ze([r,a],"depthwiseConv2DNativeBackpropInput");const m=nt(r.shape),h=nt(a.shape),p=ls(d,a.shape,o,l,c,u,!0),f=new is(p.inShape,"float32"),y=f.values,[x,g,b]=f.strides,w=n.data.get(r.dataId).values,[v,E,k]=m,C=n.data.get(a.dataId).values,[I,A,$]=h,{batchSize:T,filterHeight:F,filterWidth:O,inChannels:M,inHeight:B,inWidth:L,outChannels:Y,outHeight:D,outWidth:_,strideHeight:P,strideWidth:z}=p,q=F-1-p.padInfo.top,K=O-1-p.padInfo.left,ae=Y/M;for(let ne=0;ne<T;++ne)for(let Z=0;Z<M;++Z)for(let ke=0;ke<B;++ke){const Ae=ke-q,W=Math.max(0,Math.ceil(Ae/P)),le=Math.min(D,(F+Ae)/P);for(let we=0;we<L;++we){const de=we-K,Ee=Math.max(0,Math.ceil(de/z)),Re=Math.min(_,(O+de)/z);let ze=0;for(let _e=W;_e<le;++_e){const ht=_e*P-Ae;for(let X=Ee;X<Re;++X){const me=X*z-de,Fe=v*ne+E*_e+k*X,tt=I*(F-1-ht)+A*(O-1-me)+$*Z;for(let Oe=0;Oe<ae;++Oe){const Ye=Z*ae+Oe,at=w[Fe+Ye],At=C[tt+Oe];ze+=at*At}}}y[x*ne+g*ke+b*we+Z]=ze}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const pde={kernelName:v2,backendName:"cpu",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(t){const{inputs:e,backend:n}=t,{x:s}=e,r=ue(s.shape),a=n.data.get(s.dataId).values,o=Nt([r,r],s.dtype),l=o.values;for(let u=0;u<a.length;u++)l[u*r+u]=a[u];const c=[...s.shape,...s.shape];return n.makeTensorInfo(c,o.dtype,o.values)}const gde={kernelName:n4,backendName:"cpu",kernelFunc:fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde={kernelName:Dx,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:a,pad:o,dilations:l}=n,c=e,u=c.data.get(s.dataId).values,d=s.shape.length,m=c.data.get(r.dataId).values,h=r.shape.length,{batchSize:p,inHeight:f,inWidth:y,inChannels:x,outHeight:g,outWidth:b,padInfo:w,strideHeight:v,strideWidth:E,filterHeight:k,filterWidth:C,dilationHeight:I,dilationWidth:A,outShape:$}=Dp(s.shape,r.shape,a,o,"NHWC",l),T=ue($),F=$.length,O=Cn(s.dtype,T);for(let B=0;B<p;++B)for(let L=0;L<g;++L){const Y=L*v-w.top;for(let D=0;D<b;++D){const _=D*E-w.left;for(let P=0;P<x;++P){let z=Number.MIN_SAFE_INTEGER;for(let K=0;K<k;++K){const ae=Y+K*I;if(ae>=0&&ae<f)for(let ne=0;ne<C;++ne){const Z=_+ne*A;if(Z>=0&&Z<y){const ke=uo([B,ae,Z,P],d,nt(s.shape)),Ae=uo([K,ne,P],h,nt(r.shape)),W=u[ke]+m[Ae];W>z&&(z=W)}}}const q=uo([B,L,D,P],F,nt($));O[q]=z}}}return{dataId:c.write(kc(O,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yde={kernelName:N2,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:a}=t,{strides:o,pad:l,dilations:c}=n,u=e,d=Pa(s.shape,u.data.get(s.dataId).values),m=Pa(r.shape,u.data.get(r.dataId).values),{batchSize:h,inHeight:p,inWidth:f,inChannels:y,outHeight:x,outWidth:g,padInfo:b,strideHeight:w,strideWidth:v,filterHeight:E,filterWidth:k,dilationHeight:C,dilationWidth:I,outShape:A}=Dp(s.shape,r.shape,o,l,"NHWC",c);R(a.rank===A.length,()=>`Error in ${N2}, dy must have the same rank as output ${A.length}, but got ${a.rank}`);const $=Pa(A,u.data.get(a.dataId).values),T=ZD(r.shape,r.dtype);for(let O=0;O<h;++O)for(let M=0;M<x;++M){const B=M*w-b.top;for(let L=0;L<g;++L){const Y=L*v-b.left;for(let D=0;D<y;++D){let _=Number.MIN_SAFE_INTEGER,P=0,z=0;for(let q=0;q<E;++q){const K=B+q*C;if(K>=0&&K<p)for(let ae=0;ae<k;++ae){const ne=Y+ae*I;if(ne>=0&&ne<f){const Z=d[O][K][ne][D]+m[q][ae][D];Z>_&&(_=Z,P=q,z=ae)}}}T[P][z][D]+=$[O][M][L][D]}}}return{dataId:u.write(kc(T,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde={kernelName:E2,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:a}=t,{strides:o,pad:l,dilations:c}=n,u=e,d=Pa(s.shape,u.data.get(s.dataId).values),m=Pa(r.shape,u.data.get(r.dataId).values),{batchSize:h,inHeight:p,inWidth:f,inChannels:y,outHeight:x,outWidth:g,padInfo:b,strideHeight:w,strideWidth:v,filterHeight:E,filterWidth:k,dilationHeight:C,dilationWidth:I,outShape:A}=Dp(s.shape,r.shape,o,l,"NHWC",c);R(a.rank===A.length,()=>`Error in ${E2}, dy must have the same rank as output ${A.length}, but got ${a.rank}`);const $=Pa(A,u.data.get(a.dataId).values),T=ZD(s.shape,s.dtype);for(let O=0;O<h;++O)for(let M=0;M<x;++M){const B=M*w-b.top;for(let L=0;L<g;++L){const Y=L*v-b.left;for(let D=0;D<y;++D){let _=Number.MIN_SAFE_INTEGER,P=B<0?0:B,z=Y<0?0:Y;for(let q=0;q<E;++q){const K=B+q*C;if(K>=0&&K<p)for(let ae=0;ae<k;++ae){const ne=Y+ae*I;if(ne>=0&&ne<f){const Z=d[O][K][ne][D]+m[q][ae][D];Z>_&&(_=Z,P=K,z=ne)}}}T[O][P][z][D]+=$[O][M][L][D]}}}return{dataId:u.write(kc(T,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:a,options:o}=s,{contextOptions:l,imageOptions:c}=o||{},u=c?.alpha||1,d=l?.contextType||"2d";if(d!=="2d")throw new Error(`Context type ${l.contextType} is not supported by the CPU backend.`);const m=a.getContext(d,l?.contextAttributes||{});if(m==null)throw new Error(`Could not get the context with ${d} type.`);const[h,p]=r.shape.slice(0,2),f=r.shape.length===2?1:r.shape[2],y=n.data.get(r.dataId).values,x=r.dtype==="float32"?255:1,g=new Uint8ClampedArray(p*h*4);for(let w=0;w<h*p;++w){const v=[0,0,0,255*u];for(let k=0;k<f;k++){const C=y[w*f+k];if(r.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(r.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);f===1?(v[0]=C*x,v[1]=C*x,v[2]=C*x):v[k]=C*x}const E=w*4;g[E+0]=Math.round(v[0]),g[E+1]=Math.round(v[1]),g[E+2]=Math.round(v[2]),g[E+3]=Math.round(v[3])}a.width=p,a.height=h;const b=new ImageData(g,p,h);return m.putImageData(b,0,0),r}const vde={kernelName:VZ,backendName:"cpu",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uf(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s;Ze(r,"sum");let l;r.dtype==="bool"?l=Nl({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):l=Co({inputs:{x:r},backend:n});const c=l.shape.length,u=Et(a,l.shape),d=yn(u,c);let m=u,h=l;d!=null&&(h=er({inputs:{x:l},backend:n,attrs:{perm:d}}),m=$n(m.length,c)),cs("sum",m,h.shape.length);const[p,f]=Qn(h.shape,m),y=pr(h.dtype,"int32");let x=gb(n,p,y);const g=ue(f),b=n.data.get(x.dataId).values,w=n.data.get(h.dataId).values;for(let v=0;v<b.length;++v){const E=v*g;let k=0;for(let C=0;C<g;++C)k+=w[E+C];b[v]=k}if(o){const v=On(x.shape,u),E=x;x=rn({inputs:{x},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(E)}return n.disposeIntermediateTensorInfo(l),d!=null&&n.disposeIntermediateTensorInfo(h),x}const Ede={kernelName:my,backendName:"cpu",kernelFunc:uf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,a=e,{allDims:o,summedDims:l,idDims:c}=bk(r,a.length);vk(o.length,c,a);const{path:u,steps:d}=Ek(l,c),m=d.length;let h=null,p=o.length;const f=[];for(let y=0;y<m;++y){for(const x of d[y]){const{permutationIndices:g,expandDims:b}=wk(p,c[x]);let w;Nk(g)?w=a[x]:(w=er({inputs:{x:a[x]},backend:n,attrs:{perm:g}}),f.push(w));const v=w.shape.slice();for(let E=0;E<b.length;++E)v.splice(b[E],0,1);zt(w.shape,v)||(w=rn({inputs:{x:w},backend:n,attrs:{shape:v}}),f.push(w)),h===null?h=w:(h=xb({inputs:{a:w,b:h},backend:n}),f.push(h))}y<m-1&&(u[y]>=0&&(h=uf({inputs:{x:h},backend:n,attrs:{axis:u[y]-(o.length-p),keepDims:!1}}),f.push(h)),p--)}for(const y of f)y!==h&&n.disposeIntermediateTensorInfo(y);return h}const kde={kernelName:k2,backendName:"cpu",kernelFunc:Nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Ze([s,r],"eluGrad");const a=new Float32Array(ue(r.shape)),o=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values;for(let c=0;c<o.length;++c){const u=o[c];u>=0?a[c]=l[c]:a[c]=l[c]*(u+1)}return n.makeTensorInfo(r.shape,"float32",a)}const Cde={kernelName:S2,backendName:"cpu",kernelFunc:Sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ide=dk,$de=mk,Tde=hk,Ade=pk,Rde=fk,_de=gk,Dde=Ht(qh,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+Ide*n);return e*(1-((((_de*s+Rde)*s+Ade)*s+Tde)*s+$de)*s*Math.exp(-n*n))}),Pde={kernelName:qh,backendName:"cpu",kernelFunc:Dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wb(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:a}=s,o=r.shape.length,l=r.shape.slice();let c=a;return a<0&&(R(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+a+1),l.splice(c,0,1),rn({inputs:{x:r},backend:n,attrs:{shape:l}})}const Fde={kernelName:Fx,backendName:"cpu",kernelFunc:wb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mde=Rn((t,e)=>t/e),bS=Kn(Gh,Mde),wS={kernelName:Gh,backendName:"cpu",kernelFunc:bS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jL(t,e,n){const s=t.shape,r=s[0],a=s[1],o=n.data.get(t.dataId),l=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,u=[r,a],d=ue(u),m=bs("float32",d),h=bs("float32",d);for(let x=0;x<r;x++){const g=Yc({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,a]}}),b=Yc({inputs:{x:c},backend:n,attrs:{begin:[x,0],size:[1,a]}}),w=xr({inputs:{real:g,imag:b},backend:n}),{real:v,imag:E}=Ode(w,e,n),k=xi(v,E);for(let C=0;C<a;C++){const I=xk(k,C);m[x*a+C]=I.real,h[x*a+C]=I.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(w)}const p=n.makeTensorInfo(u,"float32",m),f=n.makeTensorInfo(u,"float32",h),y=xr({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),y}function Ode(t,e,n){const s=ue(t.shape),r=n.data.get(t.dataId),a=n.data.get(r.complexTensorInfos.real.dataId).values,o=n.data.get(r.complexTensorInfos.imag.dataId).values;if(Lde(s)){const l=vS(a,o,s,e,n),c=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(c,"float32",l.real),d=n.makeTensorInfo(c,"float32",l.imag),m=n.makeTensorInfo([],"float32",al(s,"float32")),h=Co({inputs:{x:m},backend:n}),p=wS.kernelFunc({inputs:{a:u,b:m},backend:n}),f=wS.kernelFunc({inputs:{a:d,b:h},backend:n}),y=n.data.get(p.dataId).values,x=n.data.get(f.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),{real:y,imag:x}}return l}else{const l=xi(a,o),c=zde(l,s,e);return vP(c)}}function Lde(t){return(t&t-1)===0}function vS(t,e,n,s,r){if(n===1)return{real:t,imag:e};const a=xi(t,e),o=n/2,l=EP(a),c=l.real,u=l.imag,d=[c.length],m=r.makeTensorInfo(d,"float32",c),h=r.makeTensorInfo(d,"float32",u),p=xr({inputs:{real:m,imag:h},backend:r}),f=NP(a),y=f.real,x=f.imag,g=[y.length],b=r.makeTensorInfo(g,"float32",y),w=r.makeTensorInfo(g,"float32",x),v=xr({inputs:{real:b,imag:w},backend:r}),E=vS(c,u,o,s,r),k=E.real,C=E.imag,I=[k.length],A=r.makeTensorInfo(I,"float32",k),$=r.makeTensorInfo(I,"float32",C),T=xr({inputs:{real:A,imag:$},backend:r}),F=vS(y,x,o,s,r),O=F.real,M=F.imag,B=[O.length],L=r.makeTensorInfo(B,"float32",O),Y=r.makeTensorInfo(B,"float32",M),D=xr({inputs:{real:L,imag:Y},backend:r}),_=SP(n,s),P=[_.real.length],z=r.makeTensorInfo(P,"float32",_.real),q=r.makeTensorInfo(P,"float32",_.imag),K=xr({inputs:{real:z,imag:q},backend:r}),ae=xb({inputs:{a:K,b:D},backend:r}),ne=Ld({inputs:{a:T,b:ae},backend:r}),Z=xS({inputs:{a:T,b:ae},backend:r}),ke=Kc({inputs:{input:ne},backend:r}),Ae=Kc({inputs:{input:Z},backend:r}),W=zd({inputs:{input:ne},backend:r}),le=zd({inputs:{input:Z},backend:r}),we=Bd({inputs:[ke,Ae],backend:r,attrs:{axis:0}}),de=Bd({inputs:[W,le],backend:r,attrs:{axis:0}}),Ee=r.data.get(we.dataId).values,Re=r.data.get(de.dataId).values;return r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(w),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(L),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(D),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(ae),r.disposeIntermediateTensorInfo(ne),r.disposeIntermediateTensorInfo(Z),r.disposeIntermediateTensorInfo(ke),r.disposeIntermediateTensorInfo(W),r.disposeIntermediateTensorInfo(Ae),r.disposeIntermediateTensorInfo(le),r.disposeIntermediateTensorInfo(we),r.disposeIntermediateTensorInfo(de),{real:Ee,imag:Re}}function zde(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let a=0,o=0;for(let l=0;l<e;l++){const c=CP(r*l,e,n),u=xk(t,l);a+=u.real*c.real-u.imag*c.imag,o+=u.real*c.imag+u.imag*c.real}n&&(a/=e,o/=e),kP(s,a,o,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bde(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ue(s.shape),a=s.shape[s.shape.length-1],o=r/a,l=rn({inputs:{x:s},backend:n,attrs:{shape:[o,a]}}),c=jL(l,!1,n),u=rn({inputs:{x:c},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}const Ude={kernelName:C2,backendName:"cpu",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ES(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:a}=n,o=a||pd(r),l=Cn(o,ue(s));return Wde(l,r,o),e.makeTensorInfo(s,o,l)}const Vde={kernelName:I2,backendName:"cpu",kernelFunc:ES};function Wde(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jde={kernelName:$2,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,a=bs(s.dtype,ue(s.shape)),[o,l,c,u]=s.shape,d=r.data.get(s.dataId).values;for(let h=0;h<o;h++){const p=h*c*l*u;for(let f=0;f<l;f++){const y=f*(c*u);for(let x=0;x<c;x++){const g=x*u;for(let b=0;b<u;b++){const w=Math.round(c-x-1),v=p+y+g+b;let E=d[v];if(w>=0&&w<c){const k=w*u,C=p+y+k+b;E=d[C]}a[v]=E}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:d,dilations:m,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=s;let y=VL({inputs:{x:r,filter:a},backend:n,attrs:{strides:c,pad:u,dataFormat:d,dilations:m,dimRoundingMode:h}});if(o){const x=y;if(d==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const g=rn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});y=Ld({inputs:{a:y,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else y=Ld({inputs:{a:y,b:o},backend:n});n.disposeIntermediateTensorInfo(x)}if(p){const x=y;if(d==="NCHW"&&p==="prelu"&&l.shape.length===1&&l.shape[0]!==1){const g=rn({inputs:{x:l},backend:n,attrs:{shape:[l.shape[0],1,1]}});y=bb(n,y,p,g,f),n.disposeIntermediateTensorInfo(g)}else y=bb(n,y,p,l,f);n.disposeIntermediateTensorInfo(x)}return y}const Hde={kernelName:wy,backendName:"cpu",kernelFunc:Gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:d,dilations:m,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=s;let y=WL({inputs:{x:r,filter:a},backend:n,attrs:{strides:c,pad:u,dataFormat:d,dilations:m,dimRoundingMode:h}});if(o){const x=y;y=Ld({inputs:{a:y,b:o},backend:n}),n.disposeIntermediateTensorInfo(x)}if(p){const x=y;y=bb(n,y,p,l,f),n.disposeIntermediateTensorInfo(x)}return y}const Kde={kernelName:v4,backendName:"cpu",kernelFunc:qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xde(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,a=ue(s.shape),o=r.shape,l=o[o.length-1],[c,u,d,m]=QN(s,r);if(u===0)return n.makeTensorInfo(c,s.dtype,[]);const h=n.data.get(r.dataId).values,p=n.bufferSync(s),f=YO(h,p,s.dtype,u,l,d,m,s.shape,a);return n.makeTensorInfo(c,s.dtype,f.values)}const Yde={kernelName:s4,backendName:"cpu",kernelFunc:Xde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:a}=e,{axis:o,batchDims:l}=s;Ze([r,a],"gatherV2");const c=Et(o,r.shape)[0],u=n.data.get(a.dataId).values,d=r.shape[c];for(let v=0;v<u.length;++v){const E=u[v];R(E<=d-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${d-1}]`)}let m=l;l==null&&(m=0);const h=ue(a.shape),p=Ck(r,a,c,m),f=rn({inputs:{x:r},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),y=rn({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,h/p.batchSize]}}),x=[p.batchSize,p.outerSize,h/p.batchSize,p.sliceSize],g=n.bufferSync(y),b=n.bufferSync(f),w=ZO(b,g,x);return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.makeTensorInfo(p.outputShape,w.dtype,w.values)}const Jde={kernelName:Ox,backendName:"cpu",kernelFunc:Zde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qde(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ue(s.shape),a=s.shape[s.shape.length-1],o=r/a,l=rn({inputs:{x:s},backend:n,attrs:{shape:[o,a]}}),c=jL(l,!0,n),u=rn({inputs:{x:c},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}const eme={kernelName:T2,backendName:"cpu",kernelFunc:Qde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tme=Ht(ep,t=>Number.isFinite(t)?1:0,"bool"),nme={kernelName:ep,backendName:"cpu",kernelFunc:tme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sme=Ht(tp,t=>Math.abs(t)===1/0?1:0,"bool"),rme={kernelName:tp,backendName:"cpu",kernelFunc:sme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame=Ht(np,t=>Number.isNaN(t)?1:0,"bool"),ome={kernelName:np,backendName:"cpu",kernelFunc:ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ime(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:a}=n,o=nL(s,r,a);return e.makeTensorInfo([o.length],"float32",o)}const lme={kernelName:r4,backendName:"cpu",kernelFunc:ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cme=Ht(rp,t=>Math.log1p(t)),ume={kernelName:rp,backendName:"cpu",kernelFunc:cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dme=Rn((t,e)=>t&&e),mme=Kn(Vx,dme,null,"bool"),hme={kernelName:Vx,backendName:"cpu",kernelFunc:mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pme=Ht(Wx,t=>t?0:1,"bool"),fme={kernelName:Wx,backendName:"cpu",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme=Rn((t,e)=>t||e),xme=Kn(jx,gme,null,"bool"),yme={kernelName:jx,backendName:"cpu",kernelFunc:xme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:a,bias:o,alpha:l,beta:c}=s;Ze(r,"LRN");const u=r.shape[3],d=u-1,m=n.data.get(r.dataId).values,h=ue(r.shape),p=new Float32Array(h);function f(y){const x=y%u;let g=y-x+Math.max(0,x-a);const b=y-x+Math.min(x+a,d);let w=0;for(;g<=b;g++){const v=m[g];w+=v*v}return w}for(let y=0;y<h;y++){const x=f(y),g=m[y]*Math.pow(o+l*x,-c);p[y]=g}return n.makeTensorInfo(r.shape,r.dtype,p)}const wme={kernelName:Gx,backendName:"cpu",kernelFunc:bme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:a,dy:o}=e,{depthRadius:l,bias:c,alpha:u,beta:d}=s;Ze(o,"LRNGrad");const m=ue(o.shape),h=o.shape[3],p=n.data.get(o.dataId).values,f=n.data.get(r.dataId).values,y=n.data.get(a.dataId).values,x=new Float32Array(m),g=m;for(let b=0;b<g;b++){const w=b%h,v=b-w+Math.max(0,w-l),E=b-w+Math.min(h,w+l+1);let k=0;for(let C=v;C<E;C++)k+=Math.pow(f[C],2);k=u*k+c;for(let C=v;C<E;C++){let I=-2*u*d*f[C]*y[b]/k;b===C&&(I+=Math.pow(k,-d)),I*=p[b],x[C]+=I}}return n.makeTensorInfo(o.shape,r.dtype,x)}const Eme={kernelName:R2,backendName:"cpu",kernelFunc:vme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:a,keepDims:o}=s,l=n;let c=r.shape;const u=c.length,d=Et(a,c);let m=d;const h=yn(m,u);let p=l.data.get(r.dataId).values;if(h!=null){const v=new Array(u);for(let E=0;E<v.length;E++)v[E]=c[h[E]];p=fS(p,c,r.dtype,h,v),m=$n(m.length,u),c=v}Ze(r,"max"),cs("max",m,u);const[f,y]=Qn(c,m),x=ue(y),g=rL(p,x,f,r.dtype),b=l.write(g,f,r.dtype);let w=f;return o&&(w=On(f,d)),{dataId:b,shape:w,dtype:r.dtype}}const Nme={kernelName:Hx,backendName:"cpu",kernelFunc:GL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ze(r,"maxPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;R(vs(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=ra(r.shape,a,o,u,l,c);let m;if(d.filterWidth===1&&d.filterHeight===1&&zt(d.inShape,d.outShape))m=Co({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,p=nt(r.shape),f=yS(h,r.shape,r.dtype,p,d,"max");m=n.makeTensorInfo(d.outShape,r.dtype,f.values)}return m}const Sme={kernelName:qx,backendName:"cpu",kernelFunc:kme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=s;Ze(r,"maxPool3d");const d=mi(r.shape,a,o,1,l,c,u),m=n.data.get(r.dataId).values,h=UL(m,r.shape,r.dtype,nt(r.shape),d,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const Ime={kernelName:Kx,backendName:"cpu",kernelFunc:Cme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $me(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=s;Ze([r,a],"maxPool3DGrad");const d=mi(a.shape,o,l,1,c,u),m=n.bufferSync(a),h=xue(m,d),p=d.strideDepth,f=d.strideHeight,y=d.strideWidth,x=d.dilationDepth,g=d.dilationHeight,b=d.dilationWidth,w=d.effectiveFilterDepth,v=d.effectiveFilterHeight,E=d.effectiveFilterWidth,k=w-1-d.padInfo.front,C=E-1-d.padInfo.left,I=v-1-d.padInfo.top,A=Nt(a.shape,"float32"),$=n.bufferSync(r);for(let T=0;T<d.batchSize;++T)for(let F=0;F<d.inChannels;++F)for(let O=0;O<d.inDepth;++O)for(let M=0;M<d.inHeight;++M)for(let B=0;B<d.inWidth;++B){const L=O-k,Y=M-I,D=B-C;let _=0;for(let P=0;P<w;P+=x){const z=(L+P)/p;if(!(z<0||z>=d.outDepth||Math.floor(z)!==z))for(let q=0;q<v;q+=g){const K=(Y+q)/f;if(!(K<0||K>=d.outHeight||Math.floor(K)!==K))for(let ae=0;ae<E;ae+=b){const ne=(D+ae)/y;if(ne<0||ne>=d.outWidth||Math.floor(ne)!==ne)continue;const Z=w*v*E-1-h.get(T,z,K,ne,F),ke=P*v*E+q*E+ae,Ae=Z===ke?1:0;if(Ae===0)continue;const W=$.get(T,z,K,ne,F);_+=W*Ae}}}A.set(_,T,O,M,B,F)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const Tme={kernelName:D2,backendName:"cpu",kernelFunc:$me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a,output:o}=e,l=a;Ze([a,o],"maxPoolGrad");const{filterSize:c,strides:u,pad:d,dimRoundingMode:m}=s,h=ra(l.shape,c,u,1,d,m),p=n.data.get(l.dataId).values,f=Nt(h.outShape,l.dtype,BL(p,l.shape,l.dtype,h).values),y=h.strideHeight,x=h.strideWidth,g=h.dilationHeight,b=h.dilationWidth,w=h.effectiveFilterHeight,v=h.effectiveFilterWidth,E=v-1-h.padInfo.left,k=w-1-h.padInfo.top,C=Nt(l.shape,"float32"),I=n.data.get(r.dataId).values,A=Nt(r.shape,"float32",I);for(let $=0;$<h.batchSize;++$)for(let T=0;T<h.inChannels;++T)for(let F=0;F<h.inHeight;++F)for(let O=0;O<h.inWidth;++O){const M=F-k,B=O-E;let L=0;for(let Y=0;Y<w;Y+=g){const D=(M+Y)/y;if(!(D<0||D>=h.outHeight||Math.floor(D)!==D))for(let _=0;_<v;_+=b){const P=(B+_)/x;if(P<0||P>=h.outWidth||Math.floor(P)!==P)continue;const z=w*v-1-f.get($,D,P,T),q=Y*v+_,K=z===q?1:0;if(K===0)continue;const ae=A.get($,D,P,T);L+=ae*K}}C.set(L,$,F,O,T)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Rme={kernelName:_2,backendName:"cpu",kernelFunc:Ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _me(t,e,n,s,r){const a=nt(e),o=yS(t,e,n,a,r,"max"),l=BL(t,e,n,r,!0,s);return[o.values,l.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dme={kernelName:a4,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:a,pad:o,includeBatchInIndex:l}=e,c=n;Ze(s,"MaxPoolWithArgmax");const u=c.data.get(s.dataId).values,d=ra(s.shape,r,a,[1,1],o),[m,h]=_me(u,s.shape,s.dtype,l,d),p=c.write(m,d.outShape,s.dtype),f=c.write(h,d.outShape,s.dtype);return[{dataId:p,shape:d.outShape,dtype:s.dtype},{dataId:f,shape:d.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s,l=Et(a,r.shape),u=Qn(r.shape,l)[1],d=ue(u),m=[],h=n.makeTensorInfo([],"float32",new Float32Array([d]));m.push(h);const p=Nl({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});m.push(p);const f=bS({inputs:{a:p,b:h},backend:n});m.push(f);const y=uf({inputs:{x:f},backend:n,attrs:{axis:a,keepDims:o}});return m.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const Fme={kernelName:Xx,backendName:"cpu",kernelFunc:Pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s;Ze(r,"min");const l=Et(a,r.shape);let c=l;const u=yn(c,r.shape.length);let d=r;u!=null&&(d=er({inputs:{x:r},backend:n,attrs:{perm:u}}),c=$n(c.length,r.shape.length)),cs("min",c,d.shape.length);const[m,h]=Qn(d.shape,c),p=ue(h),f=ws(ue(m),d.dtype),y=n.data.get(d.dataId).values;for(let g=0;g<f.length;++g){const b=g*p;let w=y[b];for(let v=0;v<p;++v){const E=y[b+v];(Number.isNaN(E)||E<w)&&(w=E)}f[g]=w}u!=null&&n.disposeIntermediateTensorInfo(d);const x=n.makeTensorInfo(m,d.dtype,f);if(o){const g=On(m,l),b=rn({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),b}return x}const Ome={kernelName:Yx,backendName:"cpu",kernelFunc:Mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lme(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,mode:o}=s;Ze(r,"mirrorPad");const l=a.map((w,v)=>w[0]+r.shape[v]+w[1]),c=a.map(w=>w[0]),u=a.map((w,v)=>w[0]+r.shape[v]),d=o==="reflect"?0:1,m=n.data.get(r.dataId).values,h=r.shape.length,p=nt(r.shape),f=ue(l),y=l.length,x=nt(l),g=bs(r.dtype,f);for(let w=0;w<f;w++){let v=fd(w,y,x);for(let k=0;k<y;k++)v[k]<c[k]?v[k]=c[k]*2-v[k]-d:v[k]>=u[k]&&(v[k]=(u[k]-1)*2-v[k]+d);v=v.map((k,C)=>k-c[C]);const E=uo(v,h,p);g[w]=m[E]}return{dataId:n.write(g,l,r.dtype),shape:l,dtype:r.dtype}}const zme={kernelName:Zx,backendName:"cpu",kernelFunc:Lme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bme=Rn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),Ume=Kn(ip,Bme),Vme={kernelName:ip,backendName:"cpu",kernelFunc:Ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HL(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:a}=s,o=r.shape.length;let l=a;if(l===-1&&(l=o-1),l!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${l}`);const c=Et([l],r.shape),u=GL({inputs:{x:r},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),d=On(u.shape,c),m=rn({inputs:{x:u},backend:n,attrs:{shape:d}}),h=xS({inputs:{a:r,b:m},backend:n}),p=HO({inputs:{x:h},backend:n}),f=uf({inputs:{x:p},backend:n,attrs:{axis:c,keepDims:!1}}),y=rn({inputs:{x:f},backend:n,attrs:{shape:d}}),x=bS({inputs:{a:p,b:y},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),x}const Wme={kernelName:fy,backendName:"cpu",kernelFunc:HL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:a,seed:o,normalized:l}=s;Ze(r,"multinomial");const c=l?r:HL({inputs:{logits:r},backend:n,attrs:{dim:-1}}),u=c.shape[0],d=c.shape[1],m=n.data.get(c.dataId).values,h=[u,a],p=ws(ue(h),"int32");for(let f=0;f<u;++f){const y=f*d,x=new Float32Array(d-1);x[0]=m[y];for(let w=1;w<x.length;++w)x[w]=x[w-1]+m[y+w];const g=MN.alea(o.toString()),b=f*a;for(let w=0;w<a;++w){const v=g();p[b+w]=x.length;for(let E=0;E<x.length;E++)if(v<x[E]){p[b+w]=E;break}}}return l||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(h,"int32",p)}const Gme={kernelName:o4,backendName:"cpu",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hme=qN;function qme(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=s;Ze(r,"NonMaxSuppression");const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:m}=Hme(u,d,o,l,c);return n.makeTensorInfo([m.length],"int32",new Int32Array(m))}const Kme={kernelName:P2,backendName:"cpu",kernelFunc:qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xme=KN;function Yme(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=s;Ze(r,"NonMaxSuppressionPadded");const d=n.data.get(r.dataId).values,m=n.data.get(a.dataId).values,{selectedIndices:h,validOutputs:p}=Xme(d,m,o,l,c,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const Zme={kernelName:F2,backendName:"cpu",kernelFunc:Yme};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jme=XN;function Qme(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=s;Ze(r,"NonMaxSuppressionWithScore");const d=n.data.get(r.dataId).values,m=n.data.get(a.dataId).values,h=o,p=l,f=c,y=u,{selectedIndices:x,selectedScores:g}=Jme(d,m,h,p,f,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const ehe={kernelName:M2,backendName:"cpu",kernelFunc:Qme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function the(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:a,depth:o,onValue:l,offValue:c}=s;Ze(r,"oneHot");const u=ue(r.shape),d=new Float32Array(u*o);d.fill(c);const m=n.data.get(r.dataId).values;for(let h=0;h<u;++h)m[h]>=0&&m[h]<o&&(d[h*o+m[h]]=l);return n.makeTensorInfo([...r.shape,o],a,d)}const nhe={kernelName:ty,backendName:"cpu",kernelFunc:the};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vb(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Kc({inputs:{input:s},backend:n}),a=vb({inputs:{x:r},backend:n}),o=zd({inputs:{input:s},backend:n}),l=vb({inputs:{x:o},backend:n}),c=xr({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}else return ES({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const she={kernelName:yy,backendName:"cpu",kernelFunc:vb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Kc({inputs:{input:s},backend:n}),a=qL({inputs:{x:r},backend:n}),o=zd({inputs:{input:s},backend:n}),l=vb({inputs:{x:o},backend:n}),c=xr({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}else return ES({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const rhe={kernelName:ey,backendName:"cpu",kernelFunc:qL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return wb({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const a=e[0].shape,o=e[0].dtype;e.forEach(d=>{YE(a,d.shape,"All tensors passed to stack must have matching shapes"),R(o===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],c=e.map(d=>{const m=wb({inputs:{input:d},backend:n,attrs:{dim:r}});return l.push(m),m}),u=Bd({inputs:c,backend:n,attrs:{axis:r}});return l.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const ahe={kernelName:ny,backendName:"cpu",kernelFunc:KL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ohe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,constantValue:o}=s;Ze(r,"pad");const l=a.map((b,w)=>b[0]+r.shape[w]+b[1]),c=a.map(b=>b[0]),u=n.data.get(r.dataId).values,d=ue(r.shape),m=r.shape.length,h=nt(r.shape),p=ue(l),f=l.length,y=nt(l),x=bs(r.dtype,p);o!==0&&x.fill(o);for(let b=0;b<d;b++){const v=fd(b,m,h).map((k,C)=>k+c[C]),E=uo(v,f,y);x[E]=u[b]}return{dataId:n.write(x,l,r.dtype),shape:l,dtype:r.dtype}}const XL={kernelName:sy,backendName:"cpu",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ihe=Rn((t,e)=>Math.pow(t,e)),lhe=Kn(cp,ihe),che={kernelName:cp,backendName:"cpu",kernelFunc:lhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uhe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:a,indices:o}=e,l=r.map(x=>n.data.get(x.dataId).values),c=r.map(x=>x.shape),u=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,[m,h,p]=dL(l,c,u,a.shape,a.dtype,d,o.shape),f=m.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(p,a.dtype,h);return f.concat([y])}const dhe={kernelName:i4,backendName:"cpu",kernelFunc:uhe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:a}=e,o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,[u,d]=hL(o,s.shape,s.dtype,l,r.shape,c,a.shape),m=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([d.length],s.dtype,d);return[m,h]}const hhe={kernelName:l4,backendName:"cpu",kernelFunc:mhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function phe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:a,defaultValue:o,rowPartitionTensors:l}=e,{rowPartitionTypes:c}=s,u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,m=n.data.get(o.dataId).values,h=l.map(x=>n.data.get(x.dataId).values),p=l.map(x=>x.shape),[f,y]=gL(u,r.shape,d,a.shape,a.dtype,m,o.shape,h,p,c);return n.makeTensorInfo(f,a.dtype,y)}const fhe={kernelName:c4,backendName:"cpu",kernelFunc:phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ghe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:a,step:o}=n,l=xL(s,r,o,a);return e.makeTensorInfo([l.length],a,l)}const xhe={kernelName:O2,backendName:"cpu",kernelFunc:ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yhe=Ht(up,t=>1/t),bhe={kernelName:up,backendName:"cpu",kernelFunc:yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s;Ze(r,"resizeBilinear");const c=nt(r.shape),[u,d]=l,[m,h,p,f]=r.shape,y=n.data.get(r.dataId).values,x=new Float32Array(ue([m,u,d,f])),g=[a&&u>1?h-1:h,a&&d>1?p-1:p],b=[a&&u>1?u-1:u,a&&d>1?d-1:d];let w=0;const v=g[0]/b[0],E=g[1]/b[1];for(let k=0;k<m;k++)for(let C=0;C<u;C++){let I;o?I=v*(C+.5)-.5:I=v*C;const A=Math.max(0,Math.floor(I)),$=I-A,T=Math.min(h-1,Math.ceil(I)),F=k*c[0]+A*c[1],O=k*c[0]+T*c[1];for(let M=0;M<d;M++){let B;o?B=E*(M+.5)-.5:B=E*M;const L=Math.max(0,Math.floor(B)),Y=B-L,D=Math.min(p-1,Math.ceil(B)),_=F+L*c[2],P=O+L*c[2],z=F+D*c[2],q=O+D*c[2];for(let K=0;K<f;K++){const ae=y[_+K],ne=y[P+K],Z=y[z+K],ke=y[q+K],Ae=ae+(Z-ae)*Y,W=ne+(ke-ne)*Y,le=Ae+(W-Ae)*$;x[w++]=le}}}return n.makeTensorInfo([m,u,d,f],"float32",x)}const vhe={kernelName:ly,backendName:"cpu",kernelFunc:whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ehe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:o}=s;Ze([a,r],"resizeBilinearGrad");const l=nt(r.shape),[c,u,d,m]=r.shape,[,h,p]=a.shape,f=new Float32Array(c*u*d*m),y=[o&&h>1?u-1:u,o&&p>1?d-1:d],x=[o&&h>1?h-1:h,o&&p>1?p-1:p],g=y[0]/x[0],b=y[1]/x[1],w=n.data.get(a.dataId).values;let v=0;for(let E=0;E<c;E++){const k=E*l[0];for(let C=0;C<h;C++){const I=C*g,A=Math.floor(I),$=Math.min(Math.ceil(I),u-1),T=k+A*l[1],F=k+$*l[1],O=I-A,M=1-O;for(let B=0;B<p;B++){const L=B*b,Y=Math.floor(L),D=Math.min(Math.ceil(L),d-1),_=L-Y,P=1-_,z=T+Y*l[2],q=T+D*l[2],K=F+Y*l[2],ae=F+D*l[2],ne=M*P,Z=M*_,ke=O*P,Ae=O*_;for(let W=0;W<m;W++){const le=w[v++];f[z+W]+=le*ne,f[q+W]+=le*Z,f[K+W]+=le*ke,f[ae+W]+=le*Ae}}}}return n.makeTensorInfo([c,d,u,m],"float32",f)}const Nhe={kernelName:B2,backendName:"cpu",kernelFunc:Ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function khe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s;Ze(r,"resizeNearestNeighbor");const c=nt(r.shape),[u,d]=l,[m,h,p,f]=r.shape,y=n.data.get(r.dataId).values,x=new Float32Array(m*u*d*f),g=[a&&u>1?h-1:h,a&&d>1?p-1:p],b=[a&&u>1?u-1:u,a&&d>1?d-1:d],w=g[0]/b[0],v=g[1]/b[1];let E=0;for(let k=0;k<m;k++){const C=k*c[0];for(let I=0;I<u;I++){const A=o?w*(I+.5):w*I;let $=Math.min(h-1,a?Math.round(A):Math.floor(A));o&&($=Math.max(0,$));const T=C+$*c[1];for(let F=0;F<d;F++){const O=o?v*(F+.5):v*F;let M=Math.min(p-1,a?Math.round(O):Math.floor(O));o&&(M=Math.max(0,M));const B=T+M*c[2];for(let L=0;L<f;L++){const Y=y[B+L];x[E++]=Y}}}}return n.makeTensorInfo([m,u,d,f],r.dtype,x)}const She={kernelName:iy,backendName:"cpu",kernelFunc:khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Che(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:o}=s;Ze([a,r],"resizeNearestNeighborGrad");const l=nt(r.shape),c=nt(a.shape),[u,d,m,h]=r.shape,[,p,f]=a.shape,y=new Float32Array(u*d*m*h),x=n.data.get(a.dataId).values,g=[o&&p>1?d-1:d,o&&f>1?m-1:m],b=[o&&p>1?p-1:p,o&&f>1?f-1:f],w=g[0]/b[0],v=g[1]/b[1],E=1/w,k=1/v,C=Math.ceil(E)*2+2,I=Math.ceil(k)*2+2;for(let A=0;A<u;A++){const $=A*l[0];for(let T=0;T<d;T++){const F=$+T*l[1],O=Math.floor(T*E),M=Math.floor(O-C/2);for(let B=0;B<m;B++){const L=F+B*l[2],Y=Math.floor(B*k),D=Math.floor(Y-I/2);for(let _=0;_<h;_++){let P=0;for(let z=0;z<C;z++){const q=z+M;if(q<0||q>=p)continue;const K=$+q*c[1],ae=q*w,ne=Math.min(d-1,o?Math.round(ae):Math.floor(ae));if(T===ne)for(let Z=0;Z<I;Z++){const ke=Z+D;if(ke<0||ke>=f)continue;const Ae=K+ke*c[2],W=ke*v,le=Math.min(m-1,o?Math.round(W):Math.floor(W));B===le&&(P+=x[Ae+_])}}y[L+_]=P}}}}return n.makeTensorInfo(r.shape,r.dtype,y)}const Ihe={kernelName:z2,backendName:"cpu",kernelFunc:Che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:a}=s;Ze(r,"reverse");const o=r.shape.length,l=Et(a,r.shape);if(o===0)return Co({inputs:{x:r},backend:n});const c=new is(r.shape,r.dtype),u=n.bufferSync(r);for(let d=0;d<c.size;d++){const m=c.indexToLoc(d),h=m.slice();l.forEach(p=>h[p]=r.shape[p]-1-h[p]),c.set(u.get(...h),...m)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}const The={kernelName:cy,backendName:"cpu",kernelFunc:$he};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ahe={kernelName:q2,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:a,center:o}=e,l=n,c=bs(s.dtype,ue(s.shape)),[u,d,m,h]=s.shape,[p,f]=lk(o,d,m),y=255,x=Math.sin(r),g=Math.cos(r),b=l.data.get(s.dataId).values;for(let v=0;v<u;v++){const E=v*m*d*h;for(let k=0;k<d;k++){const C=k*(m*h);for(let I=0;I<m;I++){const A=I*h;for(let $=0;$<h;$++){const T=[u,k,I,$],F=T[2],O=T[1];let M=(F-p)*g-(O-f)*x,B=(F-p)*x+(O-f)*g;M=Math.round(M+p),B=Math.round(B+f);let L=a;if(typeof a!="number"&&($===3?L=y:L=a[$]),M>=0&&M<m&&B>=0&&B<d){const D=B*(m*h),_=M*h,P=E+D+_+$;L=b[P]}const Y=E+C+A+$;c[Y]=L}}}}return{dataId:l.write(c,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rhe=Ht(hp,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),_he={kernelName:hp,backendName:"cpu",kernelFunc:Rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dhe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:a}=e,{shape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:m}=zc(a,r,o),h=!0,p=n.bufferSync(r),f=n.bufferSync(a),y=Xc(p,f,o,m,u,c,l,d,0,h);return n.makeTensorInfo(o,y.dtype,y.values)}const Phe={kernelName:u4,backendName:"cpu",kernelFunc:Dhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function Mhe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function Ohe(t,e,n,s,r,a){const o=Cn("int32",n*r);for(let l=0;l<n;++l){const c=t.slice(l*s,(l+1)*s),u=l*r;for(let d=0;d<r;++d)o[u+d]=a==="left"?Fhe(c,e[d+u]):Mhe(c,e[d+u])}return o}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lhe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:a}=e,{side:o}=s,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=Ohe(l,c,r.shape[0],r.shape[1],a.shape[1],o);return n.makeTensorInfo(a.shape,"int32",u)}const zhe={kernelName:m4,backendName:"cpu",kernelFunc:Lhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:a}=e;Ze([s,r,a],"select");const o=s.shape.length,l=n.data.get(s.dataId).values,c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,d=pr(r.dtype,a.dtype),m=ws(ue(r.shape),d);let h=0;const p=o===0||o>1||r.shape.length===1?1:ue(r.shape.slice(1));for(let f=0;f<l.length;f++)for(let y=0;y<p;y++)l[f]===1?m[h++]=c[f]:m[h++]=u[f];return n.makeTensorInfo(r.shape,d,m)}const Uhe={kernelName:uy,backendName:"cpu",kernelFunc:Bhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe=Wy,Whe=jy,jhe=Ht(fp,t=>t>=0?Whe*t:Vhe*(Math.exp(t)-1)),Ghe={kernelName:fp,backendName:"cpu",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hhe=Ht(yp,t=>t<0?-1:t>0?1:0),qhe={kernelName:yp,backendName:"cpu",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Khe=Ht(gp,t=>Math.sin(t)),Xhe={kernelName:gp,backendName:"cpu",kernelFunc:Khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yhe=Ht(xp,t=>Math.sinh(t)),Zhe={kernelName:xp,backendName:"cpu",kernelFunc:Yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YL=Math.log(11920928955078125e-23)+2,Jhe=Ht(wp,t=>{const e=t>-YL,n=t<YL,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),Qhe={kernelName:wp,backendName:"cpu",kernelFunc:Jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function epe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,paddings:o}=s;Ze([r],"spaceToBatchND");const l=ue(a),c=[[0,0]];c.push(...o);for(let k=1+a.length;k<r.shape.length;++k)c.push([0,0]);const u=XL.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:c,constantValue:0}}),d=jp(u.shape,a,l,!1),m=Gp(d.length,a.length,!1),h=Hp(u.shape,a,l,!1),y=rn({inputs:{x:u},backend:n,attrs:{shape:d}}),b=er({inputs:{x:y},backend:n,attrs:{perm:m}}),E=rn({inputs:{x:b},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),E}const tpe={kernelName:hy,backendName:"cpu",kernelFunc:epe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function npe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:a,defaultValue:o}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const l=n.data.get(s.dataId).values,c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values[0],[m,h,p,f,y]=vL(l,s.shape,s.dtype,c,r.dtype,u,d);return[n.makeTensorInfo(h,s.dtype,m),n.makeTensorInfo([h[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(x=>Number(x)))),n.makeTensorInfo([y.length],s.dtype,new Int32Array(y))]}const spe={kernelName:h4,backendName:"cpu",kernelFunc:npe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rpe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(n.data.get(r.dataId).values),l=n.data.get(s.dataId).values,c=Array.from(n.data.get(a.dataId).values),[u,d,m]=EL(l,s.shape,s.dtype,o,c);return[n.makeTensorInfo(d,s.dtype,u),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}const ape={kernelName:p4,backendName:"cpu",kernelFunc:rpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ope(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,[u,d]=gS(o,s.shape,s.dtype,l,c,!0);return n.makeTensorInfo(d,s.dtype,u)}const ipe={kernelName:f4,backendName:"cpu",kernelFunc:ope};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,[u,d]=gS(o,s.shape,s.dtype,l,c);return n.makeTensorInfo(d,s.dtype,u)}const cpe={kernelName:g4,backendName:"cpu",kernelFunc:lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function upe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:a,defaultValue:o}=e,{outputShape:l}=s,{sliceRank:c,numUpdates:u,sliceSize:d,strides:m,outputSize:h}=zc(a,r,l),p=!1,f=n.bufferSync(r);let y;switch(a.dtype){case"bool":{const x=n.bufferSync(a),g=!!n.data.get(o.dataId).values[0];y=Xc(f,x,l,h,d,u,c,m,g,p);break}case"float32":{const x=n.bufferSync(a),g=n.data.get(o.dataId).values[0];y=Xc(f,x,l,h,d,u,c,m,g,p);break}case"int32":{const x=n.bufferSync(a),g=n.data.get(o.dataId).values[0];y=Xc(f,x,l,h,d,u,c,m,g,p);break}case"string":{const x=n.bufferSync(a),g=il(n.data.get(o.dataId).values[0]);y=Xc(f,x,l,h,d,u,c,m,g,p);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(l,y.dtype,y.values)}const dpe={kernelName:x4,backendName:"cpu",kernelFunc:upe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:a,axis:o}=s,l=Et(o,r.shape)[0],c=kk(r,a,l),u=new Array(r.shape.length).fill(0),d=r.shape.slice();return c.map(m=>{const h=[...d];h[l]=m;const p=Yc({inputs:{x:r},backend:n,attrs:{begin:u,size:h}});return u[l]+=m,p})}const hpe={kernelName:py,backendName:"cpu",kernelFunc:mpe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe={kernelName:U2,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Ze(n,"square");const r=s.data.get(n.dataId).values,a=new Float32Array(r.length);for(let l=0;l<r.length;++l){const c=r[l];a[l]=c*c}return{dataId:s.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fpe=Ht(Ip,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),gpe={kernelName:Ip,backendName:"cpu",kernelFunc:fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:d,newAxisMask:m,shrinkAxisMask:h}=s;Ze(r,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:y,sliceDim0:x,isSimpleSlice:g,begin:b,end:w,strides:v}=ak(r.shape,a,o,l,c,u,d,m,h);let E;if(y)E=rn({inputs:{x:r},backend:n,attrs:{shape:f}});else if(x||g){R(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=nk(b,w,v),C=Yc({inputs:{x:r},backend:n,attrs:{begin:b,size:k}});E=rn({inputs:{x:C},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(C)}else{const k=n.bufferSync(r),C=SL(p,k,v,b);E=n.makeTensorInfo(f,C.dtype,C.values)}return E}const ype={kernelName:W2,backendName:"cpu",kernelFunc:xpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bpe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:a,leftPad:o,rightPad:l,padWidth:c,preserveShortSequences:u}=s,{data:d,dataSplits:m}=e,h=n.data.get(d.dataId).values,p=n.data.get(m.dataId).values,[f,y]=CL(h,p,r,a,o,l,c,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(m.shape,"int32",y)]}const wpe={kernelName:y4,backendName:"cpu",kernelFunc:bpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vpe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:a,delimiter:o}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const l=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values[0],[u,d,m]=IL(l,c,r),h=d.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",d),n.makeTensorInfo([2],"int32",new Int32Array(m))]}const Epe={kernelName:b4,backendName:"cpu",kernelFunc:vpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Npe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(a.dataId).values,l=$L(o,r);return n.makeTensorInfo(a.shape,"int32",l)}const kpe={kernelName:w4,backendName:"cpu",kernelFunc:Npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Spe=Ht(kp,t=>Math.tan(t)),Cpe={kernelName:kp,backendName:"cpu",kernelFunc:Spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe=Ht(Sp,t=>Math.tanh(t)),$pe={kernelName:Sp,backendName:"cpu",kernelFunc:Ipe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tpe(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:a}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=zc(a,r,s.shape),m=!1,h=n.bufferSync(r),p=n.bufferSync(a),f=n.bufferSync(s),y=Xc(h,p,s.shape,d,c,l,o,u,f,m);return n.makeTensorInfo(s.shape,y.dtype,y.values)}const Ape={kernelName:d4,backendName:"cpu",kernelFunc:Tpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:a}=s;Ze(r,"tile");const o=AL(n.bufferSync(r),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const _pe={kernelName:Cp,backendName:"cpu",kernelFunc:Rpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:a,sorted:o}=s;Ze(r,"topk");const l=n.data.get(r.dataId).values,[c,u]=_L(l,r.shape,r.dtype,a,o);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const Ppe={kernelName:j2,backendName:"cpu",kernelFunc:Dpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fpe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:a}=e,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=n,[d,m,h,p]=r.shape,[f,y]=u??[m,h],x=[d,f,y,p],g=nt(r.shape),b=g[0],w=g[1],v=g[2],E=nt(x),k=E[0],C=E[1],I=E[2],A=bs(r.dtype,ue(x));A.fill(c);const $=s.data.get(r.dataId).values,T=s.data.get(a.dataId).values;for(let O=0;O<d;++O){const M=a.shape[0]===1?T:T.subarray(O*8,O*8+8);for(let B=0;B<f;++B)for(let L=0;L<y;++L)for(let Y=0;Y<p;++Y){let D;const _=M[6]*L+M[7]*B+1;if(_===0)continue;const P=(M[0]*L+M[1]*B+M[2])/_,z=(M[3]*L+M[4]*B+M[5])/_,q=ZL(P,h,l),K=ZL(z,m,l);switch(o){case"nearest":D=Upe($,m,h,b,w,v,O,K,q,Y,c);break;case"bilinear":D=Vpe($,m,h,b,w,v,O,K,q,Y,c);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ae=O*k+B*C+L*I+Y;A[ae]=D}return s.makeTensorInfo(x,r.dtype,A)}return{dataId:s.write(A,x,r.dtype),shape:r.shape,dtype:r.dtype}}const Mpe={kernelName:G2,backendName:"cpu",kernelFunc:Fpe};function ZL(t,e,n){switch(n){case"reflect":return Ope(t,e);case"wrap":return Lpe(t,e);case"nearest":return Bpe(t,e);case"constant":default:return zpe(t)}}function Ope(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return bc(0,n,e-1)}function Lpe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return bc(0,n,e-1)}function zpe(t,e){return t}function Bpe(t,e){return bc(0,t,e-1)}function df(t,e,n,s,r,a,o,l,c,u,d){const m=o*s+l*r+c*a+u;return 0<=l&&l<e&&0<=c&&c<n?t[m]:d}function Upe(t,e,n,s,r,a,o,l,c,u,d){const m=Math.round(l),h=Math.round(c);return df(t,e,n,s,r,a,o,m,h,u,d)}function Vpe(t,e,n,s,r,a,o,l,c,u,d){const m=Math.floor(l),h=Math.floor(c),p=m+1,f=h+1,y=(f-c)*df(t,e,n,s,r,a,o,m,h,u,d)+(c-h)*df(t,e,n,s,r,a,o,m,f,u,d),x=(f-c)*df(t,e,n,s,r,a,o,p,h,u,d)+(c-h)*df(t,e,n,s,r,a,o,p,f,u,d);return(p-l)*y+(l-m)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wpe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:a}=e;Ze(a,"unique");const o=s.data.get(a.dataId).values,{outputValues:l,outputShape:c,indices:u}=DL(o,r,a.shape,a.dtype);return[s.makeTensorInfo(c,a.dtype,l),s.makeTensorInfo([u.length],"int32",u)]}const jpe={kernelName:H2,backendName:"cpu",kernelFunc:Wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gpe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const o=r.shape.length,l=r.shape[a],c=new Array(o-1);let u=0;for(let p=0;p<o;p++)p!==a&&(c[u++]=r.shape[p]);const d=new Array(o).fill(0),m=r.shape.slice();m[a]=1;const h=new Array(l);for(let p=0;p<h.length;p++){d[a]=p;const f=Yc({inputs:{x:r},backend:n,attrs:{begin:d,size:m}});h[p]=rn({inputs:{x:f},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(f)}return h}const Hpe={kernelName:gy,backendName:"cpu",kernelFunc:Gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qpe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:a}=e,{numSegments:o}=s;Ze(r,"unsortedSegmentSum");const l=r.shape.length,c=a.shape.length,u=[],d=[],m=l-c;let h=a;for(let f=0;f<m;++f){const y=wb({inputs:{input:h},backend:n,attrs:{dim:f+1}});h=y,d.push(y)}for(let f=0;f<o;++f){const y=al(f,"int32"),x=n.makeTensorInfo([],"int32",y),g=jO({inputs:{a:x,b:h},backend:n}),b=Nl({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),w=xb({inputs:{a:b,b:r},backend:n}),v=uf({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});u.push(v),d.push(x),d.push(g),d.push(b),d.push(w),d.push(v)}const p=KL({inputs:u,backend:n,attrs:{axis:0}});return d.forEach(f=>n.disposeIntermediateTensorInfo(f)),p}const Kpe={kernelName:xy,backendName:"cpu",kernelFunc:qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xpe=[Gce,Sle,qce,Xce,Rle,Zce,Qce,tue,sue,aue,iue,cue,due,pue,gue,bue,vue,Nue,Sue,Wce,Iue,Tue,Rue,Dle,Due,Tle,Fle,Fue,Cle,Mue,Lue,zue,Uue,Wue,Gue,que,Xue,Zue,Que,tde,sde,ade,ide,cde,ude,mde,pde,gde,xde,yde,bde,vde,kde,Mce,Cde,Mle,Pde,Ole,Fde,zle,Ude,Vde,jde,Ule,Wle,Hde,Kde,Yde,Jde,Gle,qle,Ile,eme,Oue,nme,rme,ome,Oce,Xle,Zle,lme,Qle,ume,hme,fme,yme,wme,Eme,Nme,tce,Sme,Ime,Tme,Rme,Dme,Fme,Ome,sce,zme,Vme,Gme,ace,ice,Kme,Zme,ehe,cce,nhe,rhe,ahe,XL,che,zce,mce,dhe,hhe,fhe,xhe,$le,wS,bhe,Bce,Uce,Vce,vhe,Nhe,She,Ihe,The,Ahe,_he,wce,Phe,zhe,Uhe,Ghe,Ece,qhe,Xhe,Zhe,Nce,Wme,Qhe,tpe,spe,ape,ipe,cpe,dpe,hpe,Cce,ppe,$ce,Ace,gpe,ype,wpe,Epe,kpe,Pce,Ede,Cpe,$pe,Ape,_pe,Ppe,Mpe,uce,jpe,Hpe,Kpe,she];for(const t of Xpe)S4(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zc={},Eb={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Ype(t,e){Zc[t]=e}function Ha(t,e){if(!(t in Zc)||e!=null){const s=Jpe(t,e);if(s!==null)Zc[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Zc[t];return n==null||n.isContextLost()?(delete Zc[t],Ha(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Zc[t])}function Zpe(t){if(!ie().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Jpe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Zpe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Zc[t]},!1),ie().getBool("SOFTWARE_WEBGL_ENABLED")&&(Eb.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Eb)||n.getContext("experimental-webgl",Eb):n.getContext("webgl2",Eb)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mf;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(mf||(mf={}));var Mr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Mr||(Mr={}));var us;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(us||(us={}));function hf(t,e){return[e,t]}function Qpe(t,e){return t*e}function Nb(t){const e=ue(t),n=Math.ceil(e/4);return ZE(n)}function Ud(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function efe(t,e){const[n,s]=Ud(t,e);return n*s*4}function NS(t,e){const n=t;let s,r,a,o,l,c,u,d,m,h;return ie().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,a=n.RGBA16F,o=n.RGBA32F,l=n.RED,u=4,d=1,m=n.HALF_FLOAT,h=n.FLOAT,c=n.RGBA8):(s=t.RGBA,r=t.RGBA,a=t.RGBA,o=n.RGBA,l=t.RGBA,u=4,d=4,m=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,c=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:l,downloadTextureFormat:c,downloadUnpackNumChannels:u,defaultNumChannels:d,textureTypeHalfFloat:m,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(t,e){const n=e();return ie().getBool("DEBUG")&&tfe(t),n}function tfe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+afe(t,e))}const nfe=596e-10,sfe=65504;function rfe(t){return!!(ie().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||nfe<Math.abs(t)&&Math.abs(t)<sfe)}function afe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function kb(t,e){return wi(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function ofe(t,e){const n=wi(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ve(t,()=>t.shaderSource(n,e)),Ve(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function ife(t,e){const n=wi(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ve(t,()=>t.shaderSource(n,e)),Ve(t,()=>t.compileShader(n)),ie().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw JL(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const lfe=/ERROR: [0-9]+:([0-9]+):/g;function JL(t,e){const n=lfe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),a=r.length.toString().length+2,o=r.map((m,h)=>hd((h+1).toString(),a)+m);let l=0;for(let m=0;m<o.length;m++)l=Math.max(o[m].length,l);const c=o.slice(0,s-1),u=o.slice(s-1,s),d=o.slice(s);console.log(c.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${hd(u[0],l)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join(`
`))}function cfe(t){return wi(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function ufe(t,e){if(Ve(t,()=>t.linkProgram(e)),!ie().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function kS(t,e){if(Ve(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function dfe(t,e){const n=wi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ve(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ve(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function mfe(t,e){const n=wi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ve(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ve(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function hfe(t){return wi(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function pfe(t,e){const n=ie().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function ffe(t){return wi(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function QL(t,e,n,s,r,a,o){const l=t.getAttribLocation(e,n);return l===-1?!1:(Ve(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),Ve(t,()=>t.vertexAttribPointer(l,r,t.FLOAT,!1,a,o)),Ve(t,()=>t.enableVertexAttribArray(l)),!0)}function gfe(t,e,n){vfe(t,n),Ve(t,()=>t.activeTexture(t.TEXTURE0+n)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function xfe(t,e,n){return wi(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function yfe(t,e,n){return t.getUniformLocation(e,n)}function bfe(t,e,n,s){Ve(t,()=>gfe(t,e,s)),Ve(t,()=>t.uniform1i(n,s))}function SS(t,e,n){Ve(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ve(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function e5(t,e){Ve(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ve(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Sb(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+wfe(t,e))}function wfe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function wi(t,e,n){const s=Ve(t,()=>e());if(s==null)throw new Error(n);return s}function vfe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Vd(t,e=2){return ue(t.slice(0,t.length-e))}function Wd(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Cb(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Vd(t),...Wd(t)]),e}function Efe(t,e=!1){let n=ie().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ie().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ie().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((l,c)=>c>=t.length-2?XE(t[c]):t[c]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=sl(t).newShape);let r=ue(t),a=null;t.length<=1&&r<=n?a=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?a=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?a=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?a=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?a=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(a=[t[0],t[1]*t[2]*t[3]]);const o=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||o)if(e){const l=Vd(t);let c=2,u=2;t.length&&([c,u]=Wd(t)),r=l*(c/2)*(u/2),a=ZE(r).map(d=>d*2)}else a=ZE(r);return a}function Ib(t){return t%2===0}function $b(t,e){if(t=t.slice(-2),e=e.slice(-2),zt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||Ib(n)&&Ib(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Ib(t[0])&&Ib(e[0])}let CS,IS;function Nfe(t){if(CS==null){const e=Ha(t);CS=e.getParameter(e.MAX_TEXTURE_SIZE)}return CS}function kfe(t){if(IS==null){const e=Ha(t);IS=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,IS)}function Sfe(t){if(t===0)return 0;let e;const n=Ha(t);return ma(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:ma(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function ma(t,e){return t.getExtension(e)!=null}function t5(t){try{if(Ha(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Cfe(t){if(t===0)return!1;const e=Ha(t);if(t===1){if(!ma(e,"OES_texture_float"))return!1}else if(!ma(e,"EXT_color_buffer_float"))return!1;return $S(e)}function Ife(t){if(t===0)return!1;const e=Ha(t);if(t===1){if(!ma(e,"OES_texture_float")||!ma(e,"WEBGL_color_buffer_float"))return!1}else{if(ma(e,"EXT_color_buffer_float"))return $S(e);const s="EXT_color_buffer_half_float";if(ma(e,s)){const r=e.getExtension(s);return $fe(e,r)}return!1}return $S(e)}function $S(t){const e=NS(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(a),o}function $fe(t,e){const n=NS(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const l=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(o),l}function Tfe(t){return t!==2?!1:Ha(t).fenceSync!=null}function pf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&R(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Je=ie();Je.registerFlag("HAS_WEBGL",()=>Je.getNumber("WEBGL_VERSION")>0),Je.registerFlag("WEBGL_VERSION",()=>t5(2)?2:t5(1)?1:0),Je.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Je.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Je.get("WEBGL_VERSION")===2),Je.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Je.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Je.registerFlag("WEBGL_PACK",()=>Je.getBool("HAS_WEBGL")),Je.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_CLIP",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_REDUCE",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_LAZILY_UNPACK",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_CONV_IM2COL",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Je.getBool("WEBGL_PACK")),Je.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Nfe(Je.getNumber("WEBGL_VERSION"))),Je.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>kfe(Je.getNumber("WEBGL_VERSION"))),Je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Je.getNumber("WEBGL_VERSION");return t===0?0:Sfe(t)}),Je.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Je.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Z4()),Je.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Cfe(Je.getNumber("WEBGL_VERSION"))),Je.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Je.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Je.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Je.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Ife(Je.getNumber("WEBGL_VERSION"))),Je.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Tfe(Je.getNumber("WEBGL_VERSION"))),Je.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Je.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Je.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)}),Je.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Z4()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)}),Je.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),Je.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),Je.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),Je.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),Je.registerFlag("WEBGL_EXP_CONV",()=>!1),Je.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Je.getBool("IS_TEST")),Je.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),Je.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),Je.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1),Je.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fs(){let t,e,n,s,r,a,o,l,c,u;return ie().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",a="outputColor",o="out vec4 outputColor;",l=ie().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",c="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",a="gl_FragColor",o="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:a,defineOutput:o,defineSpecialNaN:l,defineSpecialInf:c,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jc(t,e,n="index"){const s=nt(e);return s.map((r,a)=>{const o=`int ${t[a]} = ${n} / ${r}`,l=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${r}`:`index -= ${t[a]} * ${r}`;return`${o}; ${l};`}).join("")}function Tb(t,e,n="index"){const s=nt(e);return s.map((r,a)=>{const o=`int ${t[a]} = ${n} / outShapeStrides[${a}]`,l=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * outShapeStrides[${a}]`:`index -= ${t[a]} * outShapeStrides[${a}]`;return`${o}; ${l};`}).join("")}function Afe(t,e){const n=t.length,s=t.map(a=>`${e}[${a}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let a=n-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function Rfe(t,e,n="index"){const s=t.map((a,o)=>o),r=Afe(s,e);return r.map((a,o)=>{const l=`int ${t[o]} = ${n} / ${r[o]}`,c=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r[o]}`:`index -= ${t[o]} * ${r[o]}`;return`${l}; ${c};`}).join("")}function TS(t){const e=nt(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function AS(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const n5=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:s5}=Ere;function _fe(t,e,n){const s=[];if(t.forEach(p=>{const f=ue(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?s.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(s.push(`uniform sampler2D ${p.name};`),s.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:y}=RS(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(y.length){case 1:s.push(`uniform int ${p.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${p.name}Shape;`);break}s.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{s.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const r=s.join(`
`),a=t.map(p=>Dfe(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,l=Fs(),c=Mfe(l);let u,d,m=zfe(l);return e.isPacked?(u=Pfe(e.logicalShape,o,n.enableShapeUniforms),d=Lfe(l)):(u=Ffe(e.logicalShape,o,n.enableShapeUniforms),d=Ofe(l)),n.packedInputs&&(m+=Wfe),[m,c,d,r,u,a,n.userCode].join(`
`)}function jd(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return tge(t,e);case 1:return sge(t,e);case 2:return age(t,e);case 3:return ige(t,e);case 4:return cge(t,e);case 5:return uge(t);case 6:return dge(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function r5(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return ege(t);case 1:return nge(t,e);case 2:return rge(t,e);case 3:return oge(t,e);default:return lge(t,e)}}function Dfe(t,e,n=!1,s){let r="";n?r+=r5(t,s):r+=jd(t,s);const a=t.shapeInfo.logicalShape,o=e.logicalShape;return a.length<=o.length&&(n?r+=mge(t,e):r+=hge(t,e)),r}function Pfe(t,e,n){switch(t.length){case 0:return a5();case 1:return jfe(t,e,n);case 2:return Jfe(t,e,n);case 3:return Hfe(t,e,n);default:return Kfe(t,e,n)}}function Ffe(t,e,n){switch(t.length){case 0:return a5();case 1:return Gfe(t,e,n);case 2:return Qfe(t,e,n);case 3:return qfe(t,e,n);case 4:return Xfe(t,e,n);case 5:return Yfe(t,e);case 6:return Zfe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Mfe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Ofe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Lfe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function zfe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Bfe}
    ${Ufe}
    ${Vfe}
  `}const Bfe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Ufe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Vfe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Wfe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function a5(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function jfe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Gfe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Hfe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),a=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function qfe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Tb(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Jc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Kfe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),a=r*Math.ceil(t[t.length-2]/2);let o=a,l="",c="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],l=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+l,c=`b${u}, `+c;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${l}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${c});
    }
  `}function Xfe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Tb(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Jc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Yfe(t,e){const n=Jc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Zfe(t,e){const n=Jc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Jfe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(zt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Qfe(t,e,n){return zt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Qc(t){return`offset${t}`}function ege(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Fs();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function tge(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,a]=t.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=Qc(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[l,c]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${l}, ${c}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function nge(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,a=Fs();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function sge(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${Gd(t)}
      }
    `;const r=t.shapeInfo.texShape,a=r[0],o=r[1];if(o===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const l=Qc(n);return o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${l});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${o}, index + ${l});
      return sampleTexture(${n}, uv);
    }
  `}function rge(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape,o=a[0],l=a[1],c=Fs();if(a!=null&&zt(n,a))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${c.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${o}.0);

        return ${c.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],d=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${d}, ${u[0]}, ${u[1]}, row, col);
      return ${c.texture2D}(${s}, uv);
    }
  `}function age(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape;if(a!=null&&zt(n,a)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=a[0],p=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${p}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:o,keptDims:l}=sl(n),c=o;if(c.length<n.length){const h=Hd(t,c),p=["row","col"];return`
      ${jd(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${qd(p,l)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Gd(t)}
      }
    `;const u=a[0],d=a[1],m=Qc(s);return d===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${m}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${m}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${m}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${m}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${m};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${m};
    vec2 uv = uvFromFlat(${u}, ${d}, index);
    return sampleTexture(${s}, uv);
  }
`}function oge(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){const h=n.slice(1),p=[1,2],f=Hd(t,h),y=["b","row","col"];return`
        ${r5(f,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${qd(y,p)});
        }
      `}const l=Fs();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=o[0],u=o[1],d=Math.ceil(n[2]/2),m=d*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${u}, ${m}, ${d}, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function ige(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[1]*n[2],o=n[2],{newShape:l,keptDims:c}=sl(n),u=l;if(u.length<n.length){const y=Hd(t,u),x=["row","col","depth"];return`
        ${jd(y,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${qd(x,c)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${o}, 1)));
        ${Gd(t)}
      }
    `;const d=t.shapeInfo.texShape,m=d[0],h=d[1],p=t.shapeInfo.flatOffset;if(h===a&&p==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${m}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===o&&p==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${m}.0);
      return sampleTexture(${s}, uv);
    }
  `;const f=Qc(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${f};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${o} + depth + ${f};
        vec2 uv = uvFromFlat(${m}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function lge(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=Fs();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const a=t.shapeInfo.logicalShape,o=a.length,l=t.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],u=c[0],d=c[1],m=Math.ceil(a[o-1]/2);let h=m*Math.ceil(a[o-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${m} + (col / 2)`;for(let y=2;y<o-1;y++)p=`int b${y}, `+p,h*=a[o-y-1],f=`b${y} * ${h} + `+f;return`
    vec4 ${s}(${p}) {
      int index = ${f};
      int texR = index / ${d};
      int texC = index - texR * ${d};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${u});
      return ${r.texture2D}(${n}, uv);
    }
  `}function cge(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[3],o=n[2]*a,l=n[1]*o,{newShape:c,keptDims:u}=sl(n);if(c.length<n.length){const b=Hd(t,c),w=["row","col","depth","depth2"];return`
      ${jd(b,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${qd(w,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${l}, ${o}, ${a}, 1)));
        ${Gd(t)}
      }
    `;const d=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,h=m[0],p=m[1],f=`int stride2 = ${s}Shape[3];`,y=`int stride1 = ${s}Shape[2] * stride2;`,x=`int stride0 = ${s}Shape[1] * stride1;`;if(p===l&&d==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${f}
        ${y}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(p===a&&d==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const g=Qc(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${f}
      ${y}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${g});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${o} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${h}, ${p}, index + ${g});
      return sampleTexture(${s}, uv);
    }
  `}function uge(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],a=e[3]*r,o=e[2]*a,l=e[1]*o,{newShape:c,keptDims:u}=sl(e);if(c.length<e.length){const y=Hd(t,c),x=["row","col","depth","depth2","depth3"];return`
      ${jd(y)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${qd(x,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${l}, ${o}, ${a}, ${r})) +
          depth3;
        ${Gd(t)}
      }
    `;const d=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,h=m[0],p=m[1];if(p===l&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===r&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const f=Qc(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${o} + depth * ${a} +
          depth2 * ${r} + depth3 + ${f};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function dge(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:a}=sl(e);if(r.length<e.length){const x=Hd(t,r),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${jd(x)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${qd(g,a)});
      }
    `}const o=e[5],l=e[4]*o,c=e[3]*l,u=e[2]*c,d=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${d}, ${u}, ${c}, ${l})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${Gd(t)}
      }
    `;const m=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1];if(f===d&&m==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${c}, ${l}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===o&&m==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=Qc(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${d} + col * ${u} + depth * ${c} +
          depth2 * ${l} + depth3 * ${o} + depth4 + ${y};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Gd(t){const e=t.name,n=ue(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function mge(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",a=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,l=s5(t.shapeInfo.logicalShape,e.logicalShape),c=Yt(o),u=o-a;let d;const m=["x","y","z","w","u","v"];a===0?d="":o<2&&l.length>=1?d="coords = 0;":d=l.map(b=>`coords.${m[b+u]} = 0;`).join(`
`);let h="";o<2&&a>0?h="coords":h=t.shapeInfo.logicalShape.map((b,w)=>`coords.${m[w+u]}`).join(", ");let p="return outputValue;";const y=ue(t.shapeInfo.logicalShape)===1,g=ue(e.logicalShape)===1;if(a===1&&!y&&!g)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(y&&!g)o===1?p=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:p=`
        return vec4(outputValue.x);
      `;else if(l.length){const b=a-2,w=a-1;l.indexOf(b)>-1&&l.indexOf(w)>-1?p="return vec4(outputValue.x);":l.indexOf(b)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(w)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${c} coords = getOutputCoords();
      ${d}
      vec4 outputValue = get${s}(${h});
      ${p}
    }
  `}function hge(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",a=e.texShape,o=t.shapeInfo.texShape,l=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&l===c&&t.shapeInfo.flatOffset==null&&zt(o,a))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=Yt(c),d=s5(t.shapeInfo.logicalShape,e.logicalShape),m=c-l;let h;const p=["x","y","z","w","u","v"];l===0?h="":c<2&&d.length>=1?h="coords = 0;":h=d.map(y=>`coords.${p[y+m]} = 0;`).join(`
`);let f="";return c<2&&l>0?f="coords":f=t.shapeInfo.logicalShape.map((y,x)=>`coords.${p[x+m]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${h}
      return get${s}(${f});
    }
  `}function Yt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function RS(t,e,n){const{newShape:s,keptDims:r}=sl(e),a=e.length,o=t&&a===3&&e[0]===1,l=o?e.slice(1):s,c=!t&&a>1&&!zt(e,n)&&s.length<a||o;return{useSqueezeShape:c,uniformShape:c?l:e,keptDims:r}}function Hd(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function qd(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pge(t,e,n,s){const r=n.map((d,m)=>{const h={logicalShape:d.shape,texShape:d.isUniform?null:d.texData.texShape,isUniform:d.isUniform,isPacked:d.isUniform?!1:d.texData.isPacked,flatOffset:null};return d.texData!=null&&d.texData.slice!=null&&d.texData.slice.flatOffset>0&&(h.flatOffset=d.texData.slice.flatOffset),{name:e.variableNames[m],shapeInfo:h}}),a=r.map(d=>d.shapeInfo),o={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},l=_fe(r,o,e),c=ife(t.gl,l),u=t.createProgram(c);return ie().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:a,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:a,outShapeInfo:o},o5(t,e,u)))}function o5(t,e,n){const s=[],r=[];let a,o,l,c=null,u=null;u=t.getUniformLocation(n,"NAN",!1),ie().getNumber("WEBGL_VERSION")===1&&(c=t.getUniformLocation(n,"INFINITY",!1));const d=!1;for(const m of e.variableNames){const h={name:m,uniform:t.getUniformLocation(n,m,d),offset:t.getUniformLocation(n,`offset${m}`,d)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${m}Shape`,d),h.texShape=t.getUniformLocation(n,`${m}TexShape`,d)),s.push(h)}if(e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",d),l=t.getUniformLocation(n,"outShapeStrides",d),o=t.getUniformLocation(n,"outTexShape",d)),e.customUniforms)for(const m of e.customUniforms)r.push(t.getUniformLocation(n,m.name,d));return{variablesLocations:s,customUniformLocations:r,infLoc:c,nanLoc:u,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:o}}function i5(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,a=e[s],o=a.shape;if(!zt(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(n.isUniform&&a.isUniform)return;const l=n.texShape,c=a.isUniform?null:a.texData.texShape;if(!zt(l,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${l} and ${c} must match`)})}function fge(t,e,n,s,r){e.program.enableShapeUniforms||(i5(e.inShapeInfos,n),i5([e.outShapeInfo],[s]));const a=s.texData.texture,o=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(a.texture,o[0],o[1]):t.setOutputMatrixTexture(a.texture,o[0],o[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),ie().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<n.length;++c){const u=n[c],{uniform:d,offset:m,shape:h,texShape:p}=e.variablesLocations[c];if(h){const{uniformShape:f}=RS(e.program.packedInputs,u.shape,u.texData.texShape);switch(f.length){case 1:t.gl.uniform1iv(h,new Int32Array(f));break;case 2:t.gl.uniform2iv(h,new Int32Array(f));break;case 3:t.gl.uniform3iv(h,new Int32Array(f));break;case 4:t.gl.uniform4iv(h,new Int32Array(f));break}}if(p&&t.gl.uniform2i(p,u.texData.texShape[0],u.texData.texShape[1]),d!=null){if(u.isUniform){if(ue(u.shape)<2)t.gl.uniform1f(d,u.uniformValues[0]);else{let f=u.uniformValues;f instanceof Float32Array||(f=new Float32Array(f)),t.gl.uniform1fv(d,f)}continue}u.texData.slice!=null&&m!=null&&t.gl.uniform1i(m,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,d,c)}}const l=e.outShapeLocation;if(l)switch(s.shape.length){case 1:t.gl.uniform1iv(l,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(l,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(l,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(l,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const c=nt(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(c));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(c));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(c));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let c=0;c<e.program.customUniforms.length;++c){const u=e.program.customUniforms[c],d=e.customUniformLocations[c],m=r[c];if(u.type==="float")t.gl.uniform1fv(d,m);else if(u.type==="vec2")t.gl.uniform2fv(d,m);else if(u.type==="vec3")t.gl.uniform3fv(d,m);else if(u.type==="vec4")t.gl.uniform4fv(d,m);else if(u.type==="int")t.gl.uniform1iv(d,m);else if(u.type==="ivec2")t.gl.uniform2iv(d,m);else if(u.type==="ivec3")t.gl.uniform3iv(d,m);else if(u.type==="ivec4")t.gl.uniform4iv(d,m);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function gge(t,e,n){let s="";e.concat(n).forEach(o=>{const l=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const c=o.texData.texShape,{useSqueezeShape:u,uniformShape:d,keptDims:m}=RS(t.packedInputs,o.shape,c);let h="",p="",f="";if(d.length===1&&t.packedInputs){const E=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];h=`${E[0]>1}_${E[1]>1}`}else if(d.length===2&&!t.packedInputs)p=`${d[0]>1}_${d[1]>1}`;else if(d.length>2&&!t.packedInputs){const E=nt(d);f=`${E[0]===c[1]}_${E[E.length-1]===c[1]}`}const y=o.shape.length,x=d.length===2&&zt(o.shape,c),g=ue(o.shape)===1,b=Cd(o.shape,n.shape),w=!t.packedInputs&&y===n.shape.length&&zt(c,n.texData.texShape),v=t.packedInputs||d.length>2?"":`${c[0]>1}_${c[1]>1}`;s+=`${y}_${w}_${u?m:""}_${d.length}_${g}_${b}_${x}_${h}_${p}_${f}_${v}_${l}`}else{const c=o.isUniform?"uniform":o.texData.texShape;s+=`${o.shape}_${c}_${l}`}});const r=t.userCode;let a=t.constructor.name;return a+="_"+s+"_"+r+`${ie().getNumber("WEBGL_VERSION")}`,a}function ks(t){return ie().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xge{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=mf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Fs();this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Tb(["r","c","d"],e):Jc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yge{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=mf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Fs();this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Tb(["r","c","d"],e):Jc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bge{constructor(e){this.variableNames=["A"],this.outTexUsage=Mr.DOWNLOAD;const n=Fs();this.outputShape=e,this.userCode=`
      ${n5}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wge{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Mr.DOWNLOAD;const n=Fs();this.outputShape=e,this.userCode=`
      ${n5}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vge={R:0,G:1,B:2,A:3};class l5{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Fs();this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)");let o="";for(let l=0;l<s.length;l++){const c=s[l];o+=`
          if(offset == ${l}) {
            result = values[${vge[c]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?AS():TS(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${o}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ege{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Fs();this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length);let r="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let l=0;l<=1;l++){const c=o*2+l;r+=`
          localCoords = coords;
          if(localCoords[2] + ${l} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${l};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${c}] = values[0];
            } else if (offset == 1) {
              result[${c}] = values[1];
            } else if (offset == 2) {
              result[${c}] = values[2];
            } else {
              result[${c}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?AS():TS(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(t){const e=Fs(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return ofe(t,n)}function kge(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return dfe(t,e)}function Sge(t){const e=new Uint16Array([0,1,2,2,1,3]);return mfe(t,e)}function ff(t,e,n,s,r,a){pfe(e,n);const o=hfe(t),l=t.TEXTURE_2D;return Ve(t,()=>t.bindTexture(l,o)),Ve(t,()=>t.texParameteri(l,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ve(t,()=>t.texParameteri(l,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ve(t,()=>t.texParameteri(l,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ve(t,()=>t.texParameteri(l,t.TEXTURE_MAG_FILTER,t.NEAREST)),ie().getNumber("WEBGL_VERSION")===1?Ve(t,()=>t.texImage2D(l,0,s,e,n,0,r,a,null)):Ve(t,()=>t.texStorage2D(l,1,s,e,n)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function c5(t){return t.internalFormatFloat}function Cge(t,e,n,s){const[r,a]=hf(e,n);return ff(t,r,a,c5(s),s.textureFormatFloat,t.FLOAT)}function u5(t){return t.internalFormatHalfFloat}function Ige(t,e,n,s){const[r,a]=hf(e,n);return ff(t,r,a,u5(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function d5(t){return t.downloadTextureFormat}function $ge(t,e,n,s){const[r,a]=hf(e,n);return ff(t,r,a,d5(s),t.RGBA,t.UNSIGNED_BYTE)}function m5(t){return t.internalFormatPackedFloat}function Tge(t,e,n,s){const[r,a]=Ud(e,n);return ff(t,r,a,m5(s),t.RGBA,t.FLOAT)}function h5(t){return t.internalFormatPackedHalfFloat}function Age(t,e,n,s){const[r,a]=Ud(e,n);return ff(t,r,a,h5(s),t.RGBA,s.textureTypeHalfFloat)}function Rge(t,e,n){return Ve(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),QL(t,e,"clipSpacePos",n,3,20,0)&&QL(t,e,"uv",n,2,20,12)}function _ge(t,e,n,s,r,a){Ve(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,l,c;r instanceof Uint8Array?(o=new Uint8Array(n*s*4),l=t.UNSIGNED_BYTE,c=t.RGBA):(o=new Float32Array(n*s*4),l=t.FLOAT,c=a.internalFormatPackedFloat),o.set(r),ie().getNumber("WEBGL_VERSION")===2?Ve(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,l,o)):Ve(t,()=>t.texImage2D(t.TEXTURE_2D,0,c,n,s,0,t.RGBA,l,o)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Dge(t,e,n){Ve(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ie().getNumber("WEBGL_VERSION")===2?Ve(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ve(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ie().getNumber("WEBGL_VERSION")===2?Ve(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ve(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Pge(t,e,n,s){const r=t.createBuffer();Ve(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const l=4*4*e*n;return Ve(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,l,t.STREAM_READ)),Ve(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ve(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Fge(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Mge(t,e,n,s){const[r,a]=hf(e,n),o=4,l=new Uint8Array(Qpe(e*n,o));return Ve(t,()=>t.readPixels(0,0,r,a,s.downloadTextureFormat,t.UNSIGNED_BYTE,l)),new Float32Array(l.buffer)}function Oge(t,e,n,s,r,a,o,l){const c=t,u=new Float32Array(efe(a,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}function Lge(t,e,n){const s=new Float32Array(e*n*4);return Ve(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _S{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=ie().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Ype(n,e)):this.gl=Ha(n),e=this.gl,ie().getNumber("WEBGL_VERSION")===2){const a=e;this.createVertexArray=()=>Ve(a,()=>a.createVertexArray()),this.bindVertexArray=o=>Ve(a,()=>a.bindVertexArray(o)),this.deleteVertexArray=o=>Ve(a,()=>a.deleteVertexArray(o)),this.getVertexArray=()=>Ve(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){const a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>Ve(e,()=>a.createVertexArrayOES()),this.bindVertexArray=o=>Ve(e,()=>a.bindVertexArrayOES(o)),this.deleteVertexArray=o=>Ve(e,()=>a.deleteVertexArrayOES(o)),this.getVertexArray=()=>Ve(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ie().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=kb(this.gl,a),ma(this.gl,o))this.textureHalfFloatExtension=kb(this.gl,o);else if(ie().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),ma(this.gl,r))this.colorBufferHalfFloatExtension=kb(this.gl,r);else if(ie().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",ma(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(ma(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=kge(this.gl),this.indexBuffer=Sge(this.gl),this.framebuffer=ffe(this.gl),this.textureConfig=NS(this.gl,this.textureHalfFloatExtension)}get debug(){return ie().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ve(e,()=>e.finish()),Ve(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ve(e,()=>e.deleteFramebuffer(this.framebuffer)),Ve(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ve(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ve(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Cge(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Ige(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),$ge(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Dge(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),_ge(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Age(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Tge(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(e5(this.gl,this.framebuffer),this.outputTexture=null),Ve(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Mge(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,a,o){return Oge(this.gl,e,n,s,r,a,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Fge(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=Pge(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(ie().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const o=r.clientWaitSync(a,0,0);return o===r.ALREADY_SIGNALED||o===r.CONDITION_SATISFIED},n=a}else ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Lge(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Nge(n));const s=cfe(n);Ve(n,()=>n.attachShader(s,this.vertexShader)),Ve(n,()=>n.attachShader(s,e)),ufe(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&kS(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;Ve(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Rge(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Ve(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&kS(this.gl,this.program),Ve(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?xfe(this.gl,e,n):yfe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ve(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),bfe(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,a]=Ud(n,s);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&kS(this.gl,this.program),Sb(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Ve(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ve(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=kb(this.gl,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await qD(()=>this.disposed||this.isQueryAvailable(e,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=zge(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ie().platform&&(s=ie().platform.setTimeoutCustom.bind(ie().platform)),qD(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),SS(this.gl,e,this.framebuffer),this.debug&&Sb(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(SS(this.gl,this.outputTexture,this.framebuffer),this.debug&&Sb(this.gl)):e5(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;SS(r,e,this.framebuffer),this.debug&&Sb(r),this.outputTexture=e,Ve(r,()=>r.viewport(0,0,n,s)),Ve(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),Ve(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function zge(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Bge,bincountImpl:p5,bincountReduceImpl:Uge,bitwiseAndImpl:Vge,castImpl:Wge,ceilImpl:jge,concatImpl:Gge,equalImpl:Hge,expImpl:qge,expm1Impl:Kge,floorImpl:Xge,gatherNdImpl:Yge,gatherV2Impl:Zge,greaterImpl:Jge,greaterEqualImpl:Qge,lessImpl:e0e,lessEqualImpl:t0e,linSpaceImpl:n0e,logImpl:s0e,maxImpl:r0e,maximumImpl:a0e,minimumImpl:o0e,multiplyImpl:i0e,negImpl:l0e,notEqualImpl:c0e,prodImpl:u0e,raggedGatherImpl:d0e,raggedRangeImpl:m0e,raggedTensorToTensorImpl:h0e,rangeImpl:p0e,rsqrtImpl:f0e,scatterImpl:g0e,sigmoidImpl:x0e,simpleAbsImpl:f5,sliceImpl:y0e,sparseFillEmptyRowsImpl:b0e,sparseReshapeImpl:w0e,sparseSegmentReductionImpl:g5,sqrtImpl:v0e,staticRegexReplaceImpl:E0e,stridedSliceImpl:N0e,stringNGramsImpl:k0e,stringSplitImpl:S0e,stringToHashBucketFastImpl:C0e,subImpl:I0e,tileImpl:$0e,topKImpl:T0e,transposeImpl:DS,uniqueImpl:A0e}=Fce;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Ms(t,e){return e===1?[t]:x5(t,e)}function R0e(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _0e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ks(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Ms("rc",this.rank),s=Yt(this.rank),r=this.getOutOfBoundsCondition(n),a=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)a=`${e[e.length-1-o]},`+a;n.push(a)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y5{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${D0e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?AS():TS(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function D0e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Rfe(["r","c","d"],"inputShape"):Jc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P0e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=w5(n,s),a=v5(e,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const o=b5(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const c=this.freeTextures[a].pop();return this.usedTextures[a].push(c),c}let l;return r===us.PACKED_2X2_FLOAT32?l=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===us.PACKED_2X2_FLOAT16?l=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===us.UNPACKED_FLOAT32?l=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===us.UNPACKED_FLOAT16?l=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===us.PACKED_4X1_UNSIGNED_BYTE&&(l=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(l),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),l}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const a=w5(s,r),o=v5(n,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);const l=b5(n,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=ie().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=l):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=l),this.numUsedTextures--;const u=this.usedTextures[o],d=u&&u.indexOf(e);if(d==null||d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[d]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function F0e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function b5(t,e,n,s,r){const a=M0e(e,s);let o;if(r){const[c,u]=Ud(t[0],t[1]);o=c*u}else{const[c,u]=hf(t[0],t[1]);o=c*u}const l=F0e(n,a);return o*l}function M0e(t,e){switch(t){case us.PACKED_2X2_FLOAT32:return m5(e);case us.PACKED_2X2_FLOAT16:return h5(e);case us.UNPACKED_FLOAT32:return c5(e);case us.UNPACKED_FLOAT16:return u5(e);case us.PACKED_4X1_UNSIGNED_BYTE:return d5(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function O0e(t){return ie().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?us.PACKED_2X2_FLOAT32:us.UNPACKED_FLOAT32:t?us.PACKED_2X2_FLOAT16:us.UNPACKED_FLOAT16}function w5(t,e){if(t===Mr.UPLOAD)return us.PACKED_2X2_FLOAT32;if(t===Mr.RENDER||t==null)return O0e(e);if(t===Mr.DOWNLOAD||t===Mr.PIXELS)return us.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function v5(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $o{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const ha="if (isnan(x)) return x;",L0e="return x;",E5="return abs(x);",z0e="return (x >= 0.0) ? x : (exp(x) - 1.0);",B0e=ha+`
  return (x < 0.0) ? 0.0 : x;
`,U0e=ha+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Sl="return x;",V0e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W0e="return x;",j0e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,G0e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,H0e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,q0e="return 1.0 / (1.0 + exp(-1.0 * x));";class Cl{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K0e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length);const n=e.length,s=Ms("rc",n),r=Yt(n),a=R0e(n,s),o=s.slice(-2),l=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${l}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X0e=G3,Y0e=1e-7,Z0e=1e-4,Ab={};function J0e(t){return t in Ab||(Ab[t]={}),Ab[t]}const Q0e=ie().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),exe=600;function txe(){return ie().global.screen==null?1024:ie().global.screen.height*ie().global.screen.width*window.devicePixelRatio*exe/1024/1024}class Rb extends KE{nextDataId(){return Rb.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ie().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof _S)n=e;else{const s=Ha(ie().getNumber("WEBGL_VERSION"),e);n=new _S(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Ha(ie().getNumber("WEBGL_VERSION"));n=new _S(s),this.binaryCache=J0e(ie().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new P0e(this.gpgpu),this.numMBBeforeWarning=txe(),this.texData=new GD(this,mo())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,a,o){const l=this.makeTensorInfo(n,s),c=this.texData.get(l.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[r,a]},c.texShape=[r,a];const u=Cb(n),d=new l5(u,!1,o),m=this.runWebGLProgram(d,[l],s,[[r,a]]);return m.shape=n,c.texture=null,this.disposeIntermediateTensorInfo(l),m.dataId}write(e,n,s){if((ie().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ie().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Mr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,a){if(ie().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Mr.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:a,slice:o,shape:l,isPacked:c}=n;if(o!=null){let h;c?h=new Cl(l,Sl):h=new $o(l,Sl);const p=this.runWebGLProgram(h,[{dataId:e,shape:l,dtype:r}],r),f=this.readSync(p.dataId);return this.disposeIntermediateTensorInfo(p),f}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let d;u&&(d=Ks());let m;if(r==="complex64"){const h=this.readSync(a.real.dataId),p=this.readSync(a.imag.dataId);m=xi(h,p)}else m=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Ks()-d),this.convertAndCacheOnCPU(e,m)}async read(e){if(this.pendingRead.has(e)){const f=this.pendingRead.get(e);return new Promise(y=>f.push(y))}const n=this.texData.get(e),{values:s,shape:r,slice:a,dtype:o,complexTensorInfos:l,isPacked:c}=n;if(a!=null){let f;c?f=new Cl(r,Sl):f=new $o(r,Sl);const y=this.runWebGLProgram(f,[{dataId:e,shape:r,dtype:o}],o),x=this.read(y.dataId);return this.disposeIntermediateTensorInfo(y),x}if(s!=null)return this.convertAndCacheOnCPU(e);if(ie().getBool("DEBUG")&&!ie().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ie().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,d;if(o!=="complex64"&&ie().get("WEBGL_BUFFER_SUPPORTED")){d=this.decode(e);const f=this.texData.get(d.dataId);u=this.gpgpu.createBufferFromTexture(f.texture.texture,...Nb(r))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let m;if(o==="complex64"){const f=await Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),y=f[0],x=f[1];m=xi(y,x)}else if(u==null)m=this.getValuesFromTexture(e);else{const f=ue(r);m=this.gpgpu.downloadFloat32MatrixFromBuffer(u,f)}if(d!=null&&this.disposeIntermediateTensorInfo(d),u!=null){const f=this.gpgpu.gl;Ve(f,()=>f.deleteBuffer(u))}const h=this.convertAndCacheOnCPU(e,m),p=this.pendingRead.get(e);return this.pendingRead.delete(e),p.forEach(f=>f(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&mo().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:a,slice:o,dtype:l,isPacked:c,texture:u}=s;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let p;c?p=new Cl(a,Sl):p=new $o(a,Sl);const f=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:l}],l),y=this.readToGPU(f,n);return this.disposeIntermediateTensorInfo(f),y}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const d=this.decode(e,n.customTexShape),m=mo().makeTensorFromTensorInfo(d),h=this.texData.get(d.dataId);return Object.assign({tensorRef:m},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>il(r));return Nt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Nt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!rfe(s))throw ie().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),a=ue(n);if(ie().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),p=this.texData.get(h.dataId),f=this.gpgpu.downloadMatrixFromPackedTexture(p.texture.texture,...Nb(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(h),f}const o=ie().getBool("WEBGL_PACK")&&r===!0,l=o?Cb(n):n,c=o?new wge(l):new bge(l),u=this.runWebGLProgram(c,[{shape:l,dtype:s,dataId:e}],"float32"),d=this.texData.get(u.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(u),m}timerAvailable(){return ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const a=Sc(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),o=Sc(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const c=await Promise.all(a);l.kernelMs=TZ(c),l.getExtraProfileInfo=()=>c.map((u,d)=>({name:o[d],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ks(),endMs:null}}endTimer(e){return ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ks(),e)}async getQueryTime(e){if(ie().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:a,isPacked:o,slice:l}=this.texData.get(e),c=l&&l.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,a,o)));const d=this.texData.get(e);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=Q0e){return ie().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ue(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Rr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return X0e(e.shape,n)}packedUnaryOp(e,n,s){const r=new Cl(e.shape,n),a=this.compileAndRun(r,[e],s);return mo().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=f5(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(ie().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,E5,e.dtype);const n=new $o(e.shape,E5),s=this.compileAndRun(n,[e]);return mo().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&_h(s[0])){const a=s.map(o=>ol(o));r=this.write(a,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return mo().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new K0e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new _0e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Vd(e.shape),...Wd(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},a=[Vd(n),...Wd(n)],o=new y5(a,s),l=!0,c=[s],u=this.runWebGLProgram(o,[r],e.dtype,c,l);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:a,dtype:o}=s;if(n!=null){const h=ue(a),p=n[0]*n[1]*4;R(h<=p,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const l=Cb(a);let c;r?c=new yge(l):c=new xge(l);const u=!0,d=[n??Nb(l)],m=this.runWebGLProgram(c,[{shape:l,dtype:o,dataId:e}],o,d,u,n);return{dtype:o,shape:a,dataId:m.dataId}}runWebGLProgram(e,n,s,r,a=!1,o){const l=this.makeTensorInfo(e.outputShape,s),c=this.texData.get(l.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===mf.DENSE){const g=o??Nb(e.outputShape);c.texShape=g.map(b=>b*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),ue(l.shape)===0)return c.values=bs(l.dtype,0),l;const u=[],d=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(g.dataId);if(b.texture==null){if(!e.packedInputs&&ue(g.shape)<=ie().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!b.isPacked!=!!e.packedInputs)g=b.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),b=this.texData.get(g.dataId);else if(b.isPacked&&!$b(b.shape,g.shape)){const w=g,v=g.shape;g.shape=b.shape,g=this.packedReshape(g,v),u.push(g),b=this.texData.get(g.dataId),w.shape=v}return{shape:g.shape,texData:b,isUniform:!1}});this.uploadToGPU(l.dataId);const m={shape:l.shape,texData:c,isUniform:!1},h=gge(e,d,m),p=this.getAndSaveBinary(h,()=>pge(this.gpgpu,e,d,m)),f=this.activeTimers!=null;let y;f&&(y=this.startTimer()),ie().get("ENGINE_COMPILE_ONLY")||fge(this.gpgpu,p,d,m,r),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),f&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)}));const x=ie().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const g=Ks();g-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!ie().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&a===!1){const g=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),g}return l}compileAndRun(e,n,s,r,a=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,a)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ie().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=re(()=>{if(!ie().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ie().getBool("DEBUG");ie().set("DEBUG",!1);const n=this.abs(Ut(1e-8)).dataSync()[0];if(ie().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Y0e:Z0e}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:a,texture:o,usage:l,isPacked:c}=n;if(o!=null)return;const u=this.activeTimers!=null;let d;u&&(d=Ks());let m=n.texShape;if(m==null&&(m=Efe(s,c),n.texShape=m),a!=null){const h=Cb(s);let p,f=m[1],y=m[0];const x=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(c||!x)&&([f,y]=Ud(m[0],m[1])),c?p=new Ege(h,x):p=new l5(h,x);const g=x?[y,f]:m,b=this.makeTensorInfo(g,r),w=this.texData.get(b.dataId);x?w.usage=Mr.PIXELS:w.usage=Mr.UPLOAD,w.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),f,y,a);const v=[[y,f]],k=this.runWebGLProgram(p,[b],r,v,!0),C=this.texData.get(k.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,ie().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=Ks()-d)}else{const h=this.acquireTexture(m,l,r,c);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=nxe(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*yx(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(a){throw a}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await gP(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(JL(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:o,outShapeStridesLocation:l,outTexShapeLocation:c}=o5(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=o,e.outShapeStridesLocation=l,e.outTexShapeLocation=c}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:o,channels:l}=e,c=mo().backend;if(!c.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=c.writeTexture(r,n,s,a,o,l);return mo().makeTensorFromDataId(u,n,s,c)}}Rb.nextDataId=0;function nxe(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */J4()&&s3("webgl",()=>new Rb,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PS=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class eu{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=ft(n,s),this.enableShapeUniforms=ks(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tu=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Kd{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ft(n,s);const a=this.outputShape.length;this.enableShapeUniforms=ks(a);let o="";if(r)if(a===0||ue(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${Yt(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const c=Ms("coords",a);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${c[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${c[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${c[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${c[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yr(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const sxe={kernelName:Qh,backendName:"webgl",kernelFunc:yr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,a=n.makeTensorInfo(s.shape,"complex64"),o=n.texData.get(a.dataId),l=yr({inputs:{x:s},backend:n}),c=yr({inputs:{x:r},backend:n});return o.complexTensorInfos={real:l,imag:c},a}const rxe={kernelName:m2,backendName:"webgl",kernelFunc:Il};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5="return (a < 0.) ? b * a : a;",k5=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function axe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:a}=s,o=n.makeTensorInfo([],"float32",al(a,"float32")),l=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Kd(k5,r.shape,o.shape):new eu(N5,r.shape,o.shape),c=n.runWebGLProgram(l,[r,o],"float32");return n.disposeIntermediateTensorInfo(o),c}const oxe={kernelName:zx,backendName:"webgl",kernelFunc:axe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5="return (a < 0.) ? b * a : a;",C5=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function ixe(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,a=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Kd(C5,s.shape,r.shape):new eu(S5,s.shape,r.shape);return n.runWebGLProgram(a,[s,r],"float32")}const lxe={kernelName:ry,backendName:"webgl",kernelFunc:ixe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xd="if (isnan(x)) return x;";function Dt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:a})=>{const{x:o}=r,l=a,c=s||o.dtype;if(l.shouldExecuteOnCPU([o])&&n!=null){const m=l.texData.get(o.dataId),h=n(m.values,c);return l.makeTensorInfo(o.shape,c,h)}const u=ie().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let d;return u?d=new Cl(o.shape,e):d=new $o(o.shape,t),l.runWebGLProgram(d,[o],c)}}function ds({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:o,backend:l})=>{const{a:c,b:u}=o,d=l;if(s&&c.dtype==="complex64"){const f=d.texData.get(c.dataId),y=d.texData.get(u.dataId),[x,g]=[[f.complexTensorInfos.real,y.complexTensorInfos.real],[f.complexTensorInfos.imag,y.complexTensorInfos.imag]].map(w=>{const[v,E]=w,k={dataId:v.dataId,dtype:v.dtype,shape:c.shape},C={dataId:E.dataId,dtype:E.dtype,shape:u.shape},I=new eu(t,c.shape,u.shape);return d.runWebGLProgram(I,[k,C],pr(v.dtype,E.dtype))}),b=Il({inputs:{real:x,imag:g},backend:d});return d.disposeIntermediateTensorInfo(x),d.disposeIntermediateTensorInfo(g),b}const m=a||pr(c.dtype,u.dtype);if((c.dtype==="string"||u.dtype==="string"||d.shouldExecuteOnCPU([c,u]))&&r!=null){const f=d.texData.get(c.dataId).values,y=d.texData.get(u.dataId).values,x=c.dtype==="string"?yi(f):f,g=c.dtype==="string"?yi(y):y,[b,w]=r(c.shape,u.shape,x,g,m),v=d.makeTensorInfo(w,m),E=d.texData.get(v.dataId);return E.values=b,v}const h=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let p;return h?p=new Kd(e,c.shape,u.shape,n):p=new eu(t,c.shape,u.shape),d.runWebGLProgram(p,[c,u],m)}}function gf(t,e=!1){if(t==="linear")return e?W0e:L0e;if(t==="relu")return e?G0e:B0e;if(t==="elu")return e?j0e:z0e;if(t==="relu6")return e?H0e:U0e;if(t==="prelu")return e?C5:S5;if(t==="leakyrelu")return e?k5:N5;if(t==="sigmoid")return e?q0e:V0e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I5{constructor(e,n,s,r=!1,a=!1,o=!1,l=null,c=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=ks(this.outputShape.length);const d=r?e[1]:e[2],m=Math.ceil(d/2),h=r?"i * 2, rc.y":"rc.y, i * 2",p=a?"rc.z, i * 2":"i * 2, rc.z",f=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],y=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",g="";l&&(c?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${l}
        }`:u?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${l}
        }`:x=`vec4 activation(vec4 x) {
          ${l}
        }`,g="result = activation(result);");const b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let w="rc.x",v="rc.x";e[0]<n[0]?w=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(v=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${m}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${w};
        int batchB = ${v};
        for (int i = 0; i < ${m}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${p});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${f[0]} * ${y[0]});
          result += (${f[1]} * ${y[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class T5{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ft(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5="return a * b;";function FS(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,a=pr(s.dtype,r.dtype);if(s.dtype==="complex64"){const l=n.texData.get(s.dataId),c=n.texData.get(r.dataId),u=new T5($5.REAL,s.shape,r.shape),d=new T5($5.IMAG,s.shape,r.shape),m=[{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:r.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(u,m,"float32"),p=n.runWebGLProgram(d,m,"float32"),f=Il({inputs:{real:h,imag:p},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}if(n.shouldExecuteOnCPU([s,r])){const l=n.texData.get(s.dataId),c=n.texData.get(r.dataId),[u,d]=i0e(s.shape,r.shape,l.values,c.values,a),m=n.makeTensorInfo(d,a),h=n.texData.get(m.dataId);return h.values=u,m}let o;return ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new Kd(A5,s.shape,r.shape):o=new eu(A5,s.shape,r.shape),n.runWebGLProgram(o,[s,r],a)}const cxe={kernelName:lp,backendName:"webgl",kernelFunc:FS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uxe(t,e,n){const s=[Vd(t.shape),...Wd(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},a=[Vd(e),...Wd(e)],o=new y5(a,s),l=!0,c=[s],u=n.runWebGLProgram(o,[r],t.dtype,c,l);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Me(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:a}=s,o=n,l=ue(r.shape),c=KD(a,l),u=ue(c);R(l===u,()=>`The new shape (${c}) has ${u} elements and the old shape (${r.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`);const d=o.texData.get(r.dataId);return d.isPacked&&!$b(r.shape,c)&&!(d.texture!==null&&$b(d.shape,c))?uxe(r,c,o):(o.incRef(r.dataId),{dataId:r.dataId,shape:c,dtype:r.dtype})}const dxe={kernelName:oy,backendName:"webgl",kernelFunc:Me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R5{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:o}=e;this.outputShape=[r,o];const l=Math.floor(s/4)*4,c=s%4;let u="sumValue += dot(values, ones);";if(n!=null){const m=1/n;u=`sumValue += dot(values * ${md(m)?m.toPrecision(2):m}, ones);`}let d="";a%s>0&&(d=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${l};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mxe{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:o}=e;this.outputShape=[r,o];let l="0.0",c="";n==="prod"?l="1.0":n==="min"?(l="1.0 / 1e-20",c="min"):n==="max"&&(l="-1.0 / 1e-20",c="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const d=Math.floor(s/4)*4,m=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${c}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,p="vec4";n==="all"?(l="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,p="bvec4"):n==="any"&&(l="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,p="bvec4");let f="";a%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${l};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${l});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${d};
        if (${m===1}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${m===2}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${m===3}) {
          ${p} values = ${p}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hxe(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Vy(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function nu(t,e,n,s){const r=hxe(t.shape);let a=t;for(let o=0;o<r.length;o++){const{inSize:l,windowSize:c,outSize:u}=r[o];let d,m;n==="mean"?d=o===0?new R5({windowSize:c,inSize:l,batchSize:t.shape[0],outSize:u},l):new R5({windowSize:c,inSize:l,batchSize:t.shape[0],outSize:u}):d=new mxe({windowSize:c,inSize:l,batchSize:t.shape[0],outSize:u},n),m=a,a=s.runWebGLProgram(d,[a],e),m.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(m)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pxe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[n[o]];this.outputShape=s,this.rank=s.length;const r=Yt(this.rank),a=fxe(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function fxe(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gxe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let d=0;d<s.length;d++)s[d]=e[n[d]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Yt(this.rank),a=x5("rc",this.rank),o=new Array(this.rank);for(let d=0;d<n.length;d++)o[n[d]]=a[d];const l=`vec2(${o.slice(-2).join()})`,c=`++${a[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${l})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${c}) {
        result[1] = ${u};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${c}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _b(t,e,n){const s=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new gxe(t.shape,e):new pxe(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xxe(t,e,n,s){const r=e,a=t.shape.length,o=Et(r,t.shape);let l=o;const c=yn(l,a),u=c!=null;let d=t;u&&(d=_b(t,c,s),l=$n(l.length,a)),cs("sum",l,a);const[m,h]=Qn(d.shape,l);let p=m;n&&(p=On(m,o));const f=ue(h),x=ue(t.shape)/f,g=Me({inputs:{x:d},attrs:{shape:[x,f]},backend:s}),b=sN(t.dtype),w=nu(g,b,"sum",s),v=Me({inputs:{x:w},attrs:{shape:p},backend:s});return s.disposeIntermediateTensorInfo(g),s.disposeIntermediateTensorInfo(w),u&&s.disposeIntermediateTensorInfo(d),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Db(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s;return xxe(r,a,o,n)}const yxe={kernelName:my,backendName:"webgl",kernelFunc:Db};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:a}=s,o=n,l=r.shape.length,c=new Array(l);for(let d=0;d<c.length;d++)c[d]=r.shape[a[d]];let u;if(o.shouldExecuteOnCPU([r])){const m=o.texData.get(r.dataId).values,h=DS(m,r.shape,r.dtype,a,c);u=o.makeTensorInfo(c,r.dtype);const p=o.texData.get(u.dataId);p.values=h}else u=_b(r,a,o);return u}const bxe={kernelName:xd,backendName:"webgl",kernelFunc:Os};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _5=1e3;function Pb({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:l=0,activation:c=null}){const u=t.shape.length,d=e.shape.length,m=n?t.shape[u-2]:t.shape[u-1],h=s?e.shape[d-1]:e.shape[d-2],p=n?t.shape[u-1]:t.shape[u-2],f=s?e.shape[d-2]:e.shape[d-1],y=t.shape.slice(0,-2),x=e.shape.slice(0,-2),g=ue(y),b=ue(x),v=ft(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([p,f]);R(m===h,()=>`Error in matMul: inner shapes (${m}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const E=n?[g,m,p]:[g,p,m],k=s?[b,f,h]:[b,h,f],C=Me({inputs:{x:t},backend:r,attrs:{shape:E}}),I=Me({inputs:{x:e},backend:r,attrs:{shape:k}}),A=[C,I],$=Math.max(g,b),T=n?C.shape[1]:C.shape[2],F=a!=null,O=o!=null,M=c==="leakyrelu",B=c!=null?gf(c,!0):null,L=F||O||M||B!=null;let Y;if((p===1||f===1)&&T>_5&&L===!1){let _=C,P=I;n&&(_=Os({inputs:{x:C},backend:r,attrs:{perm:[0,2,1]}}),A.push(_)),s&&(P=Os({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),A.push(P));const z=f!==1,q=f===1;let K=_;z&&(K=Me({inputs:{x:_},backend:r,attrs:{shape:[$,T,1]}}),A.push(K));const ae=f===1?2:1;let ne=P;q&&(ne=Me({inputs:{x:P},backend:r,attrs:{shape:[$,1,T]}}),A.push(ne));const Z=FS({inputs:{a:K,b:ne},backend:r});Y=Db({inputs:{x:Z},backend:r,attrs:{axis:ae,keepDims:!0}}),A.push(Z)}else{const _=pr(t.dtype,e.dtype),P=new I5(E,k,[$,p,f],n,s,F,B,O,M),z=[C,I];if(a!=null&&z.push(a),O&&z.push(o),M){const q=r.makeTensorInfo([],"float32",al(l,"float32"));z.push(q),A.push(q)}Y=r.runWebGLProgram(P,z,_)}const D=Me({inputs:{x:Y},backend:r,attrs:{shape:v}});A.push(Y);for(const _ of A)r.disposeIntermediateTensorInfo(_);return D}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wxe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a,bias:o,preluActivationWeights:l}=e,{transposeA:c,transposeB:u,activation:d,leakyreluAlpha:m}=s;return Pb({a:r,b:a,transposeA:c,transposeB:u,backend:n,bias:o,preluActivationWeights:l,leakyreluAlpha:m,activation:d})}const vxe={kernelName:by,backendName:"webgl",kernelFunc:wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D5="return abs(x);";function Exe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=n.texData.get(s.dataId),o=f5(a.values);return n.makeTensorInfo(s.shape,s.dtype,o)}let r;return ie().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Cl(s.shape,D5):r=new $o(s.shape,D5),n.runWebGLProgram(r,[s],s.dtype)}const Nxe={kernelName:bx,backendName:"webgl",kernelFunc:Exe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kxe=ha+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Sxe=Dt({opSnippet:kxe}),Cxe={kernelName:Dh,backendName:"webgl",kernelFunc:Sxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ixe=ha+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,$xe=Dt({opSnippet:Ixe}),Txe={kernelName:Ph,backendName:"webgl",kernelFunc:$xe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P5="return a + b;",Axe=ds({opSnippet:P5,packedOpSnippet:P5,supportsComplex:!0,cpuKernelImpl:Bge}),Rxe={kernelName:gd,backendName:"webgl",kernelFunc:Axe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _xe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((a,o)=>`T${o}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dxe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((a,o)=>`T${o}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fb(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return yr({inputs:{x:s[0]},backend:n});if(s.length>ie().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(s.length/2),u=Fb({inputs:s.slice(0,c),backend:n}),d=Fb({inputs:s.slice(c),backend:n});return Fb({inputs:[u,d],backend:n})}const r=s.map(c=>c.dtype).reduce((c,u)=>pr(c,u)),a=s.map(c=>c.shape),l=ie().getBool("WEBGL_PACK")?new Dxe(s[0].shape,a):new _xe(s[0].shape,a);return n.runWebGLProgram(l,s,r)}const Pxe={kernelName:a2,backendName:"webgl",kernelFunc:Fb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=Et(a,r.shape);let u=c;const d=yn(u,l);let m=r;d!=null&&(m=Os({inputs:{x:r},backend:n,attrs:{perm:d}}),u=$n(u.length,l)),cs("all",u,l);const[h,p]=Qn(m.shape,u),f=ue(p),y=Me({inputs:{x:m},backend:n,attrs:{shape:[-1,f]}}),x=nu(y,y.dtype,"all",n);let g;if(o){const b=On(h,c);g=Me({inputs:{x},backend:n,attrs:{shape:b}})}else g=Me({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),d!=null&&n.disposeIntermediateTensorInfo(m),g}const Mxe={kernelName:o2,backendName:"webgl",kernelFunc:Fxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=Et(a,r.shape);let u=c;const d=yn(u,l);let m=r;d!=null&&(m=Os({inputs:{x:r},backend:n,attrs:{perm:d}}),u=$n(u.length,l)),cs("any",u,l);const[h,p]=Qn(m.shape,u),f=ue(p),y=Me({inputs:{x:m},backend:n,attrs:{shape:[-1,f]}}),x=nu(y,y.dtype,"any",n);let g;if(o){const b=On(h,c);g=Me({inputs:{x},backend:n,attrs:{shape:b}})}else g=Me({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),d!=null&&n.disposeIntermediateTensorInfo(m),g}const Lxe={kernelName:i2,backendName:"webgl",kernelFunc:Oxe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zxe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:o}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];const l=n==="max"?">":"<",c=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${l} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bxe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,R(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],o=Math.ceil(a/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const l=this.outputShape,c=l.length,u=Yt(c),d=Ms("coords",c);let m,h;if(o===1){h=c+1;const I=Yt(h);m=`
        ${I} sourceLocR = ${I}(${d.join()}, 0);
        ++${d[c-1]};
        ${I} sourceLocG = ${I}(${d.join()}, 0);
        ++${d[c-2]};
        ${I} sourceLocA = ${I}(${d.join()}, 0);
        --${d[c-1]};
        ${I} sourceLocB = ${I}(${d.join()}, 0);
        --${d[c-2]};`}else h=c,m=`
        ${u} sourceLocR = coords;
        ++${d[c-1]};
        ${u} sourceLocG = coords;
        ++${d[c-2]};
        ${u} sourceLocA = coords;
        --${d[c-1]};
        ${u} sourceLocB = coords;
        --${d[c-2]};`;const p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],y=p.map(I=>"int "+I),x=Ms("sourceLocR",h-1).concat("inIdx.r"),g=Ms("sourceLocG",h-1).concat("inIdx.g"),b=Ms("sourceLocB",h-1).concat("inIdx.b"),w=Ms("sourceLocA",h-1).concat("inIdx.a"),v=s==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${w.join()})));`,k=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,C=r?"":`
      float getBestIndicesAChannel(${y.join()}) {
        return getChannel(getBestIndicesA(${p.join()}),
                                          vec2(${p.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${y.join()}) {
        return getChannel(getA(${p.join()}),
                               vec2(${p.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${d[c-1]} < ${l[c-1]-1};
        bool hasNextRow = ${d[c-2]} < ${l[c-2]-1};
        ${m}
        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},
          sourceLocB${f}, sourceLocA${f}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${E}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F5(t,e,n,s=null){let r=e.shape[0],a=e.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const o=Vy(a),l={windowSize:o,inSize:a,batchSize:r,outSize:Math.ceil(a/o)},c=new zxe(l,n,s==null),u=[e];s!=null&&u.push(s);const d=t.runWebGLProgram(c,u,"int32");if(d.shape[1]===1)return d;const m=F5(t,e,n,d);return t.disposeIntermediateTensorInfo(d),m}function M5(t,e,n,s=null){const r=s!=null?s.shape:e.shape,a=r[r.length-1],o=Vy(a),l=new Bxe(r,o,n,s==null),c=s==null?[e]:[e,s],u=t.runWebGLProgram(l,c,"int32");if(u.shape.length===e.shape.length){const d=M5(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}return u}function O5(t,e,n,s){const r=[n];if(cs("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!ie().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],o=t.texData.get(e.dataId),l=o!==null&&o.isPacked;let c=e;l&&(c=t.unpackTensor(e),a.push(c));const[u,d]=Qn(c.shape,r),m=ue(d),h=Me({inputs:{x:c},backend:t,attrs:{shape:[-1,m]}});a.push(h);const p=F5(t,h,s);a.push(p);const f=Me({inputs:{x:p},backend:t,attrs:{shape:u}});return a.forEach(y=>t.disposeIntermediateTensorInfo(y)),f}return M5(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;let o=Et(a,r.shape);const l=yn(o,r.shape.length);let c=r;const u=[];l!=null&&(c=Os({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),o=$n(o.length,c.shape.length)),cs("argMax",[o[0]],c.shape.length);const d=O5(n,c,o[0],"max");return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),d}const Vxe={kernelName:wx,backendName:"webgl",kernelFunc:Uxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wxe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;let o=Et(a,r.shape);const l=yn(o,r.shape.length);let c=r;const u=[];l!=null&&(c=Os({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),o=$n(o.length,c.shape.length)),cs("argMin",[o[0]],c.shape.length);const d=O5(n,c,o[0],"min");return u.forEach(m=>n.disposeIntermediateTensorInfo(m)),d}const jxe={kernelName:vx,backendName:"webgl",kernelFunc:Wxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gxe=ha+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Hxe=Dt({opSnippet:Gxe}),qxe={kernelName:Fh,backendName:"webgl",kernelFunc:Hxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kxe=ha+"return log(x + sqrt(x * x + 1.0));",Xxe=Dt({opSnippet:Kxe}),Yxe={kernelName:Mh,backendName:"webgl",kernelFunc:Xxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zxe=ha+`
  return atan(x);
`,Jxe=Dt({opSnippet:Zxe}),Qxe={kernelName:Oh,backendName:"webgl",kernelFunc:Jxe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eye=PS+`
  return atan(a, b);
`,tye=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+tu+`
  return result;
`,nye=ds({opSnippet:eye,packedOpSnippet:tye}),sye={kernelName:zh,backendName:"webgl",kernelFunc:nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rye=ha+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,aye=Dt({opSnippet:rye}),oye={kernelName:Lh,backendName:"webgl",kernelFunc:aye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xf{constructor(e,n,s,r=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,m=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(y||(b="-1.0 / 1e-20"),s){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${l}, ${c});
        const ivec2 pads = ivec2(${p}, ${f});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${m};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${d}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?x:g:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let v=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(v="avgValue / max(count, 1.0)");const E=Math.floor(o/4)*4,k=o%4,C=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${p}, ${f});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${m};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${E}; wC += 4) {
            int xC = xCCorner + wC * ${d};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              getValue(batch, xR, xC + 3 * ${d}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${E};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${v});
      }
    `}}class MS{constructor(e,n,s,r=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,l=e.strideDepth,c=e.strideHeight,u=e.strideWidth,d=e.dilationDepth,m=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,y=e.effectiveFilterWidth,x=e.padInfo.front,g=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let v="0.0";if(w||(v="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${l}, ${c}, ${u});
        const ivec3 pads = ivec3(${x}, ${g}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${p};
              wD += ${d}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${f};
                wR += ${m}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${y};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${f} * ${y} +
                      wR * ${y} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const E="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const C=Math.floor(o/4)*4,I=o%4,A=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${E}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${l}, ${c}, ${u});
      const ivec3 pads = ivec3(${x}, ${g}, ${b});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${d}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f};
            wR += ${m}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${C};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${A}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;pf(r,"avgPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;R(vs(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=ra(r.shape,a,o,u,l,c);if(d.filterWidth===1&&d.filterHeight===1&&zt(d.inShape,d.outShape))return yr({inputs:{x:r},backend:n});const m=new xf(d,"avg",!1);return n.runWebGLProgram(m,[r],"float32")}const lye={kernelName:Ex,backendName:"webgl",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c,dataFormat:u}=s,d=[1,1,1],m=mi(r.shape,a,o,d,l,c,u),h=new MS(m,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const uye={kernelName:Nx,backendName:"webgl",kernelFunc:cye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dye{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=c-1-e.padInfo.top,m=u-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${d}, ${m});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${l}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class mye{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,m=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=m-1-e.padInfo.front,y=h-1-e.padInfo.top,x=p-1-e.padInfo.left,g=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${f}, ${y}, ${x});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${m};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${p};
                wC += ${d}) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,o=a,{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,m=[1,1,1],h=mi(o.shape,l,c,m,u,d),p=new mye(h);return n.runWebGLProgram(p,[r],o.dtype)}const pye={kernelName:c2,backendName:"webgl",kernelFunc:hye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fye(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,o=a;pf([r,a],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=s,d=ra(o.shape,l,c,1,u),m=new dye(d);return n.runWebGLProgram(m,[r],o.dtype)}const gye={kernelName:l2,backendName:"webgl",kernelFunc:fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xye(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a}=e,{transposeA:o,transposeB:l}=s;return Pb({a:r,b:a,transposeA:o,transposeB:l,backend:n})}const yye={kernelName:kx,backendName:"webgl",kernelFunc:xye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bye{constructor(e,n,s,r,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],ft(e,n),ft(e,s);let l="0.0";r!=null&&(ft(e,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="1.0";a!=null&&(ft(e,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${l};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wye{constructor(e,n,s,r,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ft(e,n),ft(e,s);let l="vec4(0.0)";r!=null&&(ft(e,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="vec4(1.0)";a!=null&&(ft(e,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${l};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vye={kernelName:Mx,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:a,offset:o,scale:l}=t;R(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),R(o==null||r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),R(l==null||r.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=n;c==null&&(c=.001);const u=[s,r,a];let d=null;o!=null&&(d=o.shape,u.push(o));let m=null;l!=null&&(m=l.shape,u.push(l));const h=ie().getBool("WEBGL_PACK_NORMALIZATION")?new wye(s.shape,r.shape,a.shape,d,m,c):new bye(s.shape,r.shape,a.shape,d,m,c);return e.runWebGLProgram(h,u,u[0].dtype)}};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eye{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=Yt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Nye(this.rank);let r;const a=e.map((o,l)=>`sourceLoc.${OS[l]} = start[${l}] + coords.${OS[l]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const OS=["x","y","z","w","u","v"];function Nye(t){if(t===1)return"sourceLoc";if(t<=6)return OS.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kye{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Yt(this.rank),s=Ms("coords",this.rank),r=Ms("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${a})`,l=`
      result.x = ${o};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${o};
        --${r[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${o};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((d,m)=>`start[${m}]`).join()});`:e.map((d,m)=>`${r[m]} = ${s[m]} + start[${m}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${l}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(t,e,n,s){const r=s.texData.get(t.dataId),a=s.makeTensorInfo(n,t.dtype),o=s.texData.get(a.dataId);Object.assign(o,r),o.refCount=1,o.shape=n,o.dtype=t.dtype;let l=rk(e,nt(t.shape));r.slice&&(l+=r.slice.flatOffset),o.slice={flatOffset:l,origDataId:r.slice&&r.slice.origDataId||t.dataId};const c=s.dataRefCount.get(o.slice.origDataId)||1;return s.dataRefCount.set(o.slice.origDataId,c+1),a}function Yd(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,size:o}=s,[l,c]=Uy(r,a,o);if(tk(r,l,c),ue(c)===0)return n.makeTensorInfo(c,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const m=n.texData.get(r.dataId),h=y0e(m.values,l,c,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,h)}const{isPacked:u}=n.texData.get(r.dataId),d=sk(r.shape,l,c);if(u||!d){const m=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new kye(c):new Eye(c),h=[l];return n.runWebGLProgram(m,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),Sye(r,l,c,n)}const Cye={kernelName:dy,backendName:"webgl",kernelFunc:Yd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iye={kernelName:Sx,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,crops:o}=s;R(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((b,w)=>b*w),c=jp(r.shape,a,l),u=Gp(c.length,a.length),d=Hp(r.shape,a,l),m=ck(o,a.length),h=uk(d,o,a.length),p=[],f=Me({inputs:{x:r},backend:n,attrs:{shape:c}}),y=Os({inputs:{x:f},backend:n,attrs:{perm:u}}),x=Me({inputs:{x:y},backend:n,attrs:{shape:d}}),g=Yd({inputs:{x},backend:n,attrs:{begin:m,size:h}});return p.push(f),p.push(y),p.push(x),p.forEach(b=>n.disposeIntermediateTensorInfo(b)),g}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:o}=s,l=n.readSync(r.dataId),c=n.readSync(a.dataId),u=p5(l,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,u)}const Tye={kernelName:u2,backendName:"webgl",kernelFunc:$ye};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aye=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Rye=`
  return float(int(a.r) & int(b.r));
`;function _ye(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,a=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS"),o=ie().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||o===1){const c=n.texData.get(s.dataId).values,u=n.texData.get(r.dataId).values,[d,m]=Vge(s.shape,r.shape,c,u,s.dtype),h=n.makeTensorInfo(m,s.dtype),p=n.texData.get(h.dataId);return p.values=d,h}let l;return a?l=new Kd(Aye,s.shape,r.shape,!1):l=new eu(Rye,s.shape,r.shape),n.runWebGLProgram(l,[s,r],s.dtype)}const Dye={kernelName:d2,backendName:"webgl",kernelFunc:_ye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pye(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,a=n.readSync(s.dataId),o=n.readSync(r.dataId),l=ft(Array.from(a),Array.from(o));return n.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const Fye={kernelName:t4,backendName:"webgl",kernelFunc:Pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L5=ds({opSnippet:"return float(a != b);",cpuKernelImpl:c0e,dtype:"bool"}),Mye={kernelName:Qx,backendName:"webgl",kernelFunc:L5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yf(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return yr({inputs:{x:r.complexTensorInfos.real},backend:n})}const Oye={kernelName:L2,backendName:"webgl",kernelFunc:yf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lye="return float(int(x));";function zye(t,e){const n=new $o(t.shape,Lye),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LS(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return yr({inputs:{x:r},backend:n});const o=es(r.shape),l=LS({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),c=Il({inputs:{real:l,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(l),c}if(r.dtype==="complex64"){const o=yf({inputs:{input:r},backend:n}),l=LS({inputs:{x:o},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(o),l}if(!XD(r.dtype,a)){const o=yr({inputs:{x:r},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:a}}if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId).values,[l,c,u]=Wge(o,r.shape,r.dtype,a);return n.makeTensorInfo(l,c,u)}if(a==="int32")return zye(r,n);if(a==="bool"){const o=n.makeTensorInfo([],"bool",bs("bool",1)),c=L5({inputs:{a:r,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),c}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const Bye={kernelName:Bh,backendName:"webgl",kernelFunc:LS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z5="return ceil(x);",Uye=Dt({opSnippet:z5,packedOpSnippet:z5,cpuKernelImpl:jge}),Vye={kernelName:Uh,backendName:"webgl",kernelFunc:Uye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wye{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jye{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gye(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:a,clipValueMax:o}=s;let l;ie().getBool("WEBGL_PACK_CLIP")?l=new jye(r.shape):l=new Wye(r.shape);const c=[[a],[o]];return n.runWebGLProgram(l,[r],r.dtype,c)}const Hye={kernelName:Vh,backendName:"webgl",kernelFunc:Gye};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qye{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B5(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function Kye(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),a=new qye(s.shape),o=[B5(s,r.complexTensorInfos.real),B5(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}const Xye={kernelName:Cx,backendName:"webgl",kernelFunc:Kye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yye{constructor(e){this.outputShape=[],this.outputShape=yo(e,1),this.variableNames=e.map((o,l)=>`T${l}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const l=n[o-1];s.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${l}));`)}const r=n.length,a=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zye{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=yo(e,n);const s=this.outputShape,r=s.length,a=Yt(r),o=Ms("coords",r),l=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((y,x)=>`T${x}`);const c=new Array(e.length-1);c[0]=e[0][n];for(let y=1;y<c.length;y++)c[y]=c[y-1]+e[y][n];const u=l[n],d=l.slice(-2),m=l.join();let h=`if (${u} < ${c[0]}) {
        return getChannel(
            getT0(${m}), vec2(${d.join()}));
        }`;for(let y=1;y<c.length;y++){const x=c[y-1];h+=`
        if (${u} < ${c[y]}  && ${u} >= ${c[y-1]}) {
          return getChannel(
            getT${y}(${Mb(l,u,x)}),
            vec2(${Mb(d,u,x)}));
        }`}const p=c.length,f=c[c.length-1];h+=`
        return getChannel(
          getT${p}(${Mb(l,u,f)}),
          vec2(${Mb(d,u,f)}));`,this.userCode=`
      float getValue(${l.map(y=>"int "+y)}) {
        ${h}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[r-1]} = ${o[r-1]} + 1;
        if (${o[r-1]} < ${s[r-1]}) {
          result.g = getValue(${o});
        }

        ${o[r-2]} = ${o[r-2]} + 1;
        if (${o[r-2]} < ${s[r-2]}) {
          result.a = getValue(${o});
        }

        ${o[r-1]} = ${o[r-1]} - 1;
        if (${o[r-2]} < ${s[r-2]} &&
            ${o[r-1]} < ${s[r-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function Mb(t,e,n){const s=t.indexOf(e);return t.map((a,o)=>o===s?`${a} - ${n}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ob(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return yr({inputs:{x:r.complexTensorInfos.imag},backend:n})}const Jye={kernelName:A2,backendName:"webgl",kernelFunc:Ob};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bf(t,e,n){const s=t[0].dtype;if(s==="complex64"){const p=t.map(b=>yf({inputs:{input:b},backend:n})),f=t.map(b=>Ob({inputs:{input:b},backend:n})),y=bf(p,e,n),x=bf(f,e,n),g=Il({inputs:{real:y,imag:x},backend:n});return p.forEach(b=>n.disposeIntermediateTensorInfo(b)),f.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),g}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const p=t.map(v=>{const k=[-1,ue(v.shape.slice(e))];return Me({inputs:{x:v},backend:n,attrs:{shape:k}})}),f=p.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),y=yo(p.map(v=>v.shape),1),x=p[0].shape[0]===1,g=Gge(f,y,s,x),b=yo(t.map(v=>v.shape),e),w=n.makeTensorInfo(b,s,g);return p.forEach(v=>n.disposeIntermediateTensorInfo(v)),w}const a=t.filter(p=>ue(p.shape)>0),o=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const p=o?new $o(t[0].shape,Sl):new Cl(t[0].shape,Sl);return n.runWebGLProgram(p,t,s)}const l=ie().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>l){const p=[];for(let y=0;y<a.length;y+=l){const x=a.slice(y,y+l);p.push(bf(x,e,n))}const f=bf(p,e,n);for(const y of p)n.disposeIntermediateTensorInfo(y);return f}if(o){const p=new Zye(a.map(f=>f.shape),e);return n.runWebGLProgram(p,a,s)}const{tensors2D:c,outShape:u}=Qye(a,e,n),d=new Yye(c.map(p=>p.shape)),m=n.runWebGLProgram(d,c,s);c.forEach(p=>n.disposeIntermediateTensorInfo(p));const h=Me({inputs:{x:m},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(m),h}function Qye(t,e,n){const s=yo(t.map(a=>a.shape),e);return{tensors2D:t.map(a=>Me({inputs:{x:a},attrs:{shape:[-1,ue(a.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U5(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,a=Et(r,e[0].shape)[0],o=e.map(u=>u.shape);ok(o,a);const l=yo(e.map(u=>u.shape),a);if(ue(l)===0)return n.makeTensorInfo(l,e[0].dtype,[]);const c=e.filter(u=>ue(u.shape)>0);return c.length===1?yr({inputs:{x:c[0]},backend:n}):bf(c,a,n)}const ebe={kernelName:Ix,backendName:"webgl",kernelFunc:U5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V5{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,m=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,y=e.inChannels%4,x=e.dataFormat==="channelsLast",g=x?1:2,b=x?2:3,w=x?3:1;let v="",E="";s&&(r?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:v=`
          float activation(float x) {
            ${s}
          }
        `,E="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${c}, ${u});
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${d};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${p}; wC++) {
            int xC = xCCorner + wC * ${m};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${f}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${y===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${f}) *
                    getW(wR, wC, ${f}, d2);
              } else {
                dotProd +=
                    getX(batch, ${f}, xR, xC) *
                    getW(wR, wC, ${f}, d2);
              }

            } else if (${y===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${y===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${f}, d2),
                getW(wR, wC, ${f} + 1, d2),
                getW(wR, wC, ${f} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${f}),
                  getX(batch, xR, xC, ${f} + 1),
                  getX(batch, xR, xC, ${f} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${f}, xR, xC),
                  getX(batch, ${f} + 1, xR, xC),
                  getX(batch, ${f} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${E}
        setOutput(result);
      }
    `}}class tbe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,m=e.filterDepth,h=e.filterHeight,p=e.filterWidth,f=Math.floor(e.inChannels/4)*4,y=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${o}, ${l});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${m}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p}; wC++) {
              int xC = xCCorner + wC * ${d};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${f}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${y===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${f}) *
                  getW(wF, wR, wC, ${f}, d2);
              } else if (${y===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${y===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${f}),
                  getX(batch, xF, xR, xC, ${f} + 1),
                  getX(batch, xF, xR, xC, ${f} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${f}, d2),
                  getW(wF, wR, wC, ${f} + 1, d2),
                  getW(wF, wR, wC, ${f} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W5{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ks(this.outputShape.length);const o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,m=d;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<d;x++)h+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;h+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<d;x++)h+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(m+1)/2;x++){const g=x*2;if(h+=`
           xC = xCCorner + ${g*c};
           `,l===1){if(g<d&&(o%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,c===1&&g>0?h+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<d)){const b=o%2===0?XE(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,c>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:h+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):b===1?h+=`
                     xC${g+1} = xTexelC${g};
                     `:h+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<d&&(o%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<d&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<d&&(h+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<d&&(h+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<d&&(h+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let p="",f="";s&&(r?p=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?p=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:p=`vec4 activation(vec4 x) {
           ${s}
         }`,f="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${p}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${y}
         ${f}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nbe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ks(this.outputShape.length);const{dataFormat:s}=n,r=Fs(),a=s==="channelsLast",o=a?1:2,l=a?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let d=0;d<=1;d++)for(let m=0;m<=1;m++)u+=`
          blockIndex = rc.z + ${m};
          pos = rc.y + ${d};

          ${c}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${l}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${d*2+m}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${d*2+m}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lb(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function j5({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const c=t.shape,u=s.texData.get(t.dataId),d=n.inChannels,m=c[0]*c[1]*c[2],h=n.outChannels,p=n.dataFormat==="channelsLast",f=!1,y=!1;let x;const g=[];if(a!=null){const v=Lb(a.shape,p);v!=null&&(a=Me({inputs:{x:a},backend:s,attrs:{shape:v}}),g.push(a))}if(r!=null){const v=Lb(r.shape,p);v!=null&&(r=Me({inputs:{x:r},backend:s,attrs:{shape:v}}),g.push(r))}if(!((m===1||h===1)&&d>_5)&&u.isPacked&&p&&u.texture!=null&&c[2]%2!==0&&zt(u.shape.slice(-3),c.slice(-3))){const v=c[0]*c[1]*(c[2]+1),E={dataId:t.dataId,shape:[1,v,n.inChannels],dtype:t.dtype},k=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,R($b(u.shape,E.shape),()=>`packed reshape ${u.shape} to ${E.shape} isn't free`);const C=Me({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(C);const I=Pb({a:E,b:C,backend:s,transposeA:f,transposeB:y,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:o}),A=s.texData.get(I.dataId);R(A.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=k,A.shape=n.outShape,x=yr({inputs:{x:I},backend:s}),x.shape=n.outShape,g.push(I)}else{const v=n.outHeight*n.outWidth,E=Me({inputs:{x:t},backend:s,attrs:{shape:p?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),k=Me({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=Pb({a:p?E:k,b:p?k:E,transposeA:!p,transposeB:y,backend:s,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:o});x=Me({inputs:{x:C},backend:s,attrs:{shape:n.outShape}}),g.push(E),g.push(k),g.push(C)}for(const v of g)s.disposeIntermediateTensorInfo(v);return x}function G5({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const{filterWidth:c,filterHeight:u,inChannels:d,outWidth:m,outHeight:h,dataFormat:p}=n,f=p==="channelsLast",y=c*u*d,x=h*m,g=[n.batchSize,y,x],b=!0,w=!1,v=[];if(a!=null){const D=Lb(a.shape,f);D!=null&&(a=Me({inputs:{x:a},backend:s,attrs:{shape:D}}),v.push(a))}if(r!=null){const D=Lb(r.shape,f);D!=null&&(r=Me({inputs:{x:r},backend:s,attrs:{shape:D}}),v.push(r))}const E=Me({inputs:{x:e},backend:s,attrs:{shape:[1,y,ue(e.shape)/y]}});v.push(E);const k=new nbe(g,n),C=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=s.runWebGLProgram(k,[t],"float32",C),A=Me({inputs:{x:I},backend:s,attrs:{shape:g}});v.push(I),v.push(A);const $=r!=null,T=a!=null,F=l==="leakyrelu",O=l?gf(l,!0):null,M=new I5(f?A.shape:E.shape,f?E.shape:A.shape,f?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],b,w,$,O,T,F),B=f?[A,E]:[E,A];if(r&&B.push(r),T&&B.push(a),F){const D=s.makeTensorInfo([],"float32",al(o,"float32"));B.push(D),v.push(D)}const L=s.runWebGLProgram(M,B,"float32"),Y=Me({inputs:{x:L},backend:s,attrs:{shape:n.outShape}});v.push(L);for(const D of v)s.disposeIntermediateTensorInfo(D);return Y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dataFormat:c,dilations:u,dimRoundingMode:d}=s,m=hi(c),h=ls(r.shape,a.shape,o,u,l,d,!1,m);let p;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))p=j5({x:r,filter:a,convInfo:h,backend:n});else if(h.strideWidth<=2&&m==="channelsLast"&&ie().getBool("WEBGL_EXP_CONV")){const y=new W5(h),x=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=n.runWebGLProgram(y,[r,a],"float32",x)}else if(ie().getBool("WEBGL_CONV_IM2COL"))p=G5({x:r,filter:a,convInfo:h,backend:n});else{const y=new V5(h);p=n.runWebGLProgram(y,[r,a],"float32")}const f=Me({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}const rbe={kernelName:$x,backendName:"webgl",kernelFunc:sbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class abe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${o?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class obe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=e.dataFormat==="channelsLast",l=n-1-e.padInfo.top,c=s-1-e.padInfo.left,u=o?1:2,d=o?2:3,m=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${m}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${d}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class ibe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,o=e.padInfo.top,l=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${l};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class lbe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,o=e.strideHeight,l=e.strideWidth,c=n-1-e.padInfo.front,u=s-1-e.padInfo.top,d=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${u}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:o,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:d}=s,m=hi(c),h=ls(r.shape,d,o,1,l,u,!1,m),p=new abe(h);return n.runWebGLProgram(p,[r,a],"float32")}const ube={kernelName:h2,backendName:"webgl",kernelFunc:cbe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dbe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=ks(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,a=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{inputShape:o,strides:l,pad:c,dataFormat:u,dimRoundingMode:d}=s,m=hi(u),h=ls(o,a.shape,l,1,c,d,!1,m);if(ie().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&m==="channelsLast"){const p=[[h.strideHeight,h.strideWidth]],f=new dbe(h);return n.runWebGLProgram(f,[r,a],"float32",p)}else{const p=new obe(h);return n.runWebGLProgram(p,[r,a],"float32")}}const hbe={kernelName:Tx,backendName:"webgl",kernelFunc:mbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c}=s,u=ul(r.shape,a.shape,o,c,l),d=new tbe(u);return n.runWebGLProgram(d,[r,a],"float32")}const fbe={kernelName:Ax,backendName:"webgl",kernelFunc:pbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:o,pad:l,filterShape:c}=s,u=ul(r.shape,c,o,1,l),d=new ibe(u);return n.runWebGLProgram(d,[r,a],"float32")}const xbe={kernelName:p2,backendName:"webgl",kernelFunc:gbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ybe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{pad:o,strides:l,inputShape:c}=s,u=ul(c,a.shape,l,1,o),d=new lbe(u);return n.runWebGLProgram(d,[r,a],"float32")}const bbe={kernelName:f2,backendName:"webgl",kernelFunc:ybe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wbe=Xd+`
  return cos(x);
`,vbe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${tu}
  return result;
`,Ebe=Dt({opSnippet:wbe,packedOpSnippet:vbe}),Nbe={kernelName:Wh,backendName:"webgl",kernelFunc:Ebe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kbe=Dt({opSnippet:`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`}),Sbe={kernelName:jh,backendName:"webgl",kernelFunc:kbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cbe{constructor(e,n,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,l,c,u]=e,[d]=n,[m,h]=s;this.outputShape=[d,m,h,u];const p=r==="bilinear"?1:0,[f,y]=[`${l-1}.0`,`${c-1}.0`],[x,g,b]=m>1?[`${(l-1)/(m-1)}`,"(y2-y1) * height_ratio",`y1*${f} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${f}`],[w,v,E]=h>1?[`${(c-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${y} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${y}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${v};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${f} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${E};
        if( in_x < 0.0 || in_x > ${y} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${p} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ibe={kernelName:x2,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:a,boxInd:o}=e,{cropSize:l,method:c,extrapolationValue:u}=s,d=new Cbe(r.shape,a.shape,l,c,u);return n.runWebGLProgram(d,[r,a,o],"float32")}};var wf;(function(t){t.Prod="*",t.Sum="+"})(wf||(wf={}));class H5{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,o=this.op===wf.Prod?"1.0":"0.0",l=s?o:`getX(${q5(a,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let u="",d="";s?(u=r?`end != ${c-1}`:"end != 0",d=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${c}`:"end >= pow2",d=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Yt(a)} coords = getOutputCoords();
        int end = ${K5(a,"coords",this.op)};
        float val = ${l};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${d};
          ${K5(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${q5(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function q5(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function K5(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(t,e,n,s,r,a){const o=e.shape.length,l=yn([s],o);let c=e;l!=null&&(c=Os({inputs:{x:e},backend:n,attrs:{perm:l}}));const u=$n(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const d=c.shape[u];let m=yr({inputs:{x:c},backend:n});for(let h=0;h<=Math.ceil(Math.log2(d))-1;h++){const p=new H5(t,c.shape,!1,a),f=[[h]],y=m;m=n.runWebGLProgram(p,[m],m.dtype,f),n.disposeIntermediateTensorInfo(y)}if(r){const h=new H5(t,c.shape,r,a),p=m;m=n.runWebGLProgram(h,[m],m.dtype),n.disposeIntermediateTensorInfo(p)}if(l!=null){const h=dl(l),p=Os({inputs:{x:m},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),p}return m}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $be(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;return X5(wf.Prod,r,n,a,o,l)}const Tbe={kernelName:g2,backendName:"webgl",kernelFunc:$be};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Abe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:o,reverse:l}=s;return X5(wf.Sum,r,n,a,o,l)}const Rbe={kernelName:Rx,backendName:"webgl",kernelFunc:Abe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _be(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:o,binaryOutput:l}=s;if(r.shape.length===1){const c=n.readSync(r.dataId),u=n.readSync(a.dataId),d=p5(c,u,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,d)}else if(r.shape.length===2){const c=n.bufferSync(r),u=n.bufferSync(a),d=Uge(c,u,o,l);return n.makeTensorInfo(d.shape,a.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Dbe={kernelName:y2,backendName:"webgl",kernelFunc:_be};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pbe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:a,dataFormat:o}=s,l=r.shape[0],c=o==="NHWC"?r.shape[1]:r.shape[2],u=o==="NHWC"?r.shape[2]:r.shape[3],d=o==="NHWC"?r.shape[3]:r.shape[1],m=c*a,h=u*a,p=d/(a*a),f=o==="NHWC"?[l,m,h,p]:[l,p,m,h],y=new Pbe(f,a,o);return n.runWebGLProgram(y,[r],r.dtype)}const Mbe={kernelName:b2,backendName:"webgl",kernelFunc:Fbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y5{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ks(this.outputShape.length);const o=e.filterHeight,l=e.filterWidth,c=e.outChannels/e.inChannels;let u="",d="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,d="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${c};
        int q = d2 - d1 * ${c};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${l}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${m}
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z5{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ks(this.outputShape.length);const o=e.outChannels/e.inChannels,l=e.padInfo.left,c=e.strideWidth,u=e.dilationWidth,d=e.filterHeight,m=e.filterWidth,h=m;let p=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<m;g++)p+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;p+=`
    for (int r = 0; r < ${d}; r++) {
      `;for(let g=0;g<m;g++)p+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;p+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(h+1)/2;g++){const b=g*2;if(p+=`
          xC = xCCorner + ${b*u};
          `,c===1){if(b<m&&(l%2===1?(p+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?p+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:p+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):p+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<m)){const w=l%2===0?XE(u):u;u%2===0&&l%2===1||u%2!==0&&l%2!==1?(p+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?p+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:p+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):w===1?p+=`
                    xC${b+1} = xTexelC${b};
                    `:p+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<m&&(l%2===1?(p+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<m&&(p+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(p+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<m&&(p+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<m&&(p+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<m&&(p+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}p+=`
    }
  `,p+=`
      }
    `;let f="",y="";s&&(r?f=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?f=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:f=`vec4 activation(vec4 x) {
          ${s}
        }`,y="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${f}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${p}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Obe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c,dimRoundingMode:u}=s;let d=c;d==null&&(d=[1,1]),R(vs(o,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${d}'`);const m=ls(r.shape,a.shape,o,d,l,u,!0);let h;ie().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1?h=new Z5(m):h=new Y5(m);const p=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]];return n.runWebGLProgram(h,[r,a],"float32",p)}const Lbe={kernelName:_x,backendName:"webgl",kernelFunc:Obe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zbe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Bbe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,o=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ube(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,filterShape:d}=s,m=ls(r.shape,d,o,l,c,u,!0),h=new zbe(m);return n.runWebGLProgram(h,[r,a],"float32")}const Vbe={kernelName:w2,backendName:"webgl",kernelFunc:Ube};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wbe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{strides:o,dilations:l,pad:c,dimRoundingMode:u,inputShape:d}=s,m=ls(d,a.shape,o,l,c,u,!0),h=new Bbe(m);return n.runWebGLProgram(h,[r,a],"float32")}const jbe={kernelName:v2,backendName:"webgl",kernelFunc:Wbe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gbe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hbe(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],a=ue(s.shape),o=Me({inputs:{x:s},backend:n,attrs:{shape:[a]}}),l=new Gbe(a),c=n.runWebGLProgram(l,[o],o.dtype),u=Me({inputs:{x:c},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),u}const qbe={kernelName:n4,backendName:"webgl",kernelFunc:Hbe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kbe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:a,strideWidth:o,filterHeight:l,filterWidth:c,dilationHeight:u,dilationWidth:d}=e,{top:m,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${o});
      const ivec2 pads = ivec2(${m}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${l}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${d};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xbe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:o,pad:l,dilations:c}=s,u=Dp(r.shape,a.shape,o,l,"NHWC",c);let d;const m=new Kbe(u);d=n.runWebGLProgram(m,[r,a],"float32");const h=Me({inputs:{x:d},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(d),h}const Ybe={kernelName:Dx,backendName:"webgl",kernelFunc:Xbe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zbe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,a=e,{allDims:o,summedDims:l,idDims:c}=bk(r,a.length);vk(o.length,c,a);const{path:u,steps:d}=Ek(l,c),m=d.length;let h=null,p=o.length;const f=[];for(let y=0;y<m;++y){for(const x of d[y]){const{permutationIndices:g,expandDims:b}=wk(p,c[x]);let w;Nk(g)?w=a[x]:(w=Os({inputs:{x:a[x]},backend:n,attrs:{perm:g}}),f.push(w));const v=w.shape.slice();for(let E=0;E<b.length;++E)v.splice(b[E],0,1);zt(w.shape,v)||(w=Me({inputs:{x:w},backend:n,attrs:{shape:v}}),f.push(w)),h===null?h=w:(h=FS({inputs:{a:w,b:h},backend:n}),f.push(h))}y<m-1&&(u[y]>=0&&(h=Db({inputs:{x:h},backend:n,attrs:{axis:u[y]-(o.length-p),keepDims:!1}}),f.push(h)),p--)}for(const y of f)y!==h&&n.disposeIntermediateTensorInfo(y);return h}const Jbe={kernelName:k2,backendName:"webgl",kernelFunc:Zbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qbe=Dt({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`}),ewe={kernelName:Hh,backendName:"webgl",kernelFunc:Qbe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const twe="return (b >= 0.0) ? a : a * (b + 1.0);",nwe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,swe={kernelName:S2,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,a=ie().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Kd(nwe,s.shape,r.shape):new eu(twe,s.shape,r.shape);return n.runWebGLProgram(a,[s,r],s.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rwe=ds({opSnippet:"return float(a == b);",packedOpSnippet:`
  return vec4(equal(a, b));
`,dtype:"bool",cpuKernelImpl:Hge}),awe={kernelName:Px,backendName:"webgl",kernelFunc:rwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const owe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${dk};
  float a1 = ${mk};
  float a2 = ${hk};
  float a3 = ${pk};
  float a4 = ${fk};
  float a5 = ${gk};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,iwe=Dt({opSnippet:owe}),lwe={kernelName:qh,backendName:"webgl",kernelFunc:iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cwe=Xd+`
  return exp(x);
`,J5=Dt({opSnippet:cwe,packedOpSnippet:`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:qge,dtype:"float32"}),uwe={kernelName:Kh,backendName:"webgl",kernelFunc:J5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zS(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:a}=e,o=a.shape.length,l=a.shape.slice();let c=r;return r<0&&(R(-(o+1)<=r,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+r+1),l.splice(c,0,1),Me({inputs:{x:a},backend:s,attrs:{shape:l}})}const dwe={kernelName:Fx,backendName:"webgl",kernelFunc:zS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q5="return exp(x) - 1.0;",mwe=Dt({opSnippet:Q5,packedOpSnippet:Q5,cpuKernelImpl:Kge}),hwe={kernelName:Xh,backendName:"webgl",kernelFunc:mwe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ez{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=s?`${r}.0`:"1.0";let l;if(e==="real")l="return real * expR - imag * expI;";else if(e==="imag")l="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${l}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t,e,n){const s=n.texData.get(t.dataId),r=ue(t.shape),a=t.shape[t.shape.length-1],o=r/a,l=Me({inputs:{x:t},backend:n,attrs:{shape:[o,a]}}),c=l.shape,u=new ez("real",c,e),d=new ez("imag",c,e),m=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:c},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:c}],h=n.runWebGLProgram(u,m,"float32"),p=n.runWebGLProgram(d,m,"float32"),f=Il({inputs:{real:h,imag:p},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p);const y=Me({inputs:{x:f},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pwe(t){const{inputs:e,backend:n}=t,{input:s}=e;return tz(s,!1,n)}const fwe={kernelName:C2,backendName:"webgl",kernelFunc:pwe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gwe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vf(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:a}=n;if(a=a||pd(r),a==="string"){const o=Cn(a,ue(s));return o.fill(r),e.makeTensorInfo(s,a,o)}else{const o=new gwe(s,r),l=[[r]];return e.runWebGLProgram(o,[],a,l)}}const xwe={kernelName:I2,backendName:"webgl",kernelFunc:vf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ywe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bwe={kernelName:$2,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new ywe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nz="return floor(x);",wwe=Dt({opSnippet:nz,packedOpSnippet:nz,cpuKernelImpl:Xge}),vwe={kernelName:Yh,backendName:"webgl",kernelFunc:wwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ewe=ds({opSnippet:`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,packedOpSnippet:`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dtype:"int32"}),Nwe={kernelName:Zh,backendName:"webgl",kernelFunc:Ewe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kwe{constructor(e){this.variableNames=["A"];const n=Fs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Swe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Fs(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cwe={kernelName:jZ,backendName:"webgl",kernelFunc:Iwe};let Zd,BS=ie().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Iwe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:a}=s,o=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[c,u]=o?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=[u,c],m=[u,c,a];if(l||o){const y=ie().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Zd==null||y!==BS)&&(BS=y,Zd=document.createElement("canvas").getContext("2d",{willReadFrequently:BS})),Zd.canvas.width=c,Zd.canvas.height=u,Zd.drawImage(r,0,0,c,u),r=Zd.canvas}const h=n.makeTensorInfo(d,"int32");n.texData.get(h.dataId).usage=Mr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const p=ie().getBool("WEBGL_PACK")?new Swe(m):new kwe(m),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $we(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:d,dilations:m,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=s,y=hi(d),x=ls(r.shape,a.shape,c,m,u,h,!1,y);let g;const b=[],w=o!=null,v=l!=null,E=p==="leakyrelu",k=()=>{const I=[r,a],A=($,T)=>{if(T==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const F=Me({inputs:{x:$},backend:n,attrs:{shape:[$.shape[0],1,1]}});return b.push(F),F}return $};if(w&&I.push(A(o,d)),v&&I.push(A(l,d)),E){const $=n.makeTensorInfo([],"float32",al(f,"float32"));I.push($),b.push($)}return I};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))g=j5({x:r,filter:a,convInfo:x,backend:n,bias:o,activation:p,preluActivationWeights:l,leakyreluAlpha:f});else if(x.strideWidth<=2&&y==="channelsLast"&&ie().getBool("WEBGL_EXP_CONV")){const I=p?gf(p,!0):null,A=new W5(x,w,I,v,E),$=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],T=k();g=n.runWebGLProgram(A,T,"float32",$)}else if(ie().getBool("WEBGL_CONV_IM2COL"))g=G5({x:r,filter:a,convInfo:x,backend:n,bias:o,activation:p,preluActivationWeights:l,leakyreluAlpha:f});else{const I=p?gf(p,!1):null,A=new V5(x,w,I,v,E),$=k();g=n.runWebGLProgram(A,$,"float32")}const C=Me({inputs:{x:g},backend:n,attrs:{shape:x.outShape}});return b.push(g),b.forEach(I=>n.disposeIntermediateTensorInfo(I)),C}const Twe={kernelName:wy,backendName:"webgl",kernelFunc:$we};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Awe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:o,preluActivationWeights:l}=e,{strides:c,pad:u,dilations:d,dimRoundingMode:m,activation:h,leakyreluAlpha:p}=s,f=[];let y=d;y==null&&(y=[1,1]),R(vs(c,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${y}'`);const x=ls(r.shape,a.shape,c,y,u,m,!0),g=ie().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,b=h?gf(h,g):null,w=[r,a],v=o!=null,E=l!=null,k=h==="leakyrelu";if(v&&w.push(o),E&&w.push(l),k){const $=n.makeTensorInfo([],"float32",al(p,"float32"));w.push($),f.push($)}let C;g?C=new Z5(x,v,b,E,k):C=new Y5(x,v,b,E,k);const I=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],A=n.runWebGLProgram(C,w,"float32",I);return f.forEach($=>n.disposeIntermediateTensorInfo($)),A}const Rwe={kernelName:v4,backendName:"webgl",kernelFunc:Awe};class _we{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=Yt(s.length);let o=`
    int index;`;for(let l=0;l<this.sliceDim;l++)o+=`
          index = round(getIndices(coords[0], ${l}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[l]};
          flattenIndex += index * ${this.strides[l]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dwe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,a=r.shape,o=a[a.length-1],l=ue(s.shape),[c,u,d,m]=QN(s,r),h=Me({inputs:{x:r},backend:n,attrs:{shape:[u,o]}}),p=Me({inputs:{x:s},backend:n,attrs:{shape:[ue(s.shape)/d,d]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const g=n.readSync(r.dataId),b=n.bufferSync(s),w=Yge(g,b,s.dtype,u,o,d,m,s.shape,l);return n.makeTensorInfo(c,s.dtype,w.values)}const f=new _we(o,m,[u,d],s.shape),y=n.runWebGLProgram(f,[p,h],p.dtype),x=Me({inputs:{x:y},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),x}const Pwe={kernelName:s4,backendName:"webgl",kernelFunc:Dwe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fwe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=Yt(this.rank),r=Mwe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Mwe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:a}=e,{axis:o,batchDims:l}=s,c=Et(o,r.shape)[0];if(ie().get("DEBUG")){const b=n.readSync(a.dataId),w=r.shape[c];for(let v=0;v<b.length;++v){const E=b[v];R(E<=w-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${w-1}]`)}}const u=Ck(r,a,c,l),d=ue(a.shape),m=[],h=Me({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=Me({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,d/u.batchSize]}});m.push(h),m.push(p);const f=[u.batchSize,u.outerSize,d/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const b=n.bufferSync(p),w=n.bufferSync(h),v=Zge(w,b,f);return m.forEach(E=>n.disposeIntermediateTensorInfo(E)),n.makeTensorInfo(u.outputShape,v.dtype,v.values)}const y=new Fwe(h.shape,f),x=n.runWebGLProgram(y,[h,p],h.dtype);m.push(x);const g=Me({inputs:{x},backend:n,attrs:{shape:u.outputShape}});return m.forEach(b=>n.disposeIntermediateTensorInfo(b)),g}const Owe={kernelName:Ox,backendName:"webgl",kernelFunc:sz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lwe=ds({opSnippet:"return float(a > b);",packedOpSnippet:`
  return vec4(greaterThan(a, b));
`,cpuKernelImpl:Jge,dtype:"bool"}),zwe={kernelName:Lx,backendName:"webgl",kernelFunc:Lwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bwe=ds({opSnippet:"return float(a >= b);",packedOpSnippet:`
  return vec4(greaterThanEqual(a, b));
`,dtype:"bool",cpuKernelImpl:Qge}),Uwe={kernelName:Jh,backendName:"webgl",kernelFunc:Bwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vwe(t){const{inputs:e,backend:n}=t,{input:s}=e;return tz(s,!0,n)}const Wwe={kernelName:T2,backendName:"webgl",kernelFunc:Vwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jwe=Dt({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Gwe={kernelName:ep,backendName:"webgl",kernelFunc:jwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hwe=Dt({opSnippet:"return float(isinf(x));",dtype:"bool"}),qwe={kernelName:tp,backendName:"webgl",kernelFunc:Hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kwe=Dt({opSnippet:"return float(isnan(x));",dtype:"bool"}),Xwe={kernelName:np,backendName:"webgl",kernelFunc:Kwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ywe=ds({opSnippet:"return float(a < b);",packedOpSnippet:`
  return vec4(lessThan(a, b));
`,cpuKernelImpl:e0e,dtype:"bool"}),Zwe={kernelName:Bx,backendName:"webgl",kernelFunc:Ywe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jwe=ds({opSnippet:"return float(a <= b);",packedOpSnippet:`
  return vec4(lessThanEqual(a, b));
`,cpuKernelImpl:t0e,dtype:"bool"}),Qwe={kernelName:Ux,backendName:"webgl",kernelFunc:Jwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eve(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:a}=n,o=n0e(s,r,a);return e.makeTensorInfo([o.length],"float32",o)}const tve={kernelName:r4,backendName:"webgl",kernelFunc:eve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nve=Xd+`
  return x < 0.0 ? 0./0. : log(x);
`,sve=Dt({opSnippet:nve,packedOpSnippet:`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,cpuKernelImpl:s0e}),rve={kernelName:sp,backendName:"webgl",kernelFunc:sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ave=Xd+`
  return log(1.0 + x);
`,ove=Dt({opSnippet:ave}),ive={kernelName:rp,backendName:"webgl",kernelFunc:ove};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lve=ds({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dtype:"bool"}),cve={kernelName:Vx,backendName:"webgl",kernelFunc:lve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uve=Dt({opSnippet:"return float(!(x >= 1.0));"}),dve={kernelName:Wx,backendName:"webgl",kernelFunc:uve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mve=ds({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dtype:"bool"}),hve={kernelName:jx,backendName:"webgl",kernelFunc:mve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pve{constructor(e,n,s,r,a){this.variableNames=["x"],this.outputShape=[];const o=n,l=e[3]-1;this.outputShape=e;let c;const u=`float(${s}) + float(${r}) * sum`;a===.5?c=`inversesqrt(${u})`:a===1?c=`1.0/(${u})`:c=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${l}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fve{constructor(e,n,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,l=e[3]-1;this.outputShape=e;let c;const u=`float(${s}) + float(${r}) * sum`;a===.5?c=`inversesqrt(${u})`:a===1?c=`1.0/(${u})`:c=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${l}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gve={kernelName:Gx,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:a,bias:o,alpha:l,beta:c}=s,u=ie().getBool("WEBGL_PACK_NORMALIZATION")?new fve(r.shape,a,o,l,c):new pve(r.shape,a,o,l,c);return n.runWebGLProgram(u,[r],r.dtype)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xve{constructor(e,n,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yve={kernelName:R2,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:a,dy:o}=e,{depthRadius:l,bias:c,alpha:u,beta:d}=s,m=new xve(r.shape,l,c,u,d);return n.runWebGLProgram(m,[r,a,o],r.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bve(t,e,n,s){const r=ue(e),o=ue(t.shape)/r,l=Me({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),c=nu(l,t.dtype,"max",s),u=Me({inputs:{x:c},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(c),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:a,keepDims:o}=s,l=r.shape.length,c=Et(a,r.shape);let u=c;const d=yn(u,l),m=d!=null,h=n.shouldExecuteOnCPU([r]);let p=r;if(m){if(h){const w=n.texData.get(p.dataId).values,v=new Array(l);for(let C=0;C<v.length;C++)v[C]=r.shape[d[C]];const E=DS(w,r.shape,r.dtype,d,v);p=n.makeTensorInfo(v,r.dtype);const k=n.texData.get(p.dataId);k.values=E}else p=_b(r,d,n);u=$n(u.length,l)}cs("max",u,l);const[f,y]=Qn(p.shape,u);let x=f;o&&(x=On(f,c));let g;if(h){const w=n.texData.get(p.dataId).values,v=r0e(w,ue(y),x,r.dtype);g=n.makeTensorInfo(x,r.dtype);const E=n.texData.get(g.dataId);E.values=v}else g=bve(p,y,x,n);return m&&n.disposeIntermediateTensorInfo(p),g}const wve={kernelName:Hx,backendName:"webgl",kernelFunc:rz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vve=PS+`
  return max(a, b);
`,Eve=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+tu+`
  return result;
`,Nve=ds({opSnippet:vve,packedOpSnippet:Eve,cpuKernelImpl:a0e}),kve={kernelName:ap,backendName:"webgl",kernelFunc:Nve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;pf(r,"maxPool");const{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=s,u=1;R(vs(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=ra(r.shape,a,o,u,l,c);if(d.filterWidth===1&&d.filterHeight===1&&zt(d.inShape,d.outShape))return yr({inputs:{x:r},backend:n});const m=new xf(d,"max",!1);return n.runWebGLProgram(m,[r],r.dtype)}const Cve={kernelName:qx,backendName:"webgl",kernelFunc:Sve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ive(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=[1,1,1],m=mi(r.shape,a,o,d,l,u,c),h=new MS(m,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const $ve={kernelName:Kx,backendName:"webgl",kernelFunc:Ive};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tve{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,o=e.effectiveFilterWidth,l=a-1-e.padInfo.top,c=o-1-e.padInfo.left,u=a*o-1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ave{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,m=c-1-e.padInfo.front,h=u-1-e.padInfo.top,p=d-1-e.padInfo.left,f=c*u*d-1;this.userCode=`
      const ivec3 pads = ivec3(${m}, ${h}, ${p});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${f} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${d} +
                  wR * ${d} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,o=a,{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,m=[1,1,1],h=mi(o.shape,l,c,m,u,d),p=new MS(h,"max",!0),f=n.runWebGLProgram(p,[o],o.dtype),y=new Ave(h),x=n.runWebGLProgram(y,[r,f],o.dtype);return n.disposeIntermediateTensorInfo(f),x}const _ve={kernelName:D2,backendName:"webgl",kernelFunc:Rve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dve(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a,output:o}=e,l=a;pf([a,o],"maxPoolGrad");const{filterSize:c,strides:u,pad:d,dimRoundingMode:m}=s,h=ra(l.shape,c,u,1,d,m),p=!0,f=new xf(h,"max",p),y=n.runWebGLProgram(f,[l],l.dtype),x=new Tve(h),g=n.runWebGLProgram(x,[r,y],l.dtype);return n.disposeIntermediateTensorInfo(y),g}const Pve={kernelName:_2,backendName:"webgl",kernelFunc:Dve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fve(t,e,n,s){let r=new xf(n,"max",!1);const a=s.runWebGLProgram(r,[t],"float32");r=new xf(n,"max",!0,!0,e);const o=s.runWebGLProgram(r,[t],"float32");return[a,o]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mve={kernelName:a4,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:a,pad:o,includeBatchInIndex:l}=e,c=n;R(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];R(vs(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=ra(s.shape,r,a,u,o),[m,h]=Fve(s,l,d,c);return[m,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ove(t,e,n,s){const r=ue(e),o=ue(t.shape)/r,l=Me({inputs:{x:t},attrs:{shape:[o,r]},backend:s}),c=nu(l,"float32","mean",s),u=Me({inputs:{x:c},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(c),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lve={kernelName:Xx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:a}=e,o=n,l=s.shape.length,c=Et(a,s.shape);let u=c;const d=yn(u,l),m=d!=null,h=o.shouldExecuteOnCPU([s]),p=[];let f=s;if(m){if(h){const v=o.texData.get(f.dataId).values,E=new Array(l);for(let I=0;I<E.length;I++)E[I]=s.shape[d[I]];const k=DS(v,s.shape,s.dtype,d,E);f=o.makeTensorInfo(E,s.dtype);const C=o.texData.get(f.dataId);C.values=k}else f=_b(s,d,o);p.push(f),u=$n(u.length,l)}cs("sum",u,l);const[y,x]=Qn(f.shape,u);let g=y;r&&(g=On(y,c));const b=Ove(f,x,g,o);for(const w of p)o.disposeIntermediateTensorInfo(w);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zve(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=Et(a,r.shape);let u=c;const d=yn(u,l);let m=r;d!=null&&(m=Os({inputs:{x:r},backend:n,attrs:{perm:d}}),u=$n(u.length,r.shape.length)),cs("min",u,l);const[h,p]=Qn(m.shape,u),f=ue(p),y=Me({inputs:{x:m},backend:n,attrs:{shape:[-1,f]}}),x=nu(y,y.dtype,"min",n);let g;if(o){const b=On(h,c);g=Me({inputs:{x},backend:n,attrs:{shape:b}})}else g=Me({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),d!=null&&n.disposeIntermediateTensorInfo(m),g}const Bve={kernelName:Yx,backendName:"webgl",kernelFunc:zve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uve=PS+`
  return min(a, b);
`,Vve=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+tu+`
  return result;
`,Wve=ds({opSnippet:Uve,packedOpSnippet:Vve,cpuKernelImpl:o0e}),jve={kernelName:op,backendName:"webgl",kernelFunc:Wve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gve{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((d,m)=>d[0]+e[m]+d[1]);const r=e.length,a=Yt(r),o=n.map(d=>d[0]).join(","),l=n.map((d,m)=>d[0]+e[m]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${o};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hve{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((f,y)=>f[0]+e[y]+f[1]);const r=e.length,a=Yt(r),o=n.map(f=>f[0]).join(","),l=n.map((f,y)=>f[0]+e[y]).join(","),c=Ms("rc",r),u=Ms("source",r),d=`${c[r-1]} < ${this.outputShape[r-1]}`,m=r===1?"source":`vec2(${u.slice(-2).join()})`,h=s==="reflect"?0:1;let p="";if(r===1){const f=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${m});
        ${c[r-1]} += 1;
        if(${d}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${m});
        }
      `}else{const f=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;p=`
        ${a} rc = outputLoc;
        ${f}
        result[0] = getChannel(getX(${u.join()}), ${m});
        ${c[r-1]} += 1;
        if(${d}) {
          ${f}
          result[1] = getChannel(getX(${u.join()}), ${m});
        }
        rc = outputLoc;
        ${c[r-2]} += 1;
        if(${c[r-2]} < ${this.outputShape[r-2]}) {
          ${f}
          result[2] = getChannel(getX(${u.join()}), ${m});
          ${c[r-1]} += 1;
          if(${d}) {
            ${f}
            result[3] = getChannel(getX(${u.join()}), ${m});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qve={kernelName:Zx,backendName:"webgl",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:a}=n,o=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hve(s.shape,r,a):new Gve(s.shape,r,a);return e.runWebGLProgram(o,[s],s.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kve=`if (b == 0.0) return NAN;
  return mod(a, b);`,Xve=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+tu+`
  return result;
`,Yve=ds({opSnippet:Kve,packedOpSnippet:Xve}),Zve={kernelName:ip,backendName:"webgl",kernelFunc:Yve};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jve{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const az=ds({opSnippet:`
if (a == b) {
  return 1.0;
};
return a / b;`,packedOpSnippet:`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,checkOutOfBounds:!0}),Qve={kernelName:Gh,backendName:"webgl",kernelFunc:az};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oz="return a - b;",iz=ds({opSnippet:oz,packedOpSnippet:oz,supportsComplex:!0,cpuKernelImpl:I0e}),e1e={kernelName:Np,backendName:"webgl",kernelFunc:iz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:a}=s,o=Et([a],r.shape),l=rz({inputs:{x:r},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),c=On(l.shape,o),u=Me({inputs:{x:l},backend:n,attrs:{shape:c}}),d=iz({inputs:{a:r,b:u},backend:n}),m=J5({inputs:{x:d},backend:n}),h=Db({inputs:{x:m},backend:n,attrs:{axis:o,keepDims:!1}}),p=Me({inputs:{x:h},backend:n,attrs:{shape:c}}),f=az({inputs:{a:m,b:p},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}const t1e={kernelName:fy,backendName:"webgl",kernelFunc:lz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n1e(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:a,seed:o,normalized:l}=s,c=l?r:lz({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),u=c.shape[0],d=c.shape[1],m=new Jve(u,d,a),h=[[o]],p=n.runWebGLProgram(m,[c],"int32",h);return l||n.disposeIntermediateTensorInfo(c),p}const s1e={kernelName:o4,backendName:"webgl",kernelFunc:n1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r1e=ha+`
  return -x;
`,a1e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function o1e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const a=n.texData.get(s.dataId),[o,l]=l0e(a.values,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,o)}let r;return ie().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Cl(s.shape,a1e):r=new $o(s.shape,r1e),n.runWebGLProgram(r,[s],s.dtype)}const i1e={kernelName:Jx,backendName:"webgl",kernelFunc:o1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1e=qN;function c1e(t){Rr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=s,u=n.readSync(r.dataId),d=n.readSync(a.dataId),{selectedIndices:m}=l1e(u,d,o,l,c);return n.makeTensorInfo([m.length],"int32",new Int32Array(m))}const u1e={kernelName:P2,backendName:"webgl",kernelFunc:c1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d1e=KN;function m1e(t){Rr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=s,d=n.readSync(r.dataId),m=n.readSync(a.dataId),{selectedIndices:h,validOutputs:p}=d1e(d,m,o,l,c,u);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}const h1e={kernelName:F2,backendName:"webgl",kernelFunc:m1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p1e=XN;function f1e(t){Rr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=s,d=n.readSync(r.dataId),m=n.readSync(a.dataId),h=o,p=l,f=c,y=u,{selectedIndices:x,selectedScores:g}=p1e(d,m,h,p,f,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const g1e={kernelName:M2,backendName:"webgl",kernelFunc:f1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x1e{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y1e={kernelName:ty,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:a,depth:o,onValue:l,offValue:c}=s,u=ue(r.shape),d=new x1e(u,o,l,c),m=Me({inputs:{x:r},backend:n,attrs:{shape:[u]}}),h=n.runWebGLProgram(d,[m],a);n.disposeIntermediateTensorInfo(m);const p=[...r.shape,o],f=Me({inputs:{x:h},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(h),f}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zb(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=yf({inputs:{input:s},backend:n}),a=zb({inputs:{x:r},backend:n}),o=Ob({inputs:{input:s},backend:n}),l=zb({inputs:{x:o},backend:n}),c=Il({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}else return vf({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const b1e={kernelName:yy,backendName:"webgl",kernelFunc:zb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=yf({inputs:{input:s},backend:n}),a=cz({inputs:{x:r},backend:n}),o=Ob({inputs:{input:s},backend:n}),l=zb({inputs:{x:o},backend:n}),c=Il({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}else return vf({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const w1e={kernelName:ey,backendName:"webgl",kernelFunc:cz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v1e(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return zS({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const a=e[0].shape,o=e[0].dtype;e.forEach(d=>{YE(a,d.shape,"All tensors passed to stack must have matching shapes"),R(o===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],c=e.map(d=>{const m=zS({inputs:{input:d},backend:n,attrs:{dim:r}});return l.push(m),m}),u=U5({inputs:c,backend:n,attrs:{axis:r}});return l.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const E1e={kernelName:ny,backendName:"webgl",kernelFunc:v1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N1e{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,a=Yt(r),o=n.map(u=>u[0]).join(","),l=n.map((u,d)=>u[0]+e[d]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${o};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${o});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k1e{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((y,x)=>y[0]+e[x]+y[1]);const r=e.length,a=Yt(r),o=n.map(y=>y[0]).join(","),l=n.map((y,x)=>y[0]+e[x]).join(","),c=Ms("rc",r),u=Ms("source",r),d=`${c[r-1]} < ${this.outputShape[r-1]}`,m=r===1?"source":`vec2(${u.slice(-2).join()})`,h=[`${a} rc = outputLoc;`,`${c[r-1]} += 1;
       if(${d}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${c[r-2]} += 1;
       if(${c[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${c[r-1]} += 1;
         if(${d}) {`],p=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let f="";for(let y=0,x=r===1?2:4;y<x;y++)f+=`
        ${h[y]}
        if (${p}) {
          result[${y}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${y}] = getChannel(getX(${u.join()}), ${m});
        }
      `;f+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${o});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uz=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,constantValue:o}=s;if(ue(r.shape)===0){const u=a.map((d,m)=>d[0]+r.shape[m]+d[1]);return vf({backend:n,attrs:{shape:u,value:o,dtype:r.dtype}})}const l=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new k1e(r.shape,a,o):new N1e(r.shape,a,o),c=[[o]];return n.runWebGLProgram(l,[r],r.dtype,c)},S1e={kernelName:sy,backendName:"webgl",kernelFunc:uz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C1e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,I1e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+tu+`
  return result;
`,$1e=ds({opSnippet:C1e,packedOpSnippet:I1e}),T1e={kernelName:cp,backendName:"webgl",kernelFunc:$1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:o}=s,l=r.shape.length,c=[],u=Et(a,r.shape);let d=u;const m=yn(d,l);let h=r;m!=null&&(h=Os({inputs:{x:r},backend:n,attrs:{perm:m}}),d=$n(d.length,l),c.push(h)),cs("prod",d,l);let p;if(n.shouldExecuteOnCPU([h])){const f=n.texData.get(h.dataId).values,{outVals:y,outShape:x,outDtype:g}=u0e(h.shape,h.dtype,f,d);p=n.makeTensorInfo(x,g,y)}else{const[f,y]=Qn(h.shape,d),x=ue(y),g=Me({inputs:{x:h},backend:n,attrs:{shape:[-1,x]}}),b=sN(r.dtype),w=nu(g,b,"prod",n);p=Me({inputs:{x:w},backend:n,attrs:{shape:f}}),c.push(g),c.push(w)}if(o){c.push(p);const f=On(p.shape,u);p=Me({inputs:{x:p},backend:n,attrs:{shape:f}})}return c.forEach(f=>n.disposeIntermediateTensorInfo(f)),p}const R1e={kernelName:ay,backendName:"webgl",kernelFunc:A1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _1e(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:a,indices:o}=e,{outputRaggedRank:l}=s,c=r.map(g=>n.readSync(g.dataId)),u=r.map(g=>g.shape),d=n.readSync(a.dataId),m=n.readSync(o.dataId),[h,p,f]=d0e(c,u,d,a.shape,a.dtype,m,o.shape,l),y=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),x=n.makeTensorInfo(f,a.dtype,p);return y.concat([x])}const D1e={kernelName:i4,backendName:"webgl",kernelFunc:_1e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P1e(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:a}=e,o=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),[u,d]=m0e(o,s.shape,s.dtype,l,r.shape,c,a.shape),m=n.makeTensorInfo([u.length],"int32",u),h=n.makeTensorInfo([d.length],s.dtype,d);return[m,h]}const F1e={kernelName:l4,backendName:"webgl",kernelFunc:P1e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1e(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:a,defaultValue:o,rowPartitionTensors:l}=e,{rowPartitionTypes:c}=s,u=n.readSync(r.dataId),d=n.readSync(a.dataId),m=n.readSync(o.dataId),h=l.map(x=>n.readSync(x.dataId)),p=l.map(x=>x.shape),[f,y]=h0e(u,r.shape,d,a.shape,a.dtype,m,o.shape,h,p,c);return n.makeTensorInfo(f,a.dtype,y)}const O1e={kernelName:c4,backendName:"webgl",kernelFunc:M1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dz=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:a,dtype:o}=n,l=p0e(s,r,a,o);return e.makeTensorInfo([l.length],o,l)},L1e={kernelName:O2,backendName:"webgl",kernelFunc:dz};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z1e=Dt({opSnippet:"return 1.0 / x;"}),B1e={kernelName:up,backendName:"webgl",kernelFunc:z1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U1e=ha+`
  return (x < 0.0) ? 0.0 : x;
`,V1e=Dt({opSnippet:U1e,packedOpSnippet:`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),W1e={kernelName:dp,backendName:"webgl",kernelFunc:V1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j1e=ha+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,G1e=Dt({opSnippet:j1e,packedOpSnippet:`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),H1e={kernelName:mp,backendName:"webgl",kernelFunc:G1e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q1e{constructor(e,n,s,r,a){this.variableNames=["A"],this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,n,s,u];const d=[r&&n>1?l-1:l,r&&s>1?c-1:c],m=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;a?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/m[0]},
          ${d[1]/m[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K1e{constructor(e,n,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,n,s,u];const d=[r&&n>1?l-1:l,r&&s>1?c-1:c],m=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;a?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/m[0]},
          ${d[1]/m[1]},
          ${d[1]/m[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X1e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s,[c,u]=l,d=ie().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new K1e(r.shape,c,u,a,o):new q1e(r.shape,c,u,a,o);return n.runWebGLProgram(d,[r],"float32")}const Y1e={kernelName:ly,backendName:"webgl",kernelFunc:X1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z1e{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,a]=n,[,o,l]=e,c=[s&&o>1?r-1:r,s&&l>1?a-1:a],u=[s&&o>1?o-1:o,s&&l>1?l-1:l],d=c[0]/u[0],m=c[1]/u[1],h=1/d,p=1/m,f=Math.ceil(h)*2+2,y=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${m});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J1e(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:o}=s,l=new Z1e(a.shape,r.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}const Q1e={kernelName:B2,backendName:"webgl",kernelFunc:J1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eEe{constructor(e,n,s,r,a){this.variableNames=["A"],this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,n,s,u];const d=[r&&n>1?l-1:l,r&&s>1?c-1:c],m=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let p;a?p="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/m[0]},
          ${d[1]/m[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tEe{constructor(e,n,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,l,c,u]=e;this.outputShape=[o,n,s,u];const d=[r&&n>1?l-1:l,r&&s>1?c-1:c],m=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let p;a?p="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/m[0]},
          ${d[1]/m[1]},
          ${d[1]/m[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nEe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:o,size:l}=s,[c,u]=l,d=ie().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new tEe(r.shape,c,u,a,o):new eEe(r.shape,c,u,a,o);return n.runWebGLProgram(d,[r],r.dtype)}const sEe={kernelName:iy,backendName:"webgl",kernelFunc:nEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rEe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,a]=n,[,o,l]=e,c=[s&&o>1?r-1:r,s&&l>1?a-1:a],u=[s&&o>1?o-1:o,s&&l>1?l-1:l],d=c[0]/u[0],m=c[1]/u[1],h=1/d,p=1/m,f=Math.ceil(h)*2+2,y=Math.ceil(p)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${m});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${p});

        const int winHeight = int(${f});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aEe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:o}=s,l=new rEe(a.shape,r.shape,o);return n.runWebGLProgram(l,[a],a.dtype)}const oEe={kernelName:z2,backendName:"webgl",kernelFunc:aEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iEe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=l=>n.indexOf(l)!==-1&&e[l]!==1?`${e[l]} - coords[${l}] - 1`:`coords[${l}]`,a=e.map((l,c)=>r(c)).join(","),o=Yt(s);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lEe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Ms("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,o=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,l=Yt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${l} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(r.slice())};
          if(${a}){
            result.g = ${u(r.slice())};
          }
          if(${o}) {
            result.b = ${d(r.slice())};
            if(${a}) {
              result.a = ${m(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(f){return h(f)}function u(f){return f[s-1]="("+f[s-1]+" + 1)",h(f)}function d(f){return f[s-2]="("+f[s-2]+" + 1)",h(f)}function m(f){return f[s-1]="("+f[s-1]+" + 1)",f[s-2]="("+f[s-2]+" + 1)",h(f)}function h(f){const y=e.map((b,w)=>p(w,f)),x=y.join(","),g=y.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${g}))`}function p(f,y){return n.indexOf(f)!==-1&&e[f]!==1?`${e[f]} - ${y[f]} - 1`:`${y[f]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:a}=s,o=r.shape.length,l=Et(a,r.shape);if(o===0)return yr({inputs:{x:r},backend:n});const c=ie().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lEe(r.shape,l):new iEe(r.shape,l);return n.runWebGLProgram(c,[r],r.dtype)}const uEe={kernelName:cy,backendName:"webgl",kernelFunc:cEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dEe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let a="";typeof n=="number"?a=`float outputValue = ${n.toFixed(2)};`:a=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mEe={kernelName:q2,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:a,center:o}=e,l=n,c=new dEe(s.shape,a),[u,d]=lk(o,s.shape[1],s.shape[2]),m=[[u,d,Math.sin(r),Math.cos(r)]];return l.runWebGLProgram(c,[s],s.dtype,m)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hEe=Dt({opSnippet:`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`}),pEe={kernelName:hp,backendName:"webgl",kernelFunc:hEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fEe=Dt({opSnippet:"return inversesqrt(x);",cpuKernelImpl:f0e}),gEe={kernelName:pp,backendName:"webgl",kernelFunc:fEe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class US{constructor(e,n,s,r,a,o,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const u=Yt(a.length),d=Yt(o.length);let m="";s===1?m="i":s===2&&(m="i, j");const h=`getIndices(${m})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let y="";c&&(y="coords[0], coords[1]");const x=`getDefaultValue(${y})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xEe{constructor(e,n,s,r,a,o,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o;const u=Yt(a.length),d=Yt(o.length);let m="";s===1?m="i":s===2&&(m="i, j");const h=`getIndices(${m})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const f=`getUpdates(${p})`;let y="";c&&(y="coords[0], coords[1]");const x=`getDefaultValue(${y})`,g=n>1?"strides[j]":"strides",b=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${d} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${b};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${f};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yEe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:a}=e,{shape:o}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:m}=zc(a,r,o),h=[m/u,u];if(m===0)return n.makeTensorInfo(o,r.dtype);const p=Me({inputs:{x:r},backend:n,attrs:{shape:[c,l]}}),f=Me({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;ie().getBool("WEBGL_PACK")?x=new xEe(c,l,p.shape.length,f.shape.length,d,h):x=new US(c,l,p.shape.length,f.shape.length,d,h);const g=n.runWebGLProgram(x,[f,p,y],f.dtype),b=Me({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}const bEe={kernelName:u4,backendName:"webgl",kernelFunc:yEe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wEe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const a="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,l=ie().getNumber("WEBGL_VERSION")===2?a:o,c=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${l}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${c} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vEe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:a}=e,{side:o}=s,l=new wEe(r.shape[0],r.shape[1],a.shape[1],o),c=[[r.shape[1]]];return n.runWebGLProgram(l,[r,a],"int32",c)}const EEe={kernelName:m4,backendName:"webgl",kernelFunc:vEe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NEe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],u=[];for(let d=0;d<n.length;d++)u.push(`${l[d]}`),d<e&&c.push(`${l[d]}`);r=c.join(),a=u.join()}const o=Yt(s);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kEe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:a}=e,o=new NEe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(o,[s,r,a],pr(r.dtype,a.dtype))}const SEe={kernelName:uy,backendName:"webgl",kernelFunc:kEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CEe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Wy};
  float scale = ${jy};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,IEe=Dt({opSnippet:CEe}),$Ee={kernelName:fp,backendName:"webgl",kernelFunc:IEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TEe=Xd+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,AEe=Dt({opSnippet:TEe,packedOpSnippet:`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:x0e}),REe={kernelName:bp,backendName:"webgl",kernelFunc:AEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ee=Dt({opSnippet:`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`}),DEe={kernelName:yp,backendName:"webgl",kernelFunc:_Ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PEe=Xd+`
  return sin(x);
`,FEe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${tu}
  return result;
`,MEe=Dt({opSnippet:PEe,packedOpSnippet:FEe}),OEe={kernelName:gp,backendName:"webgl",kernelFunc:MEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LEe=Dt({opSnippet:`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`}),zEe={kernelName:xp,backendName:"webgl",kernelFunc:LEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BEe=Dt({opSnippet:`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`}),UEe={kernelName:wp,backendName:"webgl",kernelFunc:BEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VEe={kernelName:hy,backendName:"webgl",kernelFunc:t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,paddings:o}=s;R(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((g,b)=>g*b),c=[[0,0]];c.push(...o);for(let g=1+a.length;g<r.shape.length;++g)c.push([0,0]);const u=[],d=uz({inputs:{x:r},backend:n,attrs:{paddings:c,constantValue:0}}),m=jp(d.shape,a,l,!1),h=Gp(m.length,a.length,!1),p=Hp(d.shape,a,l,!1),f=Me({inputs:{x:d},backend:n,attrs:{shape:m}}),y=Os({inputs:{x:f},backend:n,attrs:{perm:h}}),x=Me({inputs:{x:y},backend:n,attrs:{shape:p}});return u.push(d),u.push(f),u.push(y),u.forEach(g=>n.disposeIntermediateTensorInfo(g)),x}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WEe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:a,defaultValue:o}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const l=n.readSync(s.dataId),c=n.readSync(r.dataId),u=n.readSync(a.dataId),d=n.readSync(o.dataId)[0],[m,h,p,f,y]=b0e(l,s.shape,s.dtype,c,r.dtype,u,d);return[n.makeTensorInfo(h,s.dtype,m),n.makeTensorInfo([h[0]],r.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(x=>Number(x)))),n.makeTensorInfo([y.length],s.dtype,new Int32Array(y))]}const jEe={kernelName:h4,backendName:"webgl",kernelFunc:WEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GEe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const o=Array.from(n.readSync(r.dataId)),l=n.readSync(s.dataId),c=Array.from(n.readSync(a.dataId)),[u,d,m]=w0e(l,s.shape,s.dtype,o,c);return[n.makeTensorInfo(d,s.dtype,u),n.makeTensorInfo([m.length],a.dtype,new Int32Array(m))]}const HEe={kernelName:p4,backendName:"webgl",kernelFunc:GEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qEe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const o=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),[u,d]=g5(o,s.shape,s.dtype,l,c,!0);return n.makeTensorInfo(d,s.dtype,u)}const KEe={kernelName:f4,backendName:"webgl",kernelFunc:qEe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XEe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const o=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),[u,d]=g5(o,s.shape,s.dtype,l,c);return n.makeTensorInfo(d,s.dtype,u)}const YEe={kernelName:g4,backendName:"webgl",kernelFunc:XEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZEe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:a,defaultValue:o}=e,{outputShape:l}=s,{sliceRank:c,numUpdates:u,sliceSize:d,strides:m,outputSize:h}=zc(a,r,l),p=!1;if(a.dtype==="string"){const g=n.bufferSync(r),b=n.bufferSync(a),w=il(n.readSync(o.dataId)[0]),v=g0e(g,b,l,h,d,u,c,m,w,p);return n.makeTensorInfo(l,v.dtype,v.values)}const f=new US(u,c,r.shape.length,a.shape.length,m,[h,1],p),y=n.runWebGLProgram(f,[a,r,o],a.dtype),x=Me({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(y),x}const JEe={kernelName:x4,backendName:"webgl",kernelFunc:ZEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QEe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:a,axis:o}=s,l=Et(o,r.shape)[0],c=kk(r,a,l),u=r.shape.length,d=new Array(u).fill(0),m=r.shape.slice();return c.map(h=>{const p=[...m];p[l]=h;const f=Yd({inputs:{x:r},backend:n,attrs:{begin:d,size:p}});return d[l]+=h,f})}const e2e={kernelName:py,backendName:"webgl",kernelFunc:QEe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mz="return sqrt(x);",t2e=Dt({opSnippet:mz,packedOpSnippet:mz,cpuKernelImpl:v0e}),n2e={kernelName:vp,backendName:"webgl",kernelFunc:t2e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s2e=Dt({opSnippet:"return x * x;"}),r2e={kernelName:U2,backendName:"webgl",kernelFunc:s2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hz="return (a - b) * (a - b);",a2e=ds({opSnippet:hz,packedOpSnippet:hz}),o2e={kernelName:Ep,backendName:"webgl",kernelFunc:a2e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=n.readSync(r.dataId),o=yi(a),l=E0e(o,"string",s);return n.makeTensorInfo(r.shape,"string",l)}const l2e={kernelName:V2,backendName:"webgl",kernelFunc:i2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c2e({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=ha+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new $o(s.shape,r);return n.runWebGLProgram(a,[s],s.dtype)}const u2e={kernelName:Ip,backendName:"webgl",kernelFunc:c2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d2e{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=Yt(s.length),o=Yt(s.length);let l="";if(r===1)l="coords * strides + begin";else{let c=0;l=s.map((u,d)=>(c++,s.length===1?`coords * strides[${d}] + begin[${d}]`:`coords[${c-1}] * strides[${d}] + begin[${d}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,end:o,strides:l,beginMask:c,endMask:u,ellipsisMask:d,newAxisMask:m,shrinkAxisMask:h}=s,{finalShapeSparse:p,finalShape:f,isIdentity:y,sliceDim0:x,isSimpleSlice:g,begin:b,end:w,strides:v}=ak(r.shape,a,o,l,c,u,d,m,h);let E;if(y)E=Me({inputs:{x:r},backend:n,attrs:{shape:f}});else if(x||g){R(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=nk(b,w,v),I=Yd({inputs:{x:r},backend:n,attrs:{begin:b,size:C}});E=Me({inputs:{x:I},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([r])){const I=n.readSync(r.dataId),A=Nt(r.shape,r.dtype,I),$=N0e(p,A,v,b);E=n.makeTensorInfo(f,r.dtype,$.values)}else{const I=new d2e(b,v,p);E=n.runWebGLProgram(I,[r],r.dtype)}const k=Me({inputs:{x:E},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(E),k}const h2e={kernelName:W2,backendName:"webgl",kernelFunc:m2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2e(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:a,leftPad:o,rightPad:l,padWidth:c,preserveShortSequences:u}=s,{data:d,dataSplits:m}=e,h=n.readSync(d.dataId),p=n.readSync(m.dataId),[f,y]=k0e(h,p,r,a,o,l,c,u);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(m.shape,"int32",y)]}const f2e={kernelName:y4,backendName:"webgl",kernelFunc:p2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2e(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:a,delimiter:o}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const l=n.readSync(a.dataId),c=n.readSync(o.dataId)[0],[u,d,m]=S0e(l,c,r),h=d.length;return[n.makeTensorInfo([h,2],"int32",u),n.makeTensorInfo([h],"string",d),n.makeTensorInfo([2],"int32",new Int32Array(m))]}const x2e={kernelName:b4,backendName:"webgl",kernelFunc:g2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y2e(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(a.dataId),l=C0e(o,r);return n.makeTensorInfo(a.shape,"int32",l)}const b2e={kernelName:w4,backendName:"webgl",kernelFunc:y2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w2e=Dt({opSnippet:"return tan(x);"}),v2e={kernelName:kp,backendName:"webgl",kernelFunc:w2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E2e=Dt({opSnippet:`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`}),N2e={kernelName:Sp,backendName:"webgl",kernelFunc:E2e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2e(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:a,updates:o}=e,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:m}=zc(o,a,r.shape),h=[m/u,u];if(m===0)return n.makeTensorInfo(r.shape,a.dtype);const p=Me({inputs:{x:a},backend:n,attrs:{shape:[c,l]}}),f=Me({inputs:{x:o},backend:n,attrs:{shape:[c,u]}}),y=Me({inputs:{x:r},backend:n,attrs:{shape:h}}),x=new US(c,l,p.shape.length,f.shape.length,d,h,!1,!0),g=n.runWebGLProgram(x,[f,p,y],y.dtype),b=Me({inputs:{x:g},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}const S2e={kernelName:d4,backendName:"webgl",kernelFunc:k2e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C2e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let o=0;o<s.length;o++)s[o]=e[o]*n[o];this.outputShape=s,this.rank=s.length;const r=Yt(this.rank),a=I2e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function I2e(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const c=n.readSync(r.dataId),u=r.dtype==="string"?c.map(h=>il(h)):c,d=Nt(r.shape,r.dtype,u),m=$0e(d,a);return n.makeTensorInfo(m.shape,m.dtype,m.values)}const o=new C2e(r.shape,a);return n.runWebGLProgram(o,[r],r.dtype)}const $2e={kernelName:Cp,backendName:"webgl",kernelFunc:pz};class T2e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class A2e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function su(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function fz(t){let e=1;for(;e<t;)e*=2;return e}function R2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:a,sorted:o}=s,l=ie().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=ie().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,d=u[u.length-1];if(n.shouldExecuteOnCPU([r])||d<l||a>c){const $=n.readSync(r.dataId),[T,F]=T0e($,u,r.dtype,a,o);return[n.makeTensorInfo(T.shape,T.dtype,T.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(a===0)return u[u.length-1]=0,[n.makeTensorInfo(u,r.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(d===1)return[r,vf({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const m=n.texData.get(r.dataId),h=m!==null&&m.isPacked,p=h?n.unpackTensor(r):r,y=ue(u)/d,x=Me({inputs:{x:p},attrs:{shape:[y,d]},backend:n});h&&su(n,p);const g=fz(a),b=fz(d);let w=null;const v=()=>w===null?[x,x]:[x,w],E=($,T,F)=>{const O=v(),M=new T2e(F),L=[[d],[w===null?1:0],[Number.NEGATIVE_INFINITY],[$],[T]],Y=w;w=n.runWebGLProgram(M,O,"int32",L),su(n,Y)};for(let $=1;$<g;$*=2){const T=$*2;for(let F=$;F>=1;F/=2)E(T,F,[y,b])}for(let $=b;$>g;$/=2){const T=v(),F=new A2e([y,$/2]),M=[[d],[w===null?1:0],[g]],B=w;w=n.runWebGLProgram(F,T,"int32",M),su(n,B);const L=g/2,Y=L*2;for(let D=L;D>=1;D/=2)E(Y,D,w.shape)}let k=w;w=Yd({inputs:{x:w},backend:n,attrs:{begin:0,size:[y,a]}}),su(n,k);let C=sz({inputs:{x,indices:w},backend:n,attrs:{axis:1,batchDims:1}});su(n,x);const I=u.slice(0,-1);I.push(a),k=w,w=Me({inputs:{x:w},attrs:{shape:I},backend:n}),su(n,k);const A=C;return C=Me({inputs:{x:C},attrs:{shape:I},backend:n}),su(n,A),[C,w]}const _2e={kernelName:j2,backendName:"webgl",kernelFunc:R2e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D2e{constructor(e,n,s,r,a,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const l=s==="nearest"?1:2;let c;switch(r){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${c} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${l} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:a}=e,{interpolation:o,fillMode:l,fillValue:c,outputShape:u}=s,[d,m,h,p]=r.shape,[f,y]=u??[m,h],x=[d,f,y,p],g=new D2e(m,h,o,l,c,x);return n.runWebGLProgram(g,[r,a],"float32")}const F2e={kernelName:G2,backendName:"webgl",kernelFunc:P2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:a}=e;pf(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=s.readSync(a.dataId),{outputValues:l,outputShape:c,indices:u}=A0e(o,r,a.shape,a.dtype);return[s.makeTensorInfo(c,a.dtype,l),s.makeTensorInfo([u.length],"int32",u)]}const O2e={kernelName:H2,backendName:"webgl",kernelFunc:M2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const o=r,l=o.shape.length,c=r.shape[a],u=new Array(l-1);let d=0;for(let y=0;y<l;y++)y!==a&&(u[d++]=o.shape[y]);const m=[],h=new Array(l).fill(0),p=o.shape.slice();p[a]=1;const f=new Array(c);for(let y=0;y<f.length;y++){h[a]=y;const x=Yd({inputs:{x:o},backend:n,attrs:{begin:h,size:p}}),g=Me({inputs:{x},backend:n,attrs:{shape:u}});f[y]=g,m.push(x)}return m.forEach(y=>n.disposeIntermediateTensorInfo(y)),f}const z2e={kernelName:gy,backendName:"webgl",kernelFunc:L2e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B2e{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,a=e.inSize,o=e.numSegments,l=o*Math.ceil(a/s);this.outputShape=[r,l];const c="0.0",u="sumValue",d=Math.floor(s/4)*4,m=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let p="";a%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let f="";a%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${f}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${d};
        if (${m===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${m===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${m===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:a}=e,{numSegments:o}=s,l=r.shape.length,c=[];let u=0;const d=yn([u],l);let m=r;d!=null&&(m=Os({inputs:{x:r},backend:n,attrs:{perm:d}}),c.push(m),u=$n(1,l)[0]);const h=UP(m.shape,u,o),p=ue([m.shape[u]]),f=Me({inputs:{x:m},backend:n,attrs:{shape:[-1,p]}});c.push(f);const y=sN(r.dtype),x=(v,E,k,C,I)=>{const A=v.shape[0],$=v.shape[1],T=BP($,I),F={windowSize:T,inSize:$,batchSize:A,numSegments:I},O=new B2e(F,E),M=n.compileAndRun(O,[v,k],C);if(c.push(M),M.shape[1]===I)return M;const B=dz({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),L=pz({inputs:{x:B},backend:n,attrs:{reps:[$/T]}});return c.push(B),c.push(L),x(M,E,L,C,I)},g=x(f,"unsortedSegmentSum",a,y,o),b=Me({inputs:{x:g},backend:n,attrs:{shape:h}});let w=b;if(d!=null){c.push(b);const v=dl(d);w=Os({inputs:{x:w},backend:n,attrs:{perm:v}})}return c.forEach(v=>n.disposeIntermediateTensorInfo(v)),w}const V2e={kernelName:xy,backendName:"webgl",kernelFunc:U2e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W2e=[vxe,Nxe,Cxe,Txe,Rxe,Pxe,Mxe,Lxe,Vxe,jxe,qxe,Yxe,Qxe,sye,oye,lye,uye,pye,gye,yye,vye,Iye,Tye,Dye,Fye,Bye,Vye,Hye,rxe,Xye,ebe,rbe,ube,hbe,fbe,xbe,bbe,Nbe,Sbe,Ibe,Tbe,Rbe,Dbe,Mbe,Lbe,Vbe,jbe,qbe,Ybe,Jbe,ewe,swe,awe,lwe,uwe,dwe,hwe,fwe,xwe,bwe,vwe,Nwe,Cwe,Twe,Rwe,Pwe,Owe,zwe,Uwe,sxe,Wwe,Jye,Gwe,qwe,Xwe,oxe,Zwe,Qwe,tve,rve,ive,cve,dve,hve,gve,yve,wve,kve,Cve,$ve,_ve,Pve,Mve,Lve,Bve,jve,qve,Zve,s1e,cxe,i1e,u1e,h1e,g1e,Mye,y1e,w1e,E1e,S1e,T1e,lxe,R1e,D1e,F1e,O1e,L1e,Oye,Qve,B1e,W1e,H1e,dxe,Y1e,Q1e,sEe,oEe,uEe,mEe,pEe,gEe,bEe,EEe,SEe,$Ee,REe,DEe,OEe,zEe,Cye,t1e,UEe,VEe,jEe,HEe,KEe,YEe,JEe,e2e,n2e,r2e,o2e,l2e,u2e,h2e,f2e,x2e,b2e,e1e,yxe,v2e,N2e,S2e,$2e,_2e,F2e,bxe,O2e,z2e,V2e,b1e];for(const t of W2e)S4(t);let VS=null;async function j2e(){try{try{VS=await sle("indexeddb://rep-project-matching-model"),console.log("Loaded existing model from IndexedDB")}catch{console.log("Creating new model"),VS=G2e(),await VS.save("indexeddb://rep-project-matching-model")}return!0}catch(t){return console.error("Failed to initialize AI:",t),!1}}function G2e(){const t=ole();return t.add(dS({units:16,activation:"relu",inputShape:[20]})),t.add(dS({units:8,activation:"relu"})),t.add(dS({units:1,activation:"sigmoid"})),t.compile({optimizer:"adam",loss:"binaryCrossentropy",metrics:["accuracy"]}),t}function H2e(t,e,n){const s=[],r={};return n.filter(a=>a.repId===t.id&&a.status==="reserved"&&a.gigId).forEach(a=>{a.gigId&&(r[a.gigId]=(r[a.gigId]||0)+1)}),e.forEach(a=>{const o=a.skills.filter(m=>t.specialties.some(h=>h.toLowerCase().includes(m.toLowerCase())||m.toLowerCase().includes(h.toLowerCase()))).length/Math.max(a.skills.length,1),l=r[a.id]?r[a.id]/Object.values(r).reduce((m,h)=>m+h,0):0,c=.7*o+.3*l;let u="";o>.7?u="Strong skill match with your specialties":l>.3?u="Based on your previous project history":u="New opportunity that might match your skills";const d=a.priority==="high"?.2:a.priority==="medium"?.1:0;s.push({repId:t.id,gigId:a.id,confidence:Math.min(c+d,1),reason:u})}),s.sort((a,o)=>o.confidence-a.confidence)}function q2e(t,e){const n=Array(24).fill(0);e.filter(r=>r.repId===t.id&&r.status==="reserved").forEach(r=>{const a=parseInt(r.startTime.split(":")[0]);n[a]++});const s=n.reduce((r,a)=>r+a,0);return n.map((r,a)=>{let o=s>0?r/s:0;return t.preferredHours&&a>=t.preferredHours.start&&a<t.preferredHours.end&&(o+=.2),{hour:a,score:Math.min(o,1)}})}function K2e(t,e){const n=e.filter(c=>c.repId===t.id&&c.status==="reserved");if(n.length===0)return[{repId:t.id,metric:"satisfaction",value:0},{repId:t.id,metric:"efficiency",value:0},{repId:t.id,metric:"quality",value:0}];const s=new Set(n.map(c=>c.gigId).filter(Boolean)).size,r=Math.min(s*20,100),a=n.filter(c=>c.notes&&c.notes.length>0).length,o=Math.min((n.length+a)*5,100),l=Math.floor(70+Math.random()*30);return[{repId:t.id,metric:"satisfaction",value:r},{repId:t.id,metric:"efficiency",value:o},{repId:t.id,metric:"quality",value:l}]}function X2e(t,e=7){const n=new Date,s=[];for(let r=0;r<e;r++){const a=new Date(n);a.setDate(a.getDate()+r);const o=a.toISOString().split("T")[0],l=a.getDay(),c=t.filter(p=>new Date(p.date).getDay()===l&&p.status==="reserved"),u=c.reduce((p,f)=>p+(f.duration||1),0),d=c.length>0?u/Math.max(1,c.length/4):8,m=.9+Math.random()*.2,h=Math.round(d*m);s.push({date:o,predictedHours:h})}return s}function Y2e({rep:t,projects:e,slots:n,onSelectProject:s}){const[r,a]=N.useState([]),[o,l]=N.useState(!0);return N.useEffect(()=>{l(!0);const c=setTimeout(()=>{const u=H2e(t,e,n);a(u),l(!1)},800);return()=>clearTimeout(c)},[t,e,n]),o?i.createElement("div",{className:"bg-white rounded-lg shadow p-4 animate-pulse"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement("div",{className:"w-6 h-6 bg-blue-100 rounded-full mr-2"}),i.createElement("div",{className:"h-5 bg-blue-100 rounded w-48"})),i.createElement("div",{className:"space-y-3"},[1,2,3].map(c=>i.createElement("div",{key:c,className:"h-16 bg-gray-100 rounded"})))):i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Jl,{className:"w-5 h-5 text-purple-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"AI Gig Recommendations")),r.length>0?i.createElement("div",{className:"space-y-3"},r.slice(0,3).map(c=>{const u=e.find(d=>d.id===c.gigId);return u?i.createElement("div",{key:c.gigId,className:"border rounded-lg p-3 hover:bg-blue-50 transition-colors cursor-pointer",onClick:()=>s(c.gigId)},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:u.color}}),i.createElement("h3",{className:"font-medium"},u.name)),i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"text-xs font-medium px-2 py-1 rounded-full bg-purple-100 text-purple-800 flex items-center"},i.createElement(Yu,{className:"w-3 h-3 mr-1"}),Math.round(c.confidence*100),"% match"),i.createElement(Un,{className:"w-4 h-4 text-gray-400 ml-2"}))),i.createElement("p",{className:"text-sm text-gray-600 mt-1"},c.reason),i.createElement("div",{className:"mt-2 flex flex-wrap gap-1"},u.skills.map(d=>i.createElement("span",{key:d,className:`text-xs px-2 py-0.5 rounded-full ${t.specialties.some(m=>m.toLowerCase().includes(d.toLowerCase())||d.toLowerCase().includes(m.toLowerCase()))?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},d)))):null})):i.createElement("div",{className:"text-center py-6 text-gray-500"},"No recommendations available yet"))}function Z2e({rep:t,slots:e,onSelectHour:n}){const[s,r]=N.useState([]);N.useEffect(()=>{const l=q2e(t,e);r(l)},[t,e]);const a=l=>l>=.8?"bg-green-500 text-white":l>=.6?"bg-green-200 text-green-800":l>=.4?"bg-yellow-200 text-yellow-800":l>=.2?"bg-orange-200 text-orange-800":"bg-gray-100 text-gray-500",o=l=>l>=.8?"Optimal":l>=.6?"Good":l>=.4?"Fair":"Low";return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Ct,{className:"w-5 h-5 text-blue-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Optimal Scheduling Times")),i.createElement("div",{className:"grid grid-cols-6 gap-2"},s.map(({hour:l,score:c})=>i.createElement("button",{key:l,onClick:()=>n(l),className:`p-2 rounded-lg flex flex-col items-center justify-center transition-colors hover:opacity-80 ${a(c)}`},i.createElement("span",{className:"text-sm font-bold"},l,":00"),i.createElement("span",{className:"text-xs mt-1"},o(c))))),i.createElement("div",{className:"mt-4 flex items-center justify-center space-x-4 text-xs text-gray-500"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-3 h-3 bg-green-500 rounded-sm mr-1"}),i.createElement("span",null,"Best")),i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-3 h-3 bg-green-200 rounded-sm mr-1"}),i.createElement("span",null,"Good")),i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-3 h-3 bg-yellow-200 rounded-sm mr-1"}),i.createElement("span",null,"Fair")),i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-3 h-3 bg-gray-100 rounded-sm mr-1"}),i.createElement("span",null,"Avoid"))))}var gz={exports:{}},Bb={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J2e=N,Q2e=Symbol.for("react.element"),eNe=Symbol.for("react.fragment"),tNe=Object.prototype.hasOwnProperty,nNe=J2e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sNe={key:!0,ref:!0,__self:!0,__source:!0};function xz(t,e,n){var s,r={},a=null,o=null;n!==void 0&&(a=""+n),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)tNe.call(e,s)&&!sNe.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:Q2e,type:t,key:a,ref:o,props:r,_owner:nNe.current}}Bb.Fragment=eNe,Bb.jsx=xz,Bb.jsxs=xz,gz.exports=Bb;var yz=gz.exports;/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Ef(t){return t+.5|0}const $l=(t,e,n)=>Math.max(Math.min(t,n),e);function Nf(t){return $l(Ef(t*2.55),0,255)}function Tl(t){return $l(Ef(t*255),0,255)}function vi(t){return $l(Ef(t/2.55)/100,0,1)}function bz(t){return $l(Ef(t*100),0,100)}const pa={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},WS=[..."0123456789ABCDEF"],rNe=t=>WS[t&15],aNe=t=>WS[(t&240)>>4]+WS[t&15],Ub=t=>(t&240)>>4===(t&15),oNe=t=>Ub(t.r)&&Ub(t.g)&&Ub(t.b)&&Ub(t.a);function iNe(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&pa[t[1]]*17,g:255&pa[t[2]]*17,b:255&pa[t[3]]*17,a:e===5?pa[t[4]]*17:255}:(e===7||e===9)&&(n={r:pa[t[1]]<<4|pa[t[2]],g:pa[t[3]]<<4|pa[t[4]],b:pa[t[5]]<<4|pa[t[6]],a:e===9?pa[t[7]]<<4|pa[t[8]]:255})),n}const lNe=(t,e)=>t<255?e(t):"";function cNe(t){var e=oNe(t)?rNe:aNe;return t?"#"+e(t.r)+e(t.g)+e(t.b)+lNe(t.a,e):void 0}const uNe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function wz(t,e,n){const s=e*Math.min(n,1-n),r=(a,o=(a+t/30)%12)=>n-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function dNe(t,e,n){const s=(r,a=(r+t/60)%6)=>n-n*e*Math.max(Math.min(a,4-a,1),0);return[s(5),s(3),s(1)]}function mNe(t,e,n){const s=wz(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function hNe(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function jS(t){const n=t.r/255,s=t.g/255,r=t.b/255,a=Math.max(n,s,r),o=Math.min(n,s,r),l=(a+o)/2;let c,u,d;return a!==o&&(d=a-o,u=l>.5?d/(2-a-o):d/(a+o),c=hNe(n,s,r,d,a),c=c*60+.5),[c|0,u||0,l]}function GS(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(Tl)}function HS(t,e,n){return GS(wz,t,e,n)}function pNe(t,e,n){return GS(mNe,t,e,n)}function fNe(t,e,n){return GS(dNe,t,e,n)}function vz(t){return(t%360+360)%360}function gNe(t){const e=uNe.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?Nf(+e[5]):Tl(+e[5]));const r=vz(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=pNe(r,a,o):e[1]==="hsv"?s=fNe(r,a,o):s=HS(r,a,o),{r:s[0],g:s[1],b:s[2],a:n}}function xNe(t,e){var n=jS(t);n[0]=vz(n[0]+e),n=HS(n),t.r=n[0],t.g=n[1],t.b=n[2]}function yNe(t){if(!t)return;const e=jS(t),n=e[0],s=bz(e[1]),r=bz(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${vi(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const Ez={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Nz={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function bNe(){const t={},e=Object.keys(Nz),n=Object.keys(Ez);let s,r,a,o,l;for(s=0;s<e.length;s++){for(o=l=e[s],r=0;r<n.length;r++)a=n[r],l=l.replace(a,Ez[a]);a=parseInt(Nz[o],16),t[l]=[a>>16&255,a>>8&255,a&255]}return t}let Vb;function wNe(t){Vb||(Vb=bNe(),Vb.transparent=[0,0,0,0]);const e=Vb[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const vNe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ENe(t){const e=vNe.exec(t);let n=255,s,r,a;if(e){if(e[7]!==s){const o=+e[7];n=e[8]?Nf(o):$l(o*255,0,255)}return s=+e[1],r=+e[3],a=+e[5],s=255&(e[2]?Nf(s):$l(s,0,255)),r=255&(e[4]?Nf(r):$l(r,0,255)),a=255&(e[6]?Nf(a):$l(a,0,255)),{r:s,g:r,b:a,a:n}}}function NNe(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${vi(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const qS=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Jd=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function kNe(t,e,n){const s=Jd(vi(t.r)),r=Jd(vi(t.g)),a=Jd(vi(t.b));return{r:Tl(qS(s+n*(Jd(vi(e.r))-s))),g:Tl(qS(r+n*(Jd(vi(e.g))-r))),b:Tl(qS(a+n*(Jd(vi(e.b))-a))),a:t.a+n*(e.a-t.a)}}function Wb(t,e,n){if(t){let s=jS(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=HS(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function kz(t,e){return t&&Object.assign(e||{},t)}function Sz(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Tl(t[3]))):(e=kz(t,{r:0,g:0,b:0,a:1}),e.a=Tl(e.a)),e}function SNe(t){return t.charAt(0)==="r"?ENe(t):gNe(t)}class kf{constructor(e){if(e instanceof kf)return e;const n=typeof e;let s;n==="object"?s=Sz(e):n==="string"&&(s=iNe(e)||wNe(e)||SNe(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=kz(this._rgb);return e&&(e.a=vi(e.a)),e}set rgb(e){this._rgb=Sz(e)}rgbString(){return this._valid?NNe(this._rgb):void 0}hexString(){return this._valid?cNe(this._rgb):void 0}hslString(){return this._valid?yNe(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let a;const o=n===a?.5:n,l=2*o-1,c=s.a-r.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-u,s.r=255&u*s.r+a*r.r+.5,s.g=255&u*s.g+a*r.g+.5,s.b=255&u*s.b+a*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=kNe(this._rgb,e._rgb,n)),this}clone(){return new kf(this.rgb)}alpha(e){return this._rgb.a=Tl(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Ef(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Wb(this._rgb,2,e),this}darken(e){return Wb(this._rgb,2,-e),this}saturate(e){return Wb(this._rgb,1,e),this}desaturate(e){return Wb(this._rgb,1,-e),this}rotate(e){return xNe(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ei(){}const CNe=(()=>{let t=0;return()=>t++})();function qt(t){return t==null}function ns(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Vt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function fa(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function To(t,e){return fa(t)?t:e}function Tt(t,e){return typeof t>"u"?e:t}const INe=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function gn(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Zt(t,e,n,s){let r,a,o;if(ns(t))for(a=t.length,r=0;r<a;r++)e.call(n,t[r],r);else if(Vt(t))for(o=Object.keys(t),a=o.length,r=0;r<a;r++)e.call(n,t[o[r]],o[r])}function jb(t,e){let n,s,r,a;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],a=e[n],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function Gb(t){if(ns(t))return t.map(Gb);if(Vt(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=Gb(t[n[r]]);return e}return t}function Cz(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function $Ne(t,e,n,s){if(!Cz(t))return;const r=e[t],a=n[t];Vt(r)&&Vt(a)?Sf(r,a,s):e[t]=Gb(a)}function Sf(t,e,n){const s=ns(e)?e:[e],r=s.length;if(!Vt(t))return t;n=n||{};const a=n.merger||$Ne;let o;for(let l=0;l<r;++l){if(o=s[l],!Vt(o))continue;const c=Object.keys(o);for(let u=0,d=c.length;u<d;++u)a(c[u],t,o,n)}return t}function Cf(t,e){return Sf(t,e,{merger:TNe})}function TNe(t,e,n){if(!Cz(t))return;const s=e[t],r=n[t];Vt(s)&&Vt(r)?Cf(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Gb(r))}const Iz={"":t=>t,x:t=>t.x,y:t=>t.y};function ANe(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function RNe(t){const e=ANe(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function Qd(t,e){return(Iz[e]||(Iz[e]=RNe(e)))(t)}function KS(t){return t.charAt(0).toUpperCase()+t.slice(1)}const If=t=>typeof t<"u",Al=t=>typeof t=="function",$z=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function _Ne(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ms=Math.PI,Ao=2*ms,DNe=Ao+ms,Hb=Number.POSITIVE_INFINITY,PNe=ms/180,qa=ms/2,ru=ms/4,Tz=ms*2/3,XS=Math.log10,Ro=Math.sign;function $f(t,e,n){return Math.abs(t-e)<n}function Az(t){const e=Math.round(t);t=$f(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(XS(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function FNe(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,a)=>r-a).pop(),e}function MNe(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Tf(t){return!MNe(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function ONe(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function LNe(t,e,n){let s,r,a;for(s=0,r=t.length;s<r;s++)a=t[s][n],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function au(t){return t*(ms/180)}function zNe(t){return t*(180/ms)}function Rz(t){if(!fa(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function BNe(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let a=Math.atan2(s,n);return a<-.5*ms&&(a+=Ao),{angle:a,distance:r}}function YS(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function UNe(t,e){return(t-e+DNe)%Ao-ms}function Rl(t){return(t%Ao+Ao)%Ao}function _z(t,e,n,s){const r=Rl(t),a=Rl(e),o=Rl(n),l=Rl(a-r),c=Rl(o-r),u=Rl(r-a),d=Rl(r-o);return r===a||r===o||s&&a===o||l>c&&u<d}function Or(t,e,n){return Math.max(e,Math.min(n,t))}function VNe(t){return Or(t,-32768,32767)}function ou(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function ZS(t,e,n){n=n||(o=>t[o]<e);let s=t.length-1,r=0,a;for(;s-r>1;)a=r+s>>1,n(a)?r=a:s=a;return{lo:r,hi:s}}const iu=(t,e,n,s)=>ZS(t,n,s?r=>{const a=t[r][e];return a<n||a===n&&t[r+1][e]===n}:r=>t[r][e]<n),WNe=(t,e,n)=>ZS(t,n,s=>t[s][e]>=n);function jNe(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const Dz=["push","pop","shift","splice","unshift"];function GNe(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Dz.forEach(n=>{const s="_onData"+KS(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...a){const o=r.apply(this,a);return t._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...a)}),o}})})}function Pz(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(Dz.forEach(a=>{delete t[a]}),delete t._chartjs)}function Fz(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const Mz=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function Oz(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,Mz.call(window,()=>{s=!1,t.apply(e,n)}))}}function HNe(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const JS=t=>t==="start"?"left":t==="end"?"right":"center",Ls=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,qNe=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function KNe(t,e,n){const s=e.length;let r=0,a=s;if(t._sorted){const{iScale:o,vScale:l,_parsed:c}=t,u=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,d=o.axis,{min:m,max:h,minDefined:p,maxDefined:f}=o.getUserBounds();if(p){if(r=Math.min(iu(c,d,m).lo,n?s:iu(e,d,o.getPixelForValue(m)).lo),u){const y=c.slice(0,r+1).reverse().findIndex(x=>!qt(x[l.axis]));r-=Math.max(0,y)}r=Or(r,0,s-1)}if(f){let y=Math.max(iu(c,o.axis,h,!0).hi+1,n?0:iu(e,d,o.getPixelForValue(h),!0).hi+1);if(u){const x=c.slice(y-1).findIndex(g=>!qt(g[l.axis]));y+=Math.max(0,x)}a=Or(y,r,s)-r}else a=s-r}return{start:r,count:a}}function XNe(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const a=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),a}const qb=t=>t===0||t===1,Lz=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Ao/n)),zz=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Ao/n)+1,Af={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*qa)+1,easeOutSine:t=>Math.sin(t*qa),easeInOutSine:t=>-.5*(Math.cos(ms*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>qb(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>qb(t)?t:Lz(t,.075,.3),easeOutElastic:t=>qb(t)?t:zz(t,.075,.3),easeInOutElastic(t){return qb(t)?t:t<.5?.5*Lz(t*2,.1125,.45):.5+.5*zz(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Af.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Af.easeInBounce(t*2)*.5:Af.easeOutBounce(t*2-1)*.5+.5};function QS(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Bz(t){return QS(t)?t:new kf(t)}function eC(t){return QS(t)?t:new kf(t).saturate(.5).darken(.1).hexString()}const YNe=["x","y","borderWidth","radius","tension"],ZNe=["color","borderColor","backgroundColor"];function JNe(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:ZNe},numbers:{type:"number",properties:YNe}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function QNe(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Uz=new Map;function eke(t,e){e=e||{};const n=t+JSON.stringify(e);let s=Uz.get(n);return s||(s=new Intl.NumberFormat(t,e),Uz.set(n,s)),s}function Vz(t,e,n){return eke(e,n).format(t)}const Wz={values(t){return ns(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,a=t;if(n.length>1){const u=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),a=tke(t,n)}const o=XS(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),Vz(t,s,c)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor(XS(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?Wz.numeric.call(this,t,e,n):""}};function tke(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var jz={formatters:Wz};function nke(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:jz.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const lu=Object.create(null),tC=Object.create(null);function Rf(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const a=n[s];t=t[a]||(t[a]=Object.create(null))}return t}function nC(t,e,n){return typeof e=="string"?Sf(Rf(t,e),n):Sf(Rf(t,""),e)}class ske{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>eC(r.backgroundColor),this.hoverBorderColor=(s,r)=>eC(r.borderColor),this.hoverColor=(s,r)=>eC(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return nC(this,e,n)}get(e){return Rf(this,e)}describe(e,n){return nC(tC,e,n)}override(e,n){return nC(lu,e,n)}route(e,n,s,r){const a=Rf(this,e),o=Rf(this,s),l="_"+n;Object.defineProperties(a,{[l]:{value:a[n],writable:!0},[n]:{enumerable:!0,get(){const c=this[l],u=o[r];return Vt(c)?Object.assign({},u,c):Tt(c,u)},set(c){this[l]=c}}})}apply(e){e.forEach(n=>n(this))}}var zn=new ske({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[JNe,QNe,nke]);function rke(t){return!t||qt(t.size)||qt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Gz(t,e,n,s,r){let a=e[r];return a||(a=e[r]=t.measureText(r).width,n.push(r)),a>s&&(s=a),s}function cu(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function Hz(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function sC(t,e,n,s){qz(t,e,n,s,null)}function qz(t,e,n,s,r){let a,o,l,c,u,d,m,h;const p=e.pointStyle,f=e.rotation,y=e.radius;let x=(f||0)*PNe;if(p&&typeof p=="object"&&(a=p.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(x),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(y)||y<=0)){switch(t.beginPath(),p){default:r?t.ellipse(n,s,r/2,y,0,0,Ao):t.arc(n,s,y,0,Ao),t.closePath();break;case"triangle":d=r?r/2:y,t.moveTo(n+Math.sin(x)*d,s-Math.cos(x)*y),x+=Tz,t.lineTo(n+Math.sin(x)*d,s-Math.cos(x)*y),x+=Tz,t.lineTo(n+Math.sin(x)*d,s-Math.cos(x)*y),t.closePath();break;case"rectRounded":u=y*.516,c=y-u,o=Math.cos(x+ru)*c,m=Math.cos(x+ru)*(r?r/2-u:c),l=Math.sin(x+ru)*c,h=Math.sin(x+ru)*(r?r/2-u:c),t.arc(n-m,s-l,u,x-ms,x-qa),t.arc(n+h,s-o,u,x-qa,x),t.arc(n+m,s+l,u,x,x+qa),t.arc(n-h,s+o,u,x+qa,x+ms),t.closePath();break;case"rect":if(!f){c=Math.SQRT1_2*y,d=r?r/2:c,t.rect(n-d,s-c,2*d,2*c);break}x+=ru;case"rectRot":m=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,l=Math.sin(x)*y,h=Math.sin(x)*(r?r/2:y),t.moveTo(n-m,s-l),t.lineTo(n+h,s-o),t.lineTo(n+m,s+l),t.lineTo(n-h,s+o),t.closePath();break;case"crossRot":x+=ru;case"cross":m=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,l=Math.sin(x)*y,h=Math.sin(x)*(r?r/2:y),t.moveTo(n-m,s-l),t.lineTo(n+m,s+l),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o);break;case"star":m=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,l=Math.sin(x)*y,h=Math.sin(x)*(r?r/2:y),t.moveTo(n-m,s-l),t.lineTo(n+m,s+l),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o),x+=ru,m=Math.cos(x)*(r?r/2:y),o=Math.cos(x)*y,l=Math.sin(x)*y,h=Math.sin(x)*(r?r/2:y),t.moveTo(n-m,s-l),t.lineTo(n+m,s+l),t.moveTo(n+h,s-o),t.lineTo(n-h,s+o);break;case"line":o=r?r/2:Math.cos(x)*y,l=Math.sin(x)*y,t.moveTo(n-o,s-l),t.lineTo(n+o,s+l);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(x)*(r?r/2:y),s+Math.sin(x)*y);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function _f(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function rC(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function aC(t){t.restore()}function ake(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const a=(e.x+n.x)/2;t.lineTo(a,e.y),t.lineTo(a,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function oke(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function ike(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),qt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function lke(t,e,n,s,r){if(r.strikethrough||r.underline){const a=t.measureText(s),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=n-a.actualBoundingBoxAscent,u=n+a.actualBoundingBoxDescent,d=r.strikethrough?(c+u)/2:u;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,d),t.lineTo(l,d),t.stroke()}}function cke(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Df(t,e,n,s,r,a={}){const o=ns(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,u;for(t.save(),t.font=r.string,ike(t,a),c=0;c<o.length;++c)u=o[c],a.backdrop&&cke(t,a.backdrop),l&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),qt(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(u,n,s,a.maxWidth)),t.fillText(u,n,s,a.maxWidth),lke(t,n,s,u,a),s+=Number(r.lineHeight);t.restore()}function Kb(t,e){const{x:n,y:s,w:r,h:a,radius:o}=e;t.arc(n+o.topLeft,s+o.topLeft,o.topLeft,1.5*ms,ms,!0),t.lineTo(n,s+a-o.bottomLeft),t.arc(n+o.bottomLeft,s+a-o.bottomLeft,o.bottomLeft,ms,qa,!0),t.lineTo(n+r-o.bottomRight,s+a),t.arc(n+r-o.bottomRight,s+a-o.bottomRight,o.bottomRight,qa,0,!0),t.lineTo(n+r,s+o.topRight),t.arc(n+r-o.topRight,s+o.topRight,o.topRight,0,-qa,!0),t.lineTo(n+o.topLeft,s)}const uke=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,dke=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function mke(t,e){const n=(""+t).match(uke);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const hke=t=>+t||0;function Kz(t,e){const n={},s=Vt(e),r=s?Object.keys(e):e,a=Vt(t)?s?o=>Tt(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=hke(a(o));return n}function Xz(t){return Kz(t,{top:"y",right:"x",bottom:"y",left:"x"})}function em(t){return Kz(t,["topLeft","topRight","bottomLeft","bottomRight"])}function ga(t){const e=Xz(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function zs(t,e){t=t||{},e=e||zn.font;let n=Tt(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=Tt(t.style,e.style);s&&!(""+s).match(dke)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:Tt(t.family,e.family),lineHeight:mke(Tt(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:Tt(t.weight,e.weight),string:""};return r.string=rke(r),r}function Xb(t,e,n,s){let r,a,o;for(r=0,a=t.length;r<a;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function pke(t,e,n){const{min:s,max:r}=t,a=INe(e,(r-s)/2),o=(l,c)=>n&&l===0?0:l+c;return{min:o(s,-Math.abs(a)),max:o(r,a)}}function uu(t,e){return Object.assign(Object.create(t),e)}function oC(t,e=[""],n,s,r=()=>t[0]){const a=n||t;typeof s>"u"&&(s=e6("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:a,_fallback:s,_getTarget:r,override:l=>oC([l,...t],e,a,s)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete t[0][c],!0},get(l,c){return Zz(l,c,()=>Eke(c,e,t,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(l,c){return t6(l).includes(c)},ownKeys(l){return t6(l)},set(l,c,u){const d=l._storage||(l._storage=r());return l[c]=d[c]=u,delete l._keys,!0}})}function tm(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:Yz(t,s),setContext:a=>tm(t,a,n,s),override:a=>tm(t.override(a),e,n,s)};return new Proxy(r,{deleteProperty(a,o){return delete a[o],delete t[o],!0},get(a,o,l){return Zz(a,o,()=>gke(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(a,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(a,o,l){return t[o]=l,delete a[o],!0}})}function Yz(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:Al(n)?n:()=>n,isIndexable:Al(s)?s:()=>s}}const fke=(t,e)=>t?t+KS(e):e,iC=(t,e)=>Vt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Zz(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function gke(t,e,n){const{_proxy:s,_context:r,_subProxy:a,_descriptors:o}=t;let l=s[e];return Al(l)&&o.isScriptable(e)&&(l=xke(e,l,t,n)),ns(l)&&l.length&&(l=yke(e,l,t,o.isIndexable)),iC(e,l)&&(l=tm(l,r,a&&a[e],o)),l}function xke(t,e,n,s){const{_proxy:r,_context:a,_subProxy:o,_stack:l}=n;if(l.has(t))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+t);l.add(t);let c=e(a,o||s);return l.delete(t),iC(t,c)&&(c=lC(r._scopes,r,t,c)),c}function yke(t,e,n,s){const{_proxy:r,_context:a,_subProxy:o,_descriptors:l}=n;if(typeof a.index<"u"&&s(t))return e[a.index%e.length];if(Vt(e[0])){const c=e,u=r._scopes.filter(d=>d!==c);e=[];for(const d of c){const m=lC(u,r,t,d);e.push(tm(m,a,o&&o[t],l))}}return e}function Jz(t,e,n){return Al(t)?t(e,n):t}const bke=(t,e)=>t===!0?e:typeof t=="string"?Qd(e,t):void 0;function wke(t,e,n,s,r){for(const a of e){const o=bke(n,a);if(o){t.add(o);const l=Jz(o._fallback,n,r);if(typeof l<"u"&&l!==n&&l!==s)return l}else if(o===!1&&typeof s<"u"&&n!==s)return null}return!1}function lC(t,e,n,s){const r=e._rootScopes,a=Jz(e._fallback,n,s),o=[...t,...r],l=new Set;l.add(s);let c=Qz(l,o,n,a||n,s);return c===null||typeof a<"u"&&a!==n&&(c=Qz(l,o,a,c,s),c===null)?!1:oC(Array.from(l),[""],r,a,()=>vke(e,n,s))}function Qz(t,e,n,s,r){for(;n;)n=wke(t,e,n,s,r);return n}function vke(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return ns(r)&&Vt(n)?n:r||{}}function Eke(t,e,n,s){let r;for(const a of e)if(r=e6(fke(a,t),n),typeof r<"u")return iC(t,r)?lC(n,s,t,r):r}function e6(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function t6(t){let e=t._keys;return e||(e=t._keys=Nke(t._scopes)),e}function Nke(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const kke=Number.EPSILON||1e-14,nm=(t,e)=>e<t.length&&!t[e].skip&&t[e],n6=t=>t==="x"?"y":"x";function Ske(t,e,n,s){const r=t.skip?e:t,a=e,o=n.skip?e:n,l=YS(a,r),c=YS(o,a);let u=l/(l+c),d=c/(l+c);u=isNaN(u)?0:u,d=isNaN(d)?0:d;const m=s*u,h=s*d;return{previous:{x:a.x-m*(o.x-r.x),y:a.y-m*(o.y-r.y)},next:{x:a.x+h*(o.x-r.x),y:a.y+h*(o.y-r.y)}}}function Cke(t,e,n){const s=t.length;let r,a,o,l,c,u=nm(t,0);for(let d=0;d<s-1;++d)if(c=u,u=nm(t,d+1),!(!c||!u)){if($f(e[d],0,kke)){n[d]=n[d+1]=0;continue}r=n[d]/e[d],a=n[d+1]/e[d],l=Math.pow(r,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),n[d]=r*o*e[d],n[d+1]=a*o*e[d])}}function Ike(t,e,n="x"){const s=n6(n),r=t.length;let a,o,l,c=nm(t,0);for(let u=0;u<r;++u){if(o=l,l=c,c=nm(t,u+1),!l)continue;const d=l[n],m=l[s];o&&(a=(d-o[n])/3,l[`cp1${n}`]=d-a,l[`cp1${s}`]=m-a*e[u]),c&&(a=(c[n]-d)/3,l[`cp2${n}`]=d+a,l[`cp2${s}`]=m+a*e[u])}}function $ke(t,e="x"){const n=n6(e),s=t.length,r=Array(s).fill(0),a=Array(s);let o,l,c,u=nm(t,0);for(o=0;o<s;++o)if(l=c,c=u,u=nm(t,o+1),!!c){if(u){const d=u[e]-c[e];r[o]=d!==0?(u[n]-c[n])/d:0}a[o]=l?u?Ro(r[o-1])!==Ro(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}Cke(t,r,a),Ike(t,a,e)}function Yb(t,e,n){return Math.max(Math.min(t,n),e)}function Tke(t,e){let n,s,r,a,o,l=_f(t[0],e);for(n=0,s=t.length;n<s;++n)o=a,a=l,l=n<s-1&&_f(t[n+1],e),a&&(r=t[n],o&&(r.cp1x=Yb(r.cp1x,e.left,e.right),r.cp1y=Yb(r.cp1y,e.top,e.bottom)),l&&(r.cp2x=Yb(r.cp2x,e.left,e.right),r.cp2y=Yb(r.cp2y,e.top,e.bottom)))}function Ake(t,e,n,s,r){let a,o,l,c;if(e.spanGaps&&(t=t.filter(u=>!u.skip)),e.cubicInterpolationMode==="monotone")$ke(t,r);else{let u=s?t[t.length-1]:t[0];for(a=0,o=t.length;a<o;++a)l=t[a],c=Ske(u,l,t[Math.min(a+1,o-(s?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,u=l}e.capBezierPoints&&Tke(t,n)}function cC(){return typeof window<"u"&&typeof document<"u"}function uC(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Zb(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Jb=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Rke(t,e){return Jb(t).getPropertyValue(e)}const _ke=["top","right","bottom","left"];function du(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const a=_ke[r];s[a]=parseFloat(t[e+"-"+a+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Dke=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Pke(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:a}=s;let o=!1,l,c;if(Dke(r,a,t.target))l=r,c=a;else{const u=e.getBoundingClientRect();l=s.clientX-u.left,c=s.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function mu(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=Jb(n),a=r.boxSizing==="border-box",o=du(r,"padding"),l=du(r,"border","width"),{x:c,y:u,box:d}=Pke(t,n),m=o.left+(d&&l.left),h=o.top+(d&&l.top);let{width:p,height:f}=e;return a&&(p-=o.width+l.width,f-=o.height+l.height),{x:Math.round((c-m)/p*n.width/s),y:Math.round((u-h)/f*n.height/s)}}function Fke(t,e,n){let s,r;if(e===void 0||n===void 0){const a=t&&uC(t);if(!a)e=t.clientWidth,n=t.clientHeight;else{const o=a.getBoundingClientRect(),l=Jb(a),c=du(l,"border","width"),u=du(l,"padding");e=o.width-u.width-c.width,n=o.height-u.height-c.height,s=Zb(l.maxWidth,a,"clientWidth"),r=Zb(l.maxHeight,a,"clientHeight")}}return{width:e,height:n,maxWidth:s||Hb,maxHeight:r||Hb}}const _l=t=>Math.round(t*10)/10;function Mke(t,e,n,s){const r=Jb(t),a=du(r,"margin"),o=Zb(r.maxWidth,t,"clientWidth")||Hb,l=Zb(r.maxHeight,t,"clientHeight")||Hb,c=Fke(t,e,n);let{width:u,height:d}=c;if(r.boxSizing==="content-box"){const h=du(r,"border","width"),p=du(r,"padding");u-=p.width+h.width,d-=p.height+h.height}return u=Math.max(0,u-a.width),d=Math.max(0,s?u/s:d-a.height),u=_l(Math.min(u,o,c.maxWidth)),d=_l(Math.min(d,l,c.maxHeight)),u&&!d&&(d=_l(u/2)),(e!==void 0||n!==void 0)&&s&&c.height&&d>c.height&&(d=c.height,u=_l(Math.floor(d*s))),{width:u,height:d}}function s6(t,e,n){const s=e||1,r=_l(t.height*s),a=_l(t.width*s);t.height=_l(t.height),t.width=_l(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||o.height!==r||o.width!==a?(t.currentDevicePixelRatio=s,o.height=r,o.width=a,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const Oke=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};cC()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function r6(t,e){const n=Rke(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function hu(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function Lke(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function zke(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},a={x:e.cp1x,y:e.cp1y},o=hu(t,r,n),l=hu(r,a,n),c=hu(a,e,n),u=hu(o,l,n),d=hu(l,c,n);return hu(u,d,n)}const Bke=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},Uke=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function sm(t,e,n){return t?Bke(e,n):Uke()}function a6(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function o6(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function i6(t){return t==="angle"?{between:_z,compare:UNe,normalize:Rl}:{between:ou,compare:(e,n)=>e-n,normalize:e=>e}}function l6({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function Vke(t,e,n){const{property:s,start:r,end:a}=n,{between:o,normalize:l}=i6(s),c=e.length;let{start:u,end:d,loop:m}=t,h,p;if(m){for(u+=c,d+=c,h=0,p=c;h<p&&o(l(e[u%c][s]),r,a);++h)u--,d--;u%=c,d%=c}return d<u&&(d+=c),{start:u,end:d,loop:m,style:t.style}}function Wke(t,e,n){if(!n)return[t];const{property:s,start:r,end:a}=n,o=e.length,{compare:l,between:c,normalize:u}=i6(s),{start:d,end:m,loop:h,style:p}=Vke(t,e,n),f=[];let y=!1,x=null,g,b,w;const v=()=>c(r,w,g)&&l(r,w)!==0,E=()=>l(a,g)===0||c(a,w,g),k=()=>y||v(),C=()=>!y||E();for(let I=d,A=d;I<=m;++I)b=e[I%o],!b.skip&&(g=u(b[s]),g!==w&&(y=c(g,r,a),x===null&&k()&&(x=l(g,r)===0?I:A),x!==null&&C()&&(f.push(l6({start:x,end:I,loop:h,count:o,style:p})),x=null),A=I,w=g));return x!==null&&f.push(l6({start:x,end:m,loop:h,count:o,style:p})),f}function jke(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const a=Wke(s[r],t.points,e);a.length&&n.push(...a)}return n}function Gke(t,e,n,s){let r=0,a=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(a+=r);a>r&&t[a%e].skip;)a--;return a%=e,{start:r,end:a}}function Hke(t,e,n,s){const r=t.length,a=[];let o=e,l=t[e],c;for(c=e+1;c<=n;++c){const u=t[c%r];u.skip||u.stop?l.skip||(s=!1,a.push({start:e%r,end:(c-1)%r,loop:s}),e=o=u.stop?c:null):(o=c,l.skip&&(e=c)),l=u}return o!==null&&a.push({start:e%r,end:o%r,loop:s}),a}function qke(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const a=!!t._loop,{start:o,end:l}=Gke(n,r,a,s);if(s===!0)return c6(t,[{start:o,end:l,loop:a}],n,e);const c=l<o?l+r:l,u=!!t._fullLoop&&o===0&&l===r-1;return c6(t,Hke(n,o,c,u),n,e)}function c6(t,e,n,s){return!s||!s.setContext||!n?e:Kke(t,e,n,s)}function Kke(t,e,n,s){const r=t._chart.getContext(),a=u6(t.options),{_datasetIndex:o,options:{spanGaps:l}}=t,c=n.length,u=[];let d=a,m=e[0].start,h=m;function p(f,y,x,g){const b=l?-1:1;if(f!==y){for(f+=c;n[f%c].skip;)f-=b;for(;n[y%c].skip;)y+=b;f%c!==y%c&&(u.push({start:f%c,end:y%c,loop:x,style:g}),d=g,m=y%c)}}for(const f of e){m=l?m:f.start;let y=n[m%c],x;for(h=m+1;h<=f.end;h++){const g=n[h%c];x=u6(s.setContext(uu(r,{type:"segment",p0:y,p1:g,p0DataIndex:(h-1)%c,p1DataIndex:h%c,datasetIndex:o}))),Xke(x,d)&&p(m,h-1,f.loop,d),y=g,d=x}m<h-1&&p(m,h-1,f.loop,d)}return u}function u6(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Xke(t,e){if(!e)return!1;const n=[],s=function(r,a){return QS(a)?(n.includes(a)||n.push(a),n.indexOf(a)):a};return JSON.stringify(t,s)!==JSON.stringify(e,s)}function Qb(t,e,n){return t.options.clip?t[n]:e[n]}function Yke(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:Qb(n,e,"left"),right:Qb(n,e,"right"),top:Qb(s,e,"top"),bottom:Qb(s,e,"bottom")}:e}function Zke(t,e){const n=e._clip;if(n.disabled)return!1;const s=Yke(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Jke{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const a=n.listeners[r],o=n.duration;a.forEach(l=>l({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(s-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Mz.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const a=s.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(r.draw(),this._notify(r,s,e,"progress")),a.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=a.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ni=new Jke;const d6="transparent",Qke={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=Bz(t||d6),r=s.valid&&Bz(e||d6);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class eSe{constructor(e,n,s,r){const a=n[s];r=Xb([e.to,r,a,e.from]);const o=Xb([e.from,a,r]);this._active=!0,this._fn=e.fn||Qke[e.type||typeof o],this._easing=Af[e.easing]||Af.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],a=s-this._start,o=this._duration-a;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Xb([e.to,n,r,e.from]),this._from=Xb([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||n<s),!this._active){this._target[r]=l,this._notify(!0);return}if(n<0){this._target[r]=a;return}c=n/s%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class m6{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!Vt(e))return;const n=Object.keys(zn.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const a=e[r];if(!Vt(a))return;const o={};for(const l of n)o[l]=a[l];(ns(a.properties)&&a.properties||[r]).forEach(l=>{(l===r||!s.has(l))&&s.set(l,o)})})}_animateOptions(e,n){const s=n.options,r=nSe(e,s);if(!r)return[];const a=this._createAnimations(r,s);return s.$shared&&tSe(e.options.$animations,s).then(()=>{e.options=s},()=>{}),a}_createAnimations(e,n){const s=this._properties,r=[],a=e.$animations||(e.$animations={}),o=Object.keys(n),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(e,n));continue}const d=n[u];let m=a[u];const h=s.get(u);if(m)if(h&&m.active()){m.update(h,d,l);continue}else m.cancel();if(!h||!h.duration){e[u]=d;continue}a[u]=m=new eSe(h,e,u,d),r.push(m)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Ni.add(this._chart,s),!0}}function tSe(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const a=t[s[r]];a&&a.active()&&n.push(a.wait())}return Promise.all(n)}function nSe(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function h6(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,a=n.max===void 0?e:0;return{start:s?a:r,end:s?r:a}}function sSe(t,e,n){if(n===!1)return!1;const s=h6(t,n),r=h6(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function rSe(t){let e,n,s,r;return Vt(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function p6(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,a;for(r=0,a=s.length;r<a;++r)n.push(s[r].index);return n}function f6(t,e,n,s={}){const r=t.keys,a=s.mode==="single";let o,l,c,u;if(e===null)return;let d=!1;for(o=0,l=r.length;o<l;++o){if(c=+r[o],c===n){if(d=!0,s.all)continue;break}u=t.values[c],fa(u)&&(a||e===0||Ro(e)===Ro(u))&&(e+=u)}return!d&&!s.all?0:e}function aSe(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",a=s.axis==="x"?"x":"y",o=Object.keys(t),l=new Array(o.length);let c,u,d;for(c=0,u=o.length;c<u;++c)d=o[c],l[c]={[r]:d,[a]:t[d]};return l}function dC(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function oSe(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function iSe(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function lSe(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function g6(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const a=t[r.index];if(n&&a>0||!n&&a<0)return r.index}return null}function x6(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:a,vScale:o,index:l}=s,c=a.axis,u=o.axis,d=oSe(a,o,s),m=e.length;let h;for(let p=0;p<m;++p){const f=e[p],{[c]:y,[u]:x}=f,g=f._stacks||(f._stacks={});h=g[u]=lSe(r,d,y),h[l]=x,h._top=g6(h,o,!0,s.type),h._bottom=g6(h,o,!1,s.type);const b=h._visualValues||(h._visualValues={});b[l]=x}}function mC(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function cSe(t,e){return uu(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function uSe(t,e,n){return uu(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Pf(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const a=r._stacks;if(!a||a[s]===void 0||a[s][n]===void 0)return;delete a[s][n],a[s]._visualValues!==void 0&&a[s]._visualValues[n]!==void 0&&delete a[s]._visualValues[n]}}}const hC=t=>t==="reset"||t==="none",y6=(t,e)=>e?t:Object.assign({},t),dSe=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:p6(n,!0),values:null};class pC{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=dC(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Pf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(m,h,p,f)=>m==="x"?h:m==="r"?f:p,a=n.xAxisID=Tt(s.xAxisID,mC(e,"x")),o=n.yAxisID=Tt(s.yAxisID,mC(e,"y")),l=n.rAxisID=Tt(s.rAxisID,mC(e,"r")),c=n.indexAxis,u=n.iAxisID=r(c,a,o,l),d=n.vAxisID=r(c,o,a,l);n.xScale=this.getScaleForId(a),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(l),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Pz(this._data,this),e._stacked&&Pf(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(Vt(n)){const r=this._cachedMeta;this._data=aSe(n,r)}else if(s!==n){if(s){Pz(s,this);const r=this._cachedMeta;Pf(r),r._parsed=[]}n&&Object.isExtensible(n)&&GNe(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const a=n._stacked;n._stacked=dC(n.vScale,n),n.stack!==s.stack&&(r=!0,Pf(n),n.stack=s.stack),this._resyncElements(e),(r||a!==n._stacked)&&(x6(this,n._parsed),n._stacked=dC(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:a,_stacked:o}=s,l=a.axis;let c=e===0&&n===r.length?!0:s._sorted,u=e>0&&s._parsed[e-1],d,m,h;if(this._parsing===!1)s._parsed=r,s._sorted=!0,h=r;else{ns(r[e])?h=this.parseArrayData(s,r,e,n):Vt(r[e])?h=this.parseObjectData(s,r,e,n):h=this.parsePrimitiveData(s,r,e,n);const p=()=>m[l]===null||u&&m[l]<u[l];for(d=0;d<n;++d)s._parsed[d+e]=m=h[d],c&&(p()&&(c=!1),u=m);s._sorted=c}o&&x6(this,h)}parsePrimitiveData(e,n,s,r){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,u=a.getLabels(),d=a===o,m=new Array(r);let h,p,f;for(h=0,p=r;h<p;++h)f=h+s,m[h]={[l]:d||a.parse(u[f],f),[c]:o.parse(n[f],f)};return m}parseArrayData(e,n,s,r){const{xScale:a,yScale:o}=e,l=new Array(r);let c,u,d,m;for(c=0,u=r;c<u;++c)d=c+s,m=n[d],l[c]={x:a.parse(m[0],d),y:o.parse(m[1],d)};return l}parseObjectData(e,n,s,r){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(r);let d,m,h,p;for(d=0,m=r;d<m;++d)h=d+s,p=n[h],u[d]={x:a.parse(Qd(p,l),h),y:o.parse(Qd(p,c),h)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,a=this._cachedMeta,o=n[e.axis],l={keys:p6(r,!0),values:n._stacks[e.axis]._visualValues};return f6(l,o,a.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const a=s[n.axis];let o=a===null?NaN:a;const l=r&&s._stacks[n.axis];r&&l&&(r.values=l,o=f6(r,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,a=s._sorted&&e===s.iScale,o=r.length,l=this._getOtherScale(e),c=dSe(n,s,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:m}=iSe(l);let h,p;function f(){p=r[h];const y=p[l.axis];return!fa(p[e.axis])||d>y||m<y}for(h=0;h<o&&!(!f()&&(this.updateRangeFromParsed(u,e,p,c),a));++h);if(a){for(h=o-1;h>=0;--h)if(!f()){this.updateRangeFromParsed(u,e,p,c);break}}return u}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,a,o;for(r=0,a=n.length;r<a;++r)o=n[r][e.axis],fa(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,a=this.getParsed(e);return{label:s?""+s.getLabelForValue(a[s.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=rSe(Tt(this.options.clip,sSe(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],a=n.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||r.length-l,u=this.options.drawActiveElementsOnTop;let d;for(s.dataset&&s.dataset.draw(e,a,l,c),d=l;d<l+c;++d){const m=r[d];m.hidden||(m.active&&u?o.push(m):m.draw(e,a))}for(d=0;d<o.length;++d)o[d].draw(e,a)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=uSe(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=r.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=cSe(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!n,a.mode=s,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",a=this._cachedDataOpts,o=e+"-"+n,l=a[o],c=this.enableOptionSharing&&If(s);if(l)return y6(l,c);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,e),m=r?[`${e}Hover`,"hover",e,""]:[e,""],h=u.getOptionScopes(this.getDataset(),d),p=Object.keys(zn.elements[e]),f=()=>this.getContext(s,r,n),y=u.resolveNamedOptions(h,p,f,m);return y.$shared&&(y.$shared=c,a[o]=Object.freeze(y6(y,c))),y}_resolveAnimations(e,n,s){const r=this.chart,a=this._cachedDataOpts,o=`animation-${n}`,l=a[o];if(l)return l;let c;if(r.options.animation!==!1){const d=this.chart.config,m=d.datasetAnimationScopeKeys(this._type,n),h=d.getOptionScopes(this.getDataset(),m);c=d.createResolver(h,this.getContext(e,s,n))}const u=new m6(r,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||hC(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,a=this.getSharedOptions(s),o=this.includeOptions(n,a)||a!==r;return this.updateSharedOptions(a,n,s),{sharedOptions:a,includeOptions:o}}updateElement(e,n,s,r){hC(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!hC(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const a=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const r=s.length,a=n.length,o=Math.min(a,r);o&&this.parse(0,o),a>r?this._insertElements(r,a-r,e):a<r&&this._removeElements(a,r-a)}_insertElements(e,n,s=!0){const r=this._cachedMeta,a=r.data,o=e+n;let l;const c=u=>{for(u.length+=n,l=u.length-1;l>=o;l--)u[l]=u[l-n]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(e,n),s&&this.updateElements(a,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Pf(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function mSe(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let s=[];for(let r=0,a=n.length;r<a;r++)s=s.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=Fz(s.sort((r,a)=>r-a))}return t._cache.$bar}function hSe(t){const e=t.iScale,n=mSe(e,t.type);let s=e._length,r,a,o,l;const c=()=>{o===32767||o===-32768||(If(l)&&(s=Math.min(s,Math.abs(o-l)||s)),l=o)};for(r=0,a=n.length;r<a;++r)o=e.getPixelForValue(n[r]),c();for(l=void 0,r=0,a=e.ticks.length;r<a;++r)o=e.getPixelForTick(r),c();return s}function pSe(t,e,n,s){const r=n.barThickness;let a,o;return qt(r)?(a=e.min*n.categoryPercentage,o=n.barPercentage):(a=r*s,o=1),{chunk:a/s,ratio:o,start:e.pixels[t]-a/2}}function fSe(t,e,n,s){const r=e.pixels,a=r[t];let o=t>0?r[t-1]:null,l=t<r.length-1?r[t+1]:null;const c=n.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const u=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/s,ratio:n.barPercentage,start:u}}function gSe(t,e,n,s){const r=n.parse(t[0],s),a=n.parse(t[1],s),o=Math.min(r,a),l=Math.max(r,a);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),e[n.axis]=u,e._custom={barStart:c,barEnd:u,start:r,end:a,min:o,max:l}}function b6(t,e,n,s){return ns(t)?gSe(t,e,n,s):e[n.axis]=n.parse(t,s),e}function w6(t,e,n,s){const r=t.iScale,a=t.vScale,o=r.getLabels(),l=r===a,c=[];let u,d,m,h;for(u=n,d=n+s;u<d;++u)h=e[u],m={},m[r.axis]=l||r.parse(o[u],u),c.push(b6(h,m,a,u));return c}function fC(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function xSe(t,e,n){return t!==0?Ro(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function ySe(t){let e,n,s,r,a;return t.horizontal?(e=t.base>t.x,n="left",s="right"):(e=t.base<t.y,n="bottom",s="top"),e?(r="end",a="start"):(r="start",a="end"),{start:n,end:s,reverse:e,top:r,bottom:a}}function bSe(t,e,n,s){let r=e.borderSkipped;const a={};if(!r){t.borderSkipped=a;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:d}=ySe(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===s?r=u:(n._bottom||0)===s?r=d:(a[v6(d,o,l,c)]=!0,r=u)),a[v6(r,o,l,c)]=!0,t.borderSkipped=a}function v6(t,e,n,s){return s?(t=wSe(t,e,n),t=E6(t,n,e)):t=E6(t,e,n),t}function wSe(t,e,n){return t===e?n:t===n?e:t}function E6(t,e,n){return t==="start"?e:t==="end"?n:t}function vSe(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class ESe extends pC{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,s,r){return w6(e,n,s,r)}parseArrayData(e,n,s,r){return w6(e,n,s,r)}parseObjectData(e,n,s,r){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=a.axis==="x"?l:c,d=o.axis==="x"?l:c,m=[];let h,p,f,y;for(h=s,p=s+r;h<p;++h)y=n[h],f={},f[a.axis]=a.parse(Qd(y,u),h),m.push(b6(Qd(y,d),f,o,h));return m}updateRangeFromParsed(e,n,s,r){super.updateRangeFromParsed(e,n,s,r);const a=s._custom;a&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:s,vScale:r}=n,a=this.getParsed(e),o=a._custom,l=fC(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+s.getLabelForValue(a[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,s,r){const a=r==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),d=this._getRuler(),{sharedOptions:m,includeOptions:h}=this._getSharedOptions(n,r);for(let p=n;p<n+s;p++){const f=this.getParsed(p),y=a||qt(f[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(p),x=this._calculateBarIndexPixels(p,d),g=(f._stacks||{})[l.axis],b={horizontal:u,base:y.base,enableBorderRadius:!g||fC(f._custom)||o===g._top||o===g._bottom,x:u?y.head:x.center,y:u?x.center:y.head,height:u?x.size:Math.abs(y.size),width:u?Math.abs(y.size):x.size};h&&(b.options=m||this.resolveDataElementOptions(p,e[p].active?"active":r));const w=b.options||e[p].options;bSe(b,w,g,o),vSe(b,w,d.ratio),this.updateElement(e[p],p,b,r)}}_getStacks(e,n){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),a=s.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(n),c=l&&l[s.axis],u=d=>{const m=d._parsed.find(p=>p[s.axis]===c),h=m&&m[d.vScale.axis];if(qt(h)||isNaN(h))return!0};for(const d of r)if(!(n!==void 0&&u(d))&&((a===!1||o.indexOf(d.stack)===-1||a===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[Tt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,s){const r=this._getStacks(e,s),a=n!==void 0?r.indexOf(n):-1;return a===-1?r.length-1:a}_getRuler(){const e=this.options,n=this._cachedMeta,s=n.iScale,r=[];let a,o;for(a=0,o=n.data.length;a<o;++a)r.push(s.getPixelForValue(this.getParsed(a)[s.axis],a));const l=e.barThickness;return{min:l||hSe(n),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:s,index:r},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),u=c._custom,d=fC(u);let m=c[n.axis],h=0,p=s?this.applyStack(n,c,s):m,f,y;p!==m&&(h=p-m,p=m),d&&(m=u.barStart,p=u.barEnd-u.barStart,m!==0&&Ro(m)!==Ro(u.barEnd)&&(h=0),h+=m);const x=!qt(a)&&!d?a:h;let g=n.getPixelForValue(x);if(this.chart.getDataVisibility(e)?f=n.getPixelForValue(h+p):f=g,y=f-g,Math.abs(y)<o){y=xSe(y,n,l)*o,m===l&&(g-=y/2);const b=n.getPixelForDecimal(0),w=n.getPixelForDecimal(1),v=Math.min(b,w),E=Math.max(b,w);g=Math.max(Math.min(g,E),v),f=g+y,s&&!d&&(c._stacks[n.axis]._visualValues[r]=n.getValueForPixel(f)-n.getValueForPixel(g))}if(g===n.getPixelForValue(l)){const b=Ro(y)*n.getLineWidthForValue(l)/2;g+=b,y-=b}return{size:y,base:g,head:f,center:f+y/2}}_calculateBarIndexPixels(e,n){const s=n.scale,r=this.options,a=r.skipNull,o=Tt(r.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(n.grouped){const d=a?this._getStackCount(e):n.stackCount,m=r.barThickness==="flex"?fSe(e,n,r,d*u):pSe(e,n,r,d*u),h=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(Tt(h,this.getFirstScaleIdForIndexAxis())),f=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+p;l=m.start+m.chunk*f+m.chunk/2,c=Math.min(o,m.chunk*m.ratio)}else l=s.getPixelForValue(this.getParsed(e)[s.axis],e),c=Math.min(o,n.min*n.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,n=e.vScale,s=e.data,r=s.length;let a=0;for(;a<r;++a)this.getParsed(a)[n.axis]!==null&&!s[a].hidden&&s[a].draw(this._ctx)}}class NSe extends pC{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:a}=n,o=this.chart._animationsDisabled;let{start:l,count:c}=KNe(n,r,o);this._drawStart=l,this._drawCount=c,XNe(n)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!a._decimated,s.points=r;const u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:u},e),this.updateElements(r,l,c,e)}updateElements(e,n,s,r){const a=r==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:d,includeOptions:m}=this._getSharedOptions(n,r),h=o.axis,p=l.axis,{spanGaps:f,segment:y}=this.options,x=Tf(f)?f:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||a||r==="none",b=n+s,w=e.length;let v=n>0&&this.getParsed(n-1);for(let E=0;E<w;++E){const k=e[E],C=g?k:{};if(E<n||E>=b){C.skip=!0;continue}const I=this.getParsed(E),A=qt(I[p]),$=C[h]=o.getPixelForValue(I[h],E),T=C[p]=a||A?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,I,c):I[p],E);C.skip=isNaN($)||isNaN(T)||A,C.stop=E>0&&Math.abs(I[h]-v[h])>x,y&&(C.parsed=I,C.raw=u.data[E]),m&&(C.options=d||this.resolveDataElementOptions(E,k.active?"active":r)),g||this.updateElement(k,E,C,r),v=I}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const a=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function pu(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class gC{static override(e){Object.assign(gC.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return pu()}parse(){return pu()}format(){return pu()}add(){return pu()}diff(){return pu()}startOf(){return pu()}endOf(){return pu()}}var kSe={_date:gC};function SSe(t,e,n,s){const{controller:r,data:a,_sorted:o}=t,l=r._cachedMeta.iScale,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const u=l._reversePixels?WNe:iu;if(s){if(r._sharedOptions){const d=a[0],m=typeof d.getRange=="function"&&d.getRange(e);if(m){const h=u(a,e,n-m),p=u(a,e,n+m);return{lo:h.lo,hi:p.hi}}}}else{const d=u(a,e,n);if(c){const{vScale:m}=r._cachedMeta,{_parsed:h}=t,p=h.slice(0,d.lo+1).reverse().findIndex(y=>!qt(y[m.axis]));d.lo-=Math.max(0,p);const f=h.slice(d.hi).findIndex(y=>!qt(y[m.axis]));d.hi+=Math.max(0,f)}return d}}return{lo:0,hi:a.length-1}}function Ff(t,e,n,s,r){const a=t.getSortedVisibleDatasetMetas(),o=n[e];for(let l=0,c=a.length;l<c;++l){const{index:u,data:d}=a[l],{lo:m,hi:h}=SSe(a[l],e,o,r);for(let p=m;p<=h;++p){const f=d[p];f.skip||s(f,u,p)}}}function CSe(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const a=e?Math.abs(s.x-r.x):0,o=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function xC(t,e,n,s,r){const a=[];return!r&&!t.isPointInArea(e)||Ff(t,n,e,function(l,c,u){!r&&!_f(l,t.chartArea,0)||l.inRange(e.x,e.y,s)&&a.push({element:l,datasetIndex:c,index:u})},!0),a}function ISe(t,e,n,s){let r=[];function a(o,l,c){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],s),{angle:m}=BNe(o,{x:e.x,y:e.y});_z(m,u,d)&&r.push({element:o,datasetIndex:l,index:c})}return Ff(t,n,e,a),r}function $Se(t,e,n,s,r,a){let o=[];const l=CSe(n);let c=Number.POSITIVE_INFINITY;function u(d,m,h){const p=d.inRange(e.x,e.y,r);if(s&&!p)return;const f=d.getCenterPoint(r);if(!(!!a||t.isPointInArea(f))&&!p)return;const x=l(e,f);x<c?(o=[{element:d,datasetIndex:m,index:h}],c=x):x===c&&o.push({element:d,datasetIndex:m,index:h})}return Ff(t,n,e,u),o}function yC(t,e,n,s,r,a){return!a&&!t.isPointInArea(e)?[]:n==="r"&&!s?ISe(t,e,n,r):$Se(t,e,n,s,r,a)}function N6(t,e,n,s,r){const a=[],o=n==="x"?"inXRange":"inYRange";let l=!1;return Ff(t,n,e,(c,u,d)=>{c[o]&&c[o](e[n],r)&&(a.push({element:c,datasetIndex:u,index:d}),l=l||c.inRange(e.x,e.y,r))}),s&&!l?[]:a}var TSe={evaluateInteractionItems:Ff,modes:{index(t,e,n,s){const r=mu(e,t),a=n.axis||"x",o=n.includeInvisible||!1,l=n.intersect?xC(t,r,a,s,o):yC(t,r,a,!1,s,o),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach(u=>{const d=l[0].index,m=u.data[d];m&&!m.skip&&c.push({element:m,datasetIndex:u.index,index:d})}),c):[]},dataset(t,e,n,s){const r=mu(e,t),a=n.axis||"xy",o=n.includeInvisible||!1;let l=n.intersect?xC(t,r,a,s,o):yC(t,r,a,!1,s,o);if(l.length>0){const c=l[0].datasetIndex,u=t.getDatasetMeta(c).data;l=[];for(let d=0;d<u.length;++d)l.push({element:u[d],datasetIndex:c,index:d})}return l},point(t,e,n,s){const r=mu(e,t),a=n.axis||"xy",o=n.includeInvisible||!1;return xC(t,r,a,s,o)},nearest(t,e,n,s){const r=mu(e,t),a=n.axis||"xy",o=n.includeInvisible||!1;return yC(t,r,a,n.intersect,s,o)},x(t,e,n,s){const r=mu(e,t);return N6(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=mu(e,t);return N6(t,r,"y",n.intersect,s)}}};const k6=["left","top","right","bottom"];function Mf(t,e){return t.filter(n=>n.pos===e)}function S6(t,e){return t.filter(n=>k6.indexOf(n.pos)===-1&&n.box.axis===e)}function Of(t,e){return t.sort((n,s)=>{const r=e?s:n,a=e?n:s;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function ASe(t){const e=[];let n,s,r,a,o,l;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:a,options:{stack:o,stackWeight:l=1}}=r,e.push({index:n,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&a+o,stackWeight:l});return e}function RSe(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:a}=n;if(!s||!k6.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function _Se(t,e){const n=RSe(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let a,o,l;for(a=0,o=t.length;a<o;++a){l=t[a];const{fullSize:c}=l.box,u=n[l.stack],d=u&&l.stackWeight/u.weight;l.horizontal?(l.width=d?d*s:c&&e.availableWidth,l.height=r):(l.width=s,l.height=d?d*r:c&&e.availableHeight)}return n}function DSe(t){const e=ASe(t),n=Of(e.filter(u=>u.box.fullSize),!0),s=Of(Mf(e,"left"),!0),r=Of(Mf(e,"right")),a=Of(Mf(e,"top"),!0),o=Of(Mf(e,"bottom")),l=S6(e,"x"),c=S6(e,"y");return{fullSize:n,leftAndTop:s.concat(a),rightAndBottom:r.concat(c).concat(o).concat(l),chartArea:Mf(e,"chartArea"),vertical:s.concat(r).concat(c),horizontal:a.concat(o).concat(l)}}function C6(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function I6(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function PSe(t,e,n,s){const{pos:r,box:a}=n,o=t.maxPadding;if(!Vt(r)){n.size&&(t[r]-=n.size);const m=s[n.stack]||{size:0,count:1};m.size=Math.max(m.size,n.horizontal?a.height:a.width),n.size=m.size/m.count,t[r]+=n.size}a.getPadding&&I6(o,a.getPadding());const l=Math.max(0,e.outerWidth-C6(o,t,"left","right")),c=Math.max(0,e.outerHeight-C6(o,t,"top","bottom")),u=l!==t.w,d=c!==t.h;return t.w=l,t.h=c,n.horizontal?{same:u,other:d}:{same:d,other:u}}function FSe(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function MSe(t,e){const n=e.maxPadding;function s(r){const a={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{a[o]=Math.max(e[o],n[o])}),a}return s(t?["left","right"]:["top","bottom"])}function Lf(t,e,n,s){const r=[];let a,o,l,c,u,d;for(a=0,o=t.length,u=0;a<o;++a){l=t[a],c=l.box,c.update(l.width||e.w,l.height||e.h,MSe(l.horizontal,e));const{same:m,other:h}=PSe(e,n,l,s);u|=m&&r.length,d=d||h,c.fullSize||r.push(l)}return u&&Lf(r,e,n,s)||d}function ew(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function $6(t,e,n,s){const r=n.padding;let{x:a,y:o}=e;for(const l of t){const c=l.box,u=s[l.stack]||{count:1,placed:0,weight:1},d=l.stackWeight/u.weight||1;if(l.horizontal){const m=e.w*d,h=u.size||c.height;If(u.start)&&(o=u.start),c.fullSize?ew(c,r.left,o,n.outerWidth-r.right-r.left,h):ew(c,e.left+u.placed,o,m,h),u.start=o,u.placed+=m,o=c.bottom}else{const m=e.h*d,h=u.size||c.width;If(u.start)&&(a=u.start),c.fullSize?ew(c,a,r.top,h,n.outerHeight-r.bottom-r.top):ew(c,a,e.top+u.placed,h,m),u.start=a,u.placed+=m,a=c.right}}e.x=a,e.y=o}var xa={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=ga(t.options.layout.padding),a=Math.max(e-r.width,0),o=Math.max(n-r.height,0),l=DSe(t.boxes),c=l.vertical,u=l.horizontal;Zt(t.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const d=c.reduce((y,x)=>x.box.options&&x.box.options.display===!1?y:y+1,0)||1,m=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/d,hBoxMaxHeight:o/2}),h=Object.assign({},r);I6(h,ga(s));const p=Object.assign({maxPadding:h,w:a,h:o,x:r.left,y:r.top},r),f=_Se(c.concat(u),m);Lf(l.fullSize,p,m,f),Lf(c,p,m,f),Lf(u,p,m,f)&&Lf(c,p,m,f),FSe(p),$6(l.leftAndTop,p,m,f),p.x+=p.w,p.y+=p.h,$6(l.rightAndBottom,p,m,f),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Zt(l.chartArea,y=>{const x=y.box;Object.assign(x,t.chartArea),x.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class T6{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class OSe extends T6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const tw="$chartjs",LSe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},A6=t=>t===null||t==="";function zSe(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[tw]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",A6(r)){const a=r6(t,"width");a!==void 0&&(t.width=a)}if(A6(s))if(t.style.height==="")t.height=t.width/(e||2);else{const a=r6(t,"height");a!==void 0&&(t.height=a)}return t}const R6=Oke?{passive:!0}:!1;function BSe(t,e,n){t&&t.addEventListener(e,n,R6)}function USe(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,R6)}function VSe(t,e){const n=LSe[t.type]||t.type,{x:s,y:r}=mu(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function nw(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function WSe(t,e,n){const s=t.canvas,r=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||nw(l.addedNodes,s),o=o&&!nw(l.removedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function jSe(t,e,n){const s=t.canvas,r=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||nw(l.removedNodes,s),o=o&&!nw(l.addedNodes,s);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const zf=new Map;let _6=0;function D6(){const t=window.devicePixelRatio;t!==_6&&(_6=t,zf.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function GSe(t,e){zf.size||window.addEventListener("resize",D6),zf.set(t,e)}function HSe(t){zf.delete(t),zf.size||window.removeEventListener("resize",D6)}function qSe(t,e,n){const s=t.canvas,r=s&&uC(s);if(!r)return;const a=Oz((l,c)=>{const u=r.clientWidth;n(l,c),u<r.clientWidth&&n()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,d=c.contentRect.height;u===0&&d===0||a(u,d)});return o.observe(r),GSe(t,a),o}function bC(t,e,n){n&&n.disconnect(),e==="resize"&&HSe(t)}function KSe(t,e,n){const s=t.canvas,r=Oz(a=>{t.ctx!==null&&n(VSe(a,t))},t);return BSe(s,e,r),r}class XSe extends T6{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(zSe(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[tw])return!1;const s=n[tw].initial;["height","width"].forEach(a=>{const o=s[a];qt(o)?n.removeAttribute(a):n.setAttribute(a,o)});const r=s.style||{};return Object.keys(r).forEach(a=>{n.style[a]=r[a]}),n.width=n.width,delete n[tw],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:WSe,detach:jSe,resize:qSe}[n]||KSe;r[n]=o(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:bC,detach:bC,resize:bC}[n]||USe)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return Mke(e,n,s,r)}isAttached(e){const n=e&&uC(e);return!!(n&&n.isConnected)}}function YSe(t){return!cC()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?OSe:XSe}let Dl=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Tf(this.x)&&Tf(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(a=>{r[a]=s[a]&&s[a].active()?s[a]._to:this[a]}),r}};function ZSe(t,e){const n=t.options.ticks,s=JSe(t),r=Math.min(n.maxTicksLimit||s,s),a=n.major.enabled?eCe(e):[],o=a.length,l=a[0],c=a[o-1],u=[];if(o>r)return tCe(e,u,a,o/r),u;const d=QSe(a,e,r);if(o>0){let m,h;const p=o>1?Math.round((c-l)/(o-1)):null;for(sw(e,u,d,qt(p)?0:l-p,l),m=0,h=o-1;m<h;m++)sw(e,u,d,a[m],a[m+1]);return sw(e,u,d,c,qt(p)?e.length:c+p),u}return sw(e,u,d),u}function JSe(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function QSe(t,e,n){const s=nCe(t),r=e.length/n;if(!s)return Math.max(r,1);const a=FNe(s);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>r)return c}return Math.max(r,1)}function eCe(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function tCe(t,e,n,s){let r=0,a=n[0],o;for(s=Math.ceil(s),o=0;o<t.length;o++)o===a&&(e.push(t[o]),r++,a=n[r*s])}function sw(t,e,n,s,r){const a=Tt(s,0),o=Math.min(Tt(r,t.length),t.length);let l=0,c,u,d;for(n=Math.ceil(n),r&&(c=r-s,n=c/Math.floor(c/n)),d=a;d<0;)l++,d=Math.round(a+l*n);for(u=Math.max(a,0);u<o;u++)u===d&&(e.push(t[u]),l++,d=Math.round(a+l*n))}function nCe(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const sCe=t=>t==="left"?"right":t==="right"?"left":t,P6=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,F6=(t,e)=>Math.min(e||t,t);function M6(t,e){const n=[],s=t.length/e,r=t.length;let a=0;for(;a<r;a+=s)n.push(t[Math.floor(a)]);return n}function rCe(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),a=t._startPixel,o=t._endPixel,l=1e-6;let c=t.getPixelForTick(r),u;if(!(n&&(s===1?u=Math.max(c-a,o-c):e===0?u=(t.getPixelForTick(1)-c)/2:u=(c-t.getPixelForTick(r-1))/2,c+=r<e?u:-u,c<a-l||c>o+l)))return c}function aCe(t,e){Zt(t,n=>{const s=n.gc,r=s.length/2;let a;if(r>e){for(a=0;a<r;++a)delete n.data[s[a]];s.splice(0,r)}})}function Bf(t){return t.drawTicks?t.tickLength:0}function O6(t,e){if(!t.display)return 0;const n=zs(t.font,e),s=ga(t.padding);return(ns(t.text)?t.text.length:1)*n.lineHeight+s.height}function oCe(t,e){return uu(t,{scale:e,type:"scale"})}function iCe(t,e,n){return uu(t,{tick:n,index:e,type:"tick"})}function lCe(t,e,n){let s=JS(t);return(n&&e!=="right"||!n&&e==="right")&&(s=sCe(s)),s}function cCe(t,e,n,s){const{top:r,left:a,bottom:o,right:l,chart:c}=t,{chartArea:u,scales:d}=c;let m=0,h,p,f;const y=o-r,x=l-a;if(t.isHorizontal()){if(p=Ls(s,a,l),Vt(n)){const g=Object.keys(n)[0],b=n[g];f=d[g].getPixelForValue(b)+y-e}else n==="center"?f=(u.bottom+u.top)/2+y-e:f=P6(t,n,e);h=l-a}else{if(Vt(n)){const g=Object.keys(n)[0],b=n[g];p=d[g].getPixelForValue(b)-x+e}else n==="center"?p=(u.left+u.right)/2-x+e:p=P6(t,n,e);f=Ls(s,o,r),m=n==="left"?-qa:qa}return{titleX:p,titleY:f,maxWidth:h,rotation:m}}class rm extends Dl{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=To(e,Number.POSITIVE_INFINITY),n=To(n,Number.NEGATIVE_INFINITY),s=To(s,Number.POSITIVE_INFINITY),r=To(r,Number.NEGATIVE_INFINITY),{min:To(e,s),max:To(n,r),minDefined:fa(e),maxDefined:fa(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:a}=this.getUserBounds(),o;if(r&&a)return{min:n,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),a||(s=Math.max(s,o.max));return n=a&&n>s?s:n,s=r&&n>s?n:s,{min:To(n,To(s,n)),max:To(s,To(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){gn(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=pke(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?M6(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=ZSe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){gn(this.options.afterUpdate,[this])}beforeSetDimensions(){gn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){gn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),gn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){gn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,a;for(s=0,r=e.length;s<r;s++)a=e[s],a.label=gn(n.callback,[a.value,s,e],this)}afterTickToLabelConversion(){gn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){gn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=F6(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,a=n.maxRotation;let o=r,l,c,u;if(!this._isVisible()||!n.display||r>=a||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),m=d.widest.width,h=d.highest.height,p=Or(this.chart.width-m,0,this.maxWidth);l=e.offset?this.maxWidth/s:p/(s-1),m+6>l&&(l=p/(s-(e.offset?.5:1)),c=this.maxHeight-Bf(e.grid)-n.padding-O6(e.title,this.chart.options.font),u=Math.sqrt(m*m+h*h),o=zNe(Math.min(Math.asin(Or((d.highest.height+6)/l,-1,1)),Math.asin(Or(c/u,-1,1))-Math.asin(Or(h/u,-1,1)))),o=Math.max(r,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){gn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){gn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=O6(r,n.options.font);if(l?(e.width=this.maxWidth,e.height=Bf(a)+c):(e.height=this.maxHeight,e.width=Bf(a)+c),s.display&&this.ticks.length){const{first:u,last:d,widest:m,highest:h}=this._getLabelSizes(),p=s.padding*2,f=au(this.labelRotation),y=Math.cos(f),x=Math.sin(f);if(l){const g=s.mirror?0:x*m.width+y*h.height;e.height=Math.min(this.maxHeight,e.height+g+p)}else{const g=s.mirror?0:y*m.width+x*h.height;e.width=Math.min(this.maxWidth,e.width+g+p)}this._calculatePadding(u,d,x,y)}}this._handleMargins(),l?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,m=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,p=0;c?u?(h=r*e.width,p=s*n.height):(h=s*e.height,p=r*n.width):a==="start"?p=n.width:a==="end"?h=e.width:a!=="inner"&&(h=e.width/2,p=n.width/2),this.paddingLeft=Math.max((h-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((p-m+o)*this.width/(this.width-m),0)}else{let d=n.height/2,m=e.height/2;a==="start"?(d=0,m=e.height):a==="end"&&(d=n.height,m=0),this.paddingTop=d+o,this.paddingBottom=m+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){gn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)qt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=M6(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(n/F6(n,s));let u=0,d=0,m,h,p,f,y,x,g,b,w,v,E;for(m=0;m<n;m+=c){if(f=e[m].label,y=this._resolveTickFontOptions(m),r.font=x=y.string,g=a[x]=a[x]||{data:{},gc:[]},b=y.lineHeight,w=v=0,!qt(f)&&!ns(f))w=Gz(r,g.data,g.gc,w,f),v=b;else if(ns(f))for(h=0,p=f.length;h<p;++h)E=f[h],!qt(E)&&!ns(E)&&(w=Gz(r,g.data,g.gc,w,E),v+=b);o.push(w),l.push(v),u=Math.max(w,u),d=Math.max(v,d)}aCe(a,n);const k=o.indexOf(u),C=l.indexOf(d),I=A=>({width:o[A]||0,height:l[A]||0});return{first:I(0),last:I(n-1),widest:I(k),highest:I(C),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return VNe(this._alignToPixels?cu(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=iCe(this.getContext(),e,s))}return this.$context||(this.$context=oCe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=au(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*s>l*r?l/s:c/r:c*r<l*s?c/s:l/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:a,position:o,border:l}=r,c=a.offset,u=this.isHorizontal(),m=this.ticks.length+(c?1:0),h=Bf(a),p=[],f=l.setContext(this.getContext()),y=f.display?f.width:0,x=y/2,g=function(L){return cu(s,L,y)};let b,w,v,E,k,C,I,A,$,T,F,O;if(o==="top")b=g(this.bottom),C=this.bottom-h,A=b-x,T=g(e.top)+x,O=e.bottom;else if(o==="bottom")b=g(this.top),T=e.top,O=g(e.bottom)-x,C=b+x,A=this.top+h;else if(o==="left")b=g(this.right),k=this.right-h,I=b-x,$=g(e.left)+x,F=e.right;else if(o==="right")b=g(this.left),$=e.left,F=g(e.right)-x,k=b+x,I=this.left+h;else if(n==="x"){if(o==="center")b=g((e.top+e.bottom)/2+.5);else if(Vt(o)){const L=Object.keys(o)[0],Y=o[L];b=g(this.chart.scales[L].getPixelForValue(Y))}T=e.top,O=e.bottom,C=b+x,A=C+h}else if(n==="y"){if(o==="center")b=g((e.left+e.right)/2);else if(Vt(o)){const L=Object.keys(o)[0],Y=o[L];b=g(this.chart.scales[L].getPixelForValue(Y))}k=b-x,I=k-h,$=e.left,F=e.right}const M=Tt(r.ticks.maxTicksLimit,m),B=Math.max(1,Math.ceil(m/M));for(w=0;w<m;w+=B){const L=this.getContext(w),Y=a.setContext(L),D=l.setContext(L),_=Y.lineWidth,P=Y.color,z=D.dash||[],q=D.dashOffset,K=Y.tickWidth,ae=Y.tickColor,ne=Y.tickBorderDash||[],Z=Y.tickBorderDashOffset;v=rCe(this,w,c),v!==void 0&&(E=cu(s,v,_),u?k=I=$=F=E:C=A=T=O=E,p.push({tx1:k,ty1:C,tx2:I,ty2:A,x1:$,y1:T,x2:F,y2:O,width:_,color:P,borderDash:z,borderDashOffset:q,tickWidth:K,tickColor:ae,tickBorderDash:ne,tickBorderDashOffset:Z}))}return this._ticksLength=m,this._borderValue=b,p}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:a}=s,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:d,mirror:m}=a,h=Bf(s.grid),p=h+d,f=m?-d:p,y=-au(this.labelRotation),x=[];let g,b,w,v,E,k,C,I,A,$,T,F,O="middle";if(r==="top")k=this.bottom-f,C=this._getXAxisLabelAlignment();else if(r==="bottom")k=this.top+f,C=this._getXAxisLabelAlignment();else if(r==="left"){const B=this._getYAxisLabelAlignment(h);C=B.textAlign,E=B.x}else if(r==="right"){const B=this._getYAxisLabelAlignment(h);C=B.textAlign,E=B.x}else if(n==="x"){if(r==="center")k=(e.top+e.bottom)/2+p;else if(Vt(r)){const B=Object.keys(r)[0],L=r[B];k=this.chart.scales[B].getPixelForValue(L)+p}C=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")E=(e.left+e.right)/2-p;else if(Vt(r)){const B=Object.keys(r)[0],L=r[B];E=this.chart.scales[B].getPixelForValue(L)}C=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(c==="start"?O="top":c==="end"&&(O="bottom"));const M=this._getLabelSizes();for(g=0,b=l.length;g<b;++g){w=l[g],v=w.label;const B=a.setContext(this.getContext(g));I=this.getPixelForTick(g)+a.labelOffset,A=this._resolveTickFontOptions(g),$=A.lineHeight,T=ns(v)?v.length:1;const L=T/2,Y=B.color,D=B.textStrokeColor,_=B.textStrokeWidth;let P=C;o?(E=I,C==="inner"&&(g===b-1?P=this.options.reverse?"left":"right":g===0?P=this.options.reverse?"right":"left":P="center"),r==="top"?u==="near"||y!==0?F=-T*$+$/2:u==="center"?F=-M.highest.height/2-L*$+$:F=-M.highest.height+$/2:u==="near"||y!==0?F=$/2:u==="center"?F=M.highest.height/2-L*$:F=M.highest.height-T*$,m&&(F*=-1),y!==0&&!B.showLabelBackdrop&&(E+=$/2*Math.sin(y))):(k=I,F=(1-T)*$/2);let z;if(B.showLabelBackdrop){const q=ga(B.backdropPadding),K=M.heights[g],ae=M.widths[g];let ne=F-q.top,Z=0-q.left;switch(O){case"middle":ne-=K/2;break;case"bottom":ne-=K;break}switch(C){case"center":Z-=ae/2;break;case"right":Z-=ae;break;case"inner":g===b-1?Z-=ae:g>0&&(Z-=ae/2);break}z={left:Z,top:ne,width:ae+q.width,height:K+q.height,color:B.backdropColor}}x.push({label:v,font:A,textOffset:F,options:{rotation:y,color:Y,strokeColor:D,strokeWidth:_,textAlign:P,textBaseline:O,translation:[E,k],backdrop:z}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-au(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let u,d;return n==="left"?r?(d=this.right+a,s==="near"?u="left":s==="center"?(u="center",d+=c/2):(u="right",d+=c)):(d=this.right-l,s==="near"?u="right":s==="center"?(u="center",d-=c/2):(u="left",d=this.left)):n==="right"?r?(d=this.left+a,s==="near"?u="right":s==="center"?(u="center",d-=c/2):(u="left",d-=c)):(d=this.left+l,s==="near"?u="left":s==="center"?(u="center",d+=c/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:a,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,a,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(a=>a.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,u,d)=>{!d.width||!d.color||(s.save(),s.lineWidth=d.width,s.strokeStyle=d.color,s.setLineDash(d.borderDash||[]),s.lineDashOffset=d.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(u.x,u.y),s.stroke(),s.restore())};if(n.display)for(a=0,o=r.length;a<o;++a){const c=r[a];n.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),n.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,a=s.setContext(this.getContext()),o=s.display?a.width:0;if(!o)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,d,m,h;this.isHorizontal()?(u=cu(e,this.left,o)-o/2,d=cu(e,this.right,l)+l/2,m=h=c):(m=cu(e,this.top,o)-o/2,h=cu(e,this.bottom,l)+l/2,u=d=c),n.save(),n.lineWidth=a.width,n.strokeStyle=a.color,n.beginPath(),n.moveTo(u,m),n.lineTo(d,h),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&rC(s,r);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,u=o.label,d=o.textOffset;Df(s,u,0,d,c,l)}r&&aC(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const a=zs(s.font),o=ga(s.padding),l=s.align;let c=a.lineHeight/2;n==="bottom"||n==="center"||Vt(n)?(c+=o.bottom,ns(s.text)&&(c+=a.lineHeight*(s.text.length-1))):c+=o.top;const{titleX:u,titleY:d,maxWidth:m,rotation:h}=cCe(this,c,n,l);Df(e,s.text,0,0,a,{color:s.color,maxWidth:m,rotation:h,textAlign:lCe(l,n,r),textBaseline:"middle",translation:[u,d]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=Tt(e.grid&&e.grid.z,-1),r=Tt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==rm.prototype.draw?[{z:n,draw:a=>{this.draw(a)}}]:[{z:s,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let a,o;for(a=0,o=n.length;a<o;++a){const l=n[a];l[s]===this.id&&(!e||l.type===e)&&r.push(l)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return zs(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class rw{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;mCe(n)&&(s=this.register(n));const r=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in r||(r[a]=e,uCe(e,o,s),this.override&&zn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in zn[r]&&(delete zn[r][s],this.override&&delete lu[s])}}function uCe(t,e,n){const s=Sf(Object.create(null),[n?zn.get(n):{},zn.get(e),t.defaults]);zn.set(e,s),t.defaultRoutes&&dCe(e,t.defaultRoutes),t.descriptors&&zn.describe(e,t.descriptors)}function dCe(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),a=[t].concat(s).join("."),o=e[n].split("."),l=o.pop(),c=o.join(".");zn.route(a,r,c,l)})}function mCe(t){return"id"in t&&"defaults"in t}class hCe{constructor(){this.controllers=new rw(pC,"datasets",!0),this.elements=new rw(Dl,"elements"),this.plugins=new rw(Object,"plugins"),this.scales=new rw(rm,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const a=s||this._getRegistryForType(r);s||a.isForType(r)||a===this.plugins&&r.id?this._exec(e,a,r):Zt(r,o=>{const l=s||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,n,s){const r=KS(e);gn(s["before"+r],[],s),n[e](s),gn(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var _o=new hCe;class pCe{constructor(){this._init=void 0}notify(e,n,s,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(a,e,n,s);return n==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,s,r){r=r||{};for(const a of e){const o=a.plugin,l=o[s],c=[n,r,a.options];if(gn(l,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){qt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=Tt(s.options&&s.options.plugins,{}),a=fCe(s);return r===!1&&!n?[]:xCe(e,a,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function fCe(t){const e={},n=[],s=Object.keys(_o.plugins.items);for(let a=0;a<s.length;a++)n.push(_o.getPlugin(s[a]));const r=t.plugins||[];for(let a=0;a<r.length;a++){const o=r[a];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function gCe(t,e){return!e&&t===!1?null:t===!0?{}:t}function xCe(t,{plugins:e,localIds:n},s,r){const a=[],o=t.getContext();for(const l of e){const c=l.id,u=gCe(s[c],r);u!==null&&a.push({plugin:l,options:yCe(t.config,{plugin:l,local:n[c]},u,o)})}return a}function yCe(t,{plugin:e,local:n},s,r){const a=t.pluginScopeKeys(e),o=t.getOptionScopes(s,a);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function wC(t,e){const n=zn.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function bCe(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function wCe(t,e){return t===e?"_index_":"_value_"}function L6(t){if(t==="x"||t==="y"||t==="r")return t}function vCe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function vC(t,...e){if(L6(t))return t;for(const n of e){const s=n.axis||vCe(n.position)||t.length>1&&L6(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function z6(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function ECe(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return z6(t,"x",n[0])||z6(t,"y",n[0])}return{}}function NCe(t,e){const n=lu[t.type]||{scales:{}},s=e.scales||{},r=wC(t.type,e),a=Object.create(null);return Object.keys(s).forEach(o=>{const l=s[o];if(!Vt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=vC(o,l,ECe(o,t),zn.scales[l.type]),u=wCe(c,r),d=n.scales||{};a[o]=Cf(Object.create(null),[{axis:c},l,d[c],d[u]])}),t.data.datasets.forEach(o=>{const l=o.type||t.type,c=o.indexAxis||wC(l,e),d=(lu[l]||{}).scales||{};Object.keys(d).forEach(m=>{const h=bCe(m,c),p=o[h+"AxisID"]||h;a[p]=a[p]||Object.create(null),Cf(a[p],[{axis:h},s[p],d[m]])})}),Object.keys(a).forEach(o=>{const l=a[o];Cf(l,[zn.scales[l.type],zn.scale])}),a}function B6(t){const e=t.options||(t.options={});e.plugins=Tt(e.plugins,{}),e.scales=NCe(t,e)}function U6(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function kCe(t){return t=t||{},t.data=U6(t.data),B6(t),t}const V6=new Map,W6=new Set;function aw(t,e){let n=V6.get(t);return n||(n=e(),V6.set(t,n),W6.add(n)),n}const Uf=(t,e,n)=>{const s=Qd(e,n);s!==void 0&&t.add(s)};class SCe{constructor(e){this._config=kCe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=U6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),B6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return aw(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return aw(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return aw(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return aw(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:a}=this,o=this._cachedScopes(e,s),l=o.get(n);if(l)return l;const c=new Set;n.forEach(d=>{e&&(c.add(e),d.forEach(m=>Uf(c,e,m))),d.forEach(m=>Uf(c,r,m)),d.forEach(m=>Uf(c,lu[a]||{},m)),d.forEach(m=>Uf(c,zn,m)),d.forEach(m=>Uf(c,tC,m))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),W6.has(n)&&o.set(n,u),u}chartOptionScopes(){const{options:e,type:n}=this;return[e,lu[n]||{},zn.datasets[n]||{},{type:n},zn,tC]}resolveNamedOptions(e,n,s,r=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=j6(this._resolverCache,e,r);let c=o;if(ICe(o,n)){a.$shared=!1,s=Al(s)?s():s;const u=this.createResolver(e,s,l);c=tm(o,s,u)}for(const u of n)a[u]=c[u];return a}createResolver(e,n,s=[""],r){const{resolver:a}=j6(this._resolverCache,e,s);return Vt(n)?tm(a,n,void 0,r):a}}function j6(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let a=s.get(r);return a||(a={resolver:oC(e,n),subPrefixes:n.filter(l=>!l.toLowerCase().includes("hover"))},s.set(r,a)),a}const CCe=t=>Vt(t)&&Object.getOwnPropertyNames(t).some(e=>Al(t[e]));function ICe(t,e){const{isScriptable:n,isIndexable:s}=Yz(t);for(const r of e){const a=n(r),o=s(r),l=(o||a)&&t[r];if(a&&(Al(l)||CCe(l))||o&&ns(l))return!0}return!1}var $Ce="4.5.1";const TCe=["top","bottom","left","right","chartArea"];function G6(t,e){return t==="top"||t==="bottom"||TCe.indexOf(t)===-1&&e==="x"}function H6(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function q6(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),gn(n&&n.onComplete,[t],e)}function ACe(t){const e=t.chart,n=e.options.animation;gn(n&&n.onProgress,[t],e)}function K6(t){return cC()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const ow={},X6=t=>{const e=K6(t);return Object.values(ow).filter(n=>n.canvas===e).pop()};function RCe(t,e,n){const s=Object.keys(t);for(const r of s){const a=+r;if(a>=e){const o=t[r];delete t[r],(n>0||a>e)&&(t[a+n]=o)}}}function _Ce(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}let Vf=class{static defaults=zn;static instances=ow;static overrides=lu;static registry=_o;static version=$Ce;static getChart=X6;static register(...e){_o.add(...e),Y6()}static unregister(...e){_o.remove(...e),Y6()}constructor(e,n){const s=this.config=new SCe(n),r=K6(e),a=X6(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||YSe(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,d=c&&c.width;if(this.id=CNe(),this.ctx=l,this.canvas=c,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new pCe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=HNe(m=>this.update(m),o.resizeDelay||0),this._dataChanges=[],ow[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Ni.listen(this,"complete",q6),Ni.listen(this,"progress",ACe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:a}=this;return qt(e)?n&&a?a:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return _o}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():s6(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Hz(this.canvas,this.ctx),this}stop(){return Ni.stop(this),this}resize(e,n){Ni.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,a=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,a),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,s6(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),gn(s.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Zt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((o,l)=>(o[l]=!1,o),{});let a=[];n&&(a=a.concat(Object.keys(n).map(o=>{const l=n[o],c=vC(o,l),u=c==="r",d=c==="x";return{options:l,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),Zt(a,o=>{const l=o.options,c=l.id,u=vC(c,l),d=Tt(l.type,o.dtype);(l.position===void 0||G6(l.position,u)!==G6(o.dposition))&&(l.position=o.dposition),r[c]=!0;let m=null;if(c in s&&s[c].type===d)m=s[c];else{const h=_o.getScale(d);m=new h({id:c,type:d,ctx:this.ctx,chart:this}),s[m.id]=m}m.init(l,e)}),Zt(r,(o,l)=>{o||delete s[l]}),Zt(s,o=>{xa.configure(this,o,o.options),xa.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,a)=>r.index-a.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(H6("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(a=>a===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const a=n[s];let o=this.getDatasetMeta(s);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=l,o.indexAxis=a.indexAxis||wC(l,this.options),o.order=a.order||0,o.index=s,o.label=""+a.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const c=_o.getController(l),{datasetElementType:u,dataElementType:d}=zn.datasets[l];Object.assign(c,{dataElementType:_o.getElement(d),datasetElementType:u&&_o.getElement(u)}),o.controller=new c(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Zt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:m}=this.getDatasetMeta(u),h=!r&&a.indexOf(m)===-1;m.buildOrUpdateElements(h),o=Math.max(+m.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||Zt(a,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(H6("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Zt(this.scales,e=>{xa.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!$z(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:a}of n){const o=s==="_removeElements"?-a:a;RCe(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),r=s(0);for(let a=1;a<n;a++)if(!$z(r,s(a)))return;return Array.from(r).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;xa.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],Zt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,a)=>{r._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,Al(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ni.has(this)?this.attached&&!Ni.running(this)&&Ni.start(this):(this.draw(),q6({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,a;for(r=0,a=n.length;r<a;++r){const o=n[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Zke(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&rC(n,r),e.controller.draw(),r&&aC(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return _f(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const a=TSe.modes[n];return typeof a=="function"?a(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(a=>a&&a._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=uu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,r);If(n)?(a.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(a,{visible:s}),this.update(l=>l.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Ni.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Hz(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete ow[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(a,o)=>{n.addEventListener(this,a,o),e[a]=o},r=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};Zt(this.options.events,a=>s(a,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(c,u)=>{n.addEventListener(this,c,u),e[c]=u},r=(c,u)=>{e[c]&&(n.removeEventListener(this,c,u),delete e[c])},a=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",a),s("detach",o)};o=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),s("attach",l)},n.isAttached(this.canvas)?l():o()}unbindEvents(){Zt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Zt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let a,o,l,c;for(n==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!jb(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,a=(c,u)=>c.filter(d=>!u.some(m=>d.datasetIndex===m.datasetIndex&&d.index===m.index)),o=a(n,e),l=s?e:a(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const a=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(a||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:a}=this,o=n,l=this._getActiveElements(e,r,s,o),c=_Ne(e),u=_Ce(e,this._lastEvent,s,c);s&&(this._lastEvent=null,gn(a.onHover,[e,l,this],this),c&&gn(a.onClick,[e,l,this],this));const d=!jb(l,r);return(d||n)&&(this._active=l,this._updateHoverStyles(l,r,n)),this._lastEvent=u,d}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,r)}};function Y6(){return Zt(Vf.instances,t=>t._plugins.invalidate())}function Z6(t,e,n=e){t.lineCap=Tt(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Tt(n.borderDash,e.borderDash)),t.lineDashOffset=Tt(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Tt(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Tt(n.borderWidth,e.borderWidth),t.strokeStyle=Tt(n.borderColor,e.borderColor)}function DCe(t,e,n){t.lineTo(n.x,n.y)}function PCe(t){return t.stepped?ake:t.tension||t.cubicInterpolationMode==="monotone"?oke:DCe}function J6(t,e,n={}){const s=t.length,{start:r=0,end:a=s-1}=n,{start:o,end:l}=e,c=Math.max(r,o),u=Math.min(a,l),d=r<o&&a<o||r>l&&a>l;return{count:s,start:c,loop:e.loop,ilen:u<c&&!d?s+u-c:u-c}}function FCe(t,e,n,s){const{points:r,options:a}=e,{count:o,start:l,loop:c,ilen:u}=J6(r,n,s),d=PCe(a);let{move:m=!0,reverse:h}=s||{},p,f,y;for(p=0;p<=u;++p)f=r[(l+(h?u-p:p))%o],!f.skip&&(m?(t.moveTo(f.x,f.y),m=!1):d(t,y,f,h,a.stepped),y=f);return c&&(f=r[(l+(h?u:0))%o],d(t,y,f,h,a.stepped)),!!c}function MCe(t,e,n,s){const r=e.points,{count:a,start:o,ilen:l}=J6(r,n,s),{move:c=!0,reverse:u}=s||{};let d=0,m=0,h,p,f,y,x,g;const b=v=>(o+(u?l-v:v))%a,w=()=>{y!==x&&(t.lineTo(d,x),t.lineTo(d,y),t.lineTo(d,g))};for(c&&(p=r[b(0)],t.moveTo(p.x,p.y)),h=0;h<=l;++h){if(p=r[b(h)],p.skip)continue;const v=p.x,E=p.y,k=v|0;k===f?(E<y?y=E:E>x&&(x=E),d=(m*d+v)/++m):(w(),t.lineTo(v,E),f=k,m=0,y=x=E),g=E}w()}function EC(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?MCe:FCe}function OCe(t){return t.stepped?Lke:t.tension||t.cubicInterpolationMode==="monotone"?zke:hu}function LCe(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),Z6(t,e.options),t.stroke(r)}function zCe(t,e,n,s){const{segments:r,options:a}=e,o=EC(e);for(const l of r)Z6(t,a,l.style),t.beginPath(),o(t,e,l,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const BCe=typeof Path2D=="function";function UCe(t,e,n,s){BCe&&!e.options.segment?LCe(t,e,n,s):zCe(t,e,n,s)}class VCe extends Dl{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;Ake(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=qke(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],a=this.points,o=jke(this,{property:n,start:r,end:r});if(!o.length)return;const l=[],c=OCe(s);let u,d;for(u=0,d=o.length;u<d;++u){const{start:m,end:h}=o[u],p=a[m],f=a[h];if(p===f){l.push(p);continue}const y=Math.abs((r-p[n])/(f[n]-p[n])),x=c(p,f,y,s.stepped);x[n]=e[n],l.push(x)}return l.length===1?l[0]:l}pathSegment(e,n,s){return EC(this)(e,this,n,s)}path(e,n,s){const r=this.segments,a=EC(this);let o=this._loop;n=n||0,s=s||this.points.length-n;for(const l of r)o&=a(e,this,l,{start:n,end:n+s-1});return!!o}draw(e,n,s,r){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),UCe(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function Q6(t,e,n,s){const r=t.options,{[n]:a}=t.getProps([n],s);return Math.abs(e-a)<r.radius+r.hitRadius}class WCe extends Dl{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,s){const r=this.options,{x:a,y:o}=this.getProps(["x","y"],s);return Math.pow(e-a,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return Q6(this,e,"x",n)}inYRange(e,n){return Q6(this,e,"y",n)}getCenterPoint(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const s=n&&e.borderWidth||0;return(n+s)*2}draw(e,n){const s=this.options;this.skip||s.radius<.1||!_f(this,n,this.size(s)/2)||(e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.fillStyle=s.backgroundColor,sC(e,s,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function eB(t,e){const{x:n,y:s,base:r,width:a,height:o}=t.getProps(["x","y","base","width","height"],e);let l,c,u,d,m;return t.horizontal?(m=o/2,l=Math.min(n,r),c=Math.max(n,r),u=s-m,d=s+m):(m=a/2,l=n-m,c=n+m,u=Math.min(s,r),d=Math.max(s,r)),{left:l,top:u,right:c,bottom:d}}function Pl(t,e,n,s){return t?0:Or(e,n,s)}function jCe(t,e,n){const s=t.options.borderWidth,r=t.borderSkipped,a=Xz(s);return{t:Pl(r.top,a.top,0,n),r:Pl(r.right,a.right,0,e),b:Pl(r.bottom,a.bottom,0,n),l:Pl(r.left,a.left,0,e)}}function GCe(t,e,n){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,a=em(r),o=Math.min(e,n),l=t.borderSkipped,c=s||Vt(r);return{topLeft:Pl(!c||l.top||l.left,a.topLeft,0,o),topRight:Pl(!c||l.top||l.right,a.topRight,0,o),bottomLeft:Pl(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:Pl(!c||l.bottom||l.right,a.bottomRight,0,o)}}function HCe(t){const e=eB(t),n=e.right-e.left,s=e.bottom-e.top,r=jCe(t,n/2,s/2),a=GCe(t,n/2,s/2);return{outer:{x:e.left,y:e.top,w:n,h:s,radius:a},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function NC(t,e,n,s){const r=e===null,a=n===null,l=t&&!(r&&a)&&eB(t,s);return l&&(r||ou(e,l.left,l.right))&&(a||ou(n,l.top,l.bottom))}function qCe(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function KCe(t,e){t.rect(e.x,e.y,e.w,e.h)}function kC(t,e,n={}){const s=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,a=(t.x+t.w!==n.x+n.w?e:0)-s,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+s,y:t.y+r,w:t.w+a,h:t.h+o,radius:t.radius}}class XCe extends Dl{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:s,backgroundColor:r}}=this,{inner:a,outer:o}=HCe(this),l=qCe(o.radius)?Kb:KCe;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,kC(o,n,a)),e.clip(),l(e,kC(a,-n,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),l(e,kC(a,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,s){return NC(this,e,n,s)}inXRange(e,n){return NC(this,e,null,n)}inYRange(e,n){return NC(this,null,e,n)}getCenterPoint(e){const{x:n,y:s,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(n+r)/2:n,y:a?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const tB=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},YCe=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class nB extends Dl{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=gn(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=zs(s.font),a=r.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=tB(s,a);let u,d;n.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,a,l,c)+10):(d=this.maxHeight,u=this._fitCols(o,r,l,c)+10),this.width=Math.min(u,e.maxWidth||this.maxWidth),this.height=Math.min(d,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+l;let m=e;a.textAlign="left",a.textBaseline="middle";let h=-1,p=-d;return this.legendItems.forEach((f,y)=>{const x=s+n/2+a.measureText(f.text).width;(y===0||u[u.length-1]+x+2*l>o)&&(m+=d,u[u.length-(y>0?0:1)]=0,p+=d,h++),c[y]={left:0,top:p,row:h,width:x,height:r},u[u.length-1]+=x+l}),m}_fitCols(e,n,s,r){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-e;let m=l,h=0,p=0,f=0,y=0;return this.legendItems.forEach((x,g)=>{const{itemWidth:b,itemHeight:w}=ZCe(s,n,a,x,r);g>0&&p+w+2*l>d&&(m+=h+l,u.push({width:h,height:p}),f+=h+l,y++,h=p=0),c[g]={left:f,top:p,col:y,width:b,height:w},h=Math.max(h,b),p+=w+l}),m+=h,u.push({width:h,height:p}),m}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:a}}=this,o=sm(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=Ls(s,this.left+r,this.right-this.lineWidths[l]);for(const u of n)l!==u.row&&(l=u.row,c=Ls(s,this.left+r,this.right-this.lineWidths[l])),u.top+=this.top+e+r,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+r}else{let l=0,c=Ls(s,this.top+e+r,this.bottom-this.columnSizes[l].height);for(const u of n)u.col!==l&&(l=u.col,c=Ls(s,this.top+e+r,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;rC(e,this),this._draw(),aC(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:a,labels:o}=e,l=zn.color,c=sm(e.rtl,this.left,this.width),u=zs(o.font),{padding:d}=o,m=u.size,h=m/2;let p;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:f,boxHeight:y,itemHeight:x}=tB(o,m),g=function(k,C,I){if(isNaN(f)||f<=0||isNaN(y)||y<0)return;r.save();const A=Tt(I.lineWidth,1);if(r.fillStyle=Tt(I.fillStyle,l),r.lineCap=Tt(I.lineCap,"butt"),r.lineDashOffset=Tt(I.lineDashOffset,0),r.lineJoin=Tt(I.lineJoin,"miter"),r.lineWidth=A,r.strokeStyle=Tt(I.strokeStyle,l),r.setLineDash(Tt(I.lineDash,[])),o.usePointStyle){const $={radius:y*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:A},T=c.xPlus(k,f/2),F=C+h;qz(r,$,T,F,o.pointStyleWidth&&f)}else{const $=C+Math.max((m-y)/2,0),T=c.leftForLtr(k,f),F=em(I.borderRadius);r.beginPath(),Object.values(F).some(O=>O!==0)?Kb(r,{x:T,y:$,w:f,h:y,radius:F}):r.rect(T,$,f,y),r.fill(),A!==0&&r.stroke()}r.restore()},b=function(k,C,I){Df(r,I.text,k,C+x/2,u,{strikethrough:I.hidden,textAlign:c.textAlign(I.textAlign)})},w=this.isHorizontal(),v=this._computeTitleHeight();w?p={x:Ls(a,this.left+d,this.right-s[0]),y:this.top+d+v,line:0}:p={x:this.left+d,y:Ls(a,this.top+v+d,this.bottom-n[0].height),line:0},a6(this.ctx,e.textDirection);const E=x+d;this.legendItems.forEach((k,C)=>{r.strokeStyle=k.fontColor,r.fillStyle=k.fontColor;const I=r.measureText(k.text).width,A=c.textAlign(k.textAlign||(k.textAlign=o.textAlign)),$=f+h+I;let T=p.x,F=p.y;c.setWidth(this.width),w?C>0&&T+$+d>this.right&&(F=p.y+=E,p.line++,T=p.x=Ls(a,this.left+d,this.right-s[p.line])):C>0&&F+E>this.bottom&&(T=p.x=T+n[p.line].width+d,p.line++,F=p.y=Ls(a,this.top+v+d,this.bottom-n[p.line].height));const O=c.x(T);if(g(O,F,k),T=qNe(A,T+f+h,w?T+$:this.right,e.rtl),b(c.x(T),F,k),w)p.x+=$+d;else if(typeof k.text!="string"){const M=u.lineHeight;p.y+=sB(k,M)+d}else p.y+=E}),o6(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=zs(n.font),r=ga(n.padding);if(!n.display)return;const a=sm(e.rtl,this.left,this.width),o=this.ctx,l=n.position,c=s.size/2,u=r.top+c;let d,m=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),d=this.top+u,m=Ls(e.align,m,this.right-h);else{const f=this.columnSizes.reduce((y,x)=>Math.max(y,x.height),0);d=u+Ls(e.align,this.top,this.bottom-f-e.labels.padding-this._computeTitleHeight())}const p=Ls(l,m,m+h);o.textAlign=a.textAlign(JS(l)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=s.string,Df(o,n.text,p,d,s)}_computeTitleHeight(){const e=this.options.title,n=zs(e.font),s=ga(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,a;if(ou(e,this.left,this.right)&&ou(n,this.top,this.bottom)){for(a=this.legendHitBoxes,s=0;s<a.length;++s)if(r=a[s],ou(e,r.left,r.left+r.width)&&ou(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!eIe(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,a=YCe(r,s);r&&!a&&gn(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!a&&gn(n.onHover,[e,s,this],this)}else s&&gn(n.onClick,[e,s,this],this)}}function ZCe(t,e,n,s,r){const a=JCe(s,t,e,n),o=QCe(r,s,e.lineHeight);return{itemWidth:a,itemHeight:o}}function JCe(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((a,o)=>a.length>o.length?a:o)),e+n.size/2+s.measureText(r).width}function QCe(t,e,n){let s=t;return typeof e.text!="string"&&(s=sB(e,n)),s}function sB(t,e){const n=t.text?t.text.length:0;return e*n}function eIe(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var rB={id:"legend",_element:nB,start(t,e,n){const s=t.legend=new nB({ctx:t.ctx,options:n,chart:t});xa.configure(t,s,n),xa.addBox(t,s)},stop(t){xa.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;xa.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:a,useBorderRadius:o,borderRadius:l}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(n?0:void 0),d=ga(u.borderWidth);return{text:e[c.index].label,fillStyle:u.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:s||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class aB extends Dl{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=ns(s.text)?s.text.length:1;this._padding=ga(s.padding);const a=r*zs(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:a,options:o}=this,l=o.align;let c=0,u,d,m;return this.isHorizontal()?(d=Ls(l,s,a),m=n+e,u=a-s):(o.position==="left"?(d=s+e,m=Ls(l,r,n),c=ms*-.5):(d=a-e,m=Ls(l,n,r),c=ms*.5),u=r-n),{titleX:d,titleY:m,maxWidth:u,rotation:c}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=zs(n.font),a=s.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(a);Df(e,n.text,0,0,s,{color:n.color,maxWidth:c,rotation:u,textAlign:JS(n.align),textBaseline:"middle",translation:[o,l]})}}function tIe(t,e){const n=new aB({ctx:t.ctx,options:e,chart:t});xa.configure(t,n,e),xa.addBox(t,n),t.titleBlock=n}var oB={id:"title",_element:aB,start(t,e,n){tIe(t,n)},stop(t){const e=t.titleBlock;xa.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;xa.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Wf={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,a=0;for(e=0,n=t.length;e<n;++e){const l=t[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),r+=c.y,++a}}return a===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:r/a}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=t.length;a<o;++a){const c=t[a].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),d=YS(e,u);d<r&&(r=d,l=c)}}if(l){const c=l.tooltipPosition();n=c.x,s=c.y}return{x:n,y:s}}};function Do(t,e){return e&&(ns(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function ki(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function nIe(t,e){const{element:n,datasetIndex:s,index:r}=e,a=t.getDatasetMeta(s).controller,{label:o,value:l}=a.getLabelAndValue(r);return{chart:t,label:o,parsed:a.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:l,dataset:a.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function iB(t,e){const n=t.chart.ctx,{body:s,footer:r,title:a}=t,{boxWidth:o,boxHeight:l}=e,c=zs(e.bodyFont),u=zs(e.titleFont),d=zs(e.footerFont),m=a.length,h=r.length,p=s.length,f=ga(e.padding);let y=f.height,x=0,g=s.reduce((v,E)=>v+E.before.length+E.lines.length+E.after.length,0);if(g+=t.beforeBody.length+t.afterBody.length,m&&(y+=m*u.lineHeight+(m-1)*e.titleSpacing+e.titleMarginBottom),g){const v=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;y+=p*v+(g-p)*c.lineHeight+(g-1)*e.bodySpacing}h&&(y+=e.footerMarginTop+h*d.lineHeight+(h-1)*e.footerSpacing);let b=0;const w=function(v){x=Math.max(x,n.measureText(v).width+b)};return n.save(),n.font=u.string,Zt(t.title,w),n.font=c.string,Zt(t.beforeBody.concat(t.afterBody),w),b=e.displayColors?o+2+e.boxPadding:0,Zt(s,v=>{Zt(v.before,w),Zt(v.lines,w),Zt(v.after,w)}),b=0,n.font=d.string,Zt(t.footer,w),n.restore(),x+=f.width,{width:x,height:y}}function sIe(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function rIe(t,e,n,s){const{x:r,width:a}=s,o=n.caretSize+n.caretPadding;if(t==="left"&&r+a+o>e.width||t==="right"&&r-a-o<0)return!0}function aIe(t,e,n,s){const{x:r,width:a}=n,{width:o,chartArea:{left:l,right:c}}=t;let u="center";return s==="center"?u=r<=(l+c)/2?"left":"right":r<=a/2?u="left":r>=o-a/2&&(u="right"),rIe(u,t,e,n)&&(u="center"),u}function lB(t,e,n){const s=n.yAlign||e.yAlign||sIe(t,n);return{xAlign:n.xAlign||e.xAlign||aIe(t,e,n,s),yAlign:s}}function oIe(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function iIe(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function cB(t,e,n,s){const{caretSize:r,caretPadding:a,cornerRadius:o}=t,{xAlign:l,yAlign:c}=n,u=r+a,{topLeft:d,topRight:m,bottomLeft:h,bottomRight:p}=em(o);let f=oIe(e,l);const y=iIe(e,c,u);return c==="center"?l==="left"?f+=u:l==="right"&&(f-=u):l==="left"?f-=Math.max(d,h)+r:l==="right"&&(f+=Math.max(m,p)+r),{x:Or(f,0,s.width-e.width),y:Or(y,0,s.height-e.height)}}function iw(t,e,n){const s=ga(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function uB(t){return Do([],ki(t))}function lIe(t,e,n){return uu(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function dB(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const mB={beforeTitle:Ei,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Ei,beforeBody:Ei,beforeLabel:Ei,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return qt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Ei,afterBody:Ei,beforeFooter:Ei,footer:Ei,afterFooter:Ei};function br(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?mB[e].call(n,s):r}class hB extends Dl{static positioners=Wf;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,a=new m6(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=lIe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=br(s,"beforeTitle",this,e),a=br(s,"title",this,e),o=br(s,"afterTitle",this,e);let l=[];return l=Do(l,ki(r)),l=Do(l,ki(a)),l=Do(l,ki(o)),l}getBeforeBody(e,n){return uB(br(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return Zt(e,a=>{const o={before:[],lines:[],after:[]},l=dB(s,a);Do(o.before,ki(br(l,"beforeLabel",this,a))),Do(o.lines,br(l,"label",this,a)),Do(o.after,ki(br(l,"afterLabel",this,a))),r.push(o)}),r}getAfterBody(e,n){return uB(br(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=br(s,"beforeFooter",this,e),a=br(s,"footer",this,e),o=br(s,"afterFooter",this,e);let l=[];return l=Do(l,ki(r)),l=Do(l,ki(a)),l=Do(l,ki(o)),l}_createItems(e){const n=this._active,s=this.chart.data,r=[],a=[],o=[];let l=[],c,u;for(c=0,u=n.length;c<u;++c)l.push(nIe(this.chart,n[c]));return e.filter&&(l=l.filter((d,m,h)=>e.filter(d,m,h,s))),e.itemSort&&(l=l.sort((d,m)=>e.itemSort(d,m,s))),Zt(l,d=>{const m=dB(e.callbacks,d);r.push(br(m,"labelColor",this,d)),a.push(br(m,"labelPointStyle",this,d)),o.push(br(m,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let a,o=[];if(!r.length)this.opacity!==0&&(a={opacity:0});else{const l=Wf[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const c=this._size=iB(this,s),u=Object.assign({},l,c),d=lB(this.chart,s,u),m=cB(s,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,a={opacity:1,x:m.x,y:m.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const a=this.getCaretPosition(e,s,r);n.lineTo(a.x1,a.y1),n.lineTo(a.x2,a.y2),n.lineTo(a.x3,a.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:a}=this,{caretSize:o,cornerRadius:l}=s,{topLeft:c,topRight:u,bottomLeft:d,bottomRight:m}=em(l),{x:h,y:p}=e,{width:f,height:y}=n;let x,g,b,w,v,E;return a==="center"?(v=p+y/2,r==="left"?(x=h,g=x-o,w=v+o,E=v-o):(x=h+f,g=x+o,w=v-o,E=v+o),b=x):(r==="left"?g=h+Math.max(c,d)+o:r==="right"?g=h+f-Math.max(u,m)-o:g=this.caretX,a==="top"?(w=p,v=w-o,x=g-o,b=g+o):(w=p+y,v=w+o,x=g+o,b=g-o),E=w),{x1:x,x2:g,x3:b,y1:w,y2:v,y3:E}}drawTitle(e,n,s){const r=this.title,a=r.length;let o,l,c;if(a){const u=sm(s.rtl,this.x,this.width);for(e.x=iw(this,s.titleAlign,s),n.textAlign=u.textAlign(s.titleAlign),n.textBaseline="middle",o=zs(s.titleFont),l=s.titleSpacing,n.fillStyle=s.titleColor,n.font=o.string,c=0;c<a;++c)n.fillText(r[c],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,n,s,r,a){const o=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:u}=a,d=zs(a.bodyFont),m=iw(this,"left",a),h=r.x(m),p=c<d.lineHeight?(d.lineHeight-c)/2:0,f=n.y+p;if(a.usePointStyle){const y={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},x=r.leftForLtr(h,u)+u/2,g=f+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,sC(e,y,x,g),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,sC(e,y,x,g)}else{e.lineWidth=Vt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const y=r.leftForLtr(h,u),x=r.leftForLtr(r.xPlus(h,1),u-2),g=em(o.borderRadius);Object.values(g).some(b=>b!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Kb(e,{x:y,y:f,w:u,h:c,radius:g}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Kb(e,{x,y:f+1,w:u-2,h:c-2,radius:g}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(y,f,u,c),e.strokeRect(y,f,u,c),e.fillStyle=o.backgroundColor,e.fillRect(x,f+1,u-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:d}=s,m=zs(s.bodyFont);let h=m.lineHeight,p=0;const f=sm(s.rtl,this.x,this.width),y=function(I){n.fillText(I,f.x(e.x+p),e.y+h/2),e.y+=h+a},x=f.textAlign(o);let g,b,w,v,E,k,C;for(n.textAlign=o,n.textBaseline="middle",n.font=m.string,e.x=iw(this,x,s),n.fillStyle=s.bodyColor,Zt(this.beforeBody,y),p=l&&x!=="right"?o==="center"?u/2+d:u+2+d:0,v=0,k=r.length;v<k;++v){for(g=r[v],b=this.labelTextColors[v],n.fillStyle=b,Zt(g.before,y),w=g.lines,l&&w.length&&(this._drawColorBox(n,e,v,f,s),h=Math.max(m.lineHeight,c)),E=0,C=w.length;E<C;++E)y(w[E]),h=m.lineHeight;Zt(g.after,y)}p=0,h=m.lineHeight,Zt(this.afterBody,y),e.y-=a}drawFooter(e,n,s){const r=this.footer,a=r.length;let o,l;if(a){const c=sm(s.rtl,this.x,this.width);for(e.x=iw(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=c.textAlign(s.footerAlign),n.textBaseline="middle",o=zs(s.footerFont),n.fillStyle=s.footerColor,n.font=o.string,l=0;l<a;++l)n.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:u,height:d}=s,{topLeft:m,topRight:h,bottomLeft:p,bottomRight:f}=em(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(l+m,c),o==="top"&&this.drawCaret(e,n,s,r),n.lineTo(l+u-h,c),n.quadraticCurveTo(l+u,c,l+u,c+h),o==="center"&&a==="right"&&this.drawCaret(e,n,s,r),n.lineTo(l+u,c+d-f),n.quadraticCurveTo(l+u,c+d,l+u-f,c+d),o==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(l+p,c+d),n.quadraticCurveTo(l,c+d,l,c+d-p),o==="center"&&a==="left"&&this.drawCaret(e,n,s,r),n.lineTo(l,c+m),n.quadraticCurveTo(l,c,l+m,c),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,a=s&&s.y;if(r||a){const o=Wf[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=iB(this,e),c=Object.assign({},o,this._size),u=lB(n,e,c),d=cB(e,c,u,n);(r._to!==d.x||a._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=ga(n.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&l&&(e.save(),e.globalAlpha=s,this.drawBackground(a,e,r,n),a6(e,n.textDirection),a.y+=o.top,this.drawTitle(a,e,n),this.drawBody(a,e,n),this.drawFooter(a,e,n),o6(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),a=!jb(s,r),o=this._positionChanged(r,n);(a||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],o=this._getActiveElements(e,a,n,s),l=this._positionChanged(o,e),c=n||!jb(o,a)||l;return c&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),c}_getActiveElements(e,n,s,r){const a=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,s);return a.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:s,caretY:r,options:a}=this,o=Wf[a.position].call(this,e,n);return o!==!1&&(s!==o.x||r!==o.y)}}var pB={id:"tooltip",_element:hB,positioners:Wf,afterInit(t,e,n){n&&(t.tooltip=new hB({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:mB},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const cIe=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function uIe(t,e,n,s){const r=t.indexOf(e);if(r===-1)return cIe(t,e,n,s);const a=t.lastIndexOf(e);return r!==a?n:r}const dIe=(t,e)=>t===null?null:Or(Math.round(t),0,e);function fB(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class gB extends rm{static id="category";static defaults={ticks:{callback:fB}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:a}of n)s[r]===a&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(qt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:uIe(s,e,Tt(n,e),this._addedLabels),dIe(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let a=this.getLabels();a=e===0&&n===a.length-1?a:a.slice(e,n+1),this._valueRange=Math.max(a.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return fB.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function mIe(t,e){const n=[],{bounds:r,step:a,min:o,max:l,precision:c,count:u,maxTicks:d,maxDigits:m,includeBounds:h}=t,p=a||1,f=d-1,{min:y,max:x}=e,g=!qt(o),b=!qt(l),w=!qt(u),v=(x-y)/(m+1);let E=Az((x-y)/f/p)*p,k,C,I,A;if(E<1e-14&&!g&&!b)return[{value:y},{value:x}];A=Math.ceil(x/E)-Math.floor(y/E),A>f&&(E=Az(A*E/f/p)*p),qt(c)||(k=Math.pow(10,c),E=Math.ceil(E*k)/k),r==="ticks"?(C=Math.floor(y/E)*E,I=Math.ceil(x/E)*E):(C=y,I=x),g&&b&&a&&ONe((l-o)/a,E/1e3)?(A=Math.round(Math.min((l-o)/E,d)),E=(l-o)/A,C=o,I=l):w?(C=g?o:C,I=b?l:I,A=u-1,E=(I-C)/A):(A=(I-C)/E,$f(A,Math.round(A),E/1e3)?A=Math.round(A):A=Math.ceil(A));const $=Math.max(Rz(E),Rz(C));k=Math.pow(10,qt(c)?$:c),C=Math.round(C*k)/k,I=Math.round(I*k)/k;let T=0;for(g&&(h&&C!==o?(n.push({value:o}),C<o&&T++,$f(Math.round((C+T*E)*k)/k,o,xB(o,v,t))&&T++):C<o&&T++);T<A;++T){const F=Math.round((C+T*E)*k)/k;if(b&&F>l)break;n.push({value:F})}return b&&h&&I!==l?n.length&&$f(n[n.length-1].value,l,xB(l,v,t))?n[n.length-1].value=l:n.push({value:l}):(!b||I===l)&&n.push({value:I}),n}function xB(t,e,{horizontal:n,minRotation:s}){const r=au(s),a=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/a,o)}class hIe extends rm{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return qt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:a}=this;const o=c=>r=n?r:c,l=c=>a=s?a:c;if(e){const c=Ro(r),u=Ro(a);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(r===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(r-c)}this.min=r,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},a=this._range||this,o=mIe(r,a);return e.bounds==="ticks"&&LNe(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return Vz(e,this.chart.options.locale,this.options.ticks.format)}}class yB extends hIe{static id="linear";static defaults={ticks:{callback:jz.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=fa(e)?e:0,this.max=fa(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=au(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,a.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const lw={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},wr=Object.keys(lw);function bB(t,e){return t-e}function wB(t,e){if(qt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:a}=t._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),fa(o)||(o=typeof s=="string"?n.parse(o,s):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Tf(a)||a===!0)?n.startOf(o,"isoWeek",a):n.startOf(o,r)),+o)}function vB(t,e,n,s){const r=wr.length;for(let a=wr.indexOf(t);a<r-1;++a){const o=lw[wr[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(l*o.size))<=s)return wr[a]}return wr[r-1]}function pIe(t,e,n,s,r){for(let a=wr.length-1;a>=wr.indexOf(n);a--){const o=wr[a];if(lw[o].common&&t._adapter.diff(r,s,o)>=e-1)return o}return wr[n?wr.indexOf(n):0]}function fIe(t){for(let e=wr.indexOf(t)+1,n=wr.length;e<n;++e)if(lw[wr[e]].common)return wr[e]}function EB(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=ZS(n,e),a=n[s]>=e?n[s]:n[r];t[a]=!0}}function gIe(t,e,n,s){const r=t._adapter,a=+r.startOf(e[0].value,s),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+r.add(l,1,s))c=n[l],c>=0&&(e[c].major=!0);return e}function NB(t,e,n){const s=[],r={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],r[l]=o,s.push({value:l,major:!1});return a===0||!n?s:gIe(t,s,r,n)}class kB extends rm{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new kSe._date(e.adapters.date);r.init(n),Cf(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:wB(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!l&&!isNaN(u.max)&&(a=Math.max(a,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=fa(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),a=fa(a)&&!isNaN(a)?a:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,o=this.max,l=jNe(r,a,o);return this._unit=n.unit||(s.autoSkip?vB(n.minUnit,this.min,this.max,this._getLabelCapacity(a)):pIe(this,l.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:fIe(this._unit),this.initOffsets(r),e.reverse&&l.reverse(),NB(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,a;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?s=a:s=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=Or(n,0,o),s=Or(s,0,o),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,a=r.time,o=a.unit||vB(a.minUnit,n,s,this._getLabelCapacity(n)),l=Tt(r.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,u=Tf(c)||c===!0,d={};let m=n,h,p;if(u&&(m=+e.startOf(m,"isoWeek",c)),m=+e.startOf(m,u?"day":o),e.diff(s,n,o)>1e5*l)throw new Error(n+" and "+s+" are too far apart with stepSize of "+l+" "+o);const f=r.ticks.source==="data"&&this.getDataTimestamps();for(h=m,p=0;h<s;h=+e.add(h,l,o),p++)EB(d,h,f);return(h===s||r.bounds==="ticks"||p===1)&&EB(d,h,f),Object.keys(d).sort(bB).map(y=>+y)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,a=this._unit,o=n||r[a];return this._adapter.format(e,o)}_tickFormatFunction(e,n,s,r){const a=this.options,o=a.ticks.callback;if(o)return gn(o,[e,n,s],this);const l=a.time.displayFormats,c=this._unit,u=this._majorUnit,d=c&&l[c],m=u&&l[u],h=s[n],p=u&&m&&h&&h.major;return this._adapter.format(e,r||(p?m:d))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=au(this.isHorizontal()?n.maxRotation:n.minRotation),a=Math.cos(r),o=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*a+l*o,h:s*o+l*a}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,a=this._tickFormatFunction(e,0,NB(this,[e],this._majorUnit),r),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(wB(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Fz(e.sort(bB))}}function cw(t,e,n){let s=0,r=t.length-1,a,o,l,c;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=iu(t,"pos",e)),{pos:a,time:l}=t[s],{pos:o,time:c}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=iu(t,"time",e)),{time:a,pos:l}=t[s],{time:o,pos:c}=t[r]);const u=o-a;return u?l+(c-l)*(e-a)/u:l}class cTe extends kB{static id="timeseries";static defaults=kB.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=cw(n,this.min),this._tableRange=cw(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],a=[];let o,l,c,u,d;for(o=0,l=e.length;o<l;++o)u=e[o],u>=n&&u<=s&&r.push(u);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(o=0,l=r.length;o<l;++o)d=r[o+1],c=r[o-1],u=r[o],Math.round((d+c)/2)!==u&&a.push({time:u,pos:o/(l-1)});return a}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,a)=>r-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(cw(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return cw(this._table,s*this._tableRange+this._minPos,!0)}}const SB="label";function CB(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function xIe(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function IB(t,e){t.labels=e}function $B(t,e,n=SB){const s=[];t.datasets=e.map(r=>{const a=t.datasets.find(o=>o[n]===r[n]);return!a||!r.data||s.includes(a)?{...r}:(s.push(a),Object.assign(a,r),a)})}function yIe(t,e=SB){const n={labels:[],datasets:[]};return IB(n,t.labels),$B(n,t.datasets,e),n}function bIe(t,e){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:a,type:o,data:l,options:c,plugins:u=[],fallbackContent:d,updateMode:m,...h}=t,p=N.useRef(null),f=N.useRef(null),y=()=>{p.current&&(f.current=new Vf(p.current,{type:o,data:yIe(l,a),options:c&&{...c},plugins:u}),CB(e,f.current))},x=()=>{CB(e,null),f.current&&(f.current.destroy(),f.current=null)};return N.useEffect(()=>{!r&&f.current&&c&&xIe(f.current,c)},[r,c]),N.useEffect(()=>{!r&&f.current&&IB(f.current.config.data,l.labels)},[r,l.labels]),N.useEffect(()=>{!r&&f.current&&l.datasets&&$B(f.current.config.data,l.datasets,a)},[r,l.datasets]),N.useEffect(()=>{f.current&&(r?(x(),setTimeout(y)):f.current.update(m))},[r,c,l.labels,l.datasets,m]),N.useEffect(()=>{f.current&&(x(),setTimeout(y))},[o]),N.useEffect(()=>(y(),()=>x()),[]),yz.jsx("canvas",{ref:p,role:"img",height:n,width:s,...h,children:d})}const wIe=N.forwardRef(bIe);function TB(t,e){return Vf.register(e),N.forwardRef((n,s)=>yz.jsx(wIe,{...n,ref:s,type:t}))}const vIe=TB("line",NSe),EIe=TB("bar",ESe);Vf.register(gB,yB,XCe,oB,pB,rB);function NIe({rep:t,slots:e}){const[n,s]=N.useState([]);N.useEffect(()=>{const o=K2e(t,e);s(o)},[t,e]);const r={labels:["Satisfaction","Efficiency","Quality"],datasets:[{label:"Performance Score",data:[n.find(o=>o.metric==="satisfaction")?.value||0,n.find(o=>o.metric==="efficiency")?.value||0,n.find(o=>o.metric==="quality")?.value||0],backgroundColor:["rgba(59, 130, 246, 0.6)","rgba(16, 185, 129, 0.6)","rgba(139, 92, 246, 0.6)"],borderColor:["rgb(59, 130, 246)","rgb(16, 185, 129)","rgb(139, 92, 246)"],borderWidth:1}]},a={responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100}},plugins:{legend:{display:!1}}};return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Ta,{className:"w-5 h-5 text-green-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Performance Metrics")),i.createElement("div",{className:"h-64 mb-4"},i.createElement(EIe,{data:r,options:a})),i.createElement("div",{className:"grid grid-cols-3 gap-2"},n.map(o=>i.createElement("div",{key:o.metric,className:"text-center p-2 bg-gray-50 rounded-lg"},i.createElement("div",{className:"text-xs text-gray-500 capitalize"},o.metric),i.createElement("div",{className:"text-lg font-bold"},Math.round(o.value),"%")))))}Vf.register(gB,yB,WCe,VCe,oB,pB,rB);function AB({slots:t}){const[e,n]=N.useState([]);N.useEffect(()=>{const a=X2e(t);n(a)},[t]);const s={labels:e.map(a=>{const o=new Date(a.date);return`${o.getDate()}/${o.getMonth()+1}`}),datasets:[{label:"Predicted Hours",data:e.map(a=>a.predictedHours),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.5)",tension:.3}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Hours"}}}};return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(lA,{className:"w-5 h-5 text-purple-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Workload Prediction")),i.createElement("div",{className:"h-64"},i.createElement(vIe,{data:s,options:r})),i.createElement("div",{className:"mt-4 bg-purple-50 p-3 rounded-lg flex items-start"},i.createElement(Ia,{className:"w-5 h-5 text-purple-600 mr-2 mt-0.5"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-purple-900"},"AI Insight"),i.createElement("p",{className:"text-sm text-purple-800 mt-1"},"Based on historical trends, next week appears to have heavier workload on Tuesday and Thursday. Consider distributing tasks earlier in the week."))))}function RB({slots:t,reps:e,selectedDate:n,onAttendanceUpdate:s}){const[r,a]=N.useState(null),[o,l]=N.useState(""),c=t.filter(m=>m.date===jt(n,"yyyy-MM-dd")&&m.status==="reserved"),u=(m,h)=>{s(m.id,h,o),a(null),l("")},d=m=>{const h=e.find(p=>p.id===m);return h?h.name:"Unknown REP"};return c.length===0?i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Ct,{className:"w-5 h-5 text-blue-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Attendance Tracking")),i.createElement("div",{className:"text-center py-8 text-gray-500"},"No reserved slots for this date to track attendance")):i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Ct,{className:"w-5 h-5 text-blue-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Attendance Tracking")),i.createElement("div",{className:"space-y-3"},c.map(m=>{const h=r===m.id;return i.createElement("div",{key:m.id,className:"border rounded-lg overflow-hidden"},i.createElement("div",{className:`p-3 flex items-center justify-between cursor-pointer ${m.attended===!0?"bg-green-50":m.attended===!1?"bg-red-50":"bg-white"}`,onClick:()=>a(h?null:m.id)},i.createElement("div",null,i.createElement("div",{className:"font-medium"},d(m.repId)),i.createElement("div",{className:"text-sm text-gray-600"},m.startTime," - ",m.endTime)),i.createElement("div",{className:"flex items-center"},m.attended===!0&&i.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},i.createElement(mt,{className:"w-3 h-3 mr-1"}),"Attended"),m.attended===!1&&i.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},i.createElement(qi,{className:"w-3 h-3 mr-1"}),"Missed"),m.attended===void 0&&i.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},i.createElement(Xm,{className:"w-3 h-3 mr-1"}),"Not Recorded"))),h&&i.createElement("div",{className:"p-3 border-t bg-gray-50"},i.createElement("div",{className:"mb-3"},i.createElement("label",{htmlFor:"attendanceNotes",className:"block text-sm font-medium text-gray-700 mb-1"},"Notes"),i.createElement("textarea",{id:"attendanceNotes",value:o,onChange:p=>l(p.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",rows:2,placeholder:"Add notes about attendance..."})),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{onClick:()=>u(m,!0),className:"flex-1 py-2 px-4 bg-green-600 hover:bg-green-700 text-white rounded-md font-medium flex items-center justify-center"},i.createElement(mt,{className:"w-4 h-4 mr-2"}),"Mark Attended"),i.createElement("button",{onClick:()=>u(m,!1),className:"flex-1 py-2 px-4 bg-red-600 hover:bg-red-700 text-white rounded-md font-medium flex items-center justify-center"},i.createElement(qi,{className:"w-4 h-4 mr-2"}),"Mark Missed"))))})))}function kIe({rep:t,slots:e}){const n=N.useMemo(()=>{const a=e.filter(g=>g.repId===t.id&&g.status==="reserved"&&g.attended!==void 0),o=a.length,l=a.filter(g=>g.attended===!0).length,c=new Date,u=$h(c),d=jE(c),m=a.filter(g=>{const b=new Date(g.date);return HE(b,{start:u,end:d})}),h=m.length,p=m.filter(g=>g.attended===!0).length,f=o>0?Math.round(l/o*100):0,y=h>0?Math.round(p/h*100):0;let x="Unknown";return o>=5&&(f>=95?x="Excellent":f>=85?x="Good":f>=75?x="Average":x="Needs Improvement"),{attendanceScore:f,currentMonthScore:y,totalTracked:o,attended:l,currentMonthTotal:h,currentMonthAttended:p,reliabilityTier:x}},[t,e]),s=a=>a>=90?"text-green-600":a>=80?"text-blue-600":a>=70?"text-yellow-600":"text-red-600",r=a=>{switch(a){case"Excellent":return"bg-green-100 text-green-800";case"Good":return"bg-blue-100 text-blue-800";case"Average":return"bg-yellow-100 text-yellow-800";case"Needs Improvement":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Sa,{className:"w-5 h-5 text-blue-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Attendance Scorecard")),i.createElement("div",{className:"flex justify-center mb-6"},i.createElement("div",{className:"w-32 h-32 rounded-full border-8 border-blue-100 flex items-center justify-center"},i.createElement("div",{className:"text-center"},i.createElement("div",{className:`text-3xl font-bold ${s(n.attendanceScore)}`},n.attendanceScore,"%"),i.createElement("div",{className:"text-sm text-gray-500"},"Overall Score")))),i.createElement("div",{className:"grid grid-cols-2 gap-4 mb-6"},i.createElement("div",{className:"bg-gray-50 p-3 rounded-lg text-center"},i.createElement("div",{className:"text-sm text-gray-500"},"Current Month"),i.createElement("div",{className:`text-xl font-bold ${s(n.currentMonthScore)}`},n.currentMonthScore,"%"),i.createElement("div",{className:"text-xs text-gray-500"},n.currentMonthAttended," of ",n.currentMonthTotal," sessions")),i.createElement("div",{className:"bg-gray-50 p-3 rounded-lg text-center"},i.createElement("div",{className:"text-sm text-gray-500"},"Reliability Tier"),i.createElement("div",{className:`text-sm font-medium px-2 py-1 rounded-full inline-block mt-1 ${r(n.reliabilityTier)}`},n.reliabilityTier))),i.createElement("div",{className:"space-y-3"},i.createElement("div",{className:"flex justify-between items-center p-2 bg-green-50 rounded-lg"},i.createElement("div",{className:"flex items-center"},i.createElement(mt,{className:"w-4 h-4 text-green-600 mr-2"}),i.createElement("span",{className:"text-sm"},"Sessions Attended")),i.createElement("span",{className:"font-medium"},n.attended)),i.createElement("div",{className:"flex justify-between items-center p-2 bg-red-50 rounded-lg"},i.createElement("div",{className:"flex items-center"},i.createElement(qi,{className:"w-4 h-4 text-red-600 mr-2"}),i.createElement("span",{className:"text-sm"},"Sessions Missed")),i.createElement("span",{className:"font-medium"},n.totalTracked-n.attended)),i.createElement("div",{className:"flex justify-between items-center p-2 bg-blue-50 rounded-lg"},i.createElement("div",{className:"flex items-center"},i.createElement(Sn,{className:"w-4 h-4 text-blue-600 mr-2"}),i.createElement("span",{className:"text-sm"},"Total Tracked")),i.createElement("span",{className:"font-medium"},n.totalTracked))),n.totalTracked<5&&i.createElement("div",{className:"mt-4 text-sm text-gray-500 bg-yellow-50 p-2 rounded-lg"},i.createElement(Sn,{className:"w-4 h-4 text-yellow-600 inline mr-1"}),"Not enough data for reliable scoring (minimum 5 sessions)"))}function _B({reps:t,slots:e}){const[n,s]=N.useState("month"),[r,a]=N.useState("score"),o=e.filter(m=>{const h=aZ(m.date),p=new Date;if(n==="month"){const f=$h(p),y=jE(p);return HE(h,{start:f,end:y})}else if(n==="week"){const f=new Date(p);f.setDate(p.getDate()-p.getDay());const y=new Date(f);return y.setDate(f.getDate()+6),HE(h,{start:f,end:y})}return!0}),c=[...t.map(m=>{const h=o.filter(x=>x.repId===m.id&&x.status==="reserved"&&x.attended!==void 0),p=h.length,f=h.filter(x=>x.attended===!0).length,y=p>0?Math.round(f/p*100):0;return{...m,attendanceScore:y,totalTracked:p,attended:f}})].sort((m,h)=>r==="name"?m.name.localeCompare(h.name):(h.attendanceScore||0)-(m.attendanceScore||0)),u=m=>{const h=m||0;return h>=90?"text-green-600":h>=80?"text-blue-600":h>=70?"text-yellow-600":"text-red-600"},d=()=>{const m=["REP Name","Email","Attendance Score","Sessions Attended","Total Sessions","Specialties"],h=c.map(g=>[g.name,g.email,`${g.attendanceScore}%`,g.attended,g.totalTracked,g.specialties.join(", ")]),p=[m.join(","),...h.map(g=>g.join(","))].join(`
`),f=new Blob([p],{type:"text/csv;charset=utf-8;"}),y=URL.createObjectURL(f),x=document.createElement("a");x.setAttribute("href",y),x.setAttribute("download",`attendance_report_${jt(new Date,"yyyy-MM-dd")}.csv`),x.click()};return i.createElement("div",{className:"bg-white rounded-lg shadow p-4"},i.createElement("div",{className:"flex items-center justify-between mb-4"},i.createElement("div",{className:"flex items-center"},i.createElement(hn,{className:"w-5 h-5 text-blue-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Attendance Report")),i.createElement("button",{onClick:d,className:"px-3 py-1 bg-blue-600 text-white rounded-md text-sm font-medium flex items-center"},i.createElement(qu,{className:"w-4 h-4 mr-1"}),"Export")),i.createElement("div",{className:"flex items-center justify-between mb-4"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(eh,{className:"w-4 h-4 text-gray-500"}),i.createElement("select",{value:n,onChange:m=>s(m.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},i.createElement("option",{value:"all"},"All Time"),i.createElement("option",{value:"month"},"This Month"),i.createElement("option",{value:"week"},"This Week"))),i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("span",{className:"text-sm text-gray-500"},"Sort by:"),i.createElement("select",{value:r,onChange:m=>a(m.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},i.createElement("option",{value:"score"},"Attendance Score"),i.createElement("option",{value:"name"},"Name")))),i.createElement("div",{className:"overflow-x-auto"},i.createElement("table",{className:"min-w-full divide-y divide-gray-200"},i.createElement("thead",{className:"bg-gray-50"},i.createElement("tr",null,i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"REP"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Attendance Score"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Sessions"),i.createElement("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Specialties"))),i.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},c.map(m=>i.createElement("tr",{key:m.id},i.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center"},m.avatar?i.createElement("img",{src:m.avatar,alt:m.name,className:"h-10 w-10 rounded-full"}):i.createElement("span",{className:"text-gray-500 text-sm"},m.name.charAt(0))),i.createElement("div",{className:"ml-4"},i.createElement("div",{className:"text-sm font-medium text-gray-900"},m.name),i.createElement("div",{className:"text-sm text-gray-500"},m.email)))),i.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},i.createElement("div",{className:`text-lg font-bold ${u(m.attendanceScore)}`},m.attendanceScore,"%")),i.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"flex items-center mr-2"},i.createElement(mt,{className:"w-4 h-4 text-green-500 mr-1"}),i.createElement("span",{className:"text-sm"},m.attended)),i.createElement("div",{className:"flex items-center"},i.createElement(qi,{className:"w-4 h-4 text-red-500 mr-1"}),i.createElement("span",{className:"text-sm"},m.totalTracked-m.attended)))),i.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},i.createElement("div",{className:"flex flex-wrap gap-1"},m.specialties.map(h=>i.createElement("span",{key:h,className:"px-2 py-0.5 rounded-full text-xs bg-gray-100"},h)))))),c.length===0&&i.createElement("tr",null,i.createElement("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500"},"No attendance data available for the selected timeframe"))))))}const jf="https://v25matchingbackend-production.up.railway.app/api",fu={getTimeSlots:async(t,e,n)=>{try{const s={};return t&&(s.agentId=t),e&&(s.gigId=e),n&&(s.date=n),(await Ie.get(`${jf}/time-slots`,{params:s})).data}catch(s){throw console.error("Error fetching time slots:",s),s}},upsertTimeSlot:async t=>{try{return(await Ie.post(`${jf}/time-slots`,t)).data}catch(e){throw console.error("Error saving time slot:",e),e}},deleteTimeSlot:async t=>{try{await Ie.delete(`${jf}/time-slots/${t}`)}catch(e){throw console.error("Error deleting time slot:",e),e}},cancelTimeSlot:async t=>{try{return(await Ie.patch(`${jf}/time-slots/${t}/cancel`)).data}catch(e){throw console.error("Error cancelling time slot:",e),e}},getGigAgents:async(t,e)=>{try{const n={};return e&&(n.status=e),(await Ie.get(`${jf}/gig-agents/gigs/${t}/agents`,{params:n})).data}catch(n){throw console.error("Error fetching gig agents:",n),n}}},Gf="https://v25matchingbackend-production.up.railway.app/api",SIe={generateSlots:async t=>{try{return(await Ie.post(`${Gf}/slots/generate`,t)).data}catch(e){throw console.error("Error generating slots:",e),e}},getSlots:async(t,e)=>{try{const n={};return t&&(n.gigId=t),e&&(n.date=e),(await Ie.get(`${Gf}/slots`,{params:n})).data}catch(n){throw console.error("Error fetching slots:",n),n}},reserveSlot:async(t,e,n)=>{try{return(await Ie.post(`${Gf}/slots/${t}/reserve`,{agentId:e,notes:n})).data}catch(s){throw console.error("Error reserving slot:",s),s}},cancelReservation:async t=>{try{return(await Ie.delete(`${Gf}/slots/reservations/${t}`)).data}catch(e){throw console.error("Error cancelling reservation:",e),e}},getReservations:async(t,e)=>{try{const n={};return t&&(n.agentId=t),e&&(n.gigId=e),(await Ie.get(`${Gf}/slots/reservations`,{params:n})).data}catch(n){throw console.error("Error fetching reservations:",n),n}}};function CIe({gigId:t,companyId:e,selectedDate:n,onSlotsGenerated:s}){const[r,a]=N.useState(1),[o,l]=N.useState("09:00"),[c,u]=N.useState("18:00"),[d,m]=N.useState(!1),[h,p]=N.useState(null),[f,y]=N.useState(!1),[x,g]=N.useState([]),[b,w]=N.useState(!1);N.useEffect(()=>{(async()=>{if(!t){g([]);return}try{y(!0),w(!1),g([]);const C=await Ie.get(`https://v25gigsmanualcreationbackend-production.up.railway.app/api/gigs/${t}`),I=C.data.data||C.data,A=jt(n,"EEEE");if(I.availability?.schedule&&Array.isArray(I.availability.schedule)){const $=new Set,T=I.availability.schedule.find(F=>F.day.toLowerCase()===A.toLowerCase());if(T&&T.hours?.start&&T.hours?.end){const F=parseInt(T.hours.start.split(":")[0],10),O=parseInt(T.hours.end.split(":")[0],10);for(let B=F;B<=O;B++)$.add(`${B.toString().padStart(2,"0")}:00`);const M=Array.from($).sort();g(M),w(!0),M.length>0&&(l(M[0]),u(M[M.length-1]))}else g([]),w(!1)}else g([]),w(!1)}catch(k){console.error("Error fetching gig data:",k),p({text:"Failed to load gig availability",type:"error"}),w(!1)}finally{y(!1)}})()},[t,n]);const v=async()=>{if(!t){p({text:"Please select a gig first",type:"error"});return}try{const E=parseInt(o.split(":")[0],10),k=parseInt(c.split(":")[0],10);if(E>=k){p({text:"End time must be after start time",type:"error"});return}m(!0),p(null);const C=jt(n,"yyyy-MM-dd"),I={gigId:t,companyId:e,startDate:C,endDate:C,slotDuration:1,capacity:r,startHour:E,endHour:k},A=await SIe.generateSlots(I);p({text:A.message||`Slots created successfully for ${C}`,type:"success"}),s&&setTimeout(()=>{s(),p(null)},2e3)}catch(E){console.error("Error creating slots:",E),p({text:E.response?.data?.message||E.message||"Failed to create slots",type:"error"})}finally{m(!1)}};return!f&&!b&&t?null:i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},i.createElement("div",{className:"flex items-center gap-2 mb-4"},i.createElement(Ia,{className:"w-5 h-5 text-blue-600"}),i.createElement("h3",{className:"text-base font-semibold text-gray-900"},"Create Slots")),i.createElement("p",{className:"text-sm text-gray-500 mb-4"},"Automatically create available time slots for this gig based on the parameters below."),f?i.createElement("div",{className:"text-center py-4"},i.createElement("div",{className:"inline-block w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"}),i.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Loading gig availability...")):i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},i.createElement("div",null,i.createElement("label",{className:"block text-xs font-medium text-gray-500 mb-1"},"Start Time"),i.createElement("select",{value:o,onChange:E=>l(E.target.value),className:"w-full rounded-xl border border-gray-200 bg-gray-50 px-3 py-2 text-sm font-medium text-gray-800"},x.map(E=>i.createElement("option",{key:E,value:E},E)))),i.createElement("div",null,i.createElement("label",{className:"block text-xs font-medium text-gray-500 mb-1"},"End Time"),i.createElement("select",{value:c,onChange:E=>u(E.target.value),className:"w-full rounded-xl border border-gray-200 bg-gray-50 px-3 py-2 text-sm font-medium text-gray-800"},x.map(E=>i.createElement("option",{key:E,value:E},E)))),i.createElement("div",null,i.createElement("label",{className:"block text-xs font-medium text-gray-500 mb-1"},"Capacity (reps per slot)"),i.createElement("input",{type:"number",value:r,onChange:E=>a(parseInt(E.target.value)||1),min:1,max:50,className:"w-full rounded-xl border border-gray-200 bg-gray-50 px-3 py-2 text-sm font-medium text-gray-800"}))),h&&i.createElement("div",{className:`mt-4 p-3 rounded-xl flex items-center gap-2 ${h.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-red-50 text-red-800 border border-red-200"}`},h.type==="success"?i.createElement(mt,{className:"w-5 h-5"}):i.createElement(Sn,{className:"w-5 h-5"}),i.createElement("span",{className:"text-sm font-medium"},h.text)),i.createElement("button",{onClick:v,disabled:d||!t||f,className:"mt-4 w-full py-3 bg-blue-600 text-white rounded-xl text-sm font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},d?i.createElement(i.Fragment,null,i.createElement("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating..."):i.createElement(i.Fragment,null,i.createElement(Ia,{className:"w-4 h-4"}),"Create Slots")))}const IIe=t=>{let e=0;for(let s=0;s<t.length;s++)e=t.charCodeAt(s)+((e<<5)-e);const n=(e&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-n.length)+n},uw=t=>{const e=t.agentId&&typeof t.agentId=="object"?t.agentId:null,n=t.gigId&&typeof t.gigId=="object"?t.gigId:null,s=t._id?.$oid||t._id?.toString()||crypto.randomUUID(),r=e?._id||e?.$oid||t.agentId?.toString()||t.repId?.toString()||"",a=n?._id||n?.$oid||t.gigId?.toString()||"";return{id:s,startTime:t.startTime,endTime:t.endTime,date:t.date,gigId:a,repId:r,status:t.status,duration:t.duration||1,notes:t.notes,attended:t.attended,attendanceNotes:t.attendanceNotes,agent:e,gig:n}},$Ie=t=>{const e=t._id?.$oid||t._id?.toString()||crypto.randomUUID();return{id:e,name:t.title,description:t.description,company:t.companyName||"Unknown Company",color:IIe(e),skills:t.requiredSkills?.map(n=>typeof n=="string"?n:n.name)||[],priority:"medium"}},DB=[{id:"1",name:"Alex Johnson",email:"alex@harx.com",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",specialties:["Customer Support","Technical Troubleshooting"],performanceScore:87,preferredHours:{start:9,end:17},attendanceScore:92,attendanceHistory:[]},{id:"2",name:"Jamie Smith",email:"jamie@harx.com",avatar:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",specialties:["Sales","Product Demos"],performanceScore:92,preferredHours:{start:8,end:16},attendanceScore:85,attendanceHistory:[]},{id:"3",name:"Taylor Wilson",email:"taylor@harx.com",avatar:"https://images.unsplash.com/photo-1519345182560-3f2917c472ef?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",specialties:["Training","Onboarding"],performanceScore:78,preferredHours:{start:10,end:18},attendanceScore:78,attendanceHistory:[]},{id:"4",name:"Morgan Lee",email:"morgan@harx.com",avatar:"https://images.unsplash.com/photo-1531427186611-ecfd6d936c79?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",specialties:["Technical Support","Product Expertise"],performanceScore:85,preferredHours:{start:9,end:17},attendanceScore:88,attendanceHistory:[]}],PB=[{id:"1",name:"Tech Co",logo:"https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-1.2.1&auto=format&fit=crop&w=128&h=128&q=80",priority:3},{id:"2",name:"Marketing Inc",logo:"https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-1.2.1&auto=format&fit=crop&w=128&h=128&q=80",priority:2},{id:"3",name:"Acme Corp",logo:"https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-1.2.1&auto=format&fit=crop&w=128&h=128&q=80",priority:1}];function TIe(){const[t,e]=i.useState(new Date),[n,s]=N.useState([]),[r,a]=N.useState(null),[o,l]=N.useState(null),[c]=N.useState("company"),[u,d]=N.useState(DB[0].id),[m,h]=N.useState(null),[p,f]=N.useState(!1),[y,x]=N.useState(!1),[g,b]=N.useState(!1),[w,v]=N.useState(DB),[E,k]=N.useState([]),[C,I]=N.useState(!0),[A,$]=N.useState("");N.useState("09:00"),N.useState("10:00"),N.useState(!1),N.useEffect(()=>{const _=async()=>{const z=$e.get("companyId");if(!z){l({message:"Company ID not found. Gigs cannot be loaded.",type:"error"}),I(!1);return}try{I(!0);const K=await Ie.get(`https://v25gigsmanualcreationbackend-production.up.railway.app/api/gigs/company/${z}`),ae=K.data.data||K.data;if(Array.isArray(ae)){const ne=ae.map($Ie);k(ne),ne.length>0&&h(ne[0].id),console.log(`Loaded ${ne.length} gigs`)}}catch(q){console.error("Error fetching gigs:",q),l({message:"Failed to load Gigs",type:"error"})}finally{I(!1)}};(async()=>{const z=await j2e();f(z)})(),_()},[c]),N.useEffect(()=>{(async()=>{if(m)try{I(!0);const P=await fu.getGigAgents(m);if(P&&P.length>0){const ae=P.map(ne=>{const Z=ne.agentId&&typeof ne.agentId=="object"?ne.agentId:ne,ke=Z?._id||Z?.$oid||Z?.toString()||"",Ae=Z.personalInfo||{},W=Z.professionalSummary||{};return{id:ke,name:Ae.name||Z.name||Z.fullName||"Unknown Agent",email:Ae.email||Z.email||"",avatar:Ae.photo?.url||Z.avatar||Z.photo?.url||"",specialties:W.currentRole?[W.currentRole]:Z.specialties||[],performanceScore:Z.performanceScore||85,preferredHours:Z.preferredHours||{start:9,end:17},attendanceScore:Z.attendanceScore||90,attendanceHistory:[]}});v(ae),ae.length>0&&!ae.find(ne=>ne.id===u)&&d(ae[0].id),ae.length>0&&!ae.find(ne=>ne.id===A)&&$(ae[0].id)}else $("");const z=await fu.getTimeSlots(void 0,m),q=Array.isArray(z)?z.map(uw):[];s(q);const K=[];q.forEach(ae=>{if(ae.agent&&ae.agent._id){const ne=ae.agent,Z=ne.personalInfo||{},ke=ne.professionalSummary||{},Ae=ne?._id||ne?.$oid||ne?.toString()||"";!w.find(W=>W.id===Ae)&&!K.find(W=>W.id===Ae)&&K.push({id:Ae,name:Z.name||ne.name||ne.fullName||"Unknown Agent",email:Z.email||ne.email||"",avatar:Z.photo?.url||ne.avatar||ne.photo?.url||"",specialties:ke.currentRole?[ke.currentRole]:ne.specialties||[],performanceScore:ne.performanceScore||85,preferredHours:ne.preferredHours||{start:9,end:17},attendanceScore:ne.attendanceScore||90,attendanceHistory:[]})}}),K.length>0&&v(ae=>{const ne=[...ae];return K.forEach(Z=>{ne.find(ke=>ke.id===Z.id)||ne.push(Z)}),ne})}catch(P){console.error("Error fetching gig data:",P)}finally{I(!1)}})()},[m,t]);const T=N.useMemo(()=>w.find(_=>_.id===u)||w[0],[u,w]),F=N.useMemo(()=>{const _={totalHours:0,projectBreakdown:{},availableSlots:0,reservedSlots:0};return(c==="rep"?n.filter(z=>z.repId===u):n).forEach(z=>{z.status!=="cancelled"&&(_.totalHours+=z.duration||1,z.status==="available"?_.availableSlots++:z.status==="reserved"&&_.reservedSlots++,z.gigId&&(_.projectBreakdown[z.gigId]=(_.projectBreakdown[z.gigId]||0)+(z.duration||1)))}),_},[n,c,u]),O=async _=>{let P;if(_.id){const z=n.find(q=>q.id===_.id);z?P={...z,..._}:P={..._,repId:_.repId||u}}else if(r)P={...r,..._};else return;try{await fu.upsertTimeSlot(P);const z=await fu.getTimeSlots(u),q=Array.isArray(z)?z.map(uw):[];s(q),l({message:_.id?"Time slot updated successfully":"New time slot created",type:"success"})}catch(z){console.error("Error saving slot:",z),l({message:"Failed to save time slot",type:"error"})}setTimeout(()=>l(null),3e3)},M=async _=>{try{await fu.cancelTimeSlot(_);const P=await fu.getTimeSlots(u),z=Array.isArray(P)?P.map(uw):[];s(z),l({message:"Time slot cancelled",type:"success"})}catch(P){console.error("Error cancelling slot:",P),l({message:"Failed to cancel time slot",type:"error"})}setTimeout(()=>l(null),3e3),r?.id===_&&a(null)},B=_=>{a(_)};jt(t,"yyyy-MM-dd")<jt(new Date,"yyyy-MM-dd");const L=_=>{const P=T.preferredHours?.start||9,z=`${P.toString().padStart(2,"0")}:00`,q=n.find(K=>K.date===jt(t,"yyyy-MM-dd")&&K.startTime===z&&K.repId===u);O(q?{...q,gigId:_,status:"reserved"}:{id:crypto.randomUUID(),startTime:z,endTime:`${(P+1).toString().padStart(2,"0")}:00`,date:jt(t,"yyyy-MM-dd"),status:"reserved",duration:1,gigId:_,repId:u})},Y=_=>{const P=document.getElementById(`time-slot-${_}`);P&&P.scrollIntoView({behavior:"smooth"});const z=`${_.toString().padStart(2,"0")}:00`,q=n.find(K=>K.date===jt(t,"yyyy-MM-dd")&&K.startTime===z&&K.repId===u);q?a(q):(O({id:crypto.randomUUID(),startTime:z,endTime:`${(_+1).toString().padStart(2,"0")}:00`,date:jt(t,"yyyy-MM-dd"),status:"available",duration:1,repId:u}),a({id:crypto.randomUUID(),startTime:z,endTime:`${(_+1).toString().padStart(2,"0")}:00`,date:jt(t,"yyyy-MM-dd"),status:"available",duration:1,repId:u}))},D=(_,P,z)=>{s(K=>K.map(ae=>ae.id===_?{...ae,attended:P,attendanceNotes:z}:ae));const q=n.find(K=>K.id===_);if(q){const K=w.findIndex(ae=>ae.id===q.repId);if(K>=0){const ae=w[K],ne={date:q.date,slotId:_,attended:P,reason:z},Z={...ae,attendanceHistory:[...ae.attendanceHistory||[],ne]},ke=Z.attendanceHistory.filter(le=>le.attended).length,Ae=Z.attendanceHistory.length,W=Ae>0?Math.round(ke/Ae*100):0;Z.attendanceScore=W,v(le=>[...le.slice(0,K),Z,...le.slice(K+1)])}}l({message:`Attendance ${P?"confirmed":"marked as missed"}`,type:"success"}),setTimeout(()=>l(null),3e3)};return i.createElement("div",{className:"min-h-screen bg-gray-50"},o&&i.createElement("div",{className:`fixed top-4 right-4 z-50 px-4 py-3 rounded-xl shadow-lg flex items-center gap-2 ${o.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-200":"bg-red-50 text-red-800 border border-red-200"}`},i.createElement(Sn,{className:"w-5 h-5 shrink-0"}),i.createElement("p",{className:"font-medium"},o.message)),i.createElement("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6"},i.createElement("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-100"},i.createElement("div",{className:"flex flex-wrap items-center justify-between gap-4"},i.createElement("div",{className:"flex items-center gap-3"},i.createElement("div",{className:"p-2.5 bg-blue-50 rounded-xl"},i.createElement(Ho,{className:"w-7 h-7 text-blue-600"})),i.createElement("div",null,i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Session Planning"),i.createElement("p",{className:"text-sm text-gray-500 mt-0.5"},"Schedule and manage time slots")),C&&i.createElement("span",{className:"text-xs text-blue-500 font-medium animate-pulse"},"Loading Gigs...")),i.createElement("div",{className:"flex items-center gap-6"},i.createElement("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-gray-50 rounded-xl border border-gray-100"},i.createElement(Ct,{className:"w-5 h-5 text-blue-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 font-medium"},"Weekly Hours"),i.createElement("p",{className:"text-lg font-bold text-gray-900"},F.totalHours,"h"))),i.createElement("div",{className:"flex items-center gap-3 px-4 py-2.5 bg-gray-50 rounded-xl border border-gray-100"},i.createElement(Ca,{className:"w-5 h-5 text-indigo-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 font-medium"},"Active Gigs"),i.createElement("p",{className:"text-lg font-bold text-gray-900"},Object.keys(F.projectBreakdown).length))))),i.createElement("div",{className:"mt-4 pt-4 border-t border-gray-100 flex flex-wrap gap-2"},i.createElement("button",{onClick:()=>x(!y),className:`px-4 py-2 rounded-xl text-sm font-medium flex items-center gap-2 ${y?"bg-purple-100 text-purple-800":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-100"}`},i.createElement(Jl,{className:"w-4 h-4"}),"AI Assistant ",y?"On":"Off"),i.createElement("button",{onClick:()=>b(!g),className:`px-4 py-2 rounded-xl text-sm font-medium flex items-center gap-2 ${g?"bg-emerald-100 text-emerald-800":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-100"}`},i.createElement(Ct,{className:"w-4 h-4"}),"Attendance ",g?"On":"Off"))),i.createElement("main",{className:"space-y-6"},c==="company"?i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement("div",{className:"flex space-x-2 overflow-x-auto pb-2 no-scrollbar"},E.length===0?i.createElement("div",{className:"text-gray-500 italic px-4 py-3 bg-white rounded-xl border border-dashed border-gray-200 w-full text-center text-sm"},"No active gigs found."):E.map(_=>i.createElement("button",{key:_.id,onClick:()=>h(_.id),className:`px-4 py-2.5 rounded-xl whitespace-nowrap text-sm font-medium transition-all ${m===_.id?"bg-blue-600 text-white shadow-sm":"bg-white text-gray-600 hover:bg-gray-50 border border-gray-200"}`},_.name))),i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement(jD,{selectedDate:t,onDateSelect:e,slots:n,view:"2-weeks"})),m&&i.createElement(i.Fragment,null,i.createElement(CIe,{gigId:m||void 0,companyId:$e.get("companyId"),selectedDate:t,onSlotsGenerated:()=>{if(!m)return;(async()=>{try{const P=await fu.getTimeSlots(void 0,m),z=Array.isArray(P)?P.map(uw):[];s(z)}catch(P){console.error("Error refreshing slots:",P)}})()}})),m&&i.createElement(SZ,{company:E.find(_=>_.id===m)?.name||"",slots:n,projects:E.filter(_=>_.id===m).map(_=>({..._,company:_.name})),reps:w,selectedDate:t}),g&&i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},i.createElement(RB,{slots:n,reps:w,selectedDate:t,onAttendanceUpdate:D}),i.createElement(_B,{reps:w,slots:n})),y&&i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 border-l-4 border-purple-500"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Jl,{className:"w-6 h-6 text-purple-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"AI Insights")),i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},i.createElement(AB,{slots:n})))):c==="rep"?i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement(kZ,{reps:w,selectedRepId:u,onSelectRep:d}),i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},i.createElement("div",{className:"lg:col-span-2"},i.createElement(jD,{selectedDate:t,onDateSelect:e,slots:n.filter(_=>_.repId===u),view:"2-weeks"})),i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},i.createElement("h2",{className:"text-base font-semibold text-gray-900 mb-4"},"Weekly Overview"),i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"flex justify-between items-center text-sm"},i.createElement("span",{className:"text-gray-500"},"Available Slots"),i.createElement("span",{className:"font-semibold text-gray-900"},F.availableSlots)),i.createElement("div",{className:"flex justify-between items-center text-sm"},i.createElement("span",{className:"text-gray-500"},"Reserved Slots"),i.createElement("span",{className:"font-semibold text-gray-900"},F.reservedSlots)),i.createElement("hr",{className:"my-4 border-gray-100"}),i.createElement("h3",{className:"text-sm font-semibold text-gray-900 mb-2"},"Gig Hours"),Object.entries(F.projectBreakdown).map(([_,P])=>{const z=E.find(q=>q.id===_);return i.createElement("div",{key:_,className:"flex justify-between items-center"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-3 h-3 rounded-full mr-2",style:{backgroundColor:z?.color||"#ccc"}}),i.createElement("span",{className:"text-gray-600"},z?.name||"Unknown Gig")),i.createElement("span",{className:"font-medium"},P,"h"))}),i.createElement("hr",{className:"my-4 border-gray-100"}),i.createElement("h3",{className:"text-sm font-semibold text-gray-900 mb-2"},"Quick Reserve"),i.createElement(NZ,{slot:r||n[0]||{},availableProjects:E,onUpdate:O,onClear:()=>M(r?.id||"")})))),g&&i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},i.createElement(kIe,{rep:T,slots:n}),i.createElement(RB,{slots:n.filter(_=>_.repId===u),reps:w,selectedDate:t,onAttendanceUpdate:D})),y&&i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6"},i.createElement("div",null,i.createElement(Y2e,{rep:T,projects:E,slots:n,onSelectProject:L})),i.createElement("div",null,i.createElement(Z2e,{rep:T,slots:n,onSelectHour:Y})),i.createElement("div",null,i.createElement(NIe,{rep:T,slots:n}))),i.createElement(EZ,{selectedSlotId:r?.id||null,slots:n.filter(_=>_.repId===u),projects:E,onSlotClick:_=>B(n.find(P=>P.id===_))})):i.createElement("div",{className:"grid grid-cols-1 gap-6"},i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Admin Dashboard"),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},i.createElement("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100"},i.createElement("h3",{className:"text-sm font-medium text-blue-800 mb-1"},"Total REPs"),i.createElement("p",{className:"text-2xl font-bold text-blue-900"},w.length)),i.createElement("div",{className:"bg-emerald-50 p-4 rounded-xl border border-emerald-100"},i.createElement("h3",{className:"text-sm font-medium text-emerald-800 mb-1"},"Total Companies"),i.createElement("p",{className:"text-2xl font-bold text-emerald-900"},PB.length)),i.createElement("div",{className:"bg-purple-50 p-4 rounded-xl border border-purple-100"},i.createElement("h3",{className:"text-sm font-medium text-purple-800 mb-1"},"Total Gigs"),i.createElement("p",{className:"text-2xl font-bold text-purple-900"},E.length)))),g&&i.createElement(_B,{reps:w,slots:n}),y&&i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},i.createElement(AB,{slots:n}),i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},i.createElement("div",{className:"flex items-center mb-4"},i.createElement(Jl,{className:"w-5 h-5 text-purple-600 mr-2"}),i.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"AI Insights")),i.createElement("div",{className:"space-y-4"},i.createElement("div",{className:"p-4 bg-purple-50 rounded-xl border border-purple-100"},i.createElement("h3",{className:"text-sm font-medium text-purple-800 mb-2"},"Scheduling Efficiency"),i.createElement("p",{className:"text-sm text-gray-700"},"Based on current scheduling patterns, the system is operating at",i.createElement("span",{className:"font-bold text-purple-800"}," 78% "),"efficiency. Consider optimizing REP assignments based on AI recommendations.")),i.createElement("div",{className:"p-4 bg-blue-50 rounded-xl border border-blue-100"},i.createElement("h3",{className:"text-sm font-medium text-blue-800 mb-2"},"Resource Allocation"),i.createElement("p",{className:"text-sm text-gray-700"},"Tech Co projects are currently overallocated by",i.createElement("span",{className:"font-bold text-blue-800"}," 12% "),"while Acme Corp is underallocated. Consider rebalancing resources.")),i.createElement("div",{className:"p-4 bg-emerald-50 rounded-xl border border-emerald-100"},i.createElement("h3",{className:"text-sm font-medium text-emerald-800 mb-2"},"Performance Insights"),i.createElement("p",{className:"text-sm text-gray-700"},"REPs with diverse project assignments show",i.createElement("span",{className:"font-bold text-green-800"}," 23% higher "),"satisfaction scores. Consider rotating assignments more frequently."))))),i.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"REP Overview"),i.createElement("div",{className:"space-y-4"},w.map(_=>{const P=n.filter(q=>q.repId===_.id&&q.status==="reserved"),z=P.reduce((q,K)=>q+(K.duration||1),0);return i.createElement("div",{key:_.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl border border-gray-100"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center mr-3"},_.avatar?i.createElement("img",{src:_.avatar,alt:_.name,className:"w-full h-full rounded-full object-cover"}):i.createElement(qr,{className:"w-5 h-5 text-gray-500"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium"},_.name),i.createElement("p",{className:"text-sm text-gray-500"},_.email))),i.createElement("div",{className:"text-right"},i.createElement("p",{className:"text-lg font-bold"},z,"h"),i.createElement("p",{className:"text-sm text-gray-500"},P.length," slots"),_.performanceScore&&i.createElement("div",{className:"mt-1 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800"},"Score: ",_.performanceScore),_.attendanceScore&&i.createElement("div",{className:"mt-1 ml-1 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},"Attendance: ",_.attendanceScore,"%")))}))),i.createElement("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Company Overview"),i.createElement("div",{className:"space-y-4"},PB.map(_=>{const P=n.filter(K=>E.find(ne=>ne.id===K.gigId)?.company===_.name&&K.status==="reserved"),z=P.reduce((K,ae)=>K+(ae.duration||1),0),q=new Set(P.map(K=>K.repId)).size;return i.createElement("div",{key:_.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl border border-gray-100"},i.createElement("div",{className:"flex items-center"},i.createElement("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center mr-3"},_.logo?i.createElement("img",{src:_.logo,alt:_.name,className:"w-full h-full rounded-full object-cover"}):i.createElement(Ho,{className:"w-5 h-5 text-gray-500"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium"},_.name),i.createElement("p",{className:"text-sm text-gray-500"},q," REPs assigned"))),i.createElement("div",{className:"text-right"},i.createElement("p",{className:"text-lg font-bold"},z,"h"),i.createElement("p",{className:"text-sm text-gray-500"},P.length," slots"),_.priority&&i.createElement("div",{className:"mt-1 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800"},"Priority: ",_.priority)))}))))))))}const AIe=({gig:t,onBack:e})=>{const n=s=>{switch(s.toLowerCase()){case"active":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"completed":return"bg-blue-100 text-blue-800 border-blue-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("button",{onClick:e,className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-900 transition-colors"},i.createElement(Zl,{size:16}),"Back to Gigs"),i.createElement("div",{className:"h-6 w-px bg-gray-300"}),i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"View: ",t.title))),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},i.createElement(hn,{className:"h-6 w-6 text-blue-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Basic Information")),i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(ys,{className:"h-4 w-4 text-blue-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Gig Title")),i.createElement("p",{className:"text-gray-900 font-medium"},t.title)),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(hn,{className:"h-4 w-4 text-blue-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Description")),i.createElement("p",{className:"text-gray-700 leading-relaxed"},t.description||"No description available")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Sa,{className:"h-4 w-4 text-purple-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Category")),i.createElement("p",{className:"text-gray-900 font-medium"},t.category||"Not specified")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(gs,{className:"h-4 w-4 text-indigo-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Status")),i.createElement("div",{className:`inline-block px-3 py-1 rounded-full text-sm font-semibold border ${n(t.status)}`},t.status))))),t.seniority&&i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-purple-50 to-violet-50 border border-purple-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},i.createElement(Sa,{className:"h-6 w-6 text-purple-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Seniority Requirements")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(ys,{className:"h-4 w-4 text-purple-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Seniority Level")),i.createElement("p",{className:"text-gray-900 font-medium"},t.seniority.level||"Not specified")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ct,{className:"h-4 w-4 text-violet-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Years of Experience")),i.createElement("p",{className:"text-gray-900 font-medium"},t.seniority.yearsExperience||"0"," years")))),t.commission&&i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-4"},i.createElement("div",{className:"p-2 bg-blue-100 rounded-lg"},i.createElement(T1,{className:"h-6 w-6 text-blue-600"})),i.createElement("div",null,i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Commission Structure"),i.createElement("p",{className:"text-sm text-gray-600"},"Commission details and structure"))),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-blue-100"},i.createElement("div",{className:"space-y-3"},t.commission.base&&i.createElement("div",{className:"flex justify-between"},i.createElement("span",{className:"text-sm text-gray-600"},"Base Type:"),i.createElement("span",{className:"font-medium text-gray-900"},t.commission.base)),t.commission.baseAmount&&i.createElement("div",{className:"flex justify-between"},i.createElement("span",{className:"text-sm text-gray-600"},"Base Amount:"),i.createElement("span",{className:"font-medium text-gray-900"},t.commission.baseAmount," ",t.commission.currency?.symbol||"")),t.commission.bonus&&i.createElement("div",{className:"flex justify-between"},i.createElement("span",{className:"text-sm text-gray-600"},"Bonus Type:"),i.createElement("span",{className:"font-medium text-gray-900"},t.commission.bonus)),t.commission.bonusAmount&&i.createElement("div",{className:"flex justify-between"},i.createElement("span",{className:"text-sm text-gray-600"},"Bonus Amount:"),i.createElement("span",{className:"font-medium text-gray-900"},t.commission.bonusAmount," ",t.commission.currency?.symbol||"")),t.commission.transactionCommission?.amount&&i.createElement("div",{className:"flex justify-between"},i.createElement("span",{className:"text-sm text-gray-600"},"Transaction Commission:"),i.createElement("span",{className:"font-medium text-gray-900"},t.commission.transactionCommission.amount," ",t.commission.currency?.symbol||"")),t.commission.structure&&i.createElement("div",{className:"flex justify-between"},i.createElement("span",{className:"text-sm text-gray-600"},"Structure:"),i.createElement("span",{className:"font-medium text-gray-900"},t.commission.structure)),t.commission.additionalDetails&&i.createElement("div",{className:"pt-3 border-t border-gray-200"},i.createElement("span",{className:"text-sm text-gray-600"},"Additional Details:"),i.createElement("p",{className:"text-sm text-gray-900 mt-1"},t.commission.additionalDetails)))))),t.team&&i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-pink-50 to-rose-50 border border-pink-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-pink-100 rounded-lg"},i.createElement(qr,{className:"h-6 w-6 text-pink-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Team Structure")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.team.size&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-pink-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(qr,{className:"h-4 w-4 text-pink-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Team Size")),i.createElement("p",{className:"text-gray-900 font-medium"},t.team.size," members")),t.team.territories&&t.team.territories.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-pink-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(to,{className:"h-4 w-4 text-rose-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Territories")),i.createElement("div",{className:"flex flex-wrap gap-2"},t.team.territories.map((s,r)=>i.createElement("div",{key:r,className:"flex items-center gap-2 px-3 py-1 bg-rose-50 rounded-full border border-rose-200"},i.createElement("img",{src:s.flags.png,alt:s.flags.alt,className:"w-4 h-3 rounded-sm"}),i.createElement("span",{className:"text-sm font-medium text-rose-800"},s.name.common))))))),t.skills&&i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-purple-50 to-indigo-50 border border-purple-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-purple-100 rounded-lg"},i.createElement(ys,{className:"h-6 w-6 text-purple-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Skills & Requirements")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},t.skills.professional&&t.skills.professional.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-3"},"Professional Skills"),i.createElement("div",{className:"space-y-2"},t.skills.professional.map((s,r)=>i.createElement("div",{key:r,className:"flex items-center justify-between p-2 bg-purple-50 rounded-lg"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-purple-900"},s.skill.name),i.createElement("p",{className:"text-xs text-purple-600"},s.skill.category)),i.createElement("span",{className:"text-xs bg-purple-200 text-purple-800 px-2 py-1 rounded-full"},"Level ",s.level))))),t.skills.technical&&t.skills.technical.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-3"},"Technical Skills"),i.createElement("div",{className:"space-y-2"},t.skills.technical.map((s,r)=>i.createElement("div",{key:r,className:"flex items-center justify-between p-2 bg-indigo-50 rounded-lg"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-indigo-900"},s.skill.name),i.createElement("p",{className:"text-xs text-indigo-600"},s.skill.category)),i.createElement("span",{className:"text-xs bg-indigo-200 text-indigo-800 px-2 py-1 rounded-full"},"Level ",s.level))))),t.skills.soft&&t.skills.soft.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-3"},"Soft Skills"),i.createElement("div",{className:"space-y-2"},t.skills.soft.map((s,r)=>i.createElement("div",{key:r,className:"flex items-center justify-between p-2 bg-pink-50 rounded-lg"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-pink-900"},s.skill.name),i.createElement("p",{className:"text-xs text-pink-600"},s.skill.category)),i.createElement("span",{className:"text-xs bg-pink-200 text-pink-800 px-2 py-1 rounded-full"},"Level ",s.level))))),t.skills.languages&&t.skills.languages.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-purple-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-3"},"Languages"),i.createElement("div",{className:"space-y-2"},t.skills.languages.map((s,r)=>i.createElement("div",{key:r,className:"flex items-center justify-between p-2 bg-green-50 rounded-lg"},i.createElement("div",null,i.createElement("span",{className:"text-sm font-medium text-green-900"},s.language.name),i.createElement("p",{className:"text-xs text-green-600"},s.language.nativeName)),i.createElement("span",{className:"text-xs bg-green-200 text-green-800 px-2 py-1 rounded-full"},s.proficiency))))))),t.destination_zone&&i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-emerald-100 rounded-lg"},i.createElement(to,{className:"h-6 w-6 text-emerald-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Destination Zone")),i.createElement("div",{className:"bg-white rounded-lg p-4 border border-emerald-100"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("img",{src:t.destination_zone.flags.png,alt:t.destination_zone.flags.alt,className:"w-12 h-8 rounded-md border border-gray-200"}),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-semibold text-gray-900"},t.destination_zone.name.common),i.createElement("p",{className:"text-sm text-gray-600"},t.destination_zone.name.official),i.createElement("p",{className:"text-xs text-gray-500"},"Code: ",t.destination_zone.cca2))))),t.availability&&i.createElement("div",{className:"rounded-xl bg-gradient-to-br from-cyan-50 to-blue-50 border border-cyan-100 shadow-lg p-6"},i.createElement("div",{className:"flex items-center gap-3 mb-6"},i.createElement("div",{className:"p-2 bg-cyan-100 rounded-lg"},i.createElement(Ct,{className:"h-6 w-6 text-cyan-600"})),i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Schedule & Availability")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"},t.availability.minimumHours&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Ct,{className:"h-4 w-4 text-cyan-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Minimum Hours")),i.createElement("div",{className:"space-y-1"},i.createElement("p",{className:"text-sm text-gray-900"},"Daily: ",i.createElement("span",{className:"font-medium"},t.availability.minimumHours.daily,"h")),i.createElement("p",{className:"text-sm text-gray-900"},"Weekly: ",i.createElement("span",{className:"font-medium"},t.availability.minimumHours.weekly,"h")),i.createElement("p",{className:"text-sm text-gray-900"},"Monthly: ",i.createElement("span",{className:"font-medium"},t.availability.minimumHours.monthly,"h")))),t.availability.time_zone&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(gs,{className:"h-4 w-4 text-cyan-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Time Zone")),i.createElement("p",{className:"text-gray-900 font-medium"},t.availability.time_zone.zoneName),i.createElement("p",{className:"text-sm text-gray-600"},t.availability.time_zone.countryName," (",t.availability.time_zone.countryCode,")")),t.availability.flexibility&&t.availability.flexibility.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("div",{className:"flex items-center gap-2 mb-3"},i.createElement(Gr,{className:"h-4 w-4 text-blue-500"}),i.createElement("label",{className:"text-sm font-semibold text-gray-700"},"Flexibility")),i.createElement("p",{className:"text-gray-900 font-medium"},t.availability.flexibility.join(", ")))),t.availability.schedule&&t.availability.schedule.length>0&&i.createElement("div",{className:"bg-white rounded-lg p-4 border border-cyan-100"},i.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Working Schedule"),i.createElement("div",{className:"space-y-3"},t.availability.schedule.map((s,r)=>i.createElement("div",{key:r,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},i.createElement("div",{className:"flex items-center gap-3"},i.createElement(Ct,{className:"h-4 w-4 text-cyan-500"}),i.createElement("span",{className:"text-sm font-medium text-gray-900"},s.day)),i.createElement("span",{className:"text-sm text-gray-600"},s.hours.start," - ",s.hours.end))))))))},RIe=()=>{const[t,e]=N.useState([]),[n,s]=N.useState(!0),[r,a]=N.useState(null),[o,l]=N.useState(null),c=$e.get("companyId");console.log("GigDetails render - selectedGig:",o),N.useEffect(()=>{(async()=>{if(!c){a("Company ID not found"),s(!1);return}try{const y=await Ie.get(`undefined/gigs/company/${c}`);e(y.data.data)}catch(y){a("Failed to fetch gigs"),console.error("Error fetching gigs:",y)}finally{s(!1)}})()},[c]);const u=f=>{if(!f)return{bg:"bg-white/30",text:"text-indigo-900",border:"border-white/40"};switch(f.toLowerCase()){case"active":return{bg:"bg-white/30",text:"text-blue-900",border:"border-white/40"};case"pending":return{bg:"bg-white/30",text:"text-yellow-900",border:"border-white/40"};case"completed":return{bg:"bg-white/30",text:"text-green-900",border:"border-white/40"};case"cancelled":return{bg:"bg-white/30",text:"text-red-900",border:"border-white/40"};default:return{bg:"bg-white/30",text:"text-indigo-900",border:"border-white/40"}}},d=()=>"from-blue-500 via-indigo-500 to-purple-500",m=f=>{if(!f)return"Not specified";const y=f.currency?.symbol||"";return f.transactionCommission?.amount?`${f.transactionCommission.amount} ${y}`:f.bonusAmount?`${f.bonusAmount} ${y}`:f.base||"Not specified"},h=f=>{if(!f)return"Not specified";if(f.schedule&&f.schedule.length>0){const y=f.schedule.length;return`${y} day${y>1?"s":""}/week`}return"Flexible"};if(n)return i.createElement("div",{className:"flex items-center justify-center p-8"},i.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}));if(r)return i.createElement("div",{className:"p-6 text-red-600 bg-red-50 rounded-xl border border-red-200"},i.createElement("div",{className:"flex items-center"},i.createElement("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})),r));if(o)return console.log("Rendering GigDetailsView with gig:",o),i.createElement(AIe,{gig:o,onBack:()=>l(null)});const p=async(f,y)=>{f.preventDefault(),f.stopPropagation();try{await Ie.delete(`undefined/gigs/${y}`),e(g=>g.filter(b=>b._id!==y)),gc.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0}).fire({icon:"success",title:"Gig deleted successfully"})}catch(x){console.error("Error deleting gig:",x),gc.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3}).fire({icon:"error",title:"Failed to delete gig"})}};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Gig Details"),i.createElement("div",{className:"flex items-center gap-4"},i.createElement("button",{className:"flex items-center gap-2 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white font-bold px-5 py-2 rounded-full shadow-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-400",onClick:()=>{window.location.href="/app6"}},i.createElement("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4v16m8-8H4"})),"Add gig"))),t.length===0?i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4"},i.createElement("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"}))),i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No gigs found"),i.createElement("p",{className:"text-gray-500"},"No gigs have been created for this company yet.")):i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},t.map((f,y)=>{const x=u(f.status);return i.createElement("div",{key:f._id,className:`group relative overflow-hidden rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 bg-gradient-to-br ${d()}`},i.createElement("div",{className:"p-6 text-white"},i.createElement("div",{className:"flex items-start justify-between mb-4"},i.createElement("h3",{className:"text-lg font-bold leading-tight line-clamp-2 flex-1"},f.title),i.createElement("div",{className:`ml-3 px-3 py-1 rounded-full text-xs font-semibold ${x.bg} ${x.text} border ${x.border} flex-shrink-0`},f.status)),f.category&&i.createElement("div",{className:"mb-3"},i.createElement("span",{className:"inline-block bg-white/20 text-white px-2 py-1 rounded-md text-xs font-medium"},f.category)),i.createElement("p",{className:"text-white/90 text-sm leading-relaxed mb-4 overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",lineHeight:"1.4",maxHeight:"4.2em"}},f.description||"No description available"),i.createElement("div",{className:"grid grid-cols-2 gap-3 mb-4"},f.seniority&&f.seniority.level&&i.createElement("div",{className:"bg-white/10 rounded-lg p-3"},i.createElement("div",{className:"text-white/70 text-xs font-medium mb-1"},"Seniority"),i.createElement("div",{className:"text-white text-sm font-semibold"},f.seniority.level," (",f.seniority.yearsExperience||"0","y)")),f.commission&&i.createElement("div",{className:"bg-white/10 rounded-lg p-3"},i.createElement("div",{className:"text-white/70 text-xs font-medium mb-1"},"Commission"),i.createElement("div",{className:"text-white text-sm font-semibold"},m(f.commission))),f.availability&&i.createElement("div",{className:"bg-white/10 rounded-lg p-3"},i.createElement("div",{className:"text-white/70 text-xs font-medium mb-1"},"Availability"),i.createElement("div",{className:"text-white text-sm font-semibold"},h(f.availability))),f.team&&f.team.size&&i.createElement("div",{className:"bg-white/10 rounded-lg p-3"},i.createElement("div",{className:"text-white/70 text-xs font-medium mb-1"},"Team Size"),i.createElement("div",{className:"text-white text-sm font-semibold"},f.team.size," members"))),i.createElement("div",{className:"flex items-center justify-between pt-4 border-t border-white/20"},i.createElement("div",{className:"flex items-center text-white/80 text-xs"},i.createElement("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})),f.createdAt?new Date(f.createdAt).toLocaleDateString():"Date unknown"),i.createElement("div",{className:"flex gap-2"},i.createElement("button",{className:"bg-red-500/20 hover:bg-red-500/40 text-white p-2 rounded-lg transition-all duration-200 relative z-20",onClick:g=>p(g,f._id),title:"Delete Gig"},i.createElement("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"}))),i.createElement("button",{className:"bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded-lg text-xs font-medium transition-all duration-200 relative z-10",onClick:g=>{g.preventDefault(),g.stopPropagation(),console.log("View Details clicked for gig:",f),console.log("Setting selectedGig to:",f),l(f)}},"View Details")))),i.createElement("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 pointer-events-none"}))})))},_Ie=()=>{const[t,e]=N.useState("product"),[n,s]=N.useState(""),[r,a]=N.useState(!1),[o,l]=N.useState([]),c=$e.get("companyId"),u="https://v25searchcompanywizardbackend-production.up.railway.app/api";N.useEffect(()=>{c&&d()},[c]),N.useEffect(()=>{c&&m()&&!r&&(console.log(" Knowledge base data changed, checking if step should be auto-completed..."),d())},[o,c,r]);const d=async()=>{try{if(!c)return;console.log(" Checking step 7 status for company:",c);const y=await Ie.get(`${u}/onboarding/companies/${c}/onboarding/phases/2/steps/7`);if(console.log(" API response for step 7:",y.data),y.data&&y.data.status==="completed"){console.log(" Step 7 is already completed according to API"),a(!0);return}const x=localStorage.getItem("companyOnboardingProgress");if(x)try{const g=JSON.parse(x);if(g.completedSteps&&Array.isArray(g.completedSteps)&&g.completedSteps.includes(7)){console.log(" Step 7 found in localStorage, setting as completed"),a(!0);return}}catch(g){console.error(" Error parsing stored progress:",g)}if(m()&&!r){console.log(" Auto-completing step 7 locally because basic info is present"),a(!0);const g=[7],b={currentPhase:2,completedSteps:g,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(b)),$e.set("knowledgeBaseStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:7,phaseId:2,status:"completed",completedSteps:g}})),console.log(" Step 7 marked as completed locally and parent component notified")}}catch(y){console.error(" Error checking step status:",y);const x=localStorage.getItem("companyOnboardingProgress");if(x)try{const g=JSON.parse(x);g.completedSteps&&Array.isArray(g.completedSteps)&&g.completedSteps.includes(7)&&a(!0)}catch(g){console.error(" Error parsing stored progress:",g)}}},m=()=>{const y=p.flatMap(g=>g.articles.filter(b=>b.status==="published")),x=y.length>=3;return console.log(" Checking basic info for KnowledgeBase:",{publishedArticles:y.length,hasInfo:x}),x},h=async()=>{try{if(!c){console.error(" No companyId available");return}console.log(" Completing knowledge base setup...");const y=await Ie.put(`${u}/onboarding/companies/${c}/onboarding/phases/2/steps/7`,{status:"completed"});console.log(" Step 7 marked as completed:",y.data),a(!0);const x={currentPhase:2,completedSteps:[7],lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(x)),$e.set("knowledgeBaseStepCompleted","true",{expires:7}),window.dispatchEvent(new CustomEvent("stepCompleted",{detail:{stepId:7,phaseId:2,status:"completed",completedSteps:[7]}})),console.log(" Knowledge base setup completed and step 7 marked as completed")}catch(y){console.error(" Error completing knowledge base setup:",y)}},p=[{id:"product",title:"Product Information",articles:[{id:1,title:"Product Overview",content:"Comprehensive overview of our product features and benefits...",lastUpdated:"2 days ago",status:"published"},{id:2,title:"Technical Specifications",content:"Detailed technical specifications and requirements...",lastUpdated:"1 week ago",status:"draft"}]},{id:"objections",title:"Common Objections",articles:[{id:3,title:"Price Concerns",content:"How to handle pricing objections and demonstrate value...",lastUpdated:"3 days ago",status:"published"},{id:4,title:"Competition Comparison",content:"Key differentiators from competitors...",lastUpdated:"5 days ago",status:"published"}]},{id:"faq",title:"Frequently Asked Questions",articles:[{id:5,title:"General FAQs",content:"Common questions about our services...",lastUpdated:"1 day ago",status:"published"},{id:6,title:"Technical FAQs",content:"Technical support and troubleshooting questions...",lastUpdated:"4 days ago",status:"published"}]}],f=y=>{e(t===y?null:y)};return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-3"},i.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Knowledge Base"),r&&i.createElement("div",{className:"flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},i.createElement(eo,{className:"w-4 h-4"}),"Completed")),i.createElement("p",{className:"text-sm text-gray-500"},"Create and manage training materials for REPS")),i.createElement("div",{className:"flex space-x-3"},i.createElement("button",{className:"flex items-center rounded-lg bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50"},i.createElement(wW,{className:"mr-2 h-4 w-4"}),"New Section"),r?i.createElement("button",{className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm cursor-not-allowed"},i.createElement(eo,{className:"mr-2 h-4 w-4"}),"Setup Completed"):i.createElement("button",{onClick:h,className:"flex items-center rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-green-700",disabled:!m()},i.createElement(mt,{className:"mr-2 h-4 w-4"}),"Complete Setup"),i.createElement("button",{className:"flex items-center rounded-lg bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700"},i.createElement(xs,{className:"mr-2 h-4 w-4"}),"New Article"))),i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:"flex-1"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},i.createElement(Xu,{className:"h-5 w-5 text-gray-400"})),i.createElement("input",{type:"text",className:"block w-full rounded-lg border-gray-300 pl-10 focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Search knowledge base...",value:n,onChange:y=>s(y.target.value)}))),i.createElement("select",{className:"rounded-lg border-gray-300 py-2 pl-3 pr-10 text-sm focus:border-indigo-500 focus:outline-none focus:ring-indigo-500"},i.createElement("option",null,"All Categories"),i.createElement("option",null,"Product Information"),i.createElement("option",null,"Common Objections"),i.createElement("option",null,"FAQs"))),i.createElement("div",{className:"space-y-4"},p.map(y=>i.createElement("div",{key:y.id,className:"rounded-lg bg-white shadow"},i.createElement("div",{className:"flex cursor-pointer items-center justify-between p-4",onClick:()=>f(y.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-indigo-100 p-2 text-indigo-600"},i.createElement(Go,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h3",{className:"font-medium text-gray-900"},y.title),i.createElement("p",{className:"text-sm text-gray-500"},y.articles.length," articles"))),t===y.id?i.createElement(Zm,{className:"h-5 w-5 text-gray-400"}):i.createElement(Hu,{className:"h-5 w-5 text-gray-400"})),t===y.id&&i.createElement("div",{className:"border-t border-gray-200"},y.articles.map(x=>i.createElement("div",{key:x.id,className:"border-b border-gray-200 p-4 last:border-b-0"},i.createElement("div",{className:"flex items-start justify-between"},i.createElement("div",{className:"flex items-start space-x-3"},i.createElement(hn,{className:"mt-1 h-5 w-5 text-gray-400"}),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},x.title),i.createElement("p",{className:"mt-1 text-sm text-gray-500"},x.content.substring(0,100),"..."),i.createElement("div",{className:"mt-2 flex items-center space-x-4 text-xs text-gray-500"},i.createElement("span",null,"Last updated ",x.lastUpdated),i.createElement("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ${x.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},x.status==="published"?i.createElement(mt,{className:"mr-1 h-3 w-3"}):i.createElement(Sn,{className:"mr-1 h-3 w-3"}),x.status)))),i.createElement("div",{className:"flex space-x-2"},i.createElement("button",{className:"rounded-md p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(l0,{className:"h-4 w-4"})),i.createElement("button",{className:"rounded-md p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-500"},i.createElement(Hi,{className:"h-4 w-4"})),i.createElement("button",{className:"rounded-md p-1 text-gray-400 hover:bg-gray-100 hover:text-red-500"},i.createElement(Hr,{className:"h-4 w-4"})))))),i.createElement("div",{className:"bg-gray-50 p-4"},i.createElement("button",{className:"flex w-full items-center justify-center rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-100"},i.createElement(xs,{className:"mr-2 h-4 w-4"}),"Add Article to ",y.title)))))),i.createElement("div",{className:"rounded-lg bg-indigo-50 p-6"},i.createElement("h3",{className:"text-lg font-medium text-indigo-900"},"Knowledge Base Best Practices"),i.createElement("div",{className:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},i.createElement("div",{className:"rounded-lg bg-white p-4 shadow-sm"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-green-100 p-2 text-green-600"},i.createElement(mt,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Keep It Updated"),i.createElement("p",{className:"text-sm text-gray-500"},"Regularly review and update content to ensure accuracy")))),i.createElement("div",{className:"rounded-lg bg-white p-4 shadow-sm"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-blue-100 p-2 text-blue-600"},i.createElement(Ko,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Clear Communication"),i.createElement("p",{className:"text-sm text-gray-500"},"Use simple language and provide examples")))),i.createElement("div",{className:"rounded-lg bg-white p-4 shadow-sm"},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:"rounded-full bg-purple-100 p-2 text-purple-600"},i.createElement(l0,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("h4",{className:"font-medium text-gray-900"},"Easy Access"),i.createElement("p",{className:"text-sm text-gray-500"},"Organize content logically for quick reference")))))))},DIe=()=>{const[t,e]=N.useState(1),[n,s]=N.useState(1),[r,a]=N.useState([]),[o,l]=N.useState(null),[c,u]=N.useState(!1),[d,m]=N.useState(!1);N.useEffect(()=>{const W=localStorage.getItem("parsedLeads"),le=sessionStorage.getItem("uploadContactsManuallyClosed");W&&!le&&n>=2&&!d&&(console.log(" Restoring UploadContacts view - parsed leads exist and phase allows it"),m(!0)),console.log(" UploadContacts restoration check:",{hasParsedLeads:!!W,wasManuallyClosed:!!le,displayedPhase:n,showUploadContacts:d,shouldRestore:W&&!le&&n>=2&&!d})},[n]),N.useEffect(()=>{n<2&&d&&(console.log(" Cleaning parsed leads - current phase too early:",n),localStorage.removeItem("parsedLeads"),m(!1))},[n,d]),N.useEffect(()=>{d||(sessionStorage.setItem("uploadContactsManuallyClosed","true"),console.log(" Set manual close flag - preventing auto-restoration"))},[d]);const[h,p]=N.useState(!0),[f,y]=N.useState(!1),[x,g]=N.useState(!1),[b,w]=N.useState(null),[v,E]=N.useState(!1),k=$e.get("userId"),C="https://v25searchcompanywizardbackend-production.up.railway.app/api";N.useEffect(()=>{(async()=>{if(!k){console.error("User ID not found in cookies"),window.location.href="/auth";return}try{const le=await Ie.get(`${C}/companies/user/${k}`);le.data.success&&le.data.data?(w(le.data.data._id),$e.set("companyId",le.data.data._id),console.log(" Company ID fetched and stored:",le.data.data._id)):console.error("No company data found for user:",k)}catch(le){console.error("Error fetching company ID:",le)}})()},[k]),N.useEffect(()=>{b&&(console.log(" Company ID available, loading progress and checking gigs..."),F(),A(),O())},[b]),N.useEffect(()=>{const W=le=>{if(le.data.type==="STEP_COMPLETED"){console.log("Received step completion message:",le.data);const{stepId:we,phaseId:de,data:Ee}=le.data;a(Re=>Re.includes(we)?Re:[...Re,we]),F(),console.log(` Step ${we} completed successfully`)}};return window.addEventListener("message",W),()=>{window.removeEventListener("message",W)}},[]),N.useEffect(()=>{const W=we=>{const{stepId:de,phaseId:Ee,status:Re,completedSteps:ze}=we.detail;if(console.log(" Step completion event received:",{stepId:de,phaseId:Ee,status:Re,completedSteps:ze}),ze&&Array.isArray(ze)){a(ze);const _e={currentPhase:Ee,completedSteps:ze,lastUpdated:new Date().toISOString()};localStorage.setItem("companyOnboardingProgress",JSON.stringify(_e)),console.log(" Local state updated from step completion event"),setTimeout(()=>{console.log(" Reloading onboarding progress after step completion"),F()},500)}},le=()=>{console.log(" Contacts upload completed - refreshing onboarding state"),m(!1),sessionStorage.removeItem("uploadContactsManuallyClosed"),I(),setTimeout(()=>{F()},1e3)};return window.addEventListener("stepCompleted",W),window.addEventListener("contactsUploadCompleted",le),()=>{window.removeEventListener("stepCompleted",W),window.removeEventListener("contactsUploadCompleted",le)}},[]),N.useEffect(()=>{if(!b)return;const W=setInterval(()=>{I()},1e4);return()=>clearInterval(W)},[b,r]);const I=async()=>{try{if(!b||r.includes(6))return;const W=await Ie.get(`undefined/leads/company/${b}/has-leads`);if(W.data.hasLeads&&W.data.count>0){console.log(" Company has leads - auto-completing step 6");try{await Ie.put(`${C}/onboarding/companies/${b}/onboarding/phases/2/steps/6`,{status:"completed"}),a(le=>{if(!le.includes(6)){const we=[...le,6];console.log(" Step 6 auto-completed successfully - updating local state");const de={currentPhase:2,completedSteps:we,lastUpdated:new Date().toISOString()};return localStorage.setItem("companyOnboardingProgress",JSON.stringify(de)),we}return le}),g(!0)}catch(le){console.error("Error auto-completing step 6:",le)}}}catch(W){console.error("Error checking company leads for auto-completion:",W)}};N.useEffect(()=>{new URLSearchParams(window.location.search).get("session")==="someGeneratedSessionId"&&b&&M(6)},[b]);const A=async()=>{try{if(!b){console.error(" Company ID not available for checking gigs");return}const le=(await Ie.get(`undefined/gigs/company/${b}/has-gigs`)).data.data.hasGigs;if(y(le),le)try{await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding/phases/2/steps/4`,{status:"completed"}),a(we=>[...we,4])}catch(we){console.error("Error updating onboarding progress:",we)}}catch(W){console.error("Error checking company gigs:",W)}},$=async()=>{try{if(!b){console.error(" Company ID not available for checking leads");return}const le=(await Ie.get(`undefined/leads/company/${b}/has-leads`)).data.hasLeads;if(g(le),le){console.log(" Company has leads - auto-completing step 6");try{await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding/phases/2/steps/6`,{status:"completed"}),a(we=>we.includes(6)?we:[...we,6]),console.log(" Step 6 auto-completed successfully")}catch(we){console.error("Error auto-completing step 6:",we)}}else console.log(" Company has no leads - step 6 needs manual completion")}catch(W){console.error("Error checking company leads:",W)}},T=async()=>{try{if(console.log(" Checking for active gigs..."),!b){console.error(" Company ID not available for checking active gigs");return}const W=await Ie.get(`undefined/gigs/company/${b}`);if(W.data&&W.data.data){const le=W.data.data,we=le.some(de=>de.status==="active"||de.status==="approved"||de.status==="published");if(console.log(" Active gigs check:",{totalGigs:le.length,hasActiveGig:we,gigStatuses:le.map(de=>de.status)}),we)try{console.log(" Found active gig - completing last phase and step");const de=await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding/complete-last`);if(de.data){console.log(" Last phase and step completed successfully:",de.data),a(Re=>{const ze=[...Re];return ze.includes(13)||ze.push(13),ze});const Ee={currentPhase:4,completedSteps:[...r,13]};$e.set("companyOnboardingProgress",JSON.stringify(Ee)),console.log(" Step 13 marked as completed - active gig found")}}catch(de){console.error("Error completing last phase and step:",de)}else try{console.log(" No active gigs found - updating step 13 status"),t>=4&&await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding/phases/4/steps/13`,{status:"in_progress"}),a(Ee=>Ee.filter(Re=>Re!==13)),console.log(" Step 13 removed from completed steps and marked as in_progress");const de={currentPhase:3,completedSteps:r.filter(Ee=>Ee!==13)};$e.set("companyOnboardingProgress",JSON.stringify(de)),console.log(" Step 13 marked as in_progress - no active gigs found")}catch(de){console.error("Error updating onboarding progress for step 13:",de)}}}catch(W){console.error("Error checking active gigs:",W)}};N.useEffect(()=>{b&&(console.log(" Initial check for leads and gigs..."),$(),T())},[b]),N.useEffect(()=>{b&&(console.log(" Loading company progress on mount..."),F())},[b]);const F=async()=>{p(!0);try{if(!b){console.error(" Company ID not available for loading progress"),p(!1);return}const W=await Ie.get(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding`),le=W.data;console.log(" API Response:",W.data),console.log(" currentPhase from API:",le.currentPhase),console.log(" completedSteps from API:",le.completedSteps),$e.set("companyOnboardingProgress",JSON.stringify(le));const we=Ee=>{const Re=z[Ee-1];return Re?Re.steps.filter(_e=>!_e.disabled).every(_e=>le.completedSteps.includes(_e.id)):!1};let de=1;for(let Ee=1;Ee<=4;Ee++)if(Ee===1)de=1;else if(we(Ee-1))de=Ee,console.log(` Phase ${Ee-1} is fully completed, allowing access to phase ${Ee}`);else{console.log(` Phase ${Ee-1} is not fully completed, stopping at phase ${de}`);break}le.completedSteps.includes(7)&&de<3&&(we(2)?(de=3,console.log(" Step 7 completed and phase 2 is fully completed - setting phase to 3")):(console.log(" Step 7 completed but phase 2 is not fully completed - staying in phase 2"),de=2)),le.completedSteps.includes(10)&&de<4&&(we(3)?(de=4,console.log(" Step 10 completed and phase 3 is fully completed - setting phase to 4")):(console.log(" Step 10 completed but phase 3 is not fully completed - staying in phase 3"),de=3)),le.completedSteps.includes(13)&&de<4&&(we(3)?(de=4,console.log(" Step 13 completed and phase 3 is fully completed - setting phase to 4")):(console.log(" Step 13 completed but phase 3 is not fully completed - staying in phase 3"),de=3)),console.log(" Final valid phase determined:",de,"from API currentPhase:",le.currentPhase),console.log(" Setting completed steps:",le.completedSteps),e(de),s(de),a(le.completedSteps),le.completedSteps.includes(6)||setTimeout(()=>{I()},100),setTimeout(()=>{console.log(" Forcing re-render after state update"),e(Ee=>Ee)},50)}catch(W){console.error("Error loading company progress:",W),e(1),s(1),a([])}finally{p(!1)}},O=async()=>{try{lo.getInstance().isConfigured()&&console.log(" Zoho est configur - ready for manual upload")}catch(W){console.error("Error checking Zoho connection:",W)}},M=async W=>{if(!b){console.error("Company ID not available for starting step");return}try{if(r.includes(W))console.log(` Step ${W} is already completed, not changing status`);else{const Ee=z.findIndex(Re=>Re.steps.some(ze=>ze.id===W))+1;await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding/phases/${Ee}/steps/${W}`,{status:"in_progress"}),console.log(` Step ${W} status updated to in_progress`)}const de=z.flatMap(Ee=>Ee.steps).find(Ee=>Ee.id===W);if(W===7){localStorage.setItem("activeTab","knowledge-base"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"knowledge-base"}}));return}if(W===8){localStorage.setItem("activeTab","script-generator"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"script-generator"}}));return}if(W===13){localStorage.setItem("activeTab","approval-publishing"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"approval-publishing"}}));return}if(W===4){f||r.includes(4)?window.location.href="/app11":window.location.href="/app6";return}de?.component&&(W===5?u(!0):l(W))}catch(le){console.error("Error updating step status:",le),le instanceof Error&&console.error("Error details:",le.message)}},B=async W=>{if(!b){console.error("Company ID not available for reviewing step");return}try{console.log(` Reviewing step ${W} (already completed)`);const we=z.flatMap(de=>de.steps).find(de=>de.id===W);if(W===7){localStorage.setItem("activeTab","knowledge-base"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"knowledge-base"}}));return}if(W===8){localStorage.setItem("activeTab","script-generator"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"script-generator"}}));return}if(W===13){localStorage.setItem("activeTab","approval-publishing"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"approval-publishing"}}));return}if(W===4){console.log(" Opening GigDetails for review"),E(!0);return}we?.component&&(W===5?u(!0):l(W))}catch(le){console.error("Error reviewing step:",le),le instanceof Error&&console.error("Error details:",le.message)}},L=async W=>{if(!b)return;const le=de=>{const Ee=z[de-1];return Ee?Ee.steps.filter(ze=>!ze.disabled).every(ze=>r.includes(ze.id)):!1};let we=!0;if(W>1){for(let de=1;de<W;de++)if(!le(de)){console.log(` Cannot access phase ${W} - phase ${de} is not fully completed`),we=!1;break}}if(we){if(s(W),P(W)&&W<=t&&!Y(W))try{await Ie.put(`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${b}/onboarding/current-phase`,{phase:W}),e(W),console.log(` Successfully changed to phase ${W}`)}catch(de){console.error("Error updating phase:",de)}}else console.log(` Cannot change to phase ${W} - previous phases not completed`),console.log(`Vous devez complter toutes les tapes de la phase prcdente avant d'accder  la phase ${W}`)},Y=W=>z[W-1].steps.filter(we=>!we.disabled).every(we=>r.includes(we.id)),D=()=>{const W=Math.max(1,n-1);s(W)},_=()=>{const W=Math.min(4,n+1),le=we=>{const de=z[we-1];return de?de.steps.filter(Re=>!Re.disabled).every(Re=>r.includes(Re.id)):!1};if(n<4)if(le(n))console.log(` Phase ${n} is fully completed, proceeding to phase ${W}`),L(W);else{console.log(` Cannot proceed to phase ${W} - current phase ${n} is not fully completed`),console.log(`Vous devez complter toutes les tapes de la phase ${n} avant de passer  la phase suivante`);return}else n===4&&(window.location.href="/company#/company")},P=W=>W===1?!0:z[W-2].steps.filter(we=>!we.disabled).every(we=>r.includes(we.id)),z=[{id:1,title:"Company Account Setup & Identity",icon:Ym,color:"blue",steps:[{id:1,title:"Create Company Profile",description:"Legal and commercial details, key contacts, terms agreement",status:"completed",component:KX},{id:2,title:"KYC / KYB Verification",description:"Identity verification through Stripe Identity or Sumsub",status:"current",component:XX,disabled:!0},{id:3,title:"Subscription Plan",description:"Select plan: Free, Standard, or Premium",status:"pending",component:YX}]},{id:2,title:"Operational Setup",icon:Gr,color:"yellow",steps:[{id:4,title:"Create Gigs",description:"Define multi-channel gigs and requirements",status:"pending"},{id:5,title:"Telephony Setup",description:"Phone numbers, call tracking, and dialer configuration",status:"pending",component:v_},{id:6,title:"Upload Contacts",description:"Import contacts for multi-channel engagement",status:"pending",component:$D},{id:7,title:"Knowledge Base",description:"Create training materials and FAQs",status:"pending",component:_Ie},{id:8,title:"Call Script",description:"Define script and conversation flows",status:"pending",component:ZX},{id:9,title:"Reporting Setup",description:"Configure KPIs and reporting preferences",status:"pending",component:JX,disabled:!0}]},{id:3,title:"REPS Engagement",icon:qr,color:"green",steps:[{id:10,title:"Match HARX REPS",description:"Connect with qualified REPS based on requirements",status:"pending",component:QX},{id:11,title:"REP Onboarding",description:"Training, validation, and contract acceptance",status:"pending",component:eY},{id:12,title:"Session Planning",description:"Schedule call slots and prioritize leads",status:"pending",component:TIe}]},{id:4,title:"Activation",icon:_1,color:"red",steps:[{id:13,title:"Gig Activation",description:"Launch multi-channel operations",status:"pending",component:RR}]}],q=W=>{switch(W.id){case 1:return Ym;case 2:return D1;case 3:return hn;case 4:return Ko;case 5:return Ql;case 6:return Xo;case 7:return Go;case 8:return hn;case 9:return QT;case 10:return qr;case 11:return Go;case 12:return Ia;case 13:return _1;default:return mt}},K=()=>{if(d){if(console.log(" Back to onboarding clicked while UploadContacts is active - cancelling processing"),window.cancelUploadProcessing){console.log(" Calling cancelUploadProcessing function");try{window.cancelUploadProcessing(),console.log(" cancelUploadProcessing executed successfully")}catch(W){if(console.error(" Error calling cancelUploadProcessing:",W),window.emergencyCancelUpload){console.log(" Trying emergency cancellation...");try{window.emergencyCancelUpload(),console.log(" Emergency cancellation executed successfully")}catch(le){console.error(" Emergency cancellation also failed:",le)}}}}else if(console.warn(" cancelUploadProcessing function not found on window"),window.emergencyCancelUpload){console.log(" Trying emergency cancellation as fallback...");try{window.emergencyCancelUpload(),console.log(" Emergency cancellation executed successfully")}catch(W){console.error(" Emergency cancellation failed:",W)}}localStorage.removeItem("parsedLeads"),localStorage.removeItem("validationResults"),localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("parsedLeads"),sessionStorage.removeItem("validationResults"),console.log(" Removed all storage items"),m(!1),console.log(" Set showUploadContacts to false"),console.log(" Closing UploadContacts and returning to normal onboarding state");return}l(null)},ae=W=>{const we=z.flatMap(_e=>_e.steps).find(_e=>_e.id===W),de=z[t-1].steps,Ee=de.findIndex(_e=>_e.id===W),ze=de.slice(0,Ee).every(_e=>_e.disabled||r.includes(_e.id));if(W===4){r.includes(W)?E(!0):f?window.location.href="/app11":window.location.href="/app6";return}if(W===7){ze&&(localStorage.setItem("activeTab","knowledge-base"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"knowledge-base"}})));return}if(W===8){ze&&(localStorage.setItem("activeTab","script-generator"),window.dispatchEvent(new CustomEvent("tabChange",{detail:{tab:"script-generator"}})));return}if(W===5){ze&&u(!0);return}if(W===6){ze&&(sessionStorage.getItem("uploadContactsManuallyClosed")?console.log(" UploadContacts was manually closed - not reopening"):(m(!0),console.log(" Opening UploadContacts via step click")));return}we?.component&&ze&&!we.disabled&&l(W)};if(!k)return console.log("User ID not found, redirecting to /auth"),window.location.href="/auth",i.createElement("div",{className:"flex items-center justify-center min-h-screen"},i.createElement("div",{className:"text-center"},i.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),i.createElement("p",{className:"text-gray-600"},"Redirecting to authentication...")));const ne=o?z.flatMap(W=>W.steps).find(W=>W.id===o)?.component:null;if(h)return i.createElement("div",{className:"flex items-center justify-center min-h-screen"},i.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}));let Z=null,ke=()=>{};if(v?(Z=i.createElement(RIe,null),ke=()=>{E(!1)}):c?(Z=i.createElement(v_,{onBackToOnboarding:async()=>{if(u(!1),b)try{await F(),console.log(" Onboarding state reloaded successfully")}catch(W){console.error(" Error reloading onboarding state:",W)}}}),ke=()=>{u(!1)}):d?(Z=i.createElement($D,null),ke=()=>{localStorage.removeItem("parsedLeads"),localStorage.removeItem("validationResults"),localStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("uploadProcessing"),sessionStorage.removeItem("parsedLeads"),sessionStorage.removeItem("validationResults"),sessionStorage.removeItem("uploadContactsManuallyClosed"),console.log(" Manual cleanup - UploadContacts closed"),m(!1)}):ne&&(Z=i.createElement(ne,null),ke=K),Z)return i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("button",{onClick:()=>{ke()},className:"flex items-center transition-colors text-gray-600 hover:text-gray-900"},i.createElement(i0,{className:"h-5 w-5 rotate-180"}),i.createElement("span",null,"Back to Onboarding"))),Z);const Ae=z[n-1];return Ae?i.createElement("div",{className:"space-y-6"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Company Onboarding"),i.createElement("button",{className:"rounded-lg bg-indigo-600 px-4 py-2 text-white hover:bg-indigo-700"},"Save Progress")),i.createElement("div",{className:"grid grid-cols-5 gap-4"},z.map(W=>{const le=W.icon,we=n===W.id,de=Y(W.id),Ee=P(W.id);return i.createElement("div",{key:W.id,className:`relative rounded-lg p-4 ${we?"bg-indigo-50 border-2 border-indigo-500":de?"bg-green-50 border border-green-500":Ee?"bg-white border border-gray-200":"bg-gray-50 border border-gray-300"} cursor-pointer`,onClick:()=>L(W.id)},i.createElement("div",{className:"flex items-center space-x-3"},i.createElement("div",{className:`rounded-full p-2 ${we?"bg-indigo-100 text-indigo-600":de?"bg-green-100 text-green-600":Ee?"bg-gray-100 text-gray-500":"bg-gray-200 text-gray-500"}`},i.createElement(le,{className:"h-5 w-5"})),i.createElement("div",null,i.createElement("p",{className:"text-sm font-medium text-gray-900"},"Phase ",W.id),i.createElement("p",{className:"text-xs text-gray-500"},W.title),!Ee&&W.id>1&&i.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Complete previous phase first"))),W.id<4&&i.createElement("div",{className:"absolute -right-2 top-1/2 -translate-y-1/2"},i.createElement(i0,{className:"h-4 w-4 text-gray-400"})))})),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("div",{className:"mb-6"},i.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Phase ",Ae.id,": ",Ae.title),i.createElement("p",{className:"text-sm text-gray-500"},P(Ae.id)?"Complete the following steps to proceed to the next phase":"Complete all steps in the previous phase to unlock this phase")),i.createElement("div",{className:"space-y-4"},Ae.steps.map(W=>{const le=q(W),we=!!W.component||W.id===4,de=r.includes(W.id),Ee=P(Ae.id),Re=!de&&!W.disabled&&Ae.steps.slice(0,Ae.steps.findIndex(_e=>_e.id===W.id)).every(_e=>_e.disabled||r.includes(_e.id)),ze=Ee&&(de||Re);return i.createElement("div",{key:W.id,className:`rounded-lg border p-4 ${!Ee||!de&&!Re&&!W.disabled?"opacity-50 cursor-not-allowed border-gray-200 bg-gray-50":W.disabled?"opacity-50 cursor-not-allowed border-gray-200":de?"border-green-200 bg-green-50":Re?"border-indigo-200 bg-indigo-50 ring-2 ring-indigo-500":"border-gray-200 bg-white"} ${we&&!W.disabled&&ze?"cursor-pointer hover:border-indigo-300":""}`,onClick:()=>we&&!W.disabled&&ze&&ae(W.id)},i.createElement("div",{className:"flex items-start space-x-4"},i.createElement("div",{className:`rounded-full p-2 ${!Ee||!de&&!Re&&!W.disabled||W.disabled?"bg-gray-200 text-gray-400":de?"bg-green-100 text-green-600":Re?"bg-indigo-100 text-indigo-600":"bg-gray-100 text-gray-500"}`},i.createElement(le,{className:"h-5 w-5"})),i.createElement("div",{className:"flex-1"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("h3",{className:"text-sm font-medium text-gray-900"},W.title),Ee?W.disabled?i.createElement("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800"},"Coming Soon"):de?i.createElement("span",{className:"inline-flex items-center rounded-full bg-green-100 px-2.5 py-0.5 text-xs font-medium text-green-800"},i.createElement(mt,{className:"mr-1 h-3 w-3"}),"Completed"):Re?i.createElement("span",{className:"inline-flex items-center rounded-full bg-yellow-100 px-2.5 py-0.5 text-xs font-medium text-yellow-800"},i.createElement(Sn,{className:"mr-1 h-3 w-3"}),"Current Step"):i.createElement("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800"},"Locked"):i.createElement("span",{className:"inline-flex items-center rounded-full bg-gray-100 px-2.5 py-0.5 text-xs font-medium text-gray-800"},"Locked")),i.createElement("p",{className:"mt-1 text-sm text-gray-500"},W.description),we&&!W.disabled&&ze&&i.createElement("button",{className:"mt-3 text-sm font-medium text-indigo-600 hover:text-indigo-500",onClick:_e=>{_e.stopPropagation(),de?B(W.id):M(W.id)}},de?"Review Step":"Start Step"))))})),i.createElement("div",{className:"mt-6 flex justify-between"},i.createElement("button",{className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50",disabled:n===1,onClick:D},"Previous Phase"),i.createElement("button",{className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700",disabled:!1,onClick:_},"Next Phase"))),i.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},i.createElement("h2",{className:"mb-4 text-lg font-semibold text-gray-900"},"Need Help?"),i.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3"},i.createElement("button",{className:"flex items-center justify-center rounded-lg border border-gray-200 p-4 hover:bg-gray-50"},i.createElement(Ko,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("span",{className:"text-sm font-medium text-gray-700"},"Chat with Support")),i.createElement("button",{className:"flex items-center justify-center rounded-lg border border-gray-200 p-4 hover:bg-gray-50"},i.createElement(Go,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("span",{className:"text-sm font-medium text-gray-700"},"View Documentation")),i.createElement("button",{className:"flex items-center justify-center rounded-lg border border-gray-200 p-4 hover:bg-gray-50"},i.createElement(Ia,{className:"mr-2 h-5 w-5 text-indigo-600"}),i.createElement("span",{className:"text-sm font-medium text-gray-700"},"Schedule a Call"))))):i.createElement("div",{className:"text-center text-red-600"},"Error: Phase data not found. Please try refreshing the page.")},PIe=()=>{const[t,e]=N.useState(null),[n,s]=N.useState(null);return N.useEffect(()=>{(async()=>{try{const a=new URLSearchParams(window.location.search),o=a.get("code"),l=a.get("location"),c=a.get("accounts-server"),u=$e.get("userId");if(!u)throw new Error("User ID not found");if(!o)throw new Error("Authorization code not found");const d=new URLSearchParams({code:o,userId:u,...l&&{location:l},...c&&{accountsServer:c}}).toString(),m=await fetch(`undefined/zoho/auth/callback?${d}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${$e.get("gigId")}:${u}`}});if(!m.ok){const p=await m.json();throw new Error(p.error||"Failed to exchange code for tokens")}const h=await m.json();if(console.log("Callback response:",h),!h.access_token||!h.refresh_token||!h.expires_in)throw new Error("Missing required fields in Zoho response");e(h.access_token),s(h.refresh_token),$t.success("Successfully connected to Zoho CRM"),setTimeout(()=>{window.location.href="/app11?startStep=6"},3e3)}catch(a){console.error("Error handling Zoho callback:",a),$t.error(a.message||"Failed to complete Zoho authentication"),setTimeout(()=>{window.location.href="/app11"},2e3)}})()},[]),i.createElement("div",{className:"flex min-h-screen items-center justify-center"},i.createElement("div",{className:"text-center"},i.createElement("h2",{className:"text-lg font-medium text-gray-900"},"Zoho Authentication Successful!"),i.createElement("p",{className:"mt-2 text-sm text-gray-500"},"You will be redirected to the main application in a few seconds..."),t&&i.createElement("div",{className:"mt-4 p-4 bg-gray-100 rounded-lg"},i.createElement("p",{className:"text-sm font-medium text-gray-700"},"Access Token:"),i.createElement("p",{className:"mt-1 text-xs text-gray-500 break-all"},t),i.createElement("p",{className:"mt-4 text-sm font-medium text-gray-700"},"Refresh Token:"),i.createElement("p",{className:"mt-1 text-xs text-gray-500 break-all"},n))))},FIe=()=>{const[t,e]=N.useState(!0);return N.useEffect(()=>{(async()=>{try{const s=await fetch("undefined/zoho/auth",{method:"GET",headers:{Accept:"application/json"}});if(s.ok){const r=await s.json();window.location.href=r.authUrl}else throw new Error("Failed to get Zoho auth URL")}catch(s){console.error("Error initiating Zoho auth:",s),$t.error("Failed to initiate Zoho authentication"),e(!1)}})()},[]),i.createElement("div",{className:"flex min-h-screen items-center justify-center bg-gray-50"},i.createElement("div",{className:"text-center"},i.createElement("div",{className:"mb-4 flex justify-center"},i.createElement(xW,{className:"h-12 w-12 text-indigo-600"})),i.createElement("h2",{className:"text-lg font-medium text-gray-900"},"Connecting to Zoho CRM"),i.createElement("p",{className:"mt-2 text-sm text-gray-500"},t?"Please wait while we redirect you to Zoho's authentication page...":"There was an error connecting to Zoho. Please try again."),!t&&i.createElement("button",{onClick:()=>window.location.reload(),className:"mt-4 rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white hover:bg-indigo-700"},"Try Again")))},Ka=Ie.create({baseURL:"http://localhost:3001/api"}),MIe=()=>{const[t,e]=N.useState("all"),[n,s]=N.useState(!1),[r,a]=N.useState("document"),[o,l]=N.useState(""),[c,u]=N.useState(""),[d,m]=N.useState(""),[h,p]=N.useState(null),[f,y]=N.useState(""),[x,g]=N.useState([]),[b,w]=N.useState([]),[v,E]=N.useState(!1),[k,C]=N.useState(!0);N.useState(""),N.useState("neutral"),N.useState([]);const[I,A]=N.useState(null),[$,T]=N.useState(!1),[F,O]=N.useState(0),[M,B]=N.useState(0),[L,Y]=N.useState(null);N.useState({}),N.useState({});const[D,_]=N.useState({transcription:!0,sentiment:!0,insights:!0}),[P,z]=N.useState(null),[q,K]=N.useState(!1),[ae,ne]=N.useState(null),[Z,ke]=N.useState({}),[Ae,W]=N.useState(!1),[le,we]=N.useState(null),[de,Ee]=N.useState({}),[Re,ze]=N.useState({}),[_e,ht]=N.useState({}),[X,me]=N.useState({}),[Fe,tt]=N.useState({}),[Oe,Ye]=N.useState({}),[at,At]=N.useState(null),wt=5;N.useEffect(()=>{const oe=localStorage.getItem("knowledgeItems");oe&&g(JSON.parse(oe))},[]),N.useEffect(()=>{localStorage.setItem("knowledgeItems",JSON.stringify(x))},[x]);const fe=oe=>{switch(oe){case"document":return i.createElement(hn,{size:20,className:"text-blue-500"});case"audio":return i.createElement(nh,{size:20,className:"text-purple-500"});default:return i.createElement(aA,{size:20,className:"text-gray-500"})}},We=oe=>new Promise(ge=>{const he=new Audio;he.src=URL.createObjectURL(oe),he.addEventListener("loadedmetadata",()=>{URL.revokeObjectURL(he.src),ge(Math.round(he.duration/60))})}),qe=async oe=>{if(oe.target.files&&oe.target.files[0]){const ge=oe.target.files[0];p(ge),o||l(ge.name)}},je=()=>{let oe;return console.log("Running in in-app mode"),oe=$e.get("userId"),console.log("userId cookie:",oe),console.log("Verified saved user ID from cookie:",oe),oe},it=async()=>{try{const oe=$e.get("companyId");if(console.log("Attempting to update onboarding progress for company:",oe),!oe)throw new Error("Company ID not found in cookies");const ge="https://v25searchcompanywizardbackend-production.up.railway.app/api";console.log("Using API URL:",ge);const he=`${ge}/onboarding/companies/${oe}/onboarding/phases/2/steps/7`;console.log("Making request to endpoint:",he);const Be=await Ie.put(he,{status:"completed"});return console.log("Onboarding progress update response:",Be.data),Be.data&&($e.set("companyOnboardingProgress",JSON.stringify(Be.data),{expires:7}),console.log("Updated companyOnboardingProgress cookie with new data")),Be.data}catch(oe){throw console.error("Error updating onboarding progress:",oe),Ie.isAxiosError(oe)&&console.error("Axios error details:",{status:oe.response?.status,data:oe.response?.data,headers:oe.response?.headers}),oe}},St=async()=>{try{const oe=je();if(!oe)throw new Error("User ID not found");const ge=await Ka.get("/documents",{params:{userId:oe}});console.log("Response fetching documents:",ge);const he=ge.data.documents.map(pt=>({id:pt._id,name:pt.name,description:pt.description,type:"document",fileUrl:pt.fileUrl,uploadedAt:jt(new Date(pt.uploadedAt),"yyyy-MM-dd"),uploadedBy:pt.uploadedBy,tags:pt.tags,usagePercentage:0,isPublic:!0,analysis:pt.analysis})),Be=he.length>1;console.log("Documents count:",he.length),console.log("Has multiple documents:",Be),C(!Be),g(he);const Ge=he.reduce((pt,_n)=>(_n.analysis&&(pt[_n.id]=_n.analysis),pt),{});return ke(Ge),Be}catch(oe){return console.error("Error fetching documents:",oe),C(!0),!1}};N.useEffect(()=>{St()},[]),N.useEffect(()=>{(async()=>{try{const ge=je();if(!ge)throw new Error("userId ID not found");const he=await Ka.get("/call-recordings",{params:{userId:ge}});console.log("Response fetching call records:",he);const Be=he.data.callRecordings.map(Ge=>({id:Ge.id,contactId:Ge.contactId,date:Ge.date,duration:Ge.duration,recordingUrl:Ge.recordingUrl,transcriptUrl:"",summary:Ge.summary,sentiment:Ge.sentiment,tags:Ge.tags,aiInsights:Ge.aiInsights,repId:Ge.repId,companyId:Ge.companyId,processingOptions:{transcription:!0,sentiment:!0,insights:!0},audioState:{isPlaying:!1,currentTime:0,duration:Ge.duration||0,audioInstance:null,showPlayer:!1,showTranscript:!1}}));w(Be)}catch(ge){console.error("Error fetching call records:",ge)}})()},[]);const dt=async oe=>{oe.preventDefault(),E(!0);try{if(!h)throw new Error("No file selected");const ge=je();if(!ge)throw new Error("User ID not found");if(r==="document"){const he=new FormData;he.append("file",h),he.append("name",o),he.append("description",c),he.append("tags",f),he.append("uploadedBy","Current User"),he.append("userId",ge);const Be=await Ka.post("/documents/upload",he);console.log("Document upload successful:",Be.data),await St(),console.log("Updating onboarding progress for document upload");try{await it(),console.log("Successfully updated onboarding progress")}catch(Ge){console.error("Failed to update onboarding progress:",Ge)}}else if(r==="audio"){const he=await We(h),Be=new FormData;Be.append("file",h),Be.append("contactId",o),Be.append("date",jt(new Date,"yyyy-MM-dd")),Be.append("duration",he.toString()),Be.append("summary",c),Be.append("sentiment","neutral"),Be.append("tags",f),Be.append("aiInsights",""),Be.append("repId","current-user"),Be.append("userId",ge);const Ge=await Ka.post("/call-recordings/upload",Be);console.log("Call recording upload successful:",Ge.data);const pt={id:Ge.data.callRecording.id,contactId:Ge.data.callRecording.contactId,date:Ge.data.callRecording.date,duration:Ge.data.callRecording.duration,recordingUrl:Ge.data.callRecording.recordingUrl,transcriptUrl:"",summary:Ge.data.callRecording.summary,sentiment:Ge.data.callRecording.sentiment,tags:Ge.data.callRecording.tags,aiInsights:Ge.data.callRecording.aiInsights,repId:Ge.data.callRecording.repId,companyId:Ge.data.callRecording.companyId,processingOptions:{transcription:!0,sentiment:!0,insights:!0},audioState:{isPlaying:!1,currentTime:0,duration:he||0,audioInstance:null,showPlayer:!1,showTranscript:!1}};w(_n=>[..._n,pt])}l(""),u(""),m(""),p(null),y(""),s(!1)}catch(ge){console.error("Error in handleSubmit:",ge),alert("There was an error uploading your file. Please try again.")}finally{E(!1)}},gt=async oe=>{console.log("Attempting to delete item with ID:",oe);try{const ge=x.find(Be=>Be.id===oe),he=b.find(Be=>Be.id===oe);ge?(console.log("Document being deleted:",ge),await Ka.delete(`/documents/${oe}`),g(Be=>Be.filter(Ge=>Ge.id!==oe))):he&&(console.log("Call recording being deleted:",he),await Ka.delete(`/call-recordings/${oe}`),w(Be=>{const Ge=Be.find(pt=>pt.id===oe);return Ge&&Qt(Ge),Be.filter(pt=>pt.id!==oe)}),L===oe&&(I&&I.pause(),A(null),T(!1),Y(null),O(0),B(0)))}catch(ge){console.error("Error deleting item:",ge),alert("There was an error deleting the item. Please try again.")}},Qt=oe=>{if(oe.audioState.audioInstance)try{oe.audioState.audioInstance.pause(),oe.audioState.audioInstance.onloadedmetadata=null,oe.audioState.audioInstance.ontimeupdate=null,oe.audioState.audioInstance.onended=null,oe.audioState.audioInstance.onerror=null,oe.audioState.audioInstance.src&&URL.revokeObjectURL(oe.audioState.audioInstance.src)}catch(ge){console.error("Error cleaning up audio instance:",ge)}if(oe.recordingUrl)try{URL.revokeObjectURL(oe.recordingUrl)}catch(ge){console.error("Error revoking recording URL:",ge)}},Bs=async oe=>{if(oe.isCallRecording||oe.recordingUrl)if(P?.id===oe.id)z(null);else{if(z(oe),!Z[oe.id]||!Z[oe.id].summary){Ee(ge=>({...ge,[oe.id]:!0}));try{const ge=await Ka.post(`/call-recordings/${oe.id}/analyze/summary`);ke(he=>({...he,[oe.id]:{...he[oe.id]||{},summary:ge.data.summary}}))}catch{ke(he=>({...he,[oe.id]:{...he[oe.id]||{},summary:{keyIdeas:[],lastUpdated:null,error:"Failed to load summary."}}}))}finally{Ee(ge=>({...ge,[oe.id]:!1}))}}if(!Z[oe.id]||!Z[oe.id].transcription){ze(ge=>({...ge,[oe.id]:!0}));try{const ge=await Ka.post(`/call-recordings/${oe.id}/analyze/transcription`);ke(he=>({...he,[oe.id]:{...he[oe.id]||{},transcription:ge.data.transcription}})),ht(he=>({...he,[oe.id]:wt}))}catch{ke(he=>({...he,[oe.id]:{...he[oe.id]||{},transcription:{status:"failed",segments:[],lastUpdated:null,error:"Failed to load transcription."}}}))}finally{ze(ge=>({...ge,[oe.id]:!1}))}}if(!Z[oe.id]||!Z[oe.id].scoring){me(ge=>({...ge,[oe.id]:!0}));try{const ge=await Ka.post(`/call-recordings/${oe.id}/analyze/scoring`);ke(he=>({...he,[oe.id]:{...he[oe.id]||{},scoring:ge.data.scoring}}))}catch{ke(he=>({...he,[oe.id]:{...he[oe.id]||{},scoring:{status:"failed",result:null,lastUpdated:null,error:"Failed to load scoring."}}}))}finally{me(ge=>({...ge,[oe.id]:!1}))}}}else le?.id===oe.id?we(null):(we(oe),(!Z[oe.id]||!Z[oe.id].summary)&&await S(oe.id))},S=async oe=>{try{ne(oe);const ge=await Ka.post(`/rag/analyze/${oe}`);console.log("Analysis response:",ge.data),ke(he=>({...he,[oe]:ge.data}))}catch(ge){console.error("Error analyzing document:",ge),alert("Failed to analyze document. Please try again.")}finally{ne(null)}},V=oe=>{window.open(oe,"_blank")},J=()=>{v||(s(!1),l(""),u(""),m(""),p(null),y(""))},be=()=>{I&&(I.pause(),T(!1),O(0),Y(null)),K(!1),z(null)},ve=(oe,ge)=>{if(console.log("Attempting to play audio:",oe),I&&(I.pause(),T(!1)),L===ge&&I){$?(I.pause(),T(!1)):(I.play(),T(!0));return}const he=new Audio(oe);he.addEventListener("loadedmetadata",()=>{B(he.duration)}),he.addEventListener("timeupdate",()=>{O(he.currentTime)}),he.addEventListener("ended",()=>{T(!1),O(0)}),he.play().then(()=>{T(!0),A(he),Y(ge)}).catch(Be=>{console.error("Error playing audio:",Be),T(!1)})},se=oe=>{if(isNaN(oe)||oe<0)return"0:00";const ge=Math.floor(oe/60),he=Math.floor(oe%60);return`${ge}:${he.toString().padStart(2,"0")}`},De=oe=>{if(!oe)return"";try{return jt(new Date(oe),"dd MMM yyyy")}catch{return oe}};N.useEffect(()=>()=>{I&&(I.pause(),A(null),T(!1))},[]);const Ke=()=>{const oe=new CustomEvent("tabChange",{detail:{tab:"company-onboarding"}});window.dispatchEvent(oe)},He=()=>{W(!1),we(null)},xt=(oe,ge)=>{if(!oe||Fe[ge])return;const he=new Audio(oe);he.addEventListener("loadedmetadata",()=>{tt(Be=>({...Be,[ge]:he.duration}))})},en=oe=>{if(!oe)return!0;const ge=["the","and","or","but","in","on","at","to","for","of","with","by"],he=oe.toLowerCase().split(/\s+/);return he.filter(pt=>ge.includes(pt)).length/Math.min(he.length,20)>.2},Po=oe=>{const ge=`${oe.summary} ${oe.domain} ${oe.theme}`.substring(0,200);return!en(ge)},mw=async(oe,ge)=>{try{At(oe);const he={summary:ge.summary,domain:ge.domain,theme:ge.theme,technicalLevel:ge.technicalLevel,mainPoints:ge.mainPoints,targetAudience:ge.targetAudience,keyTerms:ge.keyTerms,recommendations:ge.recommendations},Be=await Ka.post("/rag/translate-analysis",{analysis:he,targetLanguage:"English"});console.log("Translation response:",Be.data),Ye(Ge=>({...Ge,[oe]:Be.data.translatedAnalysis}))}catch(he){console.error("Error translating analysis:",he),alert("Failed to translate analysis. Please try again.")}finally{At(null)}},hw=()=>{const oe=x.filter(he=>t==="all"||he.type===t).map(he=>({...he,itemType:"document",date:he.uploadedAt,isCallRecording:!1})),ge=b.filter(he=>t==="all"||t==="audio").map(he=>({id:he.id,name:he.contactId,description:he.summary,type:"audio",itemType:"callRecording",tags:he.tags,date:he.date,isCallRecording:!0,callData:he}));return[...oe,...ge].sort((he,Be)=>new Date(Be.date).getTime()-new Date(he.date).getTime())},CC=()=>{const oe=hw();return oe.length>0?i.createElement("div",{className:"space-y-4"},oe.map(ge=>{if(ge.isCallRecording&&"callData"in ge&&ge.callData){const he=ge.callData;return xt(he.recordingUrl,he.id),i.createElement(i.Fragment,{key:he.id},i.createElement("div",{className:"bg-white p-5 rounded-lg shadow-sm border border-gray-100"},i.createElement("div",{className:"flex items-start"},i.createElement("div",{className:"p-3 rounded-lg bg-purple-100 mr-4 flex-shrink-0"},i.createElement(nh,{size:20,className:"text-purple-500"})),i.createElement("div",{className:"flex-grow min-w-0"},i.createElement("div",{className:"flex items-center justify-between mb-2 flex-wrap gap-2"},i.createElement("h3",{className:"text-lg font-medium text-gray-900 truncate"},he.contactId),i.createElement("div",{className:"flex items-center space-x-2 flex-shrink-0"},i.createElement("span",{className:"px-2 py-1 text-xs rounded-full bg-purple-100 text-purple-800"},"Call Recording"),he.processingOptions?.sentiment&&he.sentiment&&i.createElement("span",{className:`px-2 py-1 text-xs rounded-full whitespace-nowrap ${he.sentiment==="positive"?"bg-green-100 text-green-800":he.sentiment==="negative"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`},he.sentiment.charAt(0).toUpperCase()+he.sentiment.slice(1)," Sentiment"),i.createElement("button",{onClick:()=>Bs(he),className:"text-blue-600 hover:text-blue-800 p-1",title:"View details"},i.createElement(Qm,{size:16})),i.createElement("button",{className:"text-red-600 hover:text-red-800 p-1",onClick:()=>gt(he.id),title:"Delete call recording"},i.createElement(Hr,{size:16})))),i.createElement("div",{className:"flex items-center text-sm text-gray-500 mb-3 whitespace-nowrap"},i.createElement(Ct,{size:14,className:"mr-1 flex-shrink-0"}),De(he.date),"  ",Fe[he.id]!==void 0?se(Fe[he.id]):"..."),i.createElement("p",{className:"text-sm text-gray-700 mb-3 break-words overflow-hidden"},he.summary),i.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},he.tags.map((Be,Ge)=>i.createElement("span",{key:`${he.id}-${Be}`,className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700 whitespace-nowrap"},Be)))))),P?.id===he.id&&i.createElement("div",{className:"bg-purple-50 border-l-4 border-purple-500 p-6 rounded-lg shadow-sm ml-4 mb-4"},i.createElement("div",{className:"flex justify-between items-start mb-4"},i.createElement("div",{className:"flex items-center"},i.createElement(nh,{size:20,className:"text-purple-600 mr-2"}),i.createElement("h3",{className:"text-xl font-semibold text-gray-900"},"Call Recording Details")),i.createElement("button",{onClick:()=>z(null),className:"text-gray-400 hover:text-gray-600"},i.createElement(Yo,{size:20}))),i.createElement("div",{className:"mb-6"},i.createElement("div",{className:"flex items-start justify-between"},i.createElement("div",null,i.createElement("h2",{className:"text-2xl font-semibold text-gray-900 mb-2"},P.contactId),i.createElement("p",{className:"text-gray-600 mb-2"},P.summary),i.createElement("div",{className:"flex items-center text-gray-500 mb-2"},i.createElement(Ct,{size:16,className:"mr-2"}),De(P.date),"  ",Fe[P.id]!==void 0?se(Fe[P.id]):"...")),i.createElement("div",{className:"flex flex-col items-end gap-2"},i.createElement("button",{className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",onClick:()=>ve(P.recordingUrl,P.id),title:L===P.id&&$?"Pause":"Play"},L===P.id&&$?i.createElement(uA,{size:18}):i.createElement(R1,{size:18}),i.createElement("span",{className:"ml-2"},L===P.id&&$?"Pause":"Play"," Audio")),i.createElement("span",{className:"text-xs text-gray-500"},L===P.id?`${se(F)} / ${se(M)}`:"0:00 / 0:00")))),i.createElement("div",{className:"mt-6 w-full"},i.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-6"},"Call Analysis"),i.createElement("details",{className:"mb-4",open:!0},i.createElement("summary",{className:"cursor-pointer text-gray-700 font-semibold py-2"},"Key Points"),i.createElement("div",{className:"space-y-4 p-2"},de[P.id]?i.createElement("div",{className:"flex items-center space-x-2 text-blue-600"},i.createElement(qo,{className:"animate-spin",size:20}),i.createElement("span",null,"Analyzing call, please wait...")):Z[P.id]&&"summary"in Z[P.id]&&Z[P.id].summary?.keyIdeas?.length>0?i.createElement(i.Fragment,null,Z[P.id].summary.keyIdeas.map((Be,Ge)=>i.createElement("div",{key:Ge,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("h5",{className:"font-medium text-gray-900 mb-2"},Be.title),i.createElement("p",{className:"text-gray-700"},Be.description))),i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(Z[P.id].summary.lastUpdated),"PPpp"))):i.createElement("div",{className:"text-gray-500 italic"},"No analysis available yet."))),i.createElement("details",{className:"mb-4",open:!0},i.createElement("summary",{className:"cursor-pointer text-gray-700 font-semibold py-2"},"Transcription"),i.createElement("div",{className:"p-4"},Re[P.id]?i.createElement("div",{className:"flex items-center space-x-2 text-blue-600"},i.createElement(qo,{className:"animate-spin",size:20}),i.createElement("span",null,"Generating transcription, please wait...")):(()=>{if(!Z||!P?.id)return i.createElement("div",{className:"text-gray-500 italic"},"No transcription available yet.");const Be=Z[P.id];if(!Be||!("transcription"in Be))return i.createElement("div",{className:"text-gray-500 italic"},"No transcription available yet.");const Ge=Be;if(Ge.transcription?.status!=="completed"||!Ge.transcription?.segments?.length)return i.createElement("div",{className:"text-gray-500 italic"},"No transcription available yet.");const pt=_e[P.id]||wt,_n=Ge.transcription.segments.slice(0,pt);return i.createElement("div",{className:"space-y-4"},_n.map((wn,Us)=>i.createElement("div",{key:Us,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("div",{className:"flex justify-between items-center mb-2 text-sm text-gray-500"},i.createElement("span",null,typeof wn.start=="string"?wn.start:se(wn.start)," - ",typeof wn.end=="string"?wn.end:se(wn.end)),wn.speaker&&i.createElement("span",{className:"font-medium"},wn.speaker)),i.createElement("p",{className:"text-gray-700"},wn.text))),pt<Ge.transcription.segments.length&&i.createElement("button",{className:"mt-2 px-4 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200",onClick:()=>ht(wn=>({...wn,[P.id]:pt+wt}))},"Show more"),pt>wt&&i.createElement("button",{className:"mt-2 ml-2 px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",onClick:()=>ht(wn=>({...wn,[P.id]:wt}))},"Show less"),Ge.transcription.lastUpdated&&i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(Ge.transcription.lastUpdated),"PPpp")))})())),i.createElement("details",{className:"mb-4",open:!0},i.createElement("summary",{className:"cursor-pointer text-gray-700 font-semibold py-2"},"Scoring"),i.createElement("div",{className:"p-4"},X[P.id]?i.createElement("div",{className:"flex items-center space-x-2 text-blue-600"},i.createElement(qo,{className:"animate-spin",size:20}),i.createElement("span",null,"Generating scoring, please wait...")):(()=>{if(!Z||!P?.id)return i.createElement("div",{className:"text-gray-500 italic"},"No scoring available yet.");const Be=Z[P.id];if(!Be||!("scoring"in Be))return i.createElement("div",{className:"text-gray-500 italic"},"No scoring available yet.");const Ge=Be.scoring;return Ge?.status!=="completed"||!Ge?.result?i.createElement("div",{className:"text-gray-500 italic"},"No scoring available yet."):i.createElement("div",{className:"space-y-4"},Object.entries(Ge.result).map(([pt,_n])=>i.createElement("div",{key:pt,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("div",{className:"flex justify-between items-center mb-2 text-sm text-gray-500"},i.createElement("span",{className:"font-medium"},pt),i.createElement("span",null,"Score: ",_n.score)),i.createElement("p",{className:"text-gray-700"},_n.feedback))),Ge.lastUpdated&&i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(Ge.lastUpdated),"PPpp")))})())))))}else return i.createElement(i.Fragment,{key:ge.id},i.createElement("div",{className:"bg-white p-5 rounded-lg shadow-sm border border-gray-100"},i.createElement("div",{className:"flex items-start"},i.createElement("div",{className:"p-3 rounded-lg bg-gray-100 mr-4 flex-shrink-0"},fe(ge.type)),i.createElement("div",{className:"flex-grow min-w-0"},i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1 truncate"},ge.name),i.createElement("p",{className:"text-sm text-gray-500 mb-3 break-words line-clamp-2"},ge.description),i.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},ge.tags.map((he,Be)=>i.createElement("span",{key:`${ge.id}-${he}`,className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700 whitespace-nowrap"},he))),i.createElement("div",{className:"flex items-center justify-between"},i.createElement("span",{className:`px-2 py-1 text-xs rounded-full whitespace-nowrap ${ge.type==="document"?"bg-blue-100 text-blue-800":ge.type==="audio"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`},ge.type.charAt(0).toUpperCase()+ge.type.slice(1)),i.createElement("div",{className:"flex space-x-2 flex-shrink-0"},i.createElement("button",{onClick:()=>Bs(ge),className:"text-blue-600 hover:text-blue-800 p-1",title:"View details"},i.createElement(Qm,{size:16})),i.createElement("button",{className:"text-red-600 hover:text-red-800 p-1",onClick:()=>gt(ge.id),title:"Delete"},i.createElement(Hr,{size:16}))))))),le?.id===ge.id&&i.createElement("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg shadow-sm ml-4 mb-4"},i.createElement("div",{className:"flex justify-between items-start mb-4"},i.createElement("div",{className:"flex items-center"},i.createElement(Jl,{size:20,className:"text-blue-600 mr-2"}),i.createElement("h3",{className:"text-xl font-semibold text-gray-900"},"Document Analysis")),i.createElement("button",{onClick:()=>we(null),className:"text-gray-400 hover:text-gray-600"},i.createElement(Yo,{size:20}))),ae===ge.id?i.createElement("div",{className:"flex items-center justify-center py-8"},i.createElement(qo,{className:"animate-spin text-blue-600 mr-3",size:24}),i.createElement("span",{className:"text-gray-600"},"Analyzing document...")):Z[ge.id]?fw(Z[ge.id],ge.id):i.createElement("div",{className:"text-center py-8"},i.createElement("p",{className:"text-gray-600 mb-4"},"No analysis available yet."),i.createElement("button",{onClick:()=>S(ge.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"Analyze Document"))))}),P&&P.recordingUrl&&i.createElement("div",{className:"bg-white rounded-lg shadow-lg border border-blue-200 mt-6 p-6 w-full"},i.createElement("div",{className:"flex justify-between items-start mb-4"},i.createElement("div",{className:"flex items-center"},i.createElement(nh,{size:20,className:"text-purple-500"}),i.createElement("h3",{className:"text-xl font-semibold ml-2"},"Call Recording Details")),i.createElement("button",{onClick:be,className:"text-gray-400 hover:text-gray-500"},i.createElement(Yo,{size:24}))),i.createElement("div",{className:"border-b border-gray-200 pb-6 mb-6"},i.createElement("div",{className:"flex items-start justify-between"},i.createElement("div",null,i.createElement("h2",{className:"text-2xl font-semibold text-gray-900 mb-2"},P.contactId),i.createElement("p",{className:"text-gray-600 mb-2"},P.summary),i.createElement("div",{className:"flex items-center text-gray-500 mb-2"},i.createElement(Ct,{size:16,className:"mr-2"}),De(P.date),"  ",Fe[P.id]!==void 0?se(Fe[P.id]):"..."),P.tags&&P.tags.length>0&&i.createElement("div",{className:"flex flex-wrap gap-2 mb-2"},P.tags.map((ge,he)=>i.createElement("span",{key:he,className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-sm"},ge)))),i.createElement("div",{className:"flex flex-col items-end gap-2"},i.createElement("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",onClick:()=>ve(P.recordingUrl,P.id),title:L===P.id&&$?"Pause":"Play"},L===P.id&&$?i.createElement(uA,{size:18}):i.createElement(R1,{size:18}),i.createElement("span",{className:"ml-2"},L===P.id&&$?"Pause":"Play"," Audio")),i.createElement("span",{className:"text-xs text-gray-500"},L===P.id?`${se(F)} / ${se(M)}`:"0:00 / 0:00")))),i.createElement("div",{className:"mt-6 w-full"},i.createElement("h2",{className:"text-2xl font-bold text-gray-800 mb-6"},"Call Analysis"),i.createElement("details",{className:"mb-4",open:!0},i.createElement("summary",{className:"cursor-pointer text-gray-700 font-semibold py-2"},"Key Points"),i.createElement("div",{className:"space-y-4 p-2"},de[P.id]?i.createElement("div",{className:"flex items-center space-x-2 text-blue-600"},i.createElement(qo,{className:"animate-spin",size:20}),i.createElement("span",null,"Analyzing call, please wait...")):Z[P.id]&&"summary"in Z[P.id]&&Z[P.id].summary?.keyIdeas?.length>0?i.createElement(i.Fragment,null,Z[P.id].summary.keyIdeas.map((ge,he)=>i.createElement("div",{key:he,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("h5",{className:"font-medium text-gray-900 mb-2"},ge.title),i.createElement("p",{className:"text-gray-700"},ge.description))),i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(Z[P.id].summary.lastUpdated),"PPpp"))):i.createElement("div",{className:"text-gray-500 italic"},"No analysis available yet."))),i.createElement("details",{className:"mb-4",open:!0},i.createElement("summary",{className:"cursor-pointer text-gray-700 font-semibold py-2"},"Transcription"),i.createElement("div",{className:"p-4"},Re[P.id]?i.createElement("div",{className:"flex items-center space-x-2 text-blue-600"},i.createElement(qo,{className:"animate-spin",size:20}),i.createElement("span",null,"Generating transcription, please wait...")):(()=>{if(!Z||!P?.id)return i.createElement("div",{className:"text-gray-500 italic"},"No transcription available yet.");const ge=Z[P.id];if(!ge||!("transcription"in ge))return i.createElement("div",{className:"text-gray-500 italic"},"No transcription available yet.");const he=ge;if(he.transcription?.status!=="completed"||!he.transcription?.segments?.length)return i.createElement("div",{className:"text-gray-500 italic"},"No transcription available yet.");const Be=_e[P.id]||wt,Ge=he.transcription.segments.slice(0,Be);return i.createElement("div",{className:"space-y-4"},Ge.map((pt,_n)=>i.createElement("div",{key:_n,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("div",{className:"flex justify-between items-center mb-2 text-sm text-gray-500"},i.createElement("span",null,typeof pt.start=="string"?pt.start:se(pt.start)," - ",typeof pt.end=="string"?pt.end:se(pt.end)),pt.speaker&&i.createElement("span",{className:"font-medium"},pt.speaker)),i.createElement("p",{className:"text-gray-700"},pt.text))),Be<he.transcription.segments.length&&i.createElement("button",{className:"mt-2 px-4 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200",onClick:()=>ht(pt=>({...pt,[P.id]:Be+wt}))},"Show more"),Be>wt&&i.createElement("button",{className:"mt-2 ml-2 px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",onClick:()=>ht(pt=>({...pt,[P.id]:wt}))},"Show less"),he.transcription.lastUpdated&&i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(he.transcription.lastUpdated),"PPpp")))})())),i.createElement("details",{className:"mb-4",open:!0},i.createElement("summary",{className:"cursor-pointer text-gray-700 font-semibold py-2"},"Scoring"),i.createElement("div",{className:"p-4"},X[P.id]?i.createElement("div",{className:"flex items-center space-x-2 text-blue-600"},i.createElement(qo,{className:"animate-spin",size:20}),i.createElement("span",null,"Generating scoring, please wait...")):(()=>{if(!Z||!P?.id)return i.createElement("div",{className:"text-gray-500 italic"},"No scoring available yet.");const ge=Z[P.id];if(!ge||!("scoring"in ge))return i.createElement("div",{className:"text-gray-500 italic"},"No scoring available yet.");const he=ge.scoring;return he?.status!=="completed"||!he?.result?i.createElement("div",{className:"text-gray-500 italic"},"No scoring available yet."):i.createElement("div",{className:"space-y-4"},Object.entries(he.result).map(([Be,Ge])=>i.createElement("div",{key:Be,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("div",{className:"flex justify-between items-center mb-2 text-sm text-gray-500"},i.createElement("span",{className:"font-medium"},Be),i.createElement("span",null,"Score: ",Ge.score)),i.createElement("p",{className:"text-gray-700"},Ge.feedback))),he.lastUpdated&&i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(he.lastUpdated),"PPpp")))})()))))):i.createElement("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-gray-100 text-center"},i.createElement("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gray-100 mb-4"},i.createElement(aA,{size:24,className:"text-gray-400"})),i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},"No resources found"),i.createElement("p",{className:"text-gray-500 max-w-md mx-auto"},t!=="all"?`No ${t==="document"?"documents":"audio recordings"} found. Try changing the filter or add new resources.`:"Your knowledge base is empty. Add documents or call recordings to get started."),t==="all"&&i.createElement("button",{className:"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center mx-auto",onClick:()=>s(!0)},i.createElement(xs,{size:18,className:"mr-2"}),"Add Your First Resource"))},pw=()=>n?i.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},i.createElement("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl my-8 max-h-[90vh] flex flex-col"},i.createElement("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center flex-shrink-0"},i.createElement("h3",{className:"text-xl font-semibold text-gray-900"},"Add to Knowledge Base"),i.createElement("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none text-xl font-semibold",onClick:J,disabled:v},"")),i.createElement("div",{className:"overflow-y-auto flex-grow"},i.createElement("form",{onSubmit:dt},i.createElement("div",{className:"p-6"},i.createElement("div",{className:"mb-6"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Resource Type"),i.createElement("div",{className:"grid grid-cols-2 gap-4"},i.createElement("button",{type:"button",className:`p-4 rounded-lg border ${r==="document"?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"} flex flex-col items-center justify-center`,onClick:()=>a("document")},i.createElement(hn,{size:24,className:r==="document"?"text-blue-500":"text-gray-500"}),i.createElement("span",{className:"mt-2 text-sm"},"Document")),i.createElement("button",{type:"button",className:`p-4 rounded-lg border ${r==="audio"?"border-blue-500 bg-blue-50":"border-gray-200 hover:bg-gray-50"} flex flex-col items-center justify-center`,onClick:()=>a("audio")},i.createElement(nh,{size:24,className:r==="audio"?"text-blue-500":"text-gray-500"}),i.createElement("span",{className:"mt-2 text-sm"},"Call Recording")))),i.createElement("div",{className:"mb-4"},i.createElement("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2"},"Name"),i.createElement("input",{type:"text",id:"name",className:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:r==="document"?"Enter a name for this resource":"Enter a name for this recording",value:o,onChange:oe=>l(oe.target.value),required:!0})),i.createElement("div",{className:"mb-4"},i.createElement("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2"},"Description"),i.createElement("textarea",{id:"description",rows:3,className:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:r==="document"?"Describe what this resource contains":"Describe what this recording contains",value:c,onChange:oe=>u(oe.target.value),required:!0})),i.createElement("div",{className:"mb-4"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Upload File"),i.createElement("div",{className:"flex items-center justify-center w-full"},i.createElement("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"},i.createElement("div",{className:"flex flex-col items-center justify-center pt-5 pb-6"},i.createElement(Xo,{size:24,className:"text-gray-400 mb-2"}),i.createElement("p",{className:"mb-2 text-sm text-gray-500"},i.createElement("span",{className:"font-semibold"},"Click to upload")," or drag and drop"),i.createElement("p",{className:"text-xs text-gray-500"},r==="document"?"PDF, DOCX, TXT, or other document formats":"MP3, WAV, or other audio formats")),i.createElement("input",{type:"file",className:"hidden",onChange:qe,accept:r==="document"?".pdf,.docx,.txt,.md,.csv,.xlsx":".mp3,.wav,.ogg,.m4a",required:!0}))),h&&i.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Selected file: ",h.name)),i.createElement("div",{className:"mb-4"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Tags"),i.createElement("input",{type:"text",className:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",placeholder:"Enter tags separated by commas",value:f,onChange:oe=>y(oe.target.value)}),i.createElement("p",{className:"mt-1 text-xs text-gray-500"},"Example: ",r==="document"?"product, api, technical":"follow-up, sales, support")),r==="audio"&&i.createElement("div",{className:"mb-4"},i.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"AI Processing Options"),i.createElement("div",{className:"space-y-2"},i.createElement("div",{className:"flex items-center"},i.createElement("input",{type:"checkbox",id:"transcription",className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500",checked:D.transcription,onChange:oe=>_(ge=>({...ge,transcription:oe.target.checked}))}),i.createElement("label",{htmlFor:"transcription",className:"ml-2 text-sm text-gray-700"},"Generate transcription")),i.createElement("div",{className:"flex items-center"},i.createElement("input",{type:"checkbox",id:"sentiment",className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500",checked:D.sentiment,onChange:oe=>_(ge=>({...ge,sentiment:oe.target.checked}))}),i.createElement("label",{htmlFor:"sentiment",className:"ml-2 text-sm text-gray-700"},"Analyze sentiment")),i.createElement("div",{className:"flex items-center"},i.createElement("input",{type:"checkbox",id:"insights",className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500",checked:D.insights,onChange:oe=>_(ge=>({...ge,insights:oe.target.checked}))}),i.createElement("label",{htmlFor:"insights",className:"ml-2 text-sm text-gray-700"},"Generate AI insights"))))),i.createElement("div",{className:"p-6 border-t border-gray-200 flex justify-end space-x-3 flex-shrink-0"},i.createElement("button",{type:"button",className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-lg",onClick:J,disabled:v},"Cancel"),i.createElement("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center",disabled:v},v?i.createElement(i.Fragment,null,i.createElement("span",{className:"animate-spin mr-2"},""),"Uploading..."):i.createElement(i.Fragment,null,i.createElement(Xo,{size:18,className:"mr-2"}),"Upload"))))))):null,fw=(oe,ge)=>{if("domain"in oe){const he=oe,Be=ge&&Oe[ge],Ge=Be?Oe[ge]:he,pt=ge&&Po(he)&&!Be;return i.createElement("div",null,ge&&i.createElement("div",{className:"mb-6 flex items-center justify-between"},i.createElement("div",{className:"flex items-center space-x-3"},Be&&i.createElement("div",{className:"flex items-center text-sm text-green-600 bg-green-50 px-3 py-1 rounded-full"},i.createElement(iA,{size:14,className:"mr-1"}),"Translated to English"),pt&&i.createElement("button",{onClick:()=>mw(ge,he),disabled:at===ge,className:"flex items-center text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 disabled:opacity-50"},at===ge?i.createElement(i.Fragment,null,i.createElement(qo,{size:14,className:"mr-1 animate-spin"}),"Translating..."):i.createElement(i.Fragment,null,i.createElement(iA,{size:14,className:"mr-1"}),"Translate to English"))),Be&&i.createElement("button",{onClick:()=>Ye(_n=>{const wn={..._n};return delete wn[ge],wn}),className:"text-sm text-gray-500 hover:text-gray-700"},"Show Original")),i.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8"},i.createElement("div",{className:"space-y-6"},i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Summary"),i.createElement("p",{className:"text-gray-700"},Ge.summary)),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Domain"),i.createElement("p",{className:"text-gray-700"},Ge.domain)),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Theme"),i.createElement("p",{className:"text-gray-700"},Ge.theme)),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Technical Level"),i.createElement("p",{className:"text-gray-700"},Ge.technicalLevel))),i.createElement("div",{className:"space-y-6"},i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Main Points"),i.createElement("ul",{className:"list-disc list-inside space-y-2"},Ge.mainPoints.map((_n,wn)=>i.createElement("li",{key:wn,className:"text-gray-700"},_n)))),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Target Audience"),i.createElement("p",{className:"text-gray-700"},Ge.targetAudience)),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Key Terms"),i.createElement("ul",{className:"list-disc list-inside space-y-2"},Ge.keyTerms.map((_n,wn)=>i.createElement("li",{key:wn,className:"text-gray-700"},_n)))),i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Recommendations"),i.createElement("ul",{className:"list-disc list-inside space-y-2"},Ge.recommendations.map((_n,wn)=>i.createElement("li",{key:wn,className:"text-gray-700"},_n)))))))}else if("summary"in oe&&oe.summary&&"keyIdeas"in oe.summary){const he=oe;return i.createElement("div",{className:"space-y-6"},i.createElement("div",null,i.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Call Summary"),i.createElement("div",{className:"space-y-4"},he.summary.keyIdeas.map((Be,Ge)=>i.createElement("div",{key:Ge,className:"bg-gray-50 p-4 rounded-lg"},i.createElement("h4",{className:"font-medium text-gray-900 mb-2"},Be.title),i.createElement("p",{className:"text-gray-700"},Be.description)))),i.createElement("div",{className:"mt-4 text-sm text-gray-500"},"Last updated: ",jt(new Date(he.summary.lastUpdated),"PPpp"))))}else return i.createElement("div",{className:"text-gray-500 italic"},"No analysis available yet.")},IC=()=>!Ae||!le||!Z[le.id]?null:i.createElement("div",{className:"p-6 relative"},i.createElement("button",{onClick:He,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 text-2xl font-bold focus:outline-none",title:"Close details"},""),i.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 p-6"},i.createElement("div",{className:"border-b border-gray-200 pb-6 mb-6"},i.createElement("div",{className:"flex items-start justify-between"},i.createElement("div",{className:"flex items-start space-x-4"},i.createElement("div",{className:"p-3 rounded-lg bg-gray-100"},fe(le.type)),i.createElement("div",null,i.createElement("h2",{className:"text-2xl font-semibold text-gray-900 mb-2"},le.name),i.createElement("p",{className:"text-gray-600 mb-4"},le.description),i.createElement("div",{className:"flex flex-wrap gap-2 mb-4"},le.tags.map((ge,he)=>i.createElement("span",{key:he,className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-sm"},ge))),i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("button",{onClick:()=>V(le.fileUrl),className:"flex items-center text-blue-600 hover:text-blue-800"},i.createElement(Jm,{size:18,className:"mr-2"}),"Open Document"),i.createElement("span",{className:"text-sm text-gray-500"},"Uploaded on ",jt(new Date(le.uploadedAt),"MMMM d, yyyy"))))),ae===le.id?i.createElement("div",{className:"flex items-center text-blue-600"},i.createElement(qo,{className:"animate-spin mr-2",size:20}),"Analyzing... This may take a few minutes"):Z[le.id]?i.createElement("button",{onClick:()=>S(le.id),className:"flex items-center text-blue-600 hover:text-blue-800"},i.createElement($a,{size:20,className:"mr-2"}),"Refresh Analysis"):i.createElement("button",{onClick:()=>S(le.id),className:"flex items-center text-blue-600 hover:text-blue-800"},i.createElement(Jl,{size:20,className:"mr-2"}),"Start Analysis"))),Z[le.id]?fw(Z[le.id],le.id):i.createElement("div",{className:"text-center py-12"},i.createElement(Jl,{size:48,className:"mx-auto text-gray-400 mb-4"}),i.createElement("p",{className:"text-gray-500"},'Click "Start Analysis" to get AI-powered insights about this document.',i.createElement("br",null),i.createElement("span",{className:"text-sm text-gray-400 mt-2 block"},"This process may take a few minutes as it analyzes the document in detail.")))));return i.createElement("div",{className:"p-6 bg-gray-50 min-h-screen"},i.createElement("button",{onClick:Ke,className:"mb-6 flex items-center text-gray-600 hover:text-gray-900 transition-colors"},i.createElement(Zl,{size:20,className:"mr-2"}),i.createElement("span",null,"Back to Onboarding")),i.createElement("div",{className:"mb-6"},i.createElement("h1",{className:"text-2xl font-bold text-gray-800 mb-2"},"Knowledge Base"),i.createElement("p",{className:"text-gray-600"},"Upload documents and call recordings to build your company's knowledge base. The AI will use this information to provide better insights and assistance when handling contacts.")),i.createElement("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-100 mb-6"},i.createElement("div",{className:"flex justify-between items-center"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(eh,{size:18,className:"text-gray-500"}),i.createElement("select",{className:"bg-gray-100 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block p-2.5",value:t,onChange:oe=>e(oe.target.value)},i.createElement("option",{value:"all"},"All Types"),i.createElement("option",{value:"document"},"Documents"),i.createElement("option",{value:"audio"},"Audio / Call Recordings"))),i.createElement("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center",onClick:()=>s(!0)},i.createElement(xs,{size:18,className:"mr-2"}),"Add Resource"))),CC(),pw(),IC())},FB=Ie.create({baseURL:"http://localhost:3001/api"}),dw=[{name:"Context & Preparation",icon:hn,color:"text-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200",description:"Preparation and context setting"},{name:"SBAM & Opening",icon:kW,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",description:"Salutation, Bonjour, Accroche, Motif"},{name:"Legal & Compliance",icon:D1,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",description:"Legal aspects and compliance"},{name:"Need Discovery",icon:Xu,color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-200",description:"Needs discovery and qualification"},{name:"Value Proposition",icon:PW,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",description:"Value proposition presentation"},{name:"Documents/Quote",icon:bW,color:"text-indigo-600",bgColor:"bg-indigo-50",borderColor:"border-indigo-200",description:"Documentation and quotation"},{name:"Objection Handling",icon:Xm,color:"text-pink-600",bgColor:"bg-pink-50",borderColor:"border-pink-200",description:"Objection handling and resolution"},{name:"Confirmation & Closing",icon:mt,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",description:"Confirmation and closing"}],OIe=t=>dw.find(e=>e.name===t)||{name:t,icon:ys,color:"text-gray-600",bgColor:"bg-gray-50",borderColor:"border-gray-200",description:t},LIe=t=>{const e={};t.forEach(r=>{e[r.phase]||(e[r.phase]=[]),e[r.phase].push(r)});const n=dw.map(r=>r.name).filter(r=>e[r]),s=Object.keys(e).filter(r=>!dw.some(a=>a.name===r));return[...n,...s].map(r=>({phaseName:r,steps:e[r]}))},zIe=()=>{const[t,e]=N.useState(!1),[n,s]=N.useState(null),[r,a]=N.useState(null),[o,l]=N.useState(""),[c,u]=N.useState(""),[d,m]=N.useState(""),[h,p]=N.useState(""),[f,y]=N.useState([]),[x,g]=N.useState(null),[b,w]=N.useState(!1),[v,E]=N.useState(null),[k,C]=N.useState([]),[I,A]=N.useState(!1),[$,T]=N.useState(null),[F,O]=N.useState("table"),[M,B]=N.useState(null),[L,Y]=N.useState(null),[D,_]=N.useState("all"),[P,z]=N.useState(null),[q,K]=N.useState(null),[ae,ne]=N.useState([]);N.useState(null);const Z=()=>$e.get("companyId"),ke=()=>{const fe=new CustomEvent("tabChange",{detail:{tab:"company-onboarding"}});window.dispatchEvent(fe)},Ae=async()=>{const fe=Z();if(console.log("[GIGS] Fetching gigs for companyId:",fe),!fe){E("Company ID not found");return}w(!0),E(null);try{const We="https://v25gigsmanualcreationbackend-production.up.railway.app/api",qe=await fetch(`${We}/gigs/company/${fe}`);if(!qe.ok)throw new Error(`Failed to fetch gigs: ${qe.statusText}`);const je=await qe.json();console.log("[GIGS] API response:",je),y(Array.isArray(je.data)?je.data:[])}catch(We){console.error("[GIGS] Error fetching gigs:",We),E(We.message||"Failed to fetch gigs")}finally{w(!1)}},W=async()=>{A(!0),T(null);try{const fe=Z();if(!fe)throw new Error("Company ID not found");const We="http://localhost:3001";let qe=`${We}/api/scripts/company/${fe}`;D!=="all"&&(qe+=`?status=${D}`),console.log("[SCRIPTS] Fetching scripts for companyId:",fe,"with filter:",D,"URL:",qe);const je=await fetch(qe);if(!je.ok)throw new Error(`Failed to fetch scripts: ${je.statusText}`);const it=await je.json();console.log("[SCRIPTS] API response:",it),C(Array.isArray(it.data)?it.data:[])}catch(fe){console.error("[SCRIPTS] Error fetching scripts:",fe),T(fe.message||"Failed to fetch scripts")}finally{A(!1)}};N.useEffect(()=>{Ae(),W()},[]),N.useEffect(()=>{W()},[D]);const le=async()=>{try{const fe=Z();if(!fe)throw new Error("Company ID not found");const qe=`https://v25searchcompanywizardbackend-production.up.railway.app/api/onboarding/companies/${fe}/onboarding/phases/2/steps/8`,je=await FB.put(qe,{status:"completed"});return console.log("Onboarding progress (script) update response:",je.data),je.data&&($e.set("companyOnboardingProgress",JSON.stringify(je.data),{expires:7}),console.log("Updated companyOnboardingProgress cookie with new data")),je.data}catch(fe){throw console.error("Error updating onboarding progress (script):",fe),fe}},we=async fe=>{fe.preventDefault(),e(!0),a(null),s(null);try{const We=Z();if(!We)throw new Error("Company ID not found");if(!x)throw new Error("Vous devez slectionner un gig pour gnrer un script.");const qe={companyId:We,gig:x,typeClient:c,langueTon:h,contexte:d},je=await FB.post("/rag/generate-script",qe);s(je.data);try{await le(),console.log("Successfully updated onboarding progress (script)")}catch(St){console.error("Failed to update onboarding progress (script):",St)}await W(),O("table"),g(null),u(""),p(""),m(""),l("");const it=je.data&&je.data.metadata&&je.data.metadata.scriptId?je.data.metadata.scriptId:null;it?setTimeout(()=>{B(St=>k.find(dt=>dt._id===it)||null)},300):B(null)}catch(We){a(We.response?.data?.error||We.message||"Failed to generate script")}finally{e(!1)}},de=fe=>{const We=f.find(qe=>qe._id===fe)||null;g(We),l(We?.category||"")},Ee=fe=>{B(fe),O("script")},Re=()=>{O(fe=>fe==="form"?"table":"form"),B(null)},ze=()=>{O("table"),B(null)},_e=async(fe,We)=>{z(fe);try{const qe="http://localhost:3001",je=await fetch(`${qe}/api/scripts/${fe}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:We})});if(!je.ok)throw new Error(`Failed to update script status: ${je.statusText}`);const it=await je.json();console.log("[SCRIPTS] Script status updated successfully:",it),C(St=>St.map(dt=>dt._id===fe?{...dt,isActive:We}:dt)),M?._id===fe&&B(St=>St?{...St,isActive:We}:null)}catch(qe){console.error("[SCRIPTS] Error updating script status:",qe),alert(`Failed to update script status: ${qe.message}`)}finally{z(null)}},ht=async fe=>{if(confirm("Are you sure you want to delete this script? This action cannot be undone.")){Y(fe);try{const We="http://localhost:3001",qe=await fetch(`${We}/api/scripts/${fe}`,{method:"DELETE"});if(!qe.ok)throw new Error(`Failed to delete script: ${qe.statusText}`);const je=await qe.json();console.log("[SCRIPTS] Script deleted successfully:",je),C(it=>it.filter(St=>St._id!==fe)),M?._id===fe&&(B(null),O("table"))}catch(We){console.error("[SCRIPTS] Error deleting script:",We),alert(`Failed to delete script: ${We.message}`)}finally{Y(null)}}},X=async fe=>{if(confirm("Are you sure you want to regenerate this script? The current version will be replaced.")){K(fe);try{const We="http://localhost:3001",qe=Z();if(!qe)throw new Error("Company ID not found");const je=await fetch(`${We}/api/scripts/${fe}/regenerate`,{method:"POST",headers:{"X-Company-ID":qe}});if(!je.ok)throw new Error(`Failed to regenerate script: ${je.statusText}`);const it=await je.json();console.log("[SCRIPTS] Script regenerated successfully:",it),C(St=>St.map(dt=>dt._id===fe?it.data:dt)),M?._id===fe&&B(it.data)}catch(We){console.error("[SCRIPTS] Error regenerating script:",We),alert(`Failed to regenerate script: ${We.message}`)}finally{K(null)}}},me=async(fe,We,qe)=>{try{ne(gt=>[...gt,We]);const je="http://localhost:3001",it=Z();if(!it)throw new Error("Company ID not found");const St=await fetch(`${je}/api/scripts/${fe}/refine`,{method:"POST",headers:{"Content-Type":"application/json","X-Company-ID":it},body:JSON.stringify({stepIndex:We,refinementPrompt:qe})});if(!St.ok)throw new Error(`Failed to refine script: ${St.statusText}`);const dt=await St.json();console.log("[SCRIPTS] Script part refined successfully:",dt),C(gt=>gt.map(Qt=>Qt._id===fe?dt.data.fullScript:Qt)),M?._id===fe&&B(dt.data.fullScript)}catch(je){console.error("[SCRIPTS] Error refining script:",je),alert(`Failed to refine script: ${je.message}`)}finally{ne(je=>je.filter(it=>it!==We))}},Fe=async(fe,We,qe)=>{try{const je=qe.replica.trim()===""?" ":qe.replica;ne(gt=>[...gt,We]);const it="http://localhost:3001";await new Promise(gt=>setTimeout(gt,100));const St=await fetch(`${it}/api/scripts/${fe}/content`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({stepIndex:We,newContent:{replica:je}})});if(!St.ok)throw new Error(`Failed to update script content: ${St.statusText}`);const dt=await St.json();console.log("[SCRIPTS] Script content updated successfully:",dt),C(gt=>gt.map(Qt=>Qt._id===fe?dt.data.fullScript:Qt)),M?._id===fe&&B(dt.data.fullScript)}catch(je){console.error("[SCRIPTS] Error updating script content:",je),alert(`Failed to update script content: ${je.message}`)}finally{ne(je=>je.filter(it=>it!==We))}},tt=async(fe,We,qe)=>{try{const je="http://localhost:3001",it=M?.script.filter(Bs=>Bs.phase===We)||[],St=M?.script.findIndex(Bs=>Bs.phase===We&&Bs.replica===it[it.length-1].replica),dt=St!==void 0?St+1:M?.script.length||0,gt=await fetch(`${je}/api/scripts/${fe}/replicas`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phase:We,actor:qe,insertIndex:dt})});if(!gt.ok)throw new Error(`Failed to add replica: ${gt.statusText}`);const Qt=await gt.json();C(Bs=>Bs.map(S=>S._id===fe?Qt.data.fullScript:S)),M?._id===fe&&B(Qt.data.fullScript),at({index:Qt.data.insertedIndex,text:""})}catch(je){console.error("[SCRIPTS] Error adding replica:",je),alert(`Failed to add replica: ${je.message}`)}},Oe=async(fe,We)=>{if(confirm("Are you sure you want to delete this replica? This action cannot be undone."))try{const qe="http://localhost:3001",je=await fetch(`${qe}/api/scripts/${fe}/replicas/${We}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!je.ok)throw new Error(`Failed to delete replica: ${je.statusText}`);const it=await je.json();C(St=>St.map(dt=>dt._id===fe?it.data.fullScript:dt)),M?._id===fe&&B(it.data.fullScript)}catch(qe){console.error("[SCRIPTS] Error deleting replica:",qe),alert(`Failed to delete replica: ${qe.message}`)}},[Ye,at]=N.useState(null),[At,wt]=N.useState(null);return i.createElement("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50"},i.createElement("div",{className:"max-w-6xl mx-auto p-6"},i.createElement("div",{className:"mb-8 flex items-center justify-between bg-white rounded-2xl shadow-lg p-6 border border-gray-100"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("button",{onClick:ke,className:"p-3 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-xl transition-all duration-200 group",title:"Back to Orchestrator"},i.createElement(Zl,{className:"w-6 h-6 group-hover:scale-110 transition-transform"})),i.createElement("div",{className:"flex items-center gap-3"},i.createElement("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl"},i.createElement(th,{className:"w-8 h-8 text-white"})),i.createElement("div",null,i.createElement("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent"},"Script Generator"),i.createElement("p",{className:"text-gray-500 text-sm"},"Create personalized call scripts for your gigs")))),F!=="form"&&i.createElement("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 font-medium",onClick:Re},i.createElement(xs,{className:"w-5 h-5"}),"Generate New Script"),(F==="form"||F==="script")&&i.createElement("button",{className:"px-6 py-3 bg-white text-gray-700 border-2 border-gray-200 rounded-xl hover:bg-gray-50 hover:border-gray-300 shadow-md hover:shadow-lg transition-all duration-200 flex items-center gap-2 font-medium",onClick:ze},i.createElement(Zl,{className:"w-5 h-5"}),"Back to Scripts")),F==="table"&&i.createElement("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden"},i.createElement("div",{className:"p-6 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-blue-50"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",null,i.createElement("h3",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2"},i.createElement(ys,{className:"w-6 h-6 text-blue-600"}),"Your Generated Scripts"),i.createElement("p",{className:"text-gray-600 text-sm mt-1"},"Manage and view all your call scripts")),i.createElement("div",{className:"flex items-center gap-2"},i.createElement(eh,{className:"w-4 h-4 text-gray-500"}),i.createElement("select",{value:D,onChange:fe=>_(fe.target.value),className:"px-3 py-2 border border-gray-200 rounded-lg bg-white text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200"},i.createElement("option",{value:"all"},"All Scripts"),i.createElement("option",{value:"active"},"Active Scripts"),i.createElement("option",{value:"inactive"},"Inactive Scripts"))))),I?i.createElement("div",{className:"p-12 text-center"},i.createElement("div",{className:"inline-flex items-center gap-3 text-gray-600"},i.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),"Loading your scripts...")):$?i.createElement("div",{className:"p-8 m-6 bg-red-50 border border-red-200 rounded-xl"},i.createElement("div",{className:"flex items-center gap-3 text-red-700"},i.createElement("div",{className:"p-2 bg-red-100 rounded-lg"},i.createElement("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),i.createElement("div",null,i.createElement("p",{className:"font-medium"},"Error loading scripts"),i.createElement("p",{className:"text-sm"},$)))):k.length===0?i.createElement("div",{className:"p-12 text-center"},i.createElement("div",{className:"p-4 bg-gray-100 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center"},i.createElement(th,{className:"w-8 h-8 text-gray-400"})),D==="all"?i.createElement(i.Fragment,null,i.createElement("h4",{className:"text-lg font-medium text-gray-700 mb-2"},"No scripts yet"),i.createElement("p",{className:"text-gray-500 mb-6"},"Create your first call script to get started"),i.createElement("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 font-medium mx-auto",onClick:Re},i.createElement(xs,{className:"w-5 h-5"}),"Generate Your First Script")):D==="active"?i.createElement(i.Fragment,null,i.createElement("h4",{className:"text-lg font-medium text-gray-700 mb-2"},"No active scripts"),i.createElement("p",{className:"text-gray-500 mb-6"},"All your scripts are currently inactive. You can activate them or create new ones."),i.createElement("div",{className:"space-y-3"},i.createElement("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 font-medium mx-auto",onClick:Re},i.createElement(xs,{className:"w-5 h-5"}),"Create New Script"),i.createElement("button",{className:"px-6 py-3 bg-white text-gray-700 border-2 border-gray-200 rounded-xl hover:bg-gray-50 hover:border-gray-300 shadow-md hover:shadow-lg transition-all duration-200 flex items-center gap-2 font-medium mx-auto",onClick:()=>_("all")},i.createElement(eh,{className:"w-5 h-5"}),"View All Scripts"))):i.createElement(i.Fragment,null,i.createElement("h4",{className:"text-lg font-medium text-gray-700 mb-2"},"No inactive scripts"),i.createElement("p",{className:"text-gray-500 mb-6"},"All your scripts are currently active. Great job keeping your scripts organized!"),i.createElement("div",{className:"space-y-3"},i.createElement("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 font-medium mx-auto",onClick:Re},i.createElement(xs,{className:"w-5 h-5"}),"Create New Script"),i.createElement("button",{className:"px-6 py-3 bg-white text-gray-700 border-2 border-gray-200 rounded-xl hover:bg-gray-50 hover:border-gray-300 shadow-md hover:shadow-lg transition-all duration-200 flex items-center gap-2 font-medium mx-auto",onClick:()=>_("all")},i.createElement(eh,{className:"w-5 h-5"}),"View All Scripts")))):i.createElement("div",{className:"overflow-x-auto"},i.createElement("table",{className:"min-w-full"},i.createElement("thead",{className:"bg-gradient-to-r from-gray-50 to-blue-50"},i.createElement("tr",null,i.createElement("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700"},"Gig"),i.createElement("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700"},"Target Client"),i.createElement("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700"},"Language"),i.createElement("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700"},"Status"),i.createElement("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-700"},"Created"),i.createElement("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-700"},"Action"))),i.createElement("tbody",{className:"divide-y divide-gray-100"},k.map((fe,We)=>(fe.gig||f.find(qe=>qe._id===fe.gigId),i.createElement("tr",{key:fe._id,className:"hover:bg-blue-50 transition-colors duration-150 group"},i.createElement("td",{className:"px-6 py-4"},i.createElement("div",{className:"flex items-center gap-3"},i.createElement("div",{className:"p-2 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},i.createElement(ys,{className:"w-4 h-4 text-blue-600"})),i.createElement("div",{className:"flex-1"},i.createElement("div",{className:"flex items-center gap-2"},i.createElement("p",{className:"font-semibold text-gray-800"},fe.gig?.title||"Untitled Gig")),i.createElement("p",{className:"text-sm text-gray-500"},fe.gig?.category||"No category")))),i.createElement("td",{className:"px-6 py-4"},i.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800"},fe.targetClient)),i.createElement("td",{className:"px-6 py-4"},i.createElement("div",{className:"flex items-center gap-2"},i.createElement(gs,{className:"w-4 h-4 text-gray-400"}),i.createElement("span",{className:"text-gray-700"},fe.language))),i.createElement("td",{className:"px-6 py-4"},i.createElement("div",{className:"flex items-center gap-2"},i.createElement("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${fe.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`},i.createElement("div",{className:`w-2 h-2 rounded-full mr-1 ${fe.isActive?"bg-green-500":"bg-gray-500"}`}),fe.isActive?"Active":"Inactive"))),i.createElement("td",{className:"px-6 py-4"},i.createElement("div",{className:"flex items-center gap-2 text-gray-600"},i.createElement(Ia,{className:"w-4 h-4"}),i.createElement("span",{className:"text-sm"},new Date(fe.createdAt).toLocaleDateString()))),i.createElement("td",{className:"px-6 py-4 text-center"},i.createElement("div",{className:"flex items-center justify-center gap-2"},i.createElement("button",{className:"inline-flex items-center gap-1 px-3 py-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-all duration-200 font-medium",onClick:()=>Ee(fe),title:"View script"},i.createElement(Qm,{className:"w-4 h-4"}),"View"),i.createElement("button",{className:`inline-flex items-center gap-1 px-3 py-2 rounded-lg transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed ${fe.isActive?"text-orange-600 hover:text-orange-800 hover:bg-orange-50":"text-green-600 hover:text-green-800 hover:bg-green-50"}`,onClick:()=>_e(fe._id,!fe.isActive),disabled:P===fe._id,title:fe.isActive?"Deactivate script":"Activate script"},P===fe._id?i.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):fe.isActive?i.createElement(fA,{className:"w-4 h-4"}):i.createElement(pA,{className:"w-4 h-4"}),P===fe._id?"Updating...":fe.isActive?"Deactivate":"Activate"),i.createElement("button",{className:"inline-flex items-center gap-1 px-3 py-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>ht(fe._id),disabled:L===fe._id,title:"Delete script"},L===fe._id?i.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-600"}):i.createElement(Hr,{className:"w-4 h-4"}),L===fe._id?"Deleting...":"Delete")))))))))),F==="script"&&M&&i.createElement("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden animate-fade-in"},i.createElement("div",{className:"p-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white"},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("div",{className:"p-3 bg-white/20 rounded-xl"},i.createElement(th,{className:"w-8 h-8"})),i.createElement("div",null,i.createElement("div",{className:"flex items-center gap-3 mb-1"},i.createElement("h3",{className:"text-2xl font-bold"},"Call Script"),i.createElement("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold bg-white/20 text-white border border-white/30"},"Structured Call")),i.createElement("p",{className:"text-blue-100"},"Ready to use conversation guide with structured phases"))),i.createElement("button",{onClick:()=>X(M._id),disabled:q===M._id,className:"px-4 py-2 bg-white/20 hover:bg-white/30 disabled:bg-white/10 disabled:cursor-not-allowed rounded-lg flex items-center gap-2 transition-all duration-200"},q===M._id?i.createElement(i.Fragment,null,i.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Regenerating..."):i.createElement(i.Fragment,null,i.createElement($a,{className:"w-4 h-4"}),"Regenerate Script")))),i.createElement("div",{className:"p-6 border-b border-gray-100 bg-gray-50"},i.createElement("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4"},i.createElement("div",{className:"flex items-center gap-2"},i.createElement(ys,{className:"w-4 h-4 text-blue-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 uppercase tracking-wide"},"Gig"),i.createElement("p",{className:"font-medium text-gray-800"},M.gig?.title||"Untitled Gig"),i.createElement("p",{className:"text-xs text-gray-500"},M.gig?.category||"No category"))),i.createElement("div",{className:"flex items-center gap-2"},i.createElement(Zu,{className:"w-4 h-4 text-purple-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 uppercase tracking-wide"},"Target Client"),i.createElement("p",{className:"font-medium text-gray-800"},M.targetClient))),i.createElement("div",{className:"flex items-center gap-2"},i.createElement(gs,{className:"w-4 h-4 text-green-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 uppercase tracking-wide"},"Language"),i.createElement("p",{className:"font-medium text-gray-800"},M.language))),i.createElement("div",{className:"flex items-center gap-2"},M.isActive?i.createElement(fA,{className:"w-4 h-4 text-green-600"}):i.createElement(pA,{className:"w-4 h-4 text-gray-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 uppercase tracking-wide"},"Status"),i.createElement("p",{className:`font-medium ${M.isActive?"text-green-800":"text-gray-800"}`},M.isActive?"Active":"Inactive"))),i.createElement("div",{className:"flex items-center gap-2"},i.createElement(Ia,{className:"w-4 h-4 text-orange-600"}),i.createElement("div",null,i.createElement("p",{className:"text-xs text-gray-500 uppercase tracking-wide"},"Created"),i.createElement("p",{className:"font-medium text-gray-800"},new Date(M.createdAt).toLocaleDateString())))),M.details&&i.createElement("div",{className:"mt-4 p-4 bg-blue-50 rounded-xl"},i.createElement("p",{className:"text-sm text-gray-600"},i.createElement("span",{className:"font-medium"},"Context:")," ",M.details))),i.createElement("div",{className:"p-6"},i.createElement("div",{className:"space-y-8"},q===M?._id?i.createElement("div",{className:"flex flex-col items-center justify-center py-12"},i.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mb-4"}),i.createElement("p",{className:"text-gray-600 font-medium"},"Regenerating Script..."),i.createElement("p",{className:"text-sm text-gray-500 mt-2"},"This may take a few moments")):Array.isArray(M?.script)&&M.script.length>0?LIe(M.script).map((fe,We)=>{const qe=OIe(fe.phaseName),je=qe.icon;return i.createElement("div",{key:We,className:"relative"},i.createElement("div",{className:`mb-6 p-4 rounded-xl border-2 ${qe.bgColor} ${qe.borderColor} shadow-sm`},i.createElement("div",{className:"flex items-center justify-between"},i.createElement("div",{className:"flex items-center gap-3"},i.createElement("div",{className:`p-3 bg-white rounded-lg shadow-md ${qe.color}`},i.createElement(je,{className:"w-6 h-6"})),i.createElement("div",null,i.createElement("h4",{className:`text-lg font-bold ${qe.color}`},fe.phaseName),i.createElement("p",{className:"text-sm text-gray-600 mt-1"},qe.description))),i.createElement("div",{className:"flex items-center gap-2"},i.createElement("button",{onClick:()=>tt(M._id,fe.phaseName,"agent"),className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors flex items-center gap-1"},i.createElement(xs,{className:"w-4 h-4"}),"Add Agent Response"),i.createElement("button",{onClick:()=>tt(M._id,fe.phaseName,"lead"),className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors flex items-center gap-1"},i.createElement(xs,{className:"w-4 h-4"}),"Add Lead Response")))),i.createElement("div",{className:"space-y-4 ml-4 border-l-2 border-gray-200 pl-6 relative"},fe.steps.map((it,St)=>{const dt=M.script.findIndex(gt=>gt.phase===it.phase&&gt.actor===it.actor&&gt.replica===it.replica);return i.createElement("div",{key:St,className:"flex items-start gap-4 group relative"},i.createElement("div",{className:`absolute -left-7 top-4 w-3 h-3 rounded-full border-2 border-white shadow-sm ${qe.bgColor} ${qe.borderColor}`}),i.createElement("div",{className:"flex-shrink-0"},it.actor==="agent"?i.createElement("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl shadow-lg"},i.createElement(th,{className:"w-5 h-5 text-white"})):i.createElement("div",{className:"p-3 bg-gradient-to-r from-green-500 to-green-600 rounded-xl shadow-lg"},i.createElement(Zu,{className:"w-5 h-5 text-white"}))),i.createElement("div",{className:"flex-1 min-w-0"},i.createElement("div",{className:"rounded-2xl px-6 py-4 shadow-md border-l-4 transition-all duration-200 group-hover:shadow-lg "+(it.actor==="agent"?"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-500 text-blue-900":"bg-gradient-to-r from-green-50 to-green-100 border-green-500 text-green-900")},i.createElement("div",{className:"flex flex-col gap-2"},i.createElement("span",{className:"font-bold text-sm uppercase tracking-wide opacity-75"},it.actor==="agent"?"Agent":"Lead",":"),i.createElement("div",{className:"min-h-[24px]"}," ",ae.includes(dt)?i.createElement("div",{className:"flex items-center gap-3"},i.createElement("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}),i.createElement("span",{className:"text-sm font-medium"},"Updating response...")):i.createElement("p",{className:"leading-relaxed whitespace-pre-wrap"},it.replica))))),i.createElement("div",{className:"absolute right-0 top-0 opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2"},i.createElement("button",{onClick:()=>Oe(M._id,dt),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200",title:"Delete replica"},i.createElement(Hr,{className:"w-4 h-4"})),i.createElement("button",{onClick:()=>at({index:dt,text:it.replica}),className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200",title:"Edit directly"},i.createElement(A1,{className:"w-4 h-4"})),i.createElement("button",{onClick:()=>wt({index:dt,prompt:""}),className:"p-2 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-all duration-200",title:"Refine with prompt"},i.createElement(Ko,{className:"w-4 h-4"}))),Ye?.index===dt&&i.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},i.createElement("div",{className:"bg-white rounded-xl p-6 max-w-2xl w-full max-h-[90vh] flex flex-col"},i.createElement("h3",{className:"text-lg font-bold mb-4"},"Edit Response"),i.createElement("div",{className:"flex-1 min-h-0 overflow-y-auto"},i.createElement("textarea",{value:Ye.text,onChange:gt=>at({...Ye,text:gt.target.value}),className:"w-full h-full min-h-[200px] p-3 border-2 border-gray-200 rounded-lg mb-4 resize-none"})),i.createElement("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200"},i.createElement("button",{onClick:()=>at(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg"},"Cancel"),i.createElement("button",{onClick:()=>{Fe(M._id,dt,{replica:Ye.text}),at(null)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},"Save Changes")))),At?.index===dt&&i.createElement("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},i.createElement("div",{className:"bg-white rounded-xl p-6 max-w-2xl w-full max-h-[90vh] flex flex-col"},i.createElement("h3",{className:"text-lg font-bold mb-4"},"Refine Response"),i.createElement("div",{className:"flex-1 min-h-0 overflow-y-auto"},i.createElement("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg"},i.createElement("p",{className:"text-sm text-gray-600 mb-2"},"Current response:"),i.createElement("p",{className:"text-gray-800"},it.replica)),i.createElement("textarea",{value:At.prompt,onChange:gt=>wt({...At,prompt:gt.target.value}),placeholder:"Describe how you want to refine this response...",className:"w-full h-full min-h-[200px] p-3 border-2 border-gray-200 rounded-lg resize-none"})),i.createElement("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200"},i.createElement("button",{onClick:()=>wt(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg"},"Cancel"),i.createElement("button",{onClick:()=>{me(M._id,dt,At.prompt),wt(null)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700"},"Refine Response")))))})))}):i.createElement("div",{className:"text-center py-12"},i.createElement("div",{className:"p-4 bg-gray-100 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center"},i.createElement(th,{className:"w-8 h-8 text-gray-400"})),i.createElement("p",{className:"text-gray-500"},"No script content available"))))),F==="form"&&i.createElement("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden animate-fade-in"},i.createElement("div",{className:"p-6 bg-gradient-to-r from-purple-600 to-blue-600 text-white"},i.createElement("div",{className:"flex items-center gap-4"},i.createElement("div",{className:"p-3 bg-white/20 rounded-xl"},i.createElement(xs,{className:"w-8 h-8"})),i.createElement("div",null,i.createElement("h3",{className:"text-2xl font-bold"},"Create New Script"),i.createElement("p",{className:"text-purple-100"},"Generate a personalized call script for your gig")))),i.createElement("form",{onSubmit:we,className:"p-8 space-y-6"},i.createElement("div",{className:"mb-8 p-6 bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-xl"},i.createElement("h4",{className:"text-lg font-bold text-purple-800 mb-2 flex items-center gap-2"},i.createElement(ys,{className:"w-5 h-5"}),"Structured Call Script"),i.createElement("p",{className:"text-purple-700 mb-4"},"Your script will be generated following a proven methodology with these key phases:"),i.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},dw.map((fe,We)=>{const qe=fe.icon;return i.createElement("div",{key:We,className:`p-3 rounded-lg border ${fe.bgColor} ${fe.borderColor} transition-all duration-200 hover:shadow-md`},i.createElement("div",{className:"flex items-center gap-2"},i.createElement(qe,{className:`w-4 h-4 ${fe.color}`}),i.createElement("p",{className:`text-xs font-semibold ${fe.color} leading-tight`},fe.name)))}))),i.createElement("div",{className:"grid md:grid-cols-2 gap-6"},i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Select Gig ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("select",{value:x?._id||"",onChange:fe=>de(fe.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white",required:!0},i.createElement("option",{value:""},"Choose a gig to create script for..."),f.map(fe=>i.createElement("option",{key:fe._id,value:fe._id},fe.title||fe.category)))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Domain"),i.createElement("input",{type:"text",value:o,readOnly:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl bg-gray-50 text-gray-600 cursor-not-allowed",placeholder:"Auto-filled from selected gig"}))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Target Client (DISC Profile) ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("select",{value:c,onChange:fe=>u(fe.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white",required:!0},i.createElement("option",{value:""},"Select client personality type..."),i.createElement("option",{value:"D"}," D: Direct and results-oriented"),i.createElement("option",{value:"I"}," I: Enthusiastic and relational"),i.createElement("option",{value:"S"}," S: Reassuring and stable"),i.createElement("option",{value:"C"}," C: Structured and analytical"))),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Context ",i.createElement("span",{className:"text-gray-400"},"(optional but recommended)")),i.createElement("textarea",{value:d,onChange:fe=>m(fe.target.value),placeholder:"Provide additional context like client history, emotional state, common objections, or specific situation details...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white resize-none",rows:3})),i.createElement("div",null,i.createElement("label",{className:"block text-sm font-semibold text-gray-700 mb-2"},"Language & Tone ",i.createElement("span",{className:"text-red-500"},"*")),i.createElement("input",{type:"text",value:h,onChange:fe=>p(fe.target.value),placeholder:"e.g., Professional yet warm, Casual and friendly, Formal and authoritative...",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 bg-white",required:!0})),i.createElement("div",{className:"pt-4"},i.createElement("button",{type:"submit",disabled:t||!x||!o.trim()||!c.trim()||!h.trim(),className:"w-full px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-4 focus:ring-blue-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 font-semibold text-lg shadow-lg hover:shadow-xl transition-all duration-200"},t?i.createElement(i.Fragment,null,i.createElement("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"}),"Generating Your Script..."):i.createElement(i.Fragment,null,i.createElement(xs,{className:"w-6 h-6"}),"Generate Script"))),r&&i.createElement("div",{className:"p-6 bg-red-50 border-2 border-red-200 rounded-xl animate-bounce"},i.createElement("div",{className:"flex items-center gap-3"},i.createElement("div",{className:"p-2 bg-red-100 rounded-lg"},i.createElement("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20"},i.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))),i.createElement("div",null,i.createElement("p",{className:"text-red-800 font-semibold"},"Something went wrong"),i.createElement("p",{className:"text-red-700 text-sm mt-1"},r))))))))};function BIe(){const[t,e]=N.useState("company-onboarding"),[n,s]=N.useState(!0),[r,a]=N.useState("Admin User"),o=window.location.pathname==="/zoho-callback",l=window.location.pathname==="/zoho-auth";N.useEffect(()=>{const d=$e.get("userId");if(!d&&!o&&!l){console.log("User ID not found, redirecting to /auth"),window.location.href="/auth";return}(async()=>{if(d)try{const y="https://v25registrationbackend-production.up.railway.app";console.log("Fetching user details for userId:",d),console.log("Registration backend URL:",y);const x=await fetch(`${y}/api/users/${d}`);if(console.log("Response status:",x.status),x.ok){const g=await x.json();console.log("User data received:",g),g.data&&g.data.fullName?(console.log("Setting user full name to:",g.data.fullName),a(g.data.fullName)):console.log("No fullName in user data")}else console.error("Response not OK:",x.status,x.statusText)}catch(y){console.error("Error fetching user details:",y)}else console.log("No userId found in cookies")})(),(async()=>{lo.getInstance()})().catch(y=>{console.debug("App: Error initializing Zoho",y)});const p=y=>{y.detail&&y.detail.tab&&e(y.detail.tab)},f=localStorage.getItem("activeTab");return f&&(e(f),localStorage.removeItem("activeTab")),window.addEventListener("tabChange",p),()=>{window.removeEventListener("tabChange",p)}},[]);const c=()=>{const d=$e.get();Object.keys(d).forEach(m=>{$e.remove(m,{path:"/"}),$e.remove(m)}),localStorage.clear(),window.location.href="/app1"},u=()=>{if(o)return i.createElement(PIe,null);if(l)return i.createElement(FIe,null);switch(t){case"profile-creation":return i.createElement(Aj,null);case"gig-generation":return i.createElement(Rj,null);case"matching":return i.createElement(v8,null);case"approval-publishing":return i.createElement(RR,null);case"optimization":return i.createElement(j7,null);case"knowledge-base":return i.createElement(MIe,null);case"script-generator":return i.createElement(zIe,null);case"company-onboarding":default:return i.createElement(DIe,null)}};return o||l?i.createElement("div",{className:"flex h-screen bg-gray-50"},i.createElement(NA,{position:"top-right"}),i.createElement("main",{className:"flex-1 overflow-y-auto"},u())):i.createElement("div",{className:"flex h-screen bg-gray-50"},i.createElement(NA,{position:"top-right"}),i.createElement("div",{className:`${n?"translate-x-0":"-translate-x-full"} fixed inset-y-0 left-0 z-30 w-64 bg-indigo-900 text-white transition-transform duration-300 ease-in-out md:relative md:translate-x-0`},i.createElement("div",{className:"flex h-16 items-center justify-between px-4 border-b border-indigo-800"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement(cW,{className:"h-6 w-6"}),i.createElement("span",{className:"text-xl font-bold"},"Smart Orchestrator")),i.createElement("button",{className:"md:hidden",onClick:()=>s(!1)},i.createElement(Yo,{className:"h-6 w-6"}))),i.createElement("nav",{className:"mt-6 px-4"},i.createElement("div",{className:"space-y-4"},i.createElement("button",{className:`flex w-full items-center space-x-2 rounded-lg py-2 px-3 ${t==="company-onboarding"?"bg-indigo-800":"hover:bg-indigo-800"}`,onClick:()=>e("company-onboarding")},i.createElement(Ym,{className:"h-5 w-5"}),i.createElement("span",null,"Company Onboarding"))),i.createElement("div",{className:"absolute bottom-0 left-0 right-0 border-t border-indigo-800 p-4"},i.createElement("div",{className:"space-y-4"},i.createElement("button",{className:"flex w-full items-center space-x-2 rounded-lg py-2 px-3 hover:bg-indigo-800"},i.createElement(Gr,{className:"h-5 w-5"}),i.createElement("span",null,"Settings")),i.createElement("button",{className:"flex w-full items-center space-x-2 rounded-lg py-2 px-3 hover:bg-indigo-800"},i.createElement(oA,{className:"h-5 w-5"}),i.createElement("span",null,"Help")),i.createElement("button",{onClick:c,className:"flex w-full items-center space-x-2 rounded-lg py-2 px-3 hover:bg-indigo-800"},i.createElement(TW,{className:"h-5 w-5"}),i.createElement("span",null,"Logout")))))),i.createElement("div",{className:"flex flex-1 flex-col overflow-hidden"},i.createElement("header",{className:"bg-white shadow-sm"},i.createElement("div",{className:"flex h-16 items-center justify-between px-4"},i.createElement("button",{className:"md:hidden",onClick:()=>s(!0)},i.createElement(AW,{className:"h-6 w-6"})),i.createElement("div",{className:"flex items-center space-x-4"},i.createElement("div",{className:"relative"},i.createElement("div",{className:"flex items-center space-x-2"},i.createElement("div",{className:"h-8 w-8 rounded-full bg-indigo-600 flex items-center justify-center text-white"},r.charAt(0).toUpperCase()),i.createElement("span",{className:"font-medium"},r)))))),i.createElement("main",{className:"flex-1 overflow-y-auto p-4"},u())))}let SC=null;function MB(t){const{container:e}=t,n=e?e.querySelector("#root"):document.getElementById("root");n?(console.log("[app11] Rendering in container:",n),SC||(SC=ZT(n)),SC.render(i.createElement(i.StrictMode,null,i.createElement(BIe,null)))):console.warn("[app11] Root element not found!")}tU.__POWERED_BY_QIANKUN__?(console.log("[app11] Running inside Qiankun"),MB({})):(console.log("[app11] Running in standalone mode"),MB({}))});
